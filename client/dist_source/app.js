!function(e){function t(t){for(var r,i,l=t[0],s=t[1],c=t[2],d=0,m=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&m.push(n[i][0]),n[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,l=1;l<a.length;l++){var s=a[l];0!==n[s]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={0:0},o=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],a=n[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,r){a=n[e]=[t,r]}));t.push(a[2]=r);var o,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=function(e){return i.p+""+({}[e]||e)+".js"}(e);var s=new Error;o=function(t){l.onerror=l.onload=null,clearTimeout(c);var a=n[e];if(0!==a){if(a){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,a[1](s)}n[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:l})}),12e4);l.onerror=l.onload=o,document.head.appendChild(l)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/static/",i.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;o.push([739,2]),a()}(Array(104).concat([function(e,t,a){e.exports=a.p+"images/icon_small.png"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"images/dashboard-example/dashboards_prettify_1.jpg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"images/dashboard-example/dashboards_prettify_2.jpg"},function(e,t,a){e.exports=a.p+"images/dashboard-example/dashboards_prettify_3.jpg"},,,function(e,t,a){e.exports=a.p+"images/db-logos/csv.png"},,,function(e){e.exports=JSON.parse('"dev"')},,,,,,,,,,,function(e,t,a){e.exports=a.p+"images/avatar.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){e.exports=a.p+"images/copy.png"},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports="# DeepBI 使用说明\n\n\n## 1，配置 API KEY\n\n- [设置]-[API KEY]\n\n### 1.1, 关于 OPENAI API KEY:\n\n- API KEY 需要 OPENAI GPT4 模型的访问权限\n- 后续会陆续支持其他大模型，敬请期待\n\n### 1.2, 关于 代理:\n\n- OPENAI API 访问可能需要科学上网,请小伙伴们自行配置代理\n\n- KEY和代理配置完毕后，配置完毕后，点击【连接测试】，显示 测试通过 即可。\n测试不通过的情况，请自行检查 API KEY是否可用，以及代理是否配置正确。\n\n![doc_0.png](/static/images/cn/img/doc_0.png)\n\n### 1.3, 关于 DeepInsight API KEY:\n- 可以点击 设置key 下面的连接，进行注册，获取API Key.(可以加我们微信群(首页联系我们)，申请免费的Token)\n\n![doc_0.png](/static/images/cn/img/us_key.png)\n\n## 2, 配置 数据源\n\n- 目前支持的数据源有， MySql，Doris, starRocks, PostgreSql, 和 CSV\n- 后续会陆续支持更多数据源，如sqlserver，clickhouse，SQLite等，敬请期待\n\n### 2.1, CSV数据源配置:\n\n- 【设置】-【CSV数据源】-【点击上传】- 选择需上传的csv文件即可\n\n![doc.png](/static/images/cn/img/doc_1.png)\n\n### 2.2, [MySql，Doris, starRocks, PostgreSql] 数据源配置:\n\n- 【设置】-【数据源】-【新建一个数据源】\n- 选择数据源，填写数据库信息，并保存\n- 配置完毕后，点击【连接测试】，显示 连接成功 即可\n\n![doc.png](/static/images/cn/img/doc_2.png)\n\n![doc.png](/static/images/cn/img/doc_3.png)\n\n## 3, 数据分析\n\n### 3.1, [数据分析] - [对话]\n\n#### 3.1.1. 勾选数据（数据源和表）\n\n- 勾选的数据会作为对话数据分析中AI的基础数据\n\n#### 3.1.2, 填写注释，提交AI检测\n\n- 尽量完善表格和字段注释，协助AI更好的理解这些数据，使Agent更好的完成数据分析任务\n\n![doc.png](/static/images/cn/img/doc_4.png)\n\n#### 3.1.3, 修改未通过的注释，再次提交\n\n- AI会反馈未通过的注释，请修改补充后，再次提交，直到所有注释通过检测\n\n![doc.png](/static/images/cn/img/doc_5.png)\n\n#### 3.1.4, 所有注释检测通过后，开始对话\n\n- 🔥 注: 若要生成持久化报表，请使用【报表】-【报表生成】，数据分析中出现的报表均为临时报表，不支持持久化\n\n![doc.png](/static/images/cn/img/doc_6.png)\n\n#### 3.1.5, 重选数据源\n\n- 若要重选数据源，进行新一轮对话，请点击【新对话】，重置当前对话，当前对话记录会存储进【历史对话】中\n\n![doc.png](/static/images/cn/img/doc_7.png)\n\n### 3.2, 【数据分析】-【历史对话】\n- 可查看历史对话记录\n\n![doc.png](/static/images/cn/img/doc_8.png)\n\n## 4, 报表 \n\n### 4.1,【报表】-【报表生成】\n\n#### 4.1.1. Check the data (data source and table)\n\n- 勾选的数据会作为报表生成中AI的基础数据\n- 🔥注: 目前CSV数据源不支持【报表生成】\n\n#### 4.1.2, 填写注释，提交AI检测\n\n- 尽量完善表格和字段注释，协助AI更好的理解这些数据，使Agent更好的完成报表生成任务\n\n![doc.png](/static/images/cn/img/doc_9.png)\n\n#### 4.1.3, 修改未通过的注释，再次提交\n\n- AI会反馈未通过的注释，请修改补充后，再次提交, 直到所有注释检测通过\n\n![doc.png](/static/images/cn/img/doc_10.png)\n\n#### 4.1.4, 所有注释检测通过后，开始对话生成报表\n\n- 点击【编辑报表】，可直接编辑 新生成的报表.\n- 🔥 注: 【报表生成】模块目前仅支持持久化报表生成任务，分析类问题，请使用【数据分析】-【对话】\n\n![doc.png](/static/images/cn/img/doc_11.png)\n\n#### 4.1.5, 重选数据源\n\n- 若要重选数据源，进行新一轮对话，请点击【新对话】，重置当前对话\n\n![doc.png](/static/images/cn/img/doc_12.png)\n\n### 4.2, 【报表】-【报表列表】\n\n#### 4.2.1, 报表状态\n\n- 【报表生成】中新生成的报表会出现在【报表列表】中，此时报表为 草稿 状态，若想要在【仪表盘】展示该报表，请点击 【发布】 按钮，将报表状态变更为 已发布 状态\n\n![doc.png](/static/images/cn/img/doc_13.png)\n\n![doc.png](/static/images/cn/img/doc_14.png)\n\n#### 4.2.2, 修改SQL语句\n\n- 点击【编辑源】，可自定义修改报表的SQL语句.\n\n![doc.png](/static/images/cn/img/doc_15.png)\n\n#### 4.2.3, 修改图表样式\n\n- 点击【编辑可视化】，可自定义编辑 可视化图表样式\n- 点击【新增可视化】，可增加可视化图表\n\n![doc.png](/static/images/cn/img/doc_16.png)\n\n![doc.png](/static/images/cn/img/doc_17.png)\n\n#### 4.2.4, 删除报表\n\n- 点击【归档】，可将报表状态变更为 归档（删除）状态\n\n![doc.png](/static/images/cn/img/doc_18.png)\n\n### 5, 仪表盘\n\n#### 5.1, 新建仪表盘\n\n- 【仪表盘】-【新建】- 编辑仪表盘\n\n![doc.png](/static/images/cn/img/doc_19.png)\n\n- 将刚生成的【已发布 】报表，添加进仪表盘\n\n![doc.png](/static/images/cn/img/doc_20.png)\n\n- 点击【发布】仪表盘\n\n![doc.png](/static/images/cn/img/doc_21.png)\n\n#### 5.1.2 分享仪表盘 \n\n- 点击【发布】后，即可分享仪表盘\n\n![doc.png](/static/images/cn/img/doc_22.png)\n\n#### 5.2 仪表盘美化\n- 选中一个已经存在的仪表盘\n![doc.png](/static/images/cn/img/doc_22_1.png)\n- 点击进入\n![doc.png](/static/images/cn/img/doc_22_2.png)\n- 选择模板，点击应用\n![doc.png](/static/images/cn/img/doc_22_3.png)\n- 进入美化大屏，等待AI自动转换完成\n![doc.png](/static/images/cn/img/doc_22_4.png)\n![doc.png](/static/images/cn/img/doc_22_5.png)\n- 转换完成\n![doc.png](/static/images/cn/img/doc_22_6.png)\n- 点击查看大屏\n![doc.png](/static/images/cn/img/doc_22_7.png)\n\n## 6, 自动数据分析 \n\n#### 6.1 添加分析任务 \n1. 点击自动数据分析\n2. 选择自动数据分析\n3. 点击下拉框\n4. 选择数据源\n\n![doc.png](/static/images/cn/img/doc_23.png)\n\n#### 6.2 确认报告所需表  \n1. 选择数据表备注表字段信息\n2. 选择报告使用的表，可以选择多个表\n3. 备注表字段信息\n4. 然后提交\n\n![doc.png](/static/images/cn/img/doc_25.png)\n\n#### 6.3 等待报告完成  \n1. 历史分析，查看报告状态\n\n![doc.png](/static/images/cn/img/doc_26.png)\n\n2. 自动更改为生成中\n![doc.png](/static/images/cn/img/doc_27.png)\n\n4. 当状态更换为成功时\n![doc.png](/static/images/cn/img/doc_28.png)\n\n6. 查看报告详情\n![doc.png](/static/images/cn/img/doc_29.png)\n"},function(e,t){e.exports='# DeepBI User Manual\n\n## 1，Configure API KEY\n\n- [Setting]-[API KEY]\n\n### 1.1, About OPENAI API KEY:\n\n- Requires access to gpt4 models.\n- Other large models will be supported in the future, so stay tuned.\n\n### 1.2, About the proxy:\n\n- OPENAI API access may require proxy configuration, please configure the proxy yourself.\n\n- After the KEY and proxy are configured, click [Connection Test] and "Test success" will be displayed. If the test\n  fails, please check whether the API KEY is available and whether the proxy is configured correctly.\n\n![doc_0.png](/static/images/en/img/doc_0.png)\n\n### 1.3, About DeepInsight API KEY:\n- You can click the connection below the set key to register and get the API Key.(You can add our wechat group (contact us on the home page) to apply for a free Token.)\n\n![doc_0.png](/static/images/en/img/us_key.png)\n\n## 2,Configure Data Source\n\n- Currently supported data sources are MySql, Doris, starRocks, PostgreSql, and CSV. More data sources will be supported\n  in the future, such as sqlserver, clickhouse, SQLite, etc., so stay tuned.\n\n### 2.1, CSV data source configure:\n\n- [Setting]-[CSV Data Source]-[Click to upload]-select the csv file to be uploaded\n\n![doc.png](/static/images/en/img/doc_1.png)\n\n### 2.2, [MySql, Doris, starRocks, PostgreSql] data source configure:\n\n- [Setting]-[Data Sources]-[New Data Source]\n- Select the data source, fill in the database information, and save. After the configuration is completed,\n  click [Test Connection ] and "Connection Success" will be displayed.\n\n![doc.png](/static/images/en/img/doc_2.png)\n\n![doc.png](/static/images/en/img/doc_3.png)\n\n## 3,Chat Builder\n\n### 3.1, [Chat Builder] - [Dialogue]\n\n#### 3.1.1. Check the data (data source and table)\n\n- The checked data will be used as the basic data for AI in conversation data analysis.\n\n#### 3.1.2, fill in the comments and submit for AI detection\n\n- Try to improve the form and field annotations as much as possible to help AI better understand the data and enable the\n  Agent to better complete the data analysis task.\n\n![doc.png](/static/images/en/img/doc_4.png)\n\n#### 3.1.3, modify the failed comments and submit again\n\n- AI will feedback the comments that have not passed. Please revise and add them and submit again until all the comments\n  pass.\n\n![doc.png](/static/images/en/img/doc_5.png)\n\n#### 3.1.4, after all annotations pass the detection, start the conversation\n\n- 🔥 Note: If you want to generate a persistent report, please use [Query Builder]-[Report Generation]. The reports that\n  appear in [Chat Builder] are temporary reports and do not support persistence.\n\n![doc.png](/static/images/en/img/doc_6.png)\n\n#### 3.1.5, reselect data source\n\n- If you want to reselect the data source and start a new round of dialogue, please click [New Dialogue] to reset the\n  current conversation. The current conversation record will be stored in [History Dialogue].\n\n![doc.png](/static/images/en/img/doc_7.png)\n\n### 3.2, [Chat Builder] - [History Dialogue]\nCan view historical conversation records\n\n![doc.png](/static/images/en/img/doc_8.png)\n\n## 4, Query Builder \n\n### 4.1, [Query Builder]-[Report Generation]\n\n#### 4.1.1. Check the data (data source and table)\n\n- The checked data will be used as the basic data of AI in report generation.\n- 🔥Note: Currently the CSV data source does\n  not support [Report Generation]\n\n#### 4.1.2, fill in the comments and submit for AI detection\n\n- Try to improve the form and field annotations as much as possible to help AI better understand the data and enable the\n  Agent to better complete the report generation task.\n\n![doc.png](/static/images/en/img/doc_9.png)\n\n#### 4.1.3, modify the failed comments and submit again\n\n- AI will feedback the annotations that have failed. Please revise and add them and submit again until all annotations\n  pass the test.\n\n![doc.png](/static/images/en/img/doc_10.png)\n\n#### 4.1.4, after all annotations pass the detection, start the dialogue to generate reports\n\n- Click [Edit Report] to directly edit the newly generated report.\n- 🔥 Note: The [Report Generation] module currently only supports persistent report generation tasks. For analysis\n  questions, please use [Chat Builder] - [Dialogue].\n\n![doc.png](/static/images/en/img/doc_11.png)\n\n#### 4.1.5, reselect data source\n\n- If you want to reselect the data source and start a new round of dialogue, please click [New Dialogue] to reset the current dialogue.\n\n![doc.png](/static/images/en/img/doc_12.png)\n\n### 4.2, [Query]-[Report List]\n\n#### 4.2.1, Report status\n\n- The newly generated report in [Report Generation] will appear in the [Report List]. At this time, the report is in\n  draft status. If you want to display the report in the [Dashboards], please click the [Publish] button, change report\n  status to published status.\n\n![doc.png](/static/images/en/img/doc_13.png)\n\n![doc.png](/static/images/en/img/doc_14.png)\n\n#### 4.2.2, Modify SQL statement\n\n- Click [Edit Source] to customize the SQL statement of the report.\n\n![doc.png](/static/images/en/img/doc_15.png)\n\n#### 4.2.3, modify chart style\n\n- Click [Edit Visualization] to customize and edit the visualization chart style.\n- Click [Add Visualization] to add a visual chart.\n\n![doc.png](/static/images/en/img/doc_16.png)\n\n![doc.png](/static/images/en/img/doc_17.png)\n\n#### 4.2.4. Deleting a report\n\n- Click [Archive] to change the report status to archive (delete) status.\n\n![doc.png](/static/images/en/img/doc_18.png)\n\n### 5, Dashboards\n\n#### 5.1, create a new dashboard\n\n- [Dashboards]-[Create]-Edit Dashboard\n\n![doc.png](/static/images/en/img/doc_19.png)\n\n- Add the newly generated Published report to the dashboard\n\n![doc.png](/static/images/en/img/doc_20.png)\n\n- Click [Publish] Dashboard\n\n![doc.png](/static/images/en/img/doc_21.png)\n\n#### 5.1.2 Share Dashboard \n\n- After clicking [Publish], you can share the dashboard\n\n![doc.png](/static/images/en/img/doc_22.png)\n\n#### 5.2 Dashboards Prettify\n- Select an existing dashboard\n![doc.png](/static/images/en/img/doc_22_1.png)\n- Click to enter\n![doc.png](/static/images/en/img/doc_22_2.png)\n- Select the template and click Apply\n![doc.png](/static/images/en/img/doc_22_3.png)\n- Enter the beautification screen and wait for the AI automatic conversion to complete\n![doc.png](/static/images/en/img/doc_22_4.png)\n![doc.png](/static/images/en/img/doc_22_5.png)\n- Conversion complete\n![doc.png](/static/images/en/img/doc_22_6.png)\n- Click to view large screen\n![doc.png](/static/images/en/img/doc_22_7.png)\n\n## 6. Automatic Data Analysis\n\n#### 6.1 Add Analysis Task\n1. Click on Automatic Data Analysis.\n2. Choose Automatic Data Analysis.\n3. Click on the dropdown.\n4. Select the data source.\n\n![doc.png](/static/images/en/img/doc_23.png)\n\n#### 6.2 Confirm Required Tables for the Report\n1. Select table remarks and field information.\n2. Choose the tables to be used in the report; multiple tables can be selected.\n3. Provide remarks for table fields.\n4. Submit.\n\n![doc.png](/static/images/en/img/doc_25.png)\n\n#### 6.3 Wait for Report Completion\n1. In historical analysis, check the report status.\n\n![doc.png](/static/images/en/img/doc_26.png)\n2. Automatically changes to generating.\n\n![doc.png](/static/images/en/img/doc_27.png)\n3. When the status changes to successful.\n\n![doc.png](/static/images/en/img/doc_28.png)\n4. View the report details.\n\n![doc.png](/static/images/en/img/doc_29.png)\n\n\n\n'},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"data/0962607.countries.geo.json"},function(e,t,a){e.exports=a.p+"data/eed73d1.usa-albers.geo.json"},function(e,t,a){e.exports=a.p+"data/dac34f3.japan.prefectures.geo.json"},function(e,t,a){e.exports=a.p+"data/47283ba.china.geo.json"},function(e,t,a){e.exports=a.p+"data/9301351.110000.geo.json"},function(e,t,a){e.exports=a.p+"data/0e6cd79.120000.geo.json"},function(e,t,a){e.exports=a.p+"data/45c8689.130000.geo.json"},function(e,t,a){e.exports=a.p+"data/0f3fc7b.140000.geo.json"},function(e,t,a){e.exports=a.p+"data/12c7237.150000.geo.json"},function(e,t,a){e.exports=a.p+"data/867ad03.210000.geo.json"},function(e,t,a){e.exports=a.p+"data/06a8c43.220000.geo.json"},function(e,t,a){e.exports=a.p+"data/b80aa15.230000.geo.json"},function(e,t,a){e.exports=a.p+"data/01e841f.310000.geo.json"},function(e,t,a){e.exports=a.p+"data/5cf6597.320000.geo.json"},function(e,t,a){e.exports=a.p+"data/44e6ca4.330000.geo.json"},function(e,t,a){e.exports=a.p+"data/c4a8143.340000.geo.json"},function(e,t,a){e.exports=a.p+"data/cc485e1.350000.geo.json"},function(e,t,a){e.exports=a.p+"data/93d9fa4.360000.geo.json"},function(e,t,a){e.exports=a.p+"data/9d7f18d.370000.geo.json"},function(e,t,a){e.exports=a.p+"data/72348fa.410000.geo.json"},function(e,t,a){e.exports=a.p+"data/33f1433.420000.geo.json"},function(e,t,a){e.exports=a.p+"data/937ee66.430000.geo.json"},function(e,t,a){e.exports=a.p+"data/fb5171d.440000.geo.json"},function(e,t,a){e.exports=a.p+"data/aa99dac.450000.geo.json"},function(e,t,a){e.exports=a.p+"data/5794562.460000.geo.json"},function(e,t,a){e.exports=a.p+"data/1cdd0ff.500000.geo.json"},function(e,t,a){e.exports=a.p+"data/b51f531.510000.geo.json"},function(e,t,a){e.exports=a.p+"data/1344c0c.520000.geo.json"},function(e,t,a){e.exports=a.p+"data/9ad8406.530000.geo.json"},function(e,t,a){e.exports=a.p+"data/8df5257.540000.geo.json"},function(e,t,a){e.exports=a.p+"data/e60e9ff.610000.geo.json"},function(e,t,a){e.exports=a.p+"data/307e6d4.620000.geo.json"},function(e,t,a){e.exports=a.p+"data/1253e95.630000.geo.json"},function(e,t,a){e.exports=a.p+"data/b230800.640000.geo.json"},function(e,t,a){e.exports=a.p+"data/8f5c51f.650000.geo.json"},function(e,t,a){e.exports=a.p+"data/5148730.710000.geo.json"},function(e,t,a){e.exports=a.p+"data/561839a.810000.geo.json"},function(e,t,a){e.exports=a.p+"data/d4c0f28.820000.geo.json"},,,,,,,,,,,,,,,,,,,,,function(e,t,a){a(1819),a(1815),e.exports=a(1816)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},,,,,,function(e,t,a){},,,function(e,t,a){var r={"./en-SG":481,"./en-SG.js":481,"./en-au":482,"./en-au.js":482,"./en-ca":483,"./en-ca.js":483,"./en-gb":484,"./en-gb.js":484,"./en-ie":485,"./en-ie.js":485,"./en-il":486,"./en-il.js":486,"./en-nz":487,"./en-nz.js":487};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=o,e.exports=n,n.id=891},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,,,,,,,function(e,t,a){},,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},,,,,,,,,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){},,,function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,function(e,t,a){},,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){var r={"./analysis.png":1618,"./avatar.svg":443,"./cn/img/bios.png":1619,"./cn/img/bios1.png":1620,"./cn/img/bios2.png":1621,"./cn/img/bios3.png":1622,"./cn/img/cmd.jpg":1623,"./cn/img/doc_0.png":1624,"./cn/img/doc_1.png":1625,"./cn/img/doc_10.png":1626,"./cn/img/doc_11.png":1627,"./cn/img/doc_12.png":1628,"./cn/img/doc_13.png":1629,"./cn/img/doc_14.png":1630,"./cn/img/doc_15.png":1631,"./cn/img/doc_16.png":1632,"./cn/img/doc_17.png":1633,"./cn/img/doc_18.png":1634,"./cn/img/doc_19.png":1635,"./cn/img/doc_2.png":1636,"./cn/img/doc_20.png":1637,"./cn/img/doc_21.png":1638,"./cn/img/doc_22.png":1639,"./cn/img/doc_22_1.png":1640,"./cn/img/doc_22_2.png":1641,"./cn/img/doc_22_3.png":1642,"./cn/img/doc_22_4.png":1643,"./cn/img/doc_22_5.png":1644,"./cn/img/doc_22_6.png":1645,"./cn/img/doc_22_7.png":1646,"./cn/img/doc_23.png":1647,"./cn/img/doc_24.png":1648,"./cn/img/doc_25.png":1649,"./cn/img/doc_26.png":1650,"./cn/img/doc_27.png":1651,"./cn/img/doc_28.png":1652,"./cn/img/doc_29.png":1653,"./cn/img/doc_3.png":1654,"./cn/img/doc_4.png":1655,"./cn/img/doc_5.png":1656,"./cn/img/doc_6.png":1657,"./cn/img/doc_7.png":1658,"./cn/img/doc_8.png":1659,"./cn/img/doc_9.png":1660,"./cn/img/docker_err.jpg":1661,"./cn/img/download.png":1662,"./cn/img/ip.png":1663,"./cn/img/us_key.png":1664,"./copy.png":604,"./dashboard-example/dashboards_prettify_1.jpg":320,"./dashboard-example/dashboards_prettify_2.jpg":425,"./dashboard-example/dashboards_prettify_3.jpg":426,"./db-logos/Cassandra.png":1665,"./db-logos/arangodb.png":1666,"./db-logos/athena.png":1667,"./db-logos/aws_es.png":1668,"./db-logos/axibasetsd.png":1669,"./db-logos/azure_kusto.png":1670,"./db-logos/bigquery.png":1671,"./db-logos/bigquery_gce.png":1672,"./db-logos/clickhouse.png":1673,"./db-logos/cloudwatch.png":1674,"./db-logos/cloudwatch_insights.png":1675,"./db-logos/cockroach.png":1676,"./db-logos/corporate_memory.png":1677,"./db-logos/couchbase.png":1678,"./db-logos/csv.png":429,"./db-logos/csv1.png":1679,"./db-logos/databend.png":1680,"./db-logos/databricks.png":1681,"./db-logos/db2.png":1682,"./db-logos/dgraph.png":1683,"./db-logos/doris.png":1684,"./db-logos/drill.png":1685,"./db-logos/druid.png":1686,"./db-logos/dynamodb_sql.png":1687,"./db-logos/elasticsearch.png":1688,"./db-logos/elasticsearch2.png":1689,"./db-logos/elasticsearch2_OpenDistroSQLElasticSearch.png":1690,"./db-logos/elasticsearch2_XPackSQLElasticSearch.png":1691,"./db-logos/exasol.png":1692,"./db-logos/firebolt.png":1693,"./db-logos/google_analytics.png":1694,"./db-logos/google_spreadsheets.png":1695,"./db-logos/graphite.png":1696,"./db-logos/hive.png":1697,"./db-logos/hive_http.png":1698,"./db-logos/impala.png":1699,"./db-logos/influxdb.png":1700,"./db-logos/jirajql.png":1701,"./db-logos/json.png":1702,"./db-logos/kibana.png":1703,"./db-logos/kylin.png":1704,"./db-logos/mapd.png":1705,"./db-logos/memsql.png":1706,"./db-logos/mongodb.png":1707,"./db-logos/mssql.png":1708,"./db-logos/mssql_odbc.png":1709,"./db-logos/mysql.png":1710,"./db-logos/nz.png":1711,"./db-logos/oracle.png":1712,"./db-logos/pg.png":1713,"./db-logos/phoenix.png":1714,"./db-logos/pinot.png":1715,"./db-logos/presto.png":1716,"./db-logos/prometheus.png":1717,"./db-logos/python.png":1718,"./db-logos/qubole.png":1719,"./db-logos/rds_mysql.png":1720,"./db-logos/redshift.png":1721,"./db-logos/redshift_iam.png":1722,"./db-logos/results.png":1723,"./db-logos/rockset.png":1724,"./db-logos/salesforce.png":1725,"./db-logos/scylla.png":1726,"./db-logos/snowflake.png":1727,"./db-logos/sparql_endpoint.png":1728,"./db-logos/sqlite.png":1729,"./db-logos/starrocks.png":1730,"./db-logos/treasuredata.png":1731,"./db-logos/trino.png":1732,"./db-logos/uptycs.png":1733,"./db-logos/url.png":1734,"./db-logos/vertica.png":1735,"./db-logos/yandex_appmetrika.png":1736,"./db-logos/yandex_metrika.png":1737,"./destinations/chatwork.png":1738,"./destinations/email.png":1739,"./destinations/hangouts_chat.png":1740,"./destinations/hipchat.png":1741,"./destinations/mattermost.png":1742,"./destinations/microsoft_teams_webhook.png":1743,"./destinations/pagerduty.png":1744,"./destinations/slack.png":1745,"./destinations/webhook.png":1746,"./en/img/bios1.png":1747,"./en/img/bios2.png":1748,"./en/img/bios3.png":1749,"./en/img/cmd.png":1750,"./en/img/doc_0.png":1751,"./en/img/doc_1.png":1752,"./en/img/doc_10.png":1753,"./en/img/doc_11.png":1754,"./en/img/doc_12.png":1755,"./en/img/doc_13.png":1756,"./en/img/doc_14.png":1757,"./en/img/doc_15.png":1758,"./en/img/doc_16.png":1759,"./en/img/doc_17.png":1760,"./en/img/doc_18.png":1761,"./en/img/doc_19.png":1762,"./en/img/doc_2.png":1763,"./en/img/doc_20.png":1764,"./en/img/doc_21.png":1765,"./en/img/doc_22.png":1766,"./en/img/doc_22_1.png":1767,"./en/img/doc_22_2.png":1768,"./en/img/doc_22_3.png":1769,"./en/img/doc_22_4.png":1770,"./en/img/doc_22_5.png":1771,"./en/img/doc_22_6.png":1772,"./en/img/doc_22_7.png":1773,"./en/img/doc_23.png":1774,"./en/img/doc_24.png":1775,"./en/img/doc_25.png":1776,"./en/img/doc_26.png":1777,"./en/img/doc_27.png":1778,"./en/img/doc_28.png":1779,"./en/img/doc_29.png":1780,"./en/img/doc_3.png":1781,"./en/img/doc_4.png":1782,"./en/img/doc_5.png":1783,"./en/img/doc_6.png":1784,"./en/img/doc_7.png":1785,"./en/img/doc_8.png":1786,"./en/img/doc_9.png":1787,"./en/img/docker_err.png":1788,"./en/img/ip.png":1789,"./en/img/us_key.png":1790,"./favicon-16x16.png":1791,"./favicon-32x32.png":1792,"./favicon-96x96.png":1793,"./fixtures/map-tile.png":1794,"./google_logo.svg":1795,"./gravatar.png":1796,"./icon_small.png":104,"./illustrations/alert.svg":1797,"./illustrations/dashboard.svg":1798,"./illustrations/no-query-results.svg":1799,"./illustrations/query.svg":1800,"./loading.png":1801,"./loading1.png":1802,"./logo.png":1803,"./logo_white.png":1804,"./next.png":1805,"./retry.png":1806,"./send-active.png":1807,"./send-default.png":1808};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=o,e.exports=n,n.id=1617},function(e,t,a){e.exports=a.p+"images/analysis.png"},function(e,t,a){e.exports=a.p+"images/cn/img/bios.png"},function(e,t,a){e.exports=a.p+"images/cn/img/bios1.png"},function(e,t,a){e.exports=a.p+"images/cn/img/bios2.png"},function(e,t,a){e.exports=a.p+"images/cn/img/bios3.png"},function(e,t,a){e.exports=a.p+"images/cn/img/cmd.jpg"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_0.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_1.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_10.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_11.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_12.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_13.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_14.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_15.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_16.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_17.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_18.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_19.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_2.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_20.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_21.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_1.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_2.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_3.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_4.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_5.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_6.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_22_7.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_23.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_24.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_25.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_26.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_27.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_28.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_29.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_3.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_4.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_5.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_6.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_7.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_8.png"},function(e,t,a){e.exports=a.p+"images/cn/img/doc_9.png"},function(e,t,a){e.exports=a.p+"images/cn/img/docker_err.jpg"},function(e,t,a){e.exports=a.p+"images/cn/img/download.png"},function(e,t,a){e.exports=a.p+"images/cn/img/ip.png"},function(e,t,a){e.exports=a.p+"images/cn/img/us_key.png"},function(e,t,a){e.exports=a.p+"images/db-logos/Cassandra.png"},function(e,t,a){e.exports=a.p+"images/db-logos/arangodb.png"},function(e,t,a){e.exports=a.p+"images/db-logos/athena.png"},function(e,t,a){e.exports=a.p+"images/db-logos/aws_es.png"},function(e,t,a){e.exports=a.p+"images/db-logos/axibasetsd.png"},function(e,t,a){e.exports=a.p+"images/db-logos/azure_kusto.png"},function(e,t,a){e.exports=a.p+"images/db-logos/bigquery.png"},function(e,t,a){e.exports=a.p+"images/db-logos/bigquery_gce.png"},function(e,t,a){e.exports=a.p+"images/db-logos/clickhouse.png"},function(e,t,a){e.exports=a.p+"images/db-logos/cloudwatch.png"},function(e,t,a){e.exports=a.p+"images/db-logos/cloudwatch_insights.png"},function(e,t,a){e.exports=a.p+"images/db-logos/cockroach.png"},function(e,t,a){e.exports=a.p+"images/db-logos/corporate_memory.png"},function(e,t,a){e.exports=a.p+"images/db-logos/couchbase.png"},function(e,t,a){e.exports=a.p+"images/db-logos/csv1.png"},function(e,t,a){e.exports=a.p+"images/db-logos/databend.png"},function(e,t,a){e.exports=a.p+"images/db-logos/databricks.png"},function(e,t,a){e.exports=a.p+"images/db-logos/db2.png"},function(e,t,a){e.exports=a.p+"images/db-logos/dgraph.png"},function(e,t,a){e.exports=a.p+"images/db-logos/doris.png"},function(e,t,a){e.exports=a.p+"images/db-logos/drill.png"},function(e,t,a){e.exports=a.p+"images/db-logos/druid.png"},function(e,t,a){e.exports=a.p+"images/db-logos/dynamodb_sql.png"},function(e,t,a){e.exports=a.p+"images/db-logos/elasticsearch.png"},function(e,t,a){e.exports=a.p+"images/db-logos/elasticsearch2.png"},function(e,t,a){e.exports=a.p+"images/db-logos/elasticsearch2_OpenDistroSQLElasticSearch.png"},function(e,t,a){e.exports=a.p+"images/db-logos/elasticsearch2_XPackSQLElasticSearch.png"},function(e,t,a){e.exports=a.p+"images/db-logos/exasol.png"},function(e,t,a){e.exports=a.p+"images/db-logos/firebolt.png"},function(e,t,a){e.exports=a.p+"images/db-logos/google_analytics.png"},function(e,t,a){e.exports=a.p+"images/db-logos/google_spreadsheets.png"},function(e,t,a){e.exports=a.p+"images/db-logos/graphite.png"},function(e,t,a){e.exports=a.p+"images/db-logos/hive.png"},function(e,t,a){e.exports=a.p+"images/db-logos/hive_http.png"},function(e,t,a){e.exports=a.p+"images/db-logos/impala.png"},function(e,t,a){e.exports=a.p+"images/db-logos/influxdb.png"},function(e,t,a){e.exports=a.p+"images/db-logos/jirajql.png"},function(e,t,a){e.exports=a.p+"images/db-logos/json.png"},function(e,t,a){e.exports=a.p+"images/db-logos/kibana.png"},function(e,t,a){e.exports=a.p+"images/db-logos/kylin.png"},function(e,t,a){e.exports=a.p+"images/db-logos/mapd.png"},function(e,t,a){e.exports=a.p+"images/db-logos/memsql.png"},function(e,t,a){e.exports=a.p+"images/db-logos/mongodb.png"},function(e,t,a){e.exports=a.p+"images/db-logos/mssql.png"},function(e,t,a){e.exports=a.p+"images/db-logos/mssql_odbc.png"},function(e,t,a){e.exports=a.p+"images/db-logos/mysql.png"},function(e,t,a){e.exports=a.p+"images/db-logos/nz.png"},function(e,t,a){e.exports=a.p+"images/db-logos/oracle.png"},function(e,t,a){e.exports=a.p+"images/db-logos/pg.png"},function(e,t,a){e.exports=a.p+"images/db-logos/phoenix.png"},function(e,t,a){e.exports=a.p+"images/db-logos/pinot.png"},function(e,t,a){e.exports=a.p+"images/db-logos/presto.png"},function(e,t,a){e.exports=a.p+"images/db-logos/prometheus.png"},function(e,t,a){e.exports=a.p+"images/db-logos/python.png"},function(e,t,a){e.exports=a.p+"images/db-logos/qubole.png"},function(e,t,a){e.exports=a.p+"images/db-logos/rds_mysql.png"},function(e,t,a){e.exports=a.p+"images/db-logos/redshift.png"},function(e,t,a){e.exports=a.p+"images/db-logos/redshift_iam.png"},function(e,t,a){e.exports=a.p+"images/db-logos/results.png"},function(e,t,a){e.exports=a.p+"images/db-logos/rockset.png"},function(e,t,a){e.exports=a.p+"images/db-logos/salesforce.png"},function(e,t,a){e.exports=a.p+"images/db-logos/scylla.png"},function(e,t,a){e.exports=a.p+"images/db-logos/snowflake.png"},function(e,t,a){e.exports=a.p+"images/db-logos/sparql_endpoint.png"},function(e,t,a){e.exports=a.p+"images/db-logos/sqlite.png"},function(e,t,a){e.exports=a.p+"images/db-logos/starrocks.png"},function(e,t,a){e.exports=a.p+"images/db-logos/treasuredata.png"},function(e,t,a){e.exports=a.p+"images/db-logos/trino.png"},function(e,t,a){e.exports=a.p+"images/db-logos/uptycs.png"},function(e,t,a){e.exports=a.p+"images/db-logos/url.png"},function(e,t,a){e.exports=a.p+"images/db-logos/vertica.png"},function(e,t,a){e.exports=a.p+"images/db-logos/yandex_appmetrika.png"},function(e,t,a){e.exports=a.p+"images/db-logos/yandex_metrika.png"},function(e,t,a){e.exports=a.p+"images/destinations/chatwork.png"},function(e,t,a){e.exports=a.p+"images/destinations/email.png"},function(e,t,a){e.exports=a.p+"images/destinations/hangouts_chat.png"},function(e,t,a){e.exports=a.p+"images/destinations/hipchat.png"},function(e,t,a){e.exports=a.p+"images/destinations/mattermost.png"},function(e,t,a){e.exports=a.p+"images/destinations/microsoft_teams_webhook.png"},function(e,t,a){e.exports=a.p+"images/destinations/pagerduty.png"},function(e,t,a){e.exports=a.p+"images/destinations/slack.png"},function(e,t,a){e.exports=a.p+"images/destinations/webhook.png"},function(e,t,a){e.exports=a.p+"images/en/img/bios1.png"},function(e,t,a){e.exports=a.p+"images/en/img/bios2.png"},function(e,t,a){e.exports=a.p+"images/en/img/bios3.png"},function(e,t,a){e.exports=a.p+"images/en/img/cmd.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_0.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_1.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_10.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_11.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_12.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_13.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_14.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_15.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_16.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_17.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_18.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_19.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_2.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_20.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_21.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_1.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_2.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_3.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_4.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_5.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_6.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_22_7.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_23.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_24.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_25.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_26.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_27.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_28.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_29.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_3.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_4.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_5.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_6.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_7.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_8.png"},function(e,t,a){e.exports=a.p+"images/en/img/doc_9.png"},function(e,t,a){e.exports=a.p+"images/en/img/docker_err.png"},function(e,t,a){e.exports=a.p+"images/en/img/ip.png"},function(e,t,a){e.exports=a.p+"images/en/img/us_key.png"},function(e,t,a){e.exports=a.p+"images/favicon-16x16.png"},function(e,t,a){e.exports=a.p+"images/favicon-32x32.png"},function(e,t,a){e.exports=a.p+"images/favicon-96x96.png"},function(e,t,a){e.exports=a.p+"images/fixtures/map-tile.png"},function(e,t,a){e.exports=a.p+"images/google_logo.svg"},function(e,t,a){e.exports=a.p+"images/gravatar.png"},function(e,t,a){e.exports=a.p+"images/illustrations/alert.svg"},function(e,t,a){e.exports=a.p+"images/illustrations/dashboard.svg"},function(e,t,a){e.exports=a.p+"images/illustrations/no-query-results.svg"},function(e,t,a){e.exports=a.p+"images/illustrations/query.svg"},function(e,t,a){e.exports=a.p+"images/loading.png"},function(e,t,a){e.exports=a.p+"images/loading1.png"},function(e,t,a){e.exports=a.p+"images/logo.png"},function(e,t,a){e.exports=a.p+"images/logo_white.png"},function(e,t,a){e.exports=a.p+"images/next.png"},function(e,t,a){e.exports=a.p+"images/retry.png"},function(e,t,a){e.exports=a.p+"images/send-active.png"},function(e,t,a){e.exports=a.p+"images/send-default.png"},function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=1809},,,,,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(32),i=a.n(o),l=(a(8),a(5),a(2)),s=a.n(l),c=(a(443),a(63)),u=a.n(c),d=(a(9),a(11)),m=a.n(d);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function g(e){var t=e.children,a=f(e,["children"]);return n.a.createElement(g.Component,a,t)}function b(e){return n.a.createElement(b.Component,e)}g.Component=function(e){var t=e.children,a=f(e,["children"]);return n.a.createElement("a",a,t)},g.WithIcon=function(e){var t=e.icon,a=e.alt,r=e.children,o=f(e,["icon","alt","children"]);return n.a.createElement(g.Component,o,r," ",t," ",n.a.createElement("span",{className:"sr-only"},a))},g.External=function(e){var t=e.icon,a=void 0===t?n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}):t,r=e.alt,o=void 0===r?"(opens in a new tab)":r,i=f(e,["icon","alt"]);return n.a.createElement(g.WithIcon,p({target:"_blank",rel:"noopener noreferrer",icon:a,alt:o},i))},b.Component=function(e){return n.a.createElement(m.a,e)},g.Button=b;var h=g,y=(a(12),a(14),a(129)),v=a.n(y);function w(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O=v()("redash:errors"),_=n.a.createContext({handleError:e=>{setTimeout(()=>{throw e})},reset:()=>{}});function E(e){var t=e.children;return n.a.createElement(u.a,{message:t,type:"error",showIcon:!0})}E.defaultProps={children:window.W_L.generic};class j extends n.a.Component{constructor(){super(...arguments),w(this,"state",{error:null}),w(this,"handleError",e=>{this.setState(this.constructor.getDerivedStateFromError(e)),this.componentDidCatch(e,null),Object(l.isFunction)(window.handleException)&&window.handleException(e)}),w(this,"reset",()=>{this.setState({error:null})})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){O(e,t)}render(){var e=this.props,t=e.renderError,a=e.children,r=this.state.error;return r?Object(l.isFunction)(t)?t(r):n.a.createElement(E,null):n.a.createElement(_.Provider,{value:this},a)}}w(j,"defaultProps",{children:null,renderError:null});a(112),a(73);var S=a(145),C=a.n(S),x=a(736),P=Object(x.a)();function L(e){var t=e.pathname,a=e.search,r=e.hash,n={};return n.path=t,n.search=Object(l.mapValues)(C.a.parse(a),e=>!!Object(l.isNil)(e)||e),n.hash=Object(l.trimStart)(r,"#"),n.url="".concat(t).concat(a).concat(r),n}var k={listen:e=>Object(l.isFunction)(e)?P.listen((t,a)=>e(k,a)):()=>{},confirmChange:e=>Object(l.isFunction)(e)?P.block(t=>e(L(t),k)):()=>{},update(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(l.isObject)(e)&&(e=Object(l.omitBy)({pathname:e.path,search:e.search,hash:e.hash},l.isUndefined),e=Object(l.extend)({pathname:k.path,search:k.search,hash:k.hash},e),Object(l.isObject)(e.search)&&(e.search=Object(l.omitBy)(Object(l.extend)({},k.search,e.search),l.isNil),e.search=Object(l.mapValues)(e.search,e=>!0===e?null:e),e.search=C.a.stringify(e.search))),t?P.replace(e):P.push(e)},url:void 0,path:void 0,setPath(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k.update({path:e},t)},search:void 0,setSearch(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k.update({search:e},t)},hash:void 0,setHash(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k.update({hash:e},t)}};function N(){Object(l.extend)(k,L(P.location))}P.listen(N),N();var A=k,T=a(246),W=a.n(T),I=a(431),q=a.n(I),D=a(24),R=a.n(D);function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){F(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function F(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function V(e,t){var a=null;R.a.warning({content:"Your session has expired. Please login to continue.",okText:n.a.createElement(n.a.Fragment,null,"Login ",n.a.createElement("i",{className:"fa fa-external-link m-r-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)")),centered:!0,mask:!0,maskClosable:!1,keyboard:!1,onOk:r=>{if(!a||a.closed){var n,o,i,s,c,u,d=z(z({},(n=640,o=640,i=window.screenX,s=window.screenY,c=window.innerWidth,u=window.innerHeight,{left:Math.floor((c-n)/2+i),top:Math.floor((u-o)/2+s),width:Math.floor(n),height:Math.floor(o)})),{},{menubar:"no",toolbar:"no",location:"yes",resizable:"yes",scrollbars:"yes",status:"yes"});a=window.open(e,"Restore Session",Object(l.map)(d,(e,t)=>"".concat(t,"=").concat(e)).join(","));var m=e=>{"redash_session_restored"===e.data.type&&(a&&a.close(),a=null,window.removeEventListener("message",m),r(),t())};window.addEventListener("message",m,!1)}else a.focus()}})}var U=null;var B=W.a.create({paramsSerializer:e=>C.a.stringify(e),xsrfCookieName:"csrf_token",xsrfHeaderName:"X-CSRF-TOKEN"});B.interceptors.response.use(e=>e.data);q()(B,e=>{var t=Object(l.get)(e,"response.data.message");return e.isAxiosError&&Object(l.includes)(t,"CSRF")?B.get("/ping"):Promise.reject(e)},{statusCodes:[400]}),q()(B,e=>{var t=parseInt(Object(l.get)(e,"response.status")),a=Object(l.get)(e,"response.data.message"),r=Object(l.get)(e,"config.url");return e.isAxiosError&&(401===t||Object(l.includes)(a,"Please login"))&&"api/session"!==r?(U||(U=new Promise(e=>{V(X.getLoginUrl(),()=>{U=null,e()})})),U):Promise.reject(e)},{statusCodes:[401,404],pauseInstanceWhileRefreshing:!1});B.interceptors.request.use(e=>{var t=X.getApiKey();return t&&(e.headers.Authorization="Key ".concat(t)),e});var H={_isAdmin:void 0,canEdit(e){var t=e.user_id||e.user&&e.user.id;return this.isAdmin||t&&t===this.id},canCreate(){return this.hasPermission("create_query")||this.hasPermission("create_dashboard")||this.hasPermission("list_alerts")},hasPermission(e){return"admin"===e&&void 0!==this._isAdmin?this._isAdmin:Object(l.includes)(this.permissions,e)},get isAdmin(){return this.hasPermission("admin")},set isAdmin(e){this._isAdmin=e}},Y={},Q=[],K=v()("redash:auth"),G={loaded:!1},$={Login:"login"};function J(e){K("Updating session to be:",e),Object(l.extend)(G,e,{loaded:!0}),Object(l.extend)(H,G.user),Object(l.extend)(Y,G.client_config),Object(l.extend)(Q,G.messages)}var X={isAuthenticated:()=>G.loaded&&G.user.id,getLoginUrl:()=>$.Login,setLoginUrl(e){$.Login=e},login(){var e=encodeURI(A.url);K("Calling login with next = %s",e),window.location.href="".concat($.Login,"?next=").concat(e)},logout(){K("Logout."),window.location.href="logout"},loadSession:()=>(K("Loading session"),G.loaded&&G.user.id?(K("Resolving with local value."),Promise.resolve(G)):(X.setApiKey(null),B.get("api/session").then(e=>(J(e),G)))),loadConfig:()=>(K("Loading config"),B.get("/api/config").then(e=>(J({client_config:e.client_config,user:{permissions:[]},messages:[]}),e))),setApiKey(e){K("Set API key to: %s",e),X.apiKey=e},getApiKey:()=>X.apiKey,requireSession:()=>(K("Requested authentication"),X.isAuthenticated()?Promise.resolve(G):X.loadSession().then(()=>{if(X.isAuthenticated())return K("Loaded session"),window.opener&&window.opener.postMessage({type:"redash_session_restored"},window.location.origin),G;K("Need to login, redirecting"),X.login()}).catch(()=>{K("Need to login, redirecting"),X.login()}))};var Z=new class{refresh(){return Promise.resolve(this)}canCreateDataSource(){return H.isAdmin}isCreateDataSourceEnabled(){return H.isAdmin}canCreateDestination(){return H.isAdmin}isCreateDestinationEnabled(){return H.isAdmin}canCreateDashboard(){return H.hasPermission("create_dashboard")}isCreateDashboardEnabled(){return H.hasPermission("create_dashboard")}canCreateAlert(){return!0}canCreateUser(){return H.isAdmin}isCreateUserEnabled(){return H.isAdmin}isCreateQuerySnippetEnabled(){return!0}getDashboardRefreshIntervals(){var e=Y.dashboardRefreshIntervals;return Object(l.isArray)(e)?e:null}getQueryRefreshIntervals(){var e=Y.queryRefreshIntervals;return Object(l.isArray)(e)?e:null}canEdit(e){return Object(l.get)(e,"can_edit",!1)}canRun(){return!0}};var ee=new class{constructor(){this.objectCounters={}}refresh(){return B.get("api/organization/status").then(e=>(this.objectCounters=e.object_counters,this))}},te=(a(216),a(181),a(3)),ae=a.n(te);function re(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function ne(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var oe=new Map,ie=new Set;function le(e,t){Object(l.isString)(e)&&""!==e&&(oe.set(e,Object(l.isFunction)(t)?t:null),ie.forEach(t=>{t.props.name===e&&t.forceUpdate()}))}class se extends n.a.Component{componentDidMount(){ie.add(this)}componentWillUnmount(){ie.delete(this)}render(){var e=this.props,t=e.name,a=e.children,r=e.fallback,o=re(e,["name","children","fallback"]),i=oe.get(t);return i?n.a.createElement(i,o,a):Object(l.isUndefined)(r)?a:r}}ne(se,"propTypes",{name:ae.a.string.isRequired,fallback:ae.a.node,children:ae.a.node}),ne(se,"defaultProps",{children:null});var ce=a(17),ue=a.n(ce),de=a(4),me=a.n(de);a(847);function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fe(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var ge=function(e){var t=e.className,a=e.type,r=fe(e,["className","type"]);return n.a.createElement("button",pe({className:me()("plain-button","clickable",{"plain-button-link":"link"===a},t),type:"button"},r))},be=(a(87),a(55)),he=a.n(be);function ye(){return(ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ve(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function we(e){var t=e.title,a=ve(e,["title"]),r=Object(l.isNil)(t)?null:n.a.createElement("span",{role:"status","aria-live":"assertive","aria-relevant":"additions"},t);return n.a.createElement(he.a,ye({trigger:["hover","focus"],title:r},a))}var Oe=a(314),_e=a.n(Oe),Ee=a(66),je=a.n(Ee);function Se(e){var t,a;return(t=()=>Object(l.uniqueId)(e),null===(a=Object(r.useRef)(null)).current&&(a.current=t()),a).current}function Ce(e){var t=e.message,a=e.icon,r=e.children,o=e.className,i=Se("bm-message");return n.a.createElement("div",{className:"big-message p-15 text-center "+o,role:"status","aria-live":"assertive","aria-relevant":"additions removals"},n.a.createElement("h3",{className:"m-t-0 m-b-0","aria-labelledby":i},n.a.createElement("i",{className:me()("fa",a),"aria-hidden":"true"})),n.a.createElement("br",null),n.a.createElement("span",{id:i},t),r)}Ce.propTypes={message:ae.a.string,icon:ae.a.string.isRequired,children:ae.a.node,className:ae.a.string},Ce.defaultProps={message:"",children:null,className:"tiled bg-white"};var xe=Ce,Pe=a(251),Le=a.n(Pe);Le.a.setConfig({ADD_ATTR:["target"]}),Le.a.addHook("afterSanitizeAttributes",(function(e){var t=e.getAttribute("target");Object(l.isString)(t)&&"_blank"===t.toLowerCase()?e.setAttribute("rel","noopener noreferrer"):e.removeAttribute("target")}));var ke=Le.a.sanitize;function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ae(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Te=n.a.memo((function(e){var t=e.children,a=Ae(e,["children"]);return n.a.createElement("div",Ne({},a,{dangerouslySetInnerHTML:{__html:ke(t)}}))}));Te.propTypes={children:ae.a.string},Te.defaultProps={children:""};var We=Te,Ie=a(110),qe=a(655),De=a.n(qe),Re=a(656),Me=a.n(Re);a(854);function ze(){return(ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(a),!0).forEach((function(t){Ue(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ue(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return He(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var Ye=Object(l.mapValues)({HOME:["",window.W_L.help],VALUE_SOURCE_OPTIONS:["/user-guide/querying/query-parameters#Value-Source-Options",window.W_L.guide_list_option],AUTHENTICATION_OPTIONS:["/user-guide/users/authentication-options",window.W_L.guide_authentication],USAGE_DATA_SHARING:["/open-source/admin-guide/usage-data",window.W_L.help_share_anonymous_data],DS_ATHENA:["/data-sources/amazon-athena-setup",window.W_L.guide_amazon_athena],DS_BIGQUERY:["/data-sources/bigquery-setup",window.W_L.guide_set_bigquery],DS_URL:["/data-sources/querying-urls",window.W_L.guide_set_url_port],DS_MONGODB:["/data-sources/mongodb-setup",window.W_L.guide_set_mongodb],DS_GOOGLE_SPREADSHEETS:["/data-sources/querying-a-google-spreadsheet",window.W_L.guide_set_google_spread],DS_GOOGLE_ANALYTICS:["/data-sources/google-analytics-setup",window.W_L.guide_set_google_analytics],DS_AXIBASETSD:["/data-sources/axibase-time-series-database",window.W_L.guide_set_axibase],DS_RESULTS:["/user-guide/querying/query-results-data-source",window.W_L.guide_set_query_result],ALERT_SETUP:["/user-guide/alerts/setting-up-an-alert",window.W_L.guide_set_alert],MAIL_CONFIG:["/open-source/setup/#Mail-Configuration",window.W_L.guide_set_mail],ALERT_NOTIF_TEMPLATE_GUIDE:["/user-guide/alerts/custom-alert-notifications",window.W_L.guide_set_notice],FAVORITES:["/user-guide/querying/favorites-tagging/#Favorites",window.W_L.guide_favorite],MANAGE_PERMISSIONS:["/user-guide/querying/writing-queries#Managing-Query-Permissions",window.W_L.guide_query_permissions],NUMBER_FORMAT_SPECS:["/user-guide/visualizations/formatting-numbers",window.W_L.guide_formatting_number],GETTING_STARTED:["/user-guide/getting-started",window.W_L.guide_menu_start],DASHBOARDS:["/user-guide/dashboards",window.W_L.guide_dashboard],QUERIES:["/help/user-guide/querying",window.W_L.guide_query],ALERTS:["/user-guide/alerts",window.W_L.guide_alert]},e=>{var t=Be(e,2);return["https://xxx/help"+t[0],t[1]]}),Qe={type:ae.a.string,href:ae.a.string,title:ae.a.node,className:ae.a.string,showTooltip:ae.a.bool,renderAsLink:ae.a.bool,children:ae.a.node},Ke={type:null,href:null,title:null,className:null,showTooltip:!0,renderAsLink:!1,children:n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"})};function Ge(e){return n.a.createElement(se,ze({},e,{name:"HelpTrigger"}))}le("HelpTrigger",function(e){var t,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return a=t=class extends n.a.Component{constructor(){super(...arguments),Ue(this,"iframeRef",n.a.createRef()),Ue(this,"iframeLoadingTimeout",null),Ue(this,"state",{visible:!1,loading:!1,error:!1,currentUrl:null,richText:null}),Ue(this,"loadIframe",e=>{clearTimeout(this.iframeLoadingTimeout),this.setState({loading:!0,error:!1}),this.iframeRef.current.src=e,this.iframeLoadingTimeout=setTimeout(()=>{this.setState({error:e,loading:!1})},2e4)}),Ue(this,"onIframeLoaded",()=>{this.setState({loading:!1}),clearTimeout(this.iframeLoadingTimeout)}),Ue(this,"onPostMessageReceived",e=>{if(Object(l.some)(r,t=>Object(l.startsWith)(e.origin,t))){var t=e.data||{},a=t.type,n=t.message;"iframe_url"===a&&this.setState({currentUrl:n})}}),Ue(this,"getUrl",()=>{var t=Object(l.get)(e,this.props.type);return t?t[0]:this.props.href}),Ue(this,"getRichText",()=>{var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:e=Ie.markdown.toHTML("CN"===window.W_L.language_mode?De.a:Me.a),this.setState({richText:e,loading:!1});case 2:case"end":return t.stop()}}),null,this,null,Promise)}),Ue(this,"openDrawer",e=>{if("HOME"===this.props.type)return this.setState({visible:!0,loading:!0}),void this.getRichText();e.shiftKey||e.ctrlKey||e.metaKey||(e.preventDefault(),this.setState({visible:!0}),setTimeout(()=>this.loadIframe(this.getUrl()),300))}),Ue(this,"closeDrawer",e=>{e&&e.preventDefault(),this.setState({visible:!1}),this.setState({visible:!1,currentUrl:null,richText:null})})}componentDidMount(){window.addEventListener("message",this.onPostMessageReceived,!1)}componentWillUnmount(){window.removeEventListener("message",this.onPostMessageReceived),clearTimeout(this.iframeLoadingTimeout)}render(){var t=this.getUrl();if(!t)return null;var a=Object(l.get)(e,"".concat(this.props.type,"[1]"),this.props.title),i=me()("help-trigger",this.props.className),s=this.state.currentUrl,c=Object(l.some)(r,e=>Object(l.startsWith)(s||t,e)),u=this.props.renderAsLink||!c,d=this.props.type;return n.a.createElement(n.a.Fragment,null,n.a.createElement(we,{title:this.props.showTooltip?n.a.createElement(n.a.Fragment,null,a,u&&n.a.createElement(n.a.Fragment,null," ",n.a.createElement("i",{className:"fa fa-external-link",style:{marginLeft:5},"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))):null},"HOME"===d?n.a.createElement(h,{className:i,onClick:this.openDrawer},this.props.children):n.a.createElement(h,{href:s||this.getUrl(),className:i,rel:"noopener noreferrer",target:"_blank",onClick:u?()=>{}:this.openDrawer})),n.a.createElement(_e.a,{placement:"right",closable:!1,onClose:this.closeDrawer,visible:this.state.visible,className:me()("help-drawer",o),destroyOnClose:!0,width:1e3},n.a.createElement("div",{className:"drawer-wrapper"},n.a.createElement("div",{className:"drawer-menu"},s&&n.a.createElement(we,{title:"Open page in a new window",placement:"left"},n.a.createElement(h,{href:s,target:"_blank"},n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))),n.a.createElement(we,{title:"Close",placement:"bottom"},n.a.createElement(ge,{onClick:this.closeDrawer},n.a.createElement(je.a,null)))),this.state.richText&&n.a.createElement(We,{className:"preview markdown"},this.state.richText),this.state.loading&&n.a.createElement(xe,{icon:"fa-spinner fa-2x fa-pulse",message:"Loading...",className:"help-message"}),this.state.error&&n.a.createElement(xe,{icon:"fa-exclamation-circle",className:"help-message"},"Something went wrong.",n.a.createElement("br",null),n.a.createElement(h,{href:this.state.error,target:"_blank",rel:"noopener"},window.W_L.click_here)," ",window.W_L.open_new_window)),n.a.createElement(se,{name:"HelpDrawerExtraContent",onLeave:this.closeDrawer,openPageUrl:this.loadIframe})))}},Ue(t,"propTypes",Ve(Ve({},Qe),{},{type:ae.a.oneOf(Object.keys(e))})),Ue(t,"defaultProps",Ke),a}(Ye,["https://xxx"])),Ge.propTypes=Qe,Ge.defaultProps=Ke;var $e=a(657),Je=document.createElement("a");Je.style.display="none",document.body.appendChild(Je);var Xe=["origin","protocol","host","hostname","port","pathname","search","hash","href"];var Ze={parse:function(e){return Je.setAttribute("href",e),Object(l.pick)(Je,Xe)},stringify:function(e){return Object(l.extend)(Je,Object(l.pick)(e,Xe)),Je.href},normalize:function(e){return Je.setAttribute("href",e),Je.href}};a(855);function et(e){return n.a.createElement("h4",null,e.message)}function tt(){return(tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function at(e,t){switch(e){case 404:return window.W_L.web_404;case 401:case 403:return window.W_L.web_403;default:return t}}function rt(e){var t=window.W_L.web_error;if(Object(l.isObject)(e)){if(e.isAxiosError&&Object(l.isObject)(e.response))return at(e.response.status,Object(l.get)(e,"response.data.message",t));if(e.status)return at(e.status,t)}return t}function nt(e){var t=e.error,a=e.message;if(!t)return null;console.error(t);var r={error:t,message:a||rt(t)};return n.a.createElement("div",{className:"error-message-container","data-test":"ErrorMessage",role:"alert"},n.a.createElement("div",{className:"error-state bg-white tiled"},n.a.createElement("div",{className:"error-state__icon"},n.a.createElement("i",{className:"zmdi zmdi-alert-circle-o","aria-hidden":"true"})),n.a.createElement("div",{className:"error-state__details"},n.a.createElement(se,tt({name:"ErrorMessageDetails",fallback:n.a.createElement(et,r)},r)))))}function ot(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function it(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(a),!0).forEach((function(t){lt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ot(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function lt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ct(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}et.propTypes={error:ae.a.instanceOf(Error).isRequired,message:ae.a.string.isRequired},nt.propTypes={error:ae.a.object.isRequired,message:ae.a.string};var ut=n.a.createContext(null);function dt(e){var t=Object(l.trimEnd)(Ze.normalize(""),"/")+"/";return e=Ze.normalize(e),!!Object(l.startsWith)(e,t)&&"/"+Object(l.trimStart)(e.substr(t.length),"/")}function mt(e){var t=e.routes,a=e.onRouteChange,o=st(Object(r.useState)(null),2),i=o[0],s=o[1],c=Object(r.useRef)(null),u=Object(r.useRef)();return Object(r.useEffect)(()=>{var e=!1,a=new $e.a(t,{resolveRoute(e,t){var a=e.route;if(Object(l.isFunction)(a.render))return it(it({},a),{},{routeParams:t})}});function r(t){if(!e){u.current&&u.current.reset();var r=dt(A.path)||"/";if(r===c.current)return;if(c.current=r,"REPLACE"===t)return;a.resolve({pathname:r}).then(t=>{e||c.current!==r||s(it(it({},t),{},{key:Math.random().toString(32).substr(2)}))}).catch(t=>{e||c.current!==r||s({render:e=>n.a.createElement(nt,e.routeParams),routeParams:{error:t}})})}}r("PUSH");var o=A.listen((e,t)=>r(t));return()=>{e=!0,c.current=null,o()}},[t]),Object(r.useEffect)(()=>{a(i)},[i,a]),i?n.a.createElement(ut.Provider,{value:i},n.a.createElement(j,{ref:u,renderError:e=>n.a.createElement(nt,{error:e})},i.render(i))):null}function pt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ft(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(a),!0).forEach((function(t){gt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}mt.propTypes={routes:ae.a.arrayOf(ae.a.shape({path:ae.a.string.isRequired,render:ae.a.func,resolve:ae.a.objectOf(ae.a.any)})),onRouteChange:ae.a.func},mt.defaultProps={routes:[],onRouteChange:()=>{}};class bt{constructor(e){Object(l.extend)(this,{pathPrefix:"/".concat(e.path)},Object(l.omit)(e,["isActive","isAvailable"])),Object(l.isFunction)(e.isActive)&&(this.isActive=e.isActive),Object(l.isFunction)(e.isAvailable)&&(this.isAvailable=e.isAvailable)}isActive(e){return e.startsWith(this.pathPrefix)}isAvailable(){return void 0===this.permission||H.hasPermission(this.permission)}}var ht=new class{constructor(){gt(this,"items",[])}add(e,t){e=Object(l.isString)(e)?e:null,this.remove(e),Object(l.isObject)(t)&&(this.items.push(new bt(ft(ft({},t),{},{id:e}))),this.items=Object(l.sortBy)(this.items,"order"))}remove(e){Object(l.isString)(e)&&(this.items=Object(l.filter)(this.items,t=>t.id!==e))}getAvailableItems(){return Object(l.filter)(this.items,e=>e.isAvailable())}getActiveItem(e){var t=dt(e);return Object(l.find)(this.items,e=>e.isActive(t))}},yt=a(104),vt=a.n(yt),wt=a(658),Ot=a.n(wt),_t=a(659),Et=a.n(_t),jt=a(660),St=a.n(jt),Ct=a(661),xt=a.n(Ct),Pt=a(204),Lt=a.n(Pt),kt=a(662),Nt=a.n(kt),At=a(432);function Tt(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,window.W_L.version,": ",Y.DeepBI_version,At!==Y.version&&" (".concat(At.substring(0,8),")")),Y.newVersionAvailable&&H.hasPermission("super_admin")&&n.a.createElement("div",{className:"m-t-10"},n.a.createElement(h,{href:"https://version.redash.io/",className:"update-available",target:"_blank",rel:"noopener"},"Update Available ",n.a.createElement("i",{className:"fa fa-external-link m-l-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))))}a(856);function Wt(){return(Wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function It(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function qt(e){var t=e.children,a=It(e,["children"]);return n.a.createElement(ue.a,Wt({selectable:!1,mode:"vertical",theme:"dark"},a),t)}function Dt(){var e=Object(r.useContext)(ut);return Object(r.useMemo)(()=>({dashboards:Object(l.includes)(["Dashboards.List","Dashboards.Favorites","Dashboards.My","Dashboards.ViewOrEdit","Dashboards.LegacyViewOrEdit"],e.id),queries:Object(l.includes)(["Queries.List","Queries.Favorites","Queries.Archived","Queries.My","Queries.View","Queries.New","Queries.Edit"],e.id),dataSources:Object(l.includes)(["DataSources.List"],e.id),alerts:Object(l.includes)(["Alerts.List","Alerts.New","Alerts.View","Alerts.Edit"],e.id),testdialogue:Object(l.includes)(["Dialogue.List"],e.id),report_route:Object(l.includes)(["Dialogue.List.Report"],e.id),dialogue_list:Object(l.includes)(["Dialogue.List.Dialogue"],e.id),autopilot:Object(l.includes)(["Dialogue.List.autopilot"],e.id),autopilot_list:Object(l.includes)(["Dialogue.List.autopilot_list"],e.id),autopilot_view:Object(l.includes)(["Dialogue.List.autopilot_view"],e.id),dashboards_prettify:Object(l.includes)(["Dialogue.List.dashboards_prettify"],e.id)}),[e.id])}function Rt(){var e=Object(l.first)(ht.getAvailableItems()),t=Dt();return n.a.createElement("nav",{className:"desktop-navbar"},n.a.createElement(qt,{className:"desktop-navbar-logo"},n.a.createElement("div",{role:"menuitem"},n.a.createElement(h,{href:"./"},n.a.createElement("img",{src:vt.a,alt:"DeepBI"})))),n.a.createElement(qt,{className:"desktop-navbar-spacer",style:{flex:"0"}},n.a.createElement(ue.a.SubMenu,{key:"create",popupClassName:"desktop-navbar-submenu","data-test":"dialogueButton",className:t.testdialogue||t.dialogue_list?"navbar-active-item":null,tabIndex:0,title:n.a.createElement(n.a.Fragment,null,n.a.createElement(Ot.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},window.W_L.data_analysis))},n.a.createElement(ue.a.Item,{key:"testdialogue"},n.a.createElement(h,{href:"./","data-test":"testdialogue"},window.W_L.dialogue)),n.a.createElement(ue.a.Item,{key:"dialogue_list"},n.a.createElement(h,{"data-test":"dialogue-list",href:"dialogue-list"},window.W_L.history_dialogue)))),n.a.createElement(qt,{className:"desktop-navbar-spacer",style:{flex:"0"}},n.a.createElement(ue.a.SubMenu,{key:"create",popupClassName:"desktop-navbar-submenu","data-test":"queriesButton",tabIndex:0,className:t.report_route||t.queries?"navbar-active-item":null,title:n.a.createElement(n.a.Fragment,null,n.a.createElement(Et.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},window.W_L.query_builder))},n.a.createElement(ue.a.Item,{key:"report_route"},n.a.createElement(h,{href:"report-route","data-test":"report-route"},window.W_L.report_generation)),n.a.createElement(ue.a.Item,{key:"queries"},n.a.createElement(h,{"data-test":"queries",href:"queries"},window.W_L.report_list)))),n.a.createElement(qt,{style:{flex:"0"}},n.a.createElement(ue.a.SubMenu,{key:"create",popupClassName:"desktop-navbar-submenu","data-test":"queriesButton",tabIndex:0,className:t.dashboards||t.dashboards_prettify?"navbar-active-item":null,title:n.a.createElement(n.a.Fragment,null,n.a.createElement(St.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},window.W_L.dashboards))},n.a.createElement(ue.a.Item,{key:"dashboards"},n.a.createElement(h,{href:"dashboards","data-test":"dashboards"},window.W_L.dashboards)),n.a.createElement(ue.a.Item,{key:"dashboards_prettify"},n.a.createElement(h,{href:"dashboards_prettify","data-test":"dashboards_prettify"},window.W_L.dashboards_prettify)))),n.a.createElement(qt,{className:"desktop-navbar-spacer",style:{flex:"1"}},n.a.createElement(ue.a.SubMenu,{key:"create",popupClassName:"desktop-navbar-submenu","data-test":"autopilotButton",className:t.autopilot||t.autopilot_view||t.autopilot_list?"navbar-active-item":null,tabIndex:0,title:n.a.createElement(n.a.Fragment,null,n.a.createElement(xt.a,{"aria-label":"autopilot navigation button"}),n.a.createElement("span",{className:"desktop-navbar-label"},window.W_L.auto_pilot))},n.a.createElement(ue.a.Item,{key:"autopilot"},n.a.createElement(h,{href:"autopilot","data-test":"autopilot"},window.W_L.auto_pilot)),n.a.createElement(ue.a.Item,{key:"autopilot_list"},n.a.createElement(h,{"data-test":"autopilot_list",href:"autopilot_list"},window.W_L.history_autopilot)))),n.a.createElement(qt,null,n.a.createElement(ue.a.Item,{key:"help"},n.a.createElement(Ge,{showTooltip:!1,type:"HOME",tabIndex:0},n.a.createElement(Lt.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},window.W_L.help))),e&&n.a.createElement(ue.a.Item,{key:"settings",className:t.dataSources?"navbar-active-item":null},n.a.createElement(h,{href:e.path,"data-test":"SettingsLink"},n.a.createElement(Nt.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},window.W_L.setting)))),n.a.createElement(qt,{className:"desktop-navbar-profile-menu"},n.a.createElement(ue.a.SubMenu,{key:"profile",popupClassName:"desktop-navbar-submenu",tabIndex:0,title:n.a.createElement("span",{"data-test":"ProfileDropdown",className:"desktop-navbar-profile-menu-title"},n.a.createElement("img",{className:"profile__image_thumb",src:H.profile_image_url,alt:H.name}))},n.a.createElement(ue.a.Item,{key:"profile"},n.a.createElement(h,{href:"users/me"},window.W_L.personal_setting)),H.hasPermission("super_admin")&&n.a.createElement(ue.a.Item,{key:"status"},n.a.createElement(h,{href:"admin/status"},window.W_L.sys_status)),n.a.createElement(ue.a.Divider,null),n.a.createElement(ue.a.Item,{key:"logout"},n.a.createElement(ge,{"data-test":"LogOutButton",onClick:()=>X.logout()},window.W_L.log_out)),n.a.createElement(ue.a.Divider,null),n.a.createElement(ue.a.Item,{key:"version",role:"presentation",disabled:!0,className:"version-info"},n.a.createElement(Tt,null)))))}var Mt=a(663),zt=a.n(Mt),Ft=a(71),Vt=a.n(Ft);a(882);function Ut(e){var t=e.getPopupContainer,a=Object(l.first)(ht.getAvailableItems());return n.a.createElement("div",{className:"mobile-navbar"},n.a.createElement("div",{className:"mobile-navbar-logo"},n.a.createElement(h,{href:"./"},n.a.createElement("img",{src:vt.a,alt:"DeepBI"}))),n.a.createElement("div",null,n.a.createElement(Vt.a,{overlayStyle:{minWidth:200},trigger:["click"],getPopupContainer:t,overlay:n.a.createElement(ue.a,{mode:"vertical",theme:"dark",selectable:!1,className:"mobile-navbar-menu"},n.a.createElement(ue.a.Item,{key:"testdialogue"},n.a.createElement(h,{href:"./"},window.W_L.data_analysis)),n.a.createElement(ue.a.Item,{key:"dialogue-list"},n.a.createElement(h,{href:"dialogue-list"},window.W_L.history_dialogue)),n.a.createElement(ue.a.Item,{key:"report-route"},n.a.createElement(h,{href:"report-route"},window.W_L.report_generation)),n.a.createElement(ue.a.Item,{key:"queries"},n.a.createElement(h,{href:"queries"},window.W_L.report_list)),n.a.createElement(ue.a.Item,{key:"dashboards"},n.a.createElement(h,{href:"dashboards"},window.W_L.dashboard)),n.a.createElement(ue.a.Item,{key:"dashboards_prettify"},n.a.createElement(h,{href:"dashboards_prettify"},window.W_L.dashboards_prettify)),n.a.createElement(ue.a.Item,{key:"autopilot"},n.a.createElement(h,{href:"autopilot"},window.W_L.auto_pilot)),n.a.createElement(ue.a.Item,{key:"autopilot_list"},n.a.createElement(h,{href:"autopilot_list"},window.W_L.history_autopilot)),a&&n.a.createElement(ue.a.Item,{key:"settings"},n.a.createElement(h,{href:a.path},window.W_L.setting)),H.hasPermission("super_admin")&&n.a.createElement(ue.a.Divider,null),n.a.createElement(ue.a.Item,{key:"logout",onClick:()=>X.logout()},window.W_L.log_out))},n.a.createElement(m.a,{className:"mobile-navbar-toggle-button",ghost:!0},n.a.createElement(zt.a,null)))))}Ut.propTypes={getPopupContainer:ae.a.func},Ut.defaultProps={getPopupContainer:null};a(888);function Bt(e){var t=e.children,a=Object(r.useRef)(),o=Object(r.useCallback)(()=>a.current,[]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(se,{name:"ApplicationWrapper"},n.a.createElement("div",{className:"application-layout-side-menu"},n.a.createElement(se,{name:"ApplicationDesktopNavbar"},n.a.createElement(Rt,null))),n.a.createElement("div",{className:"application-layout-content"},n.a.createElement("nav",{className:"application-layout-top-menu",ref:a},n.a.createElement(se,{name:"ApplicationMobileNavbar",getPopupContainer:o},n.a.createElement(Ut,{getPopupContainer:o}))),t)))}function Ht(){return(Ht=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Yt(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Qt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Kt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(a),!0).forEach((function(t){Gt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Jt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Jt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Xt(e){var t=e.bodyClass,a=e.currentRoute,o=e.render,i=$t(Object(r.useState)(!!X.isAuthenticated()),2),l=i[0],s=i[1];return Object(r.useEffect)(()=>{var e=!1;return Promise.all([X.requireSession(),ee.refresh(),Z.refresh()]).then(()=>{e||s(!!X.isAuthenticated())}).catch(()=>{e||s(!1)}),()=>{e=!0}},[]),Object(r.useEffect)(()=>{if(t)return document.body.classList.toggle(t,!0),()=>{document.body.classList.toggle(t,!1)}},[t]),l?n.a.createElement(Bt,null,n.a.createElement(n.a.Fragment,{key:a.key},n.a.createElement(j,{renderError:e=>n.a.createElement(nt,{error:e})},n.a.createElement(_.Consumer,null,e=>{var t=e.handleError;return o(Kt(Kt({},a.routeParams),{},{pageTitle:a.title,onError:t}))})))):null}Bt.propTypes={children:ae.a.node},Bt.defaultProps={children:null};function Zt(e){var t=e.render,a=e.bodyClass;return Kt(Kt({},Yt(e,["render","bodyClass"])),{},{render:e=>{var r={render:t,bodyClass:a,currentRoute:e};return n.a.createElement(se,Ht({},r,{name:"UserSessionWrapper",fallback:n.a.createElement(Xt,r)}))}})}var ea=a(20),ta=a.n(ea);a(70);function aa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ra(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(a),!0).forEach((function(t){na(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):aa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function na(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function oa(){return(oa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var ia=ae.a.shape({props:ae.a.shape({visible:ae.a.bool,onOk:ae.a.func,onCancel:ae.a.func,afterClose:ae.a.func}).isRequired,close:ae.a.func.isRequired,dismiss:ae.a.func.isRequired});function la(e){return{Component:e,showModal:t=>function(e,t){var a={props:{visible:!0,okButtonProps:{},cancelButtonProps:{},onOk:()=>{},onCancel:()=>{},afterClose:()=>{}},close:()=>{},dismiss:()=>{}},r=null,o={onClose:()=>{},onDismiss:()=>{}},s=document.createElement("div");function c(){i.a.render(n.a.createElement(e,oa({},t,{dialog:a})),s)}function u(e,t){return a.props.okButtonProps={disabled:!0},a.props.cancelButtonProps={disabled:!0},t(),c(),Promise.resolve(e).then(()=>{a.props.visible=!1}).finally(()=>{a.props.okButtonProps={},a.props.cancelButtonProps={},c()})}function d(e){return r||(r=u(o.onClose(e),()=>{a.props.okButtonProps.loading=!0}).finally(()=>{r=null})),r}function m(e){return r||(r=u(o.onDismiss(e),()=>{a.props.cancelButtonProps.loading=!0}).finally(()=>{r=null})),r}document.body.appendChild(s),a.props.onOk=d,a.props.onCancel=m,a.props.afterClose=function(){setTimeout(()=>{i.a.unmountComponentAtNode(s),document.body.removeChild(s)},10)},a.close=d,a.dismiss=m;var p={close:d,dismiss:m,update:e=>{t=ra(ra({},t),e),c()},onClose:e=>(Object(l.isFunction)(e)&&(o.onClose=e),p),onDismiss:e=>(Object(l.isFunction)(e)&&(o.onDismiss=e),p)};return c(),p}(e,t)}}function sa(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTimeout(()=>{!1===dt(e)?window.location=e:(e=Ze.parse(e),A.update({path:e.pathname,search:e.search,hash:e.hash},t))},10)}var ca=[],ua=Object(l.debounce)(()=>{var e=ca;ca=[],B.post("api/events",e)},1e3);function da(e,t,a,r){var n={action:e,object_type:t,object_id:a,timestamp:Date.now()/1e3,screen_resolution:"".concat(window.screen.width,"x").concat(window.screen.height)};Object(l.extend)(n,r),ca.push(n),ua()}var ma=6,pa=50,fa=15,ga=800,ba=3,ha=3,ya=1,va=6,wa=1,Oa=1e3,_a=a(15),Ea=a.n(_a);var ja=class{constructor(e,t){this.title=e.title,this.name=e.name,this.type=e.type,this.global=e.global,this.parentQueryId=t,this.locals=[],this.urlPrefix="p_"}static getExecutionValue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(l.isObject)(e)&&Object(l.isFunction)(e.getExecutionValue)?e.getExecutionValue(t):null}static setValue(e,t){return Object(l.isObject)(e)&&Object(l.isFunction)(e.setValue)?e.setValue(t):null}get isEmpty(){return Object(l.isNull)(this.normalizedValue)}get hasPendingValue(){return void 0!==this.pendingValue&&!Object(l.isEqual)(this.pendingValue,this.normalizedValue)}get normalizedValue(){return this.$$value}isEmptyValue(e){return Object(l.isNull)(this.normalizeValue(e))}normalizeValue(e){return Object(l.isUndefined)(e)?null:e}updateLocals(){Object(l.isArray)(this.locals)&&Object(l.each)(this.locals,e=>{e.setValue(this.value)})}setValue(e){var t=this.normalizeValue(e);return this.value=t,this.$$value=t,this.updateLocals(),this.clearPendingValue(),this}getExecutionValue(){return this.value}setPendingValue(e){this.pendingValue=this.normalizeValue(e)}applyPendingValue(){this.hasPendingValue&&this.setValue(this.pendingValue)}clearPendingValue(){this.pendingValue=void 0}toUrlParams(){var e=this.urlPrefix;return{["".concat(e).concat(this.name)]:this.isEmpty?null:this.value}}fromUrlParams(e){var t=this.urlPrefix,a="".concat(t).concat(this.name);Object(l.has)(e,a)&&this.setValue(e[a])}toQueryTextFragment(){return"{{ ".concat(this.name," }}")}toSaveableObject(){return Object(l.omit)(this,["$$value","urlPrefix","pendingValue","parentQueryId"])}};var Sa=class extends ja{constructor(e,t){super(e,t),this.setValue(e.value)}normalizeValue(e){var t=Object(l.toString)(e);return Object(l.isEmpty)(t)?null:t}};var Ca=class extends ja{constructor(e,t){super(e,t),this.setValue(e.value)}normalizeValue(e){if(Object(l.isNull)(e))return null;var t=Object(l.toNumber)(e);return isNaN(t)?null:t}};a(91);var xa=class extends ja{constructor(e,t){super(e,t),this.enumOptions=e.enumOptions,this.multiValuesOptions=e.multiValuesOptions,this.setValue(e.value)}normalizeValue(e){if(Object(l.isEmpty)(this.enumOptions))return null;var t=this.enumOptions.split("\n")||[];return this.multiValuesOptions?(Object(l.isArray)(e)||(e=[e]),e=Object(l.intersection)(e,t)):e&&!Object(l.isArray)(e)&&Object(l.includes)(t,e)||(e=t[0]),Object(l.isArray)(e)&&Object(l.isEmpty)(e)?null:e}getExecutionValue(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).joinListValues&&Object(l.isArray)(this.value)){var e=Object(l.get)(this.multiValuesOptions,"separator",","),t=Object(l.get)(this.multiValuesOptions,"prefix",""),a=Object(l.get)(this.multiValuesOptions,"suffix",""),r=Object(l.map)(this.value,e=>"".concat(t).concat(e).concat(a));return Object(l.join)(r,e)}return this.value}toUrlParams(){var e=this.urlPrefix,t=this.value;return this.multiValuesOptions&&Object(l.isArray)(this.value)&&(t=JSON.stringify(this.value)),{["".concat(e).concat(this.name)]:this.isEmpty?null:t}}fromUrlParams(e){var t=this.urlPrefix,a="".concat(t).concat(this.name);if(Object(l.has)(e,a))if(this.multiValuesOptions)try{var r=JSON.parse(e[a]);this.setValue(Object(l.isArray)(r)?r:e[a])}catch(t){this.setValue(e[a])}else this.setValue(e[a])}},Pa=(a(488),a(253)),La=a.n(Pa),ka=v()("redash:services:QueryResult"),Na=["filter","multi-filter","multiFilter"];function Aa(e){return function(e){var t;if(-1!==e.indexOf("::"))t="::";else{if(-1===e.indexOf("__"))return e;t="__"}var a=e.split(t);return""===a[0]&&2===a.length?a[1]:Object(l.includes)(Na,a[1])?a[0]:e}(e).replace(/(?:^|\s)\S/g,e=>e.toUpperCase())}var Ta=e=>{var t=e.id;return B.get("api/query_results/".concat(t))},Wa=e=>B.post((e=>e.id?"api/query_results/".concat(e.id):"api/query_results")(e),e),Ia="waiting",qa="processing",Da="done",Ra="failed",Ma="loading-result",za={1:Ia,2:qa,3:Da,4:Ra};function Fa(e,t){switch(Object(l.get)(t,"response.status")){case 403:return void e.update(t.response.data);case 400:if("job"in t.response.data)return void e.update(t.response.data);break;case 404:return void e.update({job:{error:"cached query result unavailable, please execute again.",status:4}})}ka("Unknown error",t),e.update({job:{error:Object(l.get)(t,"response.data.message","Unknown error occurred. Please try again later."),status:4}})}function Va(e){return new Promise(t=>setTimeout(t,e))}function Ua(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return B.get("api/jobs/".concat(e)).then(e=>{var a=za[e.job.status];return a===Ia||a===qa?Va(t).then(()=>Ua(e.job.id)):a===Da?e.job.result:a===Ra?Promise.reject(e.job.error):void 0})}class Ba{constructor(e){var t;this.deferred=((t={onStatusChange:e=>{}}).promise=new Promise((e,a)=>{t.resolve=e,t.reject=a}),t),this.job={},this.query_result={},this.status="waiting",this.updatedAt=Ea()(),this.isLoadingResult=!1,e&&this.update(e)}update(e){if(Object(l.extend)(this,e),"query_result"in e){this.status=Da,this.deferred.onStatusChange(Da);var t={};Object(l.each)(this.query_result.data.rows,e=>{Object(l.forOwn)(e,(a,r)=>{var n=null;Object(l.isNumber)(a)?n="float":Object(l.isString)(a)&&a.match(/^\d{4}-\d{2}-\d{2}T/)?(e[r]=Ea.a.utc(a),n="datetime"):Object(l.isString)(a)&&a.match(/^\d{4}-\d{2}-\d{2}$/)?(e[r]=Ea.a.utc(a),n="date"):"object"==typeof a&&null!==a?e[r]=JSON.stringify(a):n="string",null!==n&&(void 0!==t[r]&&t[r]!==n?t[r]="string":t[r]=n)})}),Object(l.each)(this.query_result.data.columns,e=>{e.name=""+e.name,t[e.name]&&(null!=e.type&&"string"!==e.type||(e.type=t[e.name]))}),this.deferred.resolve(this)}else 3===this.job.status||2===this.job.status?(this.deferred.onStatusChange(qa),this.status="processing"):4===this.job.status?(this.status=za[this.job.status],this.deferred.reject(new tr(this.job.error))):(this.deferred.onStatusChange(void 0),this.status=void 0)}getId(){var e=null;return"query_result"in this&&(e=this.query_result.id),e}cancelExecution(){B.delete("api/jobs/".concat(this.job.id))}getStatus(){return this.isLoadingResult?Ma:this.status||za[this.job.status]}getError(){if("None"!==this.job.error)return this.job.error}getLog(){return this.query_result.data&&this.query_result.data.log&&0!==this.query_result.data.log.length?this.query_result.data.log:null}getUpdatedAt(){return this.query_result.retrieved_at||1e3*this.job.updated_at||this.updatedAt}getRuntime(){return this.query_result.runtime}getRawData(){return this.query_result.data?this.query_result.data.rows:null}getData(){return this.query_result.data?this.query_result.data.rows:null}isEmpty(){return null===this.getData()||0===this.getData().length}getColumns(){return void 0===this.columns&&this.query_result.data&&(this.columns=this.query_result.data.columns),this.columns}getColumnNames(){return void 0===this.columnNames&&this.query_result.data&&(this.columnNames=this.query_result.data.columns.map(e=>e.name)),this.columnNames}getColumnFriendlyNames(){return this.getColumnNames().map(e=>Aa(e))}getTruncated(){return this.query_result.data?this.query_result.data.truncated:null}getFilters(){if(!this.getColumns())return[];var e=[];return this.getColumns().forEach(t=>{var a=t.name,r=a.split("::")[1]||a.split("__")[1];if(Object(l.includes)(Na,r)){var n={name:a,friendlyName:Aa(a),column:t,values:[],multiple:"multiFilter"===r||"multi-filter"===r};e.push(n)}},this),this.getRawData().forEach(t=>{e.forEach(e=>{e.values.push(t[e.name]),1===e.values.length&&(e.multiple?e.current=[t[e.name]]:e.current=t[e.name])})}),e.forEach(e=>{e.values=Object(l.uniqBy)(e.values,e=>Ea.a.isMoment(e)?e.unix():e),e.values.length>1&&e.multiple&&(e.current=e.values.slice())}),e}toPromise(e){return e&&(this.deferred.onStatusChange=e),this.deferred.promise}static getById(e,t){var a=new Ba;return a.isLoadingResult=!0,a.deferred.onStatusChange(Ma),B.get("api/queries/".concat(e,"/results/").concat(t,".json")).then(e=>{a.isLoadingResult=!1,a.update(e)}).catch(e=>{a.isLoadingResult=!1,Fa(a,e)}),a}loadLatestCachedResult(e,t){B.post("api/queries/".concat(e,"/results"),{queryId:e,parameters:t}).then(e=>{this.update(e)}).catch(e=>{Fa(this,e)})}loadResult(e){this.isLoadingResult=!0,this.deferred.onStatusChange(Ma),Ta({id:this.job.query_result_id}).then(e=>{this.update(e),this.isLoadingResult=!1}).catch(t=>{void 0===e&&(e=0),e>3?(ka("Connection error while trying to load result",t),this.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}}),this.isLoadingResult=!1):setTimeout(()=>{this.loadResult(e+1)},1e3*Math.pow(2,e))})}refreshStatus(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=()=>X.isAuthenticated()?this.loadResult():this.loadLatestCachedResult(e,t);(X.isAuthenticated()?B.get("api/jobs/".concat(this.job.id)):B.get("api/queries/".concat(e,"/jobs/").concat(this.job.id))).then(n=>{if(this.update(n),"processing"===this.getStatus()&&this.job.query_result_id&&"None"!==this.job.query_result_id)r();else if("failed"!==this.getStatus()){setTimeout(()=>{this.refreshStatus(e,t,a+1)},a>10?3e3:500)}}).catch(e=>{ka("Connection error",e),this.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}})})}getLink(e,t,a){var r="api/queries/".concat(e,"/results/").concat(this.getId(),".").concat(t);return a&&(r="".concat(r,"?api_key=").concat(a)),r}getName(e,t){return"".concat(e.replace(/ /g,"_")+Ea()(this.getUpdatedAt()).format("_YYYY_MM_DD"),".").concat(t)}static getByQueryId(e,t,a,r){var n=new Ba;return B.post("api/queries/".concat(e,"/results"),{id:e,parameters:t,apply_auto_limit:a,max_age:r}).then(a=>{n.update(a),"job"in a&&n.refreshStatus(e,t)}).catch(e=>{Fa(n,e)}),n}static get(e,t,a,r,n,o){var i=new Ba,l={data_source_id:e,parameters:a,query:t,apply_auto_limit:r,max_age:n};return void 0!==o&&(l.query_id=o),Wa(l).then(e=>{i.update(e),"job"in e&&i.refreshStatus(t,a)}).catch(e=>{Fa(i,e)}),i}}var Ha=Ba,Ya="localOptions:";var Qa={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=Ya+e;return a in window.localStorage?JSON.parse(window.localStorage.getItem(a)):t},set:function(e,t){var a=Ya+e;window.localStorage.setItem(a,JSON.stringify(t))}};function Ka(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ga(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ka(Object(a),!0).forEach((function(t){$a(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ka(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function $a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ja(){return(Ja=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}La.a.escape=l.identity;var Xa=v()("redash:services:query");class Za{constructor(e){Object(l.extend)(this,e),Object(l.has)(this,"options")||(this.options={}),this.options.apply_auto_limit=!!this.options.apply_auto_limit,Object(l.isArray)(this.options.parameters)||(this.options.parameters=[])}isNew(){return void 0===this.id}hasDailySchedule(){return this.schedule&&null!==this.schedule.match(/\d\d:\d\d/)}scheduleInLocalTime(){var e=this.schedule.split(":");return Ea.a.utc().hour(e[0]).minute(e[1]).local().format("HH:mm")}hasResult(){return!(!this.latest_query_data&&!this.latest_query_data_id)}paramsRequired(){return this.getParameters().isRequired()}hasParameters(){return this.getParametersDefs().length>0}prepareQueryResultExecution(e,t){var a=this.getParameters(),r=a.getMissing();if(r.length>0){var n="parameter",o="value";return r.length>1&&(n="parameters",o="values"),new Ha({job:{error:"missing ".concat(o," for ").concat(r.join(", ")," ").concat(n,"."),status:4}})}return a.isRequired()&&(this.latest_query_data=null,this.latest_query_data_id=null),this.latest_query_data&&0!==t?this.queryResult||(this.queryResult=new Ha({query_result:this.latest_query_data})):this.latest_query_data_id&&0!==t?this.queryResult||(this.queryResult=Ha.getById(this.id,this.latest_query_data_id)):this.queryResult=e(),this.queryResult}getQueryResult(e){return this.prepareQueryResultExecution(()=>Ha.getByQueryId(this.id,this.getParameters().getExecutionValues(),this.getAutoLimit(),e),e)}getQueryResultByText(e,t){var a=t||this.query;if(!a)return new tr(window.W_L.empty_query);var r=this.getParameters().getExecutionValues({joinListValues:!0});return this.prepareQueryResultExecution(()=>Ha.get(this.data_source_id,a,r,this.getAutoLimit(),e,this.id),e)}getUrl(e,t){var a="queries/".concat(this.id);e&&(a+="/source");var r={};return this.getParameters().isRequired()&&this.getParametersDefs().forEach(e=>{Object(l.extend)(r,e.toUrlParams())}),Object.keys(r).forEach(e=>null==r[e]&&delete r[e]),""!==(r=Object(l.map)(r,(e,t)=>"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e))).join("&"))&&(a+="?".concat(r)),t&&(a+="#".concat(t)),a}getQueryResultPromise(){return this.getQueryResult().toPromise()}getParameters(){return this.$parameters||(this.$parameters=new er(this,A.search)),this.$parameters}getAutoLimit(){return this.options.apply_auto_limit}getParametersDefs(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.getParameters().get(e)}favorite(){return Za.favorite(this)}unfavorite(){return Za.unfavorite(this)}clone(){var e=Object(l.clone)(this);return e.$parameters=null,e.getParameters(),e}}class er{constructor(e,t){this.query=e,this.updateParameters(),this.initFromQueryString(t)}parseQuery(){var e=()=>Object(l.map)(this.query.options.parameters,e=>e.name),t=[];if(void 0!==this.query.query)try{var a=La.a.parse(this.query.query);t=Object(l.uniq)(function e(t){var a=[];return t.forEach(t=>{"name"===t[0]||"&"===t[0]?a.push(t[1].split(".")[0]):"#"===t[0]&&(a=Object(l.union)(a,e(t[4])))}),a}(a))}catch(a){Xa("Failed parsing parameters: ",a),t=e()}else t=e();return t}updateParameters(e){if(this.query.query!==this.cachedQueryText){this.cachedQueryText=this.query.query;var t=e?this.parseQuery():Object(l.map)(this.query.options.parameters,e=>e.name);this.query.options.parameters=this.query.options.parameters||[];var a={};this.query.options.parameters.forEach(e=>{a[e.name]=e}),t.forEach(e=>{Object(l.has)(a,e)||this.query.options.parameters.push(Cr({title:e,name:e,type:"text",value:null,global:!1}))});var r=this.query.options.parameters;this.query.options.parameters=r.filter(e=>Object(l.includes)(t,e.name)).map(e=>e instanceof ja?e:Cr(e,this.query.id))}else{var n=this.query.options.parameters;Object(l.find)(n,e=>!(e instanceof ja))&&(this.query.options.parameters=Object(l.map)(n,e=>e instanceof ja?e:Cr(e,this.query.id)))}}initFromQueryString(e){this.get().forEach(t=>{t.fromUrlParams(e)})}get(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.updateParameters(e),this.query.options.parameters}add(e){this.query.options.parameters=this.query.options.parameters.filter(t=>t.name!==e.name);var t=Cr(e);return this.query.options.parameters.push(t),t}getMissing(){return Object(l.map)(Object(l.filter)(this.get(),e=>e.isEmpty),e=>e.title)}isRequired(){return!Object(l.isEmpty)(this.get())}getExecutionValues(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.get();return Object(l.zipObject)(Object(l.map)(t,e=>e.name),Object(l.map)(t,t=>t.getExecutionValue(e)))}hasPendingValues(){return Object(l.some)(this.get(),e=>e.hasPendingValue)}applyPendingValues(){Object(l.each)(this.get(),e=>e.applyPendingValue())}toUrlParams(){if(0===this.get().length)return"";var e=Ja(...this.get().map(e=>e.toUrlParams()));return Object.keys(e).forEach(t=>null==e[t]&&delete e[t]),Object.keys(e).map(t=>"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))).join("&")}}class tr{constructor(e){this.errorMessage=e,this.updatedAt=Ea.a.utc()}getUpdatedAt(){return this.updatedAt}getError(){return this.errorMessage}toPromise(){return Promise.reject(this)}getStatus(){return"failed"}getData(){return null}getLog(){return null}}var ar=e=>new Za(e),rr=e=>Ga(Ga({},e),{},{results:Object(l.map)(e.results,ar)}),nr={query:e=>B.get("api/queries",{params:e}).then(rr),get:e=>B.get("api/queries/".concat(e.id),e).then(ar),save:e=>B.post((e=>e.id?"api/queries/".concat(e.id):"api/queries")(e),e).then(ar),delete:e=>B.delete("api/queries/".concat(e.id)),recent:e=>B.get("api/queries/recent",{params:e}).then(e=>Object(l.map)(e,ar)),archive:e=>B.get("api/queries/archive",{params:e}).then(rr),myQueries:e=>B.get("api/queries/my",{params:e}).then(rr),fork:e=>{var t=e.id;return B.post("api/queries/".concat(t,"/fork"),{id:t}).then(ar)},resultById:e=>B.get("api/queries/".concat(e.id,"/results.json")),asDropdown:e=>B.get("api/queries/".concat(e.id,"/dropdown")),associatedDropdown:e=>{var t=e.queryId,a=e.dropdownQueryId;return B.get("api/queries/".concat(t,"/dropdowns/").concat(a))},favorites:e=>B.get("api/queries/favorites",{params:e}).then(rr),favorite:e=>B.post("api/queries/".concat(e.id,"/favorite")),unfavorite:e=>B.delete("api/queries/".concat(e.id,"/favorite")),newQuery:function(){return new Za({query:"",name:window.W_L.new_Query,schedule:null,user:H,options:{apply_auto_limit:Qa.get("applyAutoLimit",!0)},tags:[],can_edit:!0})}};Object(l.extend)(Za,nr);var or=class extends ja{constructor(e,t){super(e,t),this.queryId=e.queryId,this.multiValuesOptions=e.multiValuesOptions,this.setValue(e.value)}normalizeValue(e){return Object(l.isUndefined)(e)||Object(l.isNull)(e)||Object(l.isArray)(e)&&Object(l.isEmpty)(e)?null:e=this.multiValuesOptions?Object(l.isArray)(e)?e:[e]:Object(l.isArray)(e)?e[0]:e}getExecutionValue(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).joinListValues&&Object(l.isArray)(this.value)){var e=Object(l.get)(this.multiValuesOptions,"separator",","),t=Object(l.get)(this.multiValuesOptions,"prefix",""),a=Object(l.get)(this.multiValuesOptions,"suffix",""),r=Object(l.map)(this.value,e=>"".concat(t).concat(e).concat(a));return Object(l.join)(r,e)}return this.value}toUrlParams(){var e=this.urlPrefix,t=this.value;return this.multiValuesOptions&&Object(l.isArray)(this.value)&&(t=JSON.stringify(this.value)),{["".concat(e).concat(this.name)]:this.isEmpty?null:t}}fromUrlParams(e){var t=this.urlPrefix,a="".concat(t).concat(this.name);if(Object(l.has)(e,a))if(this.multiValuesOptions)try{var r=JSON.parse(e[a]);this.setValue(Object(l.isArray)(r)?r:e[a])}catch(t){this.setValue(e[a])}else this.setValue(e[a])}loadDropdownValues(){return this.parentQueryId?Za.associatedDropdown({queryId:this.parentQueryId,dropdownQueryId:this.queryId}).catch(()=>Promise.resolve([])):Za.asDropdown({id:this.queryId}).catch(Promise.resolve([]))}},ir={date:"YYYY-MM-DD","datetime-local":"YYYY-MM-DD HH:mm","datetime-with-seconds":"YYYY-MM-DD HH:mm:ss"},lr={now:{name:"Today/Now",value:()=>Ea()()},yesterday:{name:"Yesterday",value:()=>Ea()().subtract(1,"day")}},sr=ae.a.oneOf(Object(l.values)(lr));function cr(e){return Object(l.startsWith)(e,"d_")&&Object(l.has)(lr,e.substring("d_".length))}function ur(e){return Object(l.includes)(lr,e)}function dr(e){return cr(e)?lr[e.substring("d_".length)]:null}var mr=class extends ja{constructor(e,t){super(e,t),this.useCurrentDateTime=e.useCurrentDateTime,this.setValue(e.value)}get hasDynamicValue(){return ur(this.normalizedValue)}normalizeValue(e){if(cr(e))return dr(e);if(ur(e))return e;var t=Ea()(e);return t.isValid()?t:null}setValue(e){var t=this.normalizeValue(e);return ur(t)?this.value="d_"+Object(l.findKey)(lr,t):Ea.a.isMoment(t)?this.value=t.format(ir[this.type]):this.value=t,this.$$value=t,this.updateLocals(),this.clearPendingValue(),this}getExecutionValue(){return this.hasDynamicValue?this.normalizedValue.value().format(ir[this.type]):Object(l.isNull)(this.value)&&this.useCurrentDateTime?Ea()().format(ir[this.type]):this.value}};function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fr(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return fr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var gr={"date-range":"YYYY-MM-DD","datetime-range":"YYYY-MM-DD HH:mm","datetime-range-with-seconds":"YYYY-MM-DD HH:mm:ss"},br=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>Ea()();return function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return[e(),a?t():void 0]}},hr={today:{name:"Today",value:()=>[Ea()().startOf("day"),Ea()().endOf("day")]},yesterday:{name:"Yesterday",value:()=>[Ea()().subtract(1,"day").startOf("day"),Ea()().subtract(1,"day").endOf("day")]},this_week:{name:"This week",value:()=>[Ea()().startOf("week"),Ea()().endOf("week")]},this_month:{name:"This month",value:()=>[Ea()().startOf("month"),Ea()().endOf("month")]},this_year:{name:"This year",value:()=>[Ea()().startOf("year"),Ea()().endOf("year")]},last_week:{name:"Last week",value:()=>[Ea()().subtract(1,"week").startOf("week"),Ea()().subtract(1,"week").endOf("week")]},last_month:{name:"Last month",value:()=>[Ea()().subtract(1,"month").startOf("month"),Ea()().subtract(1,"month").endOf("month")]},last_year:{name:"Last year",value:()=>[Ea()().subtract(1,"year").startOf("year"),Ea()().subtract(1,"year").endOf("year")]},last_hour:{name:"Last hour",value:br(()=>Ea()().subtract(1,"hour"))},last_8_hours:{name:"Last 8 hours",value:br(()=>Ea()().subtract(8,"hour"))},last_24_hours:{name:"Last 24 hours",value:br(()=>Ea()().subtract(24,"hour"))},last_7_days:{name:"Last 7 days",value:br(()=>Ea()().subtract(7,"days").startOf("day"),()=>Ea()().endOf("day"))},last_14_days:{name:"Last 14 days",value:br(()=>Ea()().subtract(14,"days").startOf("day"),()=>Ea()().endOf("day"))},last_30_days:{name:"Last 30 days",value:br(()=>Ea()().subtract(30,"days").startOf("day"),()=>Ea()().endOf("day"))},last_60_days:{name:"Last 60 days",value:br(()=>Ea()().subtract(60,"days").startOf("day"),()=>Ea()().endOf("day"))},last_90_days:{name:"Last 90 days",value:br(()=>Ea()().subtract(90,"days").startOf("day"),()=>Ea()().endOf("day"))},last_12_months:{name:"Last 12 months",value:br(()=>Ea()().subtract(12,"months").startOf("day"),()=>Ea()().endOf("day"))}},yr=ae.a.oneOf(Object(l.values)(hr));function vr(e){return!!Object(l.startsWith)(e,"d_")&&!!hr[e.substring("d_".length)]}function wr(e){return Object(l.includes)(hr,e)}function Or(e){return vr(e)?hr[e.substring("d_".length)]:null}var _r=class extends ja{constructor(e,t){super(e,t),this.setValue(e.value)}get hasDynamicValue(){return wr(this.normalizedValue)}normalizeValue(e){return vr(e)?Or(e):wr(e)?e:(Object(l.isObject)(e)&&!Object(l.isArray)(e)&&(e=[e.start,e.end]),Object(l.isArray)(e)&&2===e.length&&(e=[Ea()(e[0]),Ea()(e[1])])[0].isValid()&&e[1].isValid()?e:null)}setValue(e){var t=this.normalizeValue(e);return wr(t)?this.value="d_"+Object(l.findKey)(hr,t):Object(l.isArray)(t)?this.value={start:t[0].format(gr[this.type]),end:t[1].format(gr[this.type])}:this.value=t,this.$$value=t,this.updateLocals(),this.clearPendingValue(),this}getExecutionValue(){if(this.hasDynamicValue){var e=pr(this.normalizedValue.value().map(e=>e.format(gr[this.type])),2);return{start:e[0],end:e[1]}}return this.value}toUrlParams(){var e=this.urlPrefix;return Object(l.isObject)(this.value)&&this.value.start&&this.value.end?{["".concat(e).concat(this.name)]:"".concat(this.value.start,"--").concat(this.value.end)}:super.toUrlParams()}fromUrlParams(e){var t=this.urlPrefix,a="".concat(t).concat(this.name),r="".concat(t).concat(this.name,".start"),n="".concat(t).concat(this.name,".end");if(Object(l.has)(e,a)){var o=e[a].split("--");2===o.length?this.setValue(o):this.setValue(e[a])}else Object(l.has)(e,r)&&Object(l.has)(e,n)&&this.setValue([e[r],e[n]])}toQueryTextFragment(){return"{{ ".concat(this.name,".start }} {{ ").concat(this.name,".end }}")}};function Er(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function jr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Er(Object(a),!0).forEach((function(t){Sr(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Er(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Sr(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Cr(e,t){switch(e.type){case"number":return new Ca(e,t);case"enum":return new xa(e,t);case"query":return new or(e,t);case"date":case"datetime-local":case"datetime-with-seconds":return new mr(e,t);case"date-range":case"datetime-range":case"datetime-range-with-seconds":return new _r(e,t);default:return new Sa(jr(jr({},e),{},{type:"text"}),t)}}function xr(e){return Cr(e,e.parentQueryId)}var Pr=a(18),Lr=a.n(Pr),kr=new Map;function Nr(){kr.size>0&&(kr.forEach((e,t)=>{var a=t.getBoundingClientRect(),r=Math.round(10*a.width),n=Math.round(10*a.height);e.width===r&&e.height===n||(e.width=r,e.height=n,e.callback(t))}),setTimeout(Nr,100))}function Ar(e,t){if(e&&!kr.has(e)){var a=0===kr.size;return kr.set(e,{callback:t}),a&&Nr(),()=>kr.delete(e)}return()=>{}}var Tr=ae.a.object,Wr=ae.a.shape({columns:ae.a.arrayOf(ae.a.object).isRequired,rows:ae.a.arrayOf(ae.a.object).isRequired}),Ir=ae.a.shape({id:ae.a.number,type:ae.a.string.isRequired,name:ae.a.string.isRequired,options:Tr.isRequired}),qr={visualizationName:ae.a.string,data:Wr.isRequired,options:Tr.isRequired,onOptionsChange:ae.a.func},Dr={visualizationName:ae.a.string,data:Wr.isRequired,options:Tr.isRequired,onOptionsChange:ae.a.func.isRequired};a(167);function Rr(e){return[0,e.length-1]}function Mr(e){return[d3.quantile(e,.25),d3.quantile(e,.5),d3.quantile(e,.75)]}var zr=function(){var e=1,t=1,a=0,r=null,n=Number,o=Rr,i=Mr,l=null;function s(s){s.each((function(s,c){s=s.map(n).sort(d3.ascending);var u=d3.select(this),d=s.length,m=s[0],p=s[d-1],f=s.quartiles=i(s),g=o&&o.call(this,s,c),b=g&&g.map(e=>s[e]),h=g?d3.range(0,g[0]).concat(d3.range(g[1]+1,d)):d3.range(d),y=d3.scale.linear().domain(r&&r.call(this,s,c)||[m,p]).range([t,0]),v=this.__chart__||d3.scale.linear().domain([0,1/0]).range(y.range());this.__chart__=y;var w=u.selectAll("line.center").data(b?[b]:[]);w.enter().insert("line","rect").attr("class","center").attr("x1",e/2).attr("y1",e=>v(e[0])).attr("x2",e/2).attr("y2",e=>v(e[1])).style("opacity",1e-6).transition().duration(a).style("opacity",1).attr("y1",e=>y(e[0])).attr("y2",e=>y(e[1])),w.transition().duration(a).style("opacity",1).attr("y1",e=>y(e[0])).attr("y2",e=>y(e[1])),w.exit().transition().duration(a).style("opacity",1e-6).attr("y1",e=>y(e[0])).attr("y2",e=>y(e[1])).remove();var O=u.selectAll("rect.box").data([f]);O.enter().append("rect").attr("class","box").attr("x",0).attr("y",e=>v(e[2])).attr("width",e).attr("height",e=>v(e[0])-v(e[2])).transition().duration(a).attr("y",e=>y(e[2])).attr("height",e=>y(e[0])-y(e[2])),O.transition().duration(a).attr("y",e=>y(e[2])).attr("height",e=>y(e[0])-y(e[2])),O.exit().remove();var _=u.selectAll("line.median").data([f[1]]);_.enter().append("line").attr("class","median").attr("x1",0).attr("y1",v).attr("x2",e).attr("y2",v).transition().duration(a).attr("y1",y).attr("y2",y),_.transition().duration(a).attr("y1",y).attr("y2",y),_.exit().remove();var E=u.selectAll("line.whisker").data(b||[]);E.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",v).attr("x2",e).attr("y2",v).style("opacity",1e-6).transition().duration(a).attr("y1",y).attr("y2",y).style("opacity",1),E.transition().duration(a).attr("y1",y).attr("y2",y).style("opacity",1),E.exit().transition().duration(a).attr("y1",y).attr("y2",y).style("opacity",1e-6).remove();var j=u.selectAll("circle.outlier").data(h,Number);j.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",e/2).attr("cy",e=>v(s[e])).style("opacity",1e-6).transition().duration(a).attr("cy",e=>y(s[e])).style("opacity",1),j.transition().duration(a).attr("cy",e=>y(s[e])).style("opacity",1),j.exit().transition().duration(a).attr("cy",e=>y(s[e])).style("opacity",1e-6).remove();var S=l||y.tickFormat(8),C=u.selectAll("text.box").data(f);C.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",(e,t)=>1&t?6:-6).attr("x",(t,a)=>1&a?e:0).attr("y",v).attr("text-anchor",(e,t)=>1&t?"start":"end").text(S).transition().duration(a).attr("y",y),C.transition().duration(a).text(S).attr("y",y),C.exit().remove();var x=u.selectAll("text.whisker").data(b||[]);x.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",e).attr("y",v).text(S).style("opacity",1e-6).transition().duration(a).attr("y",y).style("opacity",1),x.transition().duration(a).text(S).attr("y",y).style("opacity",1),x.exit().transition().duration(a).attr("y",y).style("opacity",1e-6).remove()})),d3.timer.flush()}return s.width=function(t){return arguments.length?(e=t,s):e},s.height=function(e){return arguments.length?(t=e,s):t},s.tickFormat=function(e){return arguments.length?(l=e,s):l},s.duration=function(e){return arguments.length?(a=e,s):a},s.domain=function(e){return arguments.length?(r=null==e?e:d3.functor(e),s):r},s.value=function(e){return arguments.length?(n=e,s):n},s.whiskers=function(e){return arguments.length?(o=e,s):o},s.quartiles=function(e){return arguments.length?(i=e,s):i},s};a(894);function Fr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vr(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Vr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ur(e,t,a){var r,n=a.xAxisLabel,o=a.yAxisLabel,i=(e=Lr.a.select(e)).node().getBoundingClientRect(),s=Math.floor(i.width),c=Math.floor(i.height),u={top:10,right:50,bottom:40,left:50,inner:25},d=s-u.right-u.left,m=c-u.top-u.bottom,p=1/0,f=-1/0,g=[],b=0,h=[],y=Object(l.map)(t.columns,e=>e.name),v=Lr.a.scale.ordinal().domain(y).rangeBands([0,s-u.left-u.right]);r=y.length>1?Math.min(v(y[1]),120):120,u.inner=r/3,Object(l.each)(y,(e,a)=>{h=g[a]=[],Object(l.each)(t.rows,t=>{b=t[e],h.push(b),b>f&&(f=Math.ceil(b)),b<p&&(p=Math.floor(b))})});var w,O=Lr.a.scale.linear().domain([.99*p,1.01*f]).range([m,0]),_=zr().whiskers((w=1.5,e=>{var t=e.quartiles[0],a=e.quartiles[2],r=(a-t)*w,n=-1,o=e.length;for(n+=1;e[n]<t-r;)n+=1;for(o-=1;e[o]>a+r;)o-=1;return[n,o]})).width(r-2*u.inner).height(m).domain([.99*p,1.01*f]),E=Lr.a.svg.axis().scale(v).orient("bottom"),j=Lr.a.svg.axis().scale(O).orient("left"),S=Lr.a.svg.axis().scale(v).tickSize(m).orient("bottom"),C=Lr.a.svg.axis().scale(O).tickSize(d).orient("right");e.selectAll("*").remove();var x=e.append("svg").attr("width",s).attr("height",m+u.bottom+u.top),P=x.append("g").attr("width",s-u.left-u.right).attr("transform","translate(".concat(u.left,",").concat(u.top,")"));x.append("text").attr("class","box").attr("x",s/2).attr("text-anchor","middle").attr("y",m+u.bottom).text(n),x.append("text").attr("class","box").attr("transform","translate(10,".concat((m+u.top+u.bottom)/2,")rotate(-90)")).attr("text-anchor","middle").text(o),P.append("rect").attr("class","grid-background").attr("width",d).attr("height",m),P.append("g").attr("class","grid").call(C),P.append("g").attr("class","grid").call(S),P.append("g").attr("class","x axis").attr("transform","translate(0,".concat(m,")")).call(E),P.append("g").attr("class","y axis").call(j),P.selectAll(".box").data(g).enter().append("g").attr("class","box").attr("width",r).attr("height",m).attr("transform",(e,t)=>"translate(".concat(function(e){return v(y[e])+(v(y[1])-u.inner)/2}(t),",",0,")")).call(_)}function Br(e){var t=e.data,a=e.options,o=Fr(Object(r.useState)(null),2),i=o[0],l=o[1];return Object(r.useEffect)(()=>{if(i)return Ur(i,t,a),Ar(i,()=>{Ur(i,t,a)})},[i,t,a]),n.a.createElement("div",{className:"box-plot-deprecated-visualization-container",ref:l})}Br.propTypes=qr;var Hr=a(23),Yr=a.n(Hr),Qr=a(117),Kr=a.n(Qr),Gr=a(50),$r=a.n(Gr),Jr=a(144),Xr=a.n(Jr),Zr=a(105),en=a.n(Zr),tn=a(100),an=a.n(tn);function rn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["#ffffff","#333333"];try{return e=an()(e),Object(l.maxBy)(t,t=>an.a.contrast(e,t))}catch(e){return null}}var nn=a(157),on=a.n(nn),ln=a(81),sn=a.n(ln),cn=a(77),un=a.n(cn);a(895);function dn(){return(dn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function mn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function pn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(a),!0).forEach((function(t){fn(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):mn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function fn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function gn(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function bn(e){var t=e.className,a=e.color,r=e.title,o=e.size,i=e.style,s=gn(e,["className","color","title","size","style"]),c=n.a.createElement("span",dn({className:me()("color-swatch",t),style:pn({backgroundColor:a,width:o},i)},s));return Object(l.isString)(r)&&""!==r?n.a.createElement(he.a,{title:r,mouseEnterDelay:0,mouseLeaveDelay:0},c):c}bn.defaultProps={className:null,style:null,title:null,color:"transparent",size:12};a(896);function hn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yn(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return yn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function vn(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#";Object(l.isNil)(e)&&t(null),(e=sn()(e)).isValid()&&t(a+e.toHex().toUpperCase())}function wn(e){var t=e.color,a=e.presetColors,o=e.presetColumns,i=e.onChange,s=e.onPressEnter,c=hn(Object(r.useState)(""),2),u=c[0],d=c[1],m=hn(Object(r.useState)(!1),2),p=m[0],f=m[1],g=function(e,t){return e=Object(l.isArray)(e)?Object(l.map)(e,e=>[null,e]):Object(l.toPairs)(e),e=Object(l.map)(e,e=>{var t=hn(e,2),a=t[0],r=t[1];return Object(l.isNil)(r)?[a,null]:(r=sn()(r)).isValid()?[a,"#"+r.toHex().toUpperCase()]:null}),Object(l.chunk)(Object(l.filter)(e),t)}(a,o);return Object(r.useEffect)(()=>{p||vn(t,d,"")},[t,p]),n.a.createElement(n.a.Fragment,null,Object(l.map)(g,(e,t)=>n.a.createElement("div",{className:"color-picker-input-swatches",key:"preset-row-".concat(t)},Object(l.map)(e,e=>{var t=hn(e,2),a=t[0],r=t[1];return n.a.createElement(bn,{key:r,color:r,title:a,size:30,onClick:()=>vn(r,i)})}))),n.a.createElement("div",{className:"color-picker-input"},n.a.createElement(ta.a,{"data-test":"ColorPicker.CustomColor",addonBefore:n.a.createElement(un.a.Text,{type:"secondary"},"#"),value:u,onChange:e=>{return t=e.target.value,d(t),void vn(t,i);var t},onFocus:()=>f(!0),onBlur:()=>f(!1),onPressEnter:s})))}function On(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(e=sn()(e)).isValid()?"#"+e.toHex().toUpperCase():t}wn.defaultProps={color:"#FFFFFF",presetColors:null,presetColumns:8,onChange:()=>{},onPressEnter:()=>{}};a(925);function _n(){return(_n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function En(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function jn(e){var t=e.className,a=e.color,o=e.presetColors,i=En(e,["className","color","presetColors"]),s=Object(r.useMemo)(()=>function(e,t){return Object(l.isArray)(t)?e:Object(l.findKey)(t,t=>On(t)===e)||e}(On(a),o),[a,o]);return n.a.createElement("span",_n({className:me()("color-label",t)},i),s)}jn.defaultProps={className:null,color:"#FFFFFF",presetColors:null};a(926);function Sn(){return(Sn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Cn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xn(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Pn(e){var t=e.color,a=e.placement,o=e.presetColors,i=e.presetColumns,s=e.interactive,c=e.children,u=e.onChange,d=e.triggerProps,m=e.addonBefore,p=e.addonAfter,f=Cn(Object(r.useState)(!1),2),g=f[0],b=f[1],h=Object(r.useMemo)(()=>On(t),[t]),y=Cn(Object(r.useState)(""),2),v=y[0],w=y[1];function O(){b(!1),s||u(v)}var _=[];return s||(_.push(n.a.createElement(he.a,{key:"cancel",title:window.W_L.cancel},n.a.createElement(je.a,{onClick:function(){b(!1)}}))),_.push(n.a.createElement(he.a,{key:"apply",title:window.W_L.apply},n.a.createElement(on.a,{onClick:O})))),Object(r.useEffect)(()=>{g&&w(h)},[h,g]),n.a.createElement("span",{className:"color-picker-wrapper"},m,n.a.createElement(Xr.a,{arrowPointAtCenter:!0,overlayClassName:"color-picker ".concat(s?"color-picker-interactive":"color-picker-with-actions"),overlayStyle:{"--color-picker-selected-color":v},content:n.a.createElement(en.a,{"data-test":"ColorPicker",className:"color-picker-panel",bordered:!1,title:Object(l.toString)(v).toUpperCase(),headStyle:{backgroundColor:v,color:rn(v)},actions:_},n.a.createElement(wn,{color:v,presetColors:o,presetColumns:i,onChange:function(e){w(e),s&&u(e)},onPressEnter:O})),trigger:"click",placement:a,visible:g,onVisibleChange:b},c||n.a.createElement(bn,Sn({color:h,size:30},d,{className:me()("color-picker-trigger",d.className)}))),p)}Pn.defaultProps={color:"#FFFFFF",placement:"top",presetColors:null,presetColumns:8,interactive:!1,triggerProps:{},children:null,addonBefore:null,addonAfter:null,onChange:()=>{}},Pn.Input=wn,Pn.Swatch=bn,Pn.Label=jn;var Ln=a(49),kn=a.n(Ln),Nn=a(664),An=a.n(Nn),Tn=a(665),Wn=a.n(Tn),In=a(666),qn=a.n(In);a(934);function Dn(){return(Dn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Rn(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Mn(e){var t=e.className,a=Rn(e,["className"]);return n.a.createElement("div",Object(l.pickBy)(a,(e,t)=>Object(l.startsWith)(t,"data-")),n.a.createElement(kn.a.Group,Dn({className:me()("text-alignment-select",t)},a),n.a.createElement(he.a,{title:window.W_L.left_align,mouseEnterDelay:0,mouseLeaveDelay:0},n.a.createElement(kn.a.Button,{value:"left","data-test":"TextAlignmentSelect.Left"},n.a.createElement(An.a,null))),n.a.createElement(he.a,{title:window.W_L.center,mouseEnterDelay:0,mouseLeaveDelay:0},n.a.createElement(kn.a.Button,{value:"center","data-test":"TextAlignmentSelect.Center"},n.a.createElement(Wn.a,null))),n.a.createElement(he.a,{title:window.W_L.right_align,mouseEnterDelay:0,mouseLeaveDelay:0},n.a.createElement(kn.a.Button,{value:"right","data-test":"TextAlignmentSelect.Right"},n.a.createElement(qn.a,null)))))}Mn.defaultProps={className:null};var zn=a(316),Fn=a.n(zn),Vn=a(36);a(944);function Un(){return(Un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Bn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Hn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(a),!0).forEach((function(t){Yn(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Yn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qn(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Kn(e){var t=e.layout,a=e.label,r=e.labelProps,o=e.disabled,i=e.children;return"vertical"===t&&a?n.a.createElement("div",{className:"visualization-editor-control-label visualization-editor-control-label-vertical"},n.a.createElement("label",r,n.a.createElement(un.a.Text,{disabled:o},a)),i):"horizontal"===t&&a?n.a.createElement(Vn.Row,{className:"visualization-editor-control-label visualization-editor-control-label-horizontal",type:"flex",align:"middle",gutter:15},n.a.createElement(Vn.Col,{span:12},n.a.createElement("label",r,n.a.createElement(un.a.Text,{disabled:o},a))),n.a.createElement(Vn.Col,{span:12},i)):i}function Gn(e){function t(t){var a=t.className,o=t.id,i=t.layout,l=t.label,s=t.labelProps,c=t.disabled,u=Qn(t,["className","id","layout","label","labelProps","disabled"]),d=Object(r.useMemo)(()=>"visualization-editor-control-".concat(Math.random().toString(36).substr(2,10)),[]);return s=Hn(Hn({},s),{},{htmlFor:o||d}),n.a.createElement(Kn,{layout:i,label:l,labelProps:s,disabled:c},n.a.createElement(e,Un({className:me()("visualization-editor-input",a),id:s.htmlFor,disabled:c},u)))}return Fn()(t,e),t}Kn.defaultProps={layout:"vertical",label:null,disabled:!1,children:null};var $n=a(106),Jn=a.n($n);function Xn(){return(Xn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Zn(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var eo={replace:(e,t)=>Object(l.merge)({},t),shallowMerge:(e,t)=>Object(l.extend)({},e,t),deepMerge:(e,t)=>Object(l.merge)({},e,t)};function to(e){var t=e.tabs,a=e.options,r=e.data,o=e.onOptionsChange,i=Zn(e,["tabs","options","data","onOptionsChange"]),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eo.deepMerge;o(t(a,e))};return t=Object(l.filter)(t,e=>!Object(l.isFunction)(e.isAvailable)||e.isAvailable(a,r)),n.a.createElement(Jn.a,{animated:!1,tabBarGutter:20},Object(l.map)(t,e=>{var t=e.key,o=e.title,c=e.component;return n.a.createElement(Jn.a.TabPane,{key:t,tab:n.a.createElement("span",{"data-test":"VisualizationEditor.Tabs.".concat(t)},Object(l.isFunction)(o)?o(a):o)},n.a.createElement(c,Xn({options:a,data:r,onOptionsChange:s},i)))}))}function ao(e){return function(t){return n.a.createElement(to,Xn({},t,{tabs:e}))}}to.defaultProps={tabs:[]};a(945);function ro(){return(ro=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function no(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function oo(e){var t=e.className,a=e.children,r=no(e,["className","children"]);return a?n.a.createElement("h4",ro({className:me()("visualization-editor-section-title",t)},r),a):null}function io(e){var t=e.className,a=e.children,r=no(e,["className","children"]);return n.a.createElement("div",ro({className:me()("visualization-editor-section",t)},r),a)}oo.defaultProps={className:null,children:null},io.defaultProps={className:null,children:null},io.Title=oo;var lo=a(116),so=a.n(lo);a(946);function co(){return(co=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function uo(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function mo(e){var t=e.id,a=e.children,o=e.disabled,i=uo(e,["id","children","disabled"]),l=Object(r.useMemo)(()=>"visualization-editor-control-".concat(Math.random().toString(36).substr(2,10)),[]);return t=t||l,a?n.a.createElement("label",{htmlFor:t,className:"switch-with-label"},n.a.createElement(so.a,co({id:t,disabled:o},i)),n.a.createElement(un.a.Text,{className:"switch-text",disabled:o},a)):n.a.createElement(so.a,i)}mo.defaultProps={id:null,disabled:!1,children:null};a(948);function po(){return(po=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fo(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var go=Gn((function(e){var t=e.className,a=fo(e,["className"]);return n.a.createElement(ta.a.TextArea,po({className:me()("visualization-editor-text-area",t)},a))})),bo=a(317),ho=a.n(bo);function yo(e){var t=e.title,a=e.href,r=e.className,o=e.children;return n.a.createElement(he.a,{title:n.a.createElement(n.a.Fragment,null,t,n.a.createElement("i",{className:"fa fa-external-link",style:{marginLeft:5}}))},n.a.createElement("a",{className:r,href:a,target:"_blank",rel:"noopener noreferrer"},o))}yo.defaultValues={title:null,className:null,children:null};var vo={HelpTriggerComponent:yo,LinkComponent:function(e){return n.a.createElement("a",e)},dateFormat:"DD/MM/YYYY",dateTimeFormat:"DD/MM/YYYY HH:mm",integerFormat:"0,0",floatFormat:"0,0.00",booleanValues:["false","true"],tableCellMaxJSONSize:5e4,allowCustomJSVisualizations:!1,hidePlotlyModeBar:!1,choroplethAvailableMaps:{}};a(949);function wo(){return(wo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Oo(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function _o(e){var t=e.icon,a=e.children,r=Oo(e,["icon","children"]);return n.a.createElement(Xr.a,wo({},r,{content:a}),t||_o.defaultIcon)}_o.defaultProps={icon:null,children:null},_o.defaultIcon=n.a.createElement(ho.a,{className:"context-help-default-icon"}),_o.NumberFormatSpecs=function(){var e=vo.HelpTriggerComponent;return n.a.createElement(e,{type:"NUMBER_FORMAT_SPECS",title:window.W_L.formatting_numbers,href:"https://redash.io/help/user-guide/visualizations/formatting-numbers",className:"visualization-editor-context-help"},_o.defaultIcon)},_o.DateTimeFormatSpecs=function(){var e=vo.HelpTriggerComponent;return n.a.createElement(e,{title:window.W_L.formatting_dates_and_times,href:"https://momentjs.com/docs/#/displaying/format/",className:"visualization-editor-context-help"},_o.defaultIcon)};var Eo=Gn(Yr.a),jo=Gn(ta.a),So=Gn(Kr.a),Co=Gn(Pn),xo=Gn(Mn);function Po(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Lo(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Po(Object(a),!0).forEach((function(t){ko(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Po(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ko(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function No(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.x_axis_label,"data-test":"BoxPlot.XAxisLabel",value:t.xAxisLabel,onChange:e=>{return r=e.target.value,n=Lo(Lo({},t),{},{xAxisLabel:r}),void a(n);var r,n}})),n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.y_axis_label,"data-test":"BoxPlot.YAxisLabel",value:t.yAxisLabel,onChange:e=>{return r=e.target.value,n=Lo(Lo({},t),{},{yAxisLabel:r}),void a(n);var r,n}})))}function Ao(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function To(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}No.propTypes=Dr;var Wo={type:"BOXPLOT",name:"箱线图(Boxplot)",isDeprecated:!0,getOptions:e=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ao(Object(a),!0).forEach((function(t){To(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ao(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),Renderer:Br,Editor:No,defaultRows:8,minRows:5},Io={globalSeriesType:"column",sortX:!0,legend:{enabled:!0,placement:"auto",traceorder:"normal"},xAxis:{type:"-",labels:{enabled:!0}},yAxis:[{type:"linear"},{type:"linear",opposite:!0}],alignYAxesAtZero:!1,error_y:{type:"data",visible:!0},series:{stacking:null,error_y:{type:"data",visible:!0}},seriesOptions:{},valuesOptions:{},columnMapping:{},direction:{type:"counterclockwise"},sizemode:"diameter",coefficient:1,numberFormat:"0,0[.]00000",percentFormat:"0[.]00%",textFormat:"",missingValuesAsZero:!0};var qo=a(118),Do=a.n(qo);function Ro(e,t,a){void 0===t[a]&&(t[a]={name:a,type:"column",data:[]}),t[a].data.push(e)}function Mo(e,t){var a={},r=t.columnMapping;return Object(l.each)(e,e=>{var t={$raw:e},n=null,o=0,i={},s=null,c=null,u=null;Object(l.forOwn)(e,(e,a)=>{var l=(a=""+a).split("::")||a.split("__"),d=l[0],m=r?r[a]:l[1];"unused"!==m&&("x"===m&&(o=e,t[m]=e),"y"===m&&(i[d]=e,t[m]=e),"yError"===m&&(s=e,t[m]=e),"series"===m&&(n=String(e)),"size"===m&&(t[m]=e,c=e),"zVal"===m&&(t[m]=e,u=e),"multiFilter"!==m&&"multi-filter"!==m||(n=String(e)))}),Object(l.isNil)(n)?Object(l.each)(i,(e,r)=>{t={x:o,y:e,$raw:t.$raw},null!==s&&(t.yError=s),null!==c&&(t.size=c),null!==u&&(t.zVal=u),Ro(t,a,r)}):Ro(t,a,n)}),Object(l.sortBy)(Object(l.values)(a),e=>{var a=e.name;return Object(l.isObject)(t.seriesOptions[a])&&t.seriesOptions[a].zIndex||0})}var zo=a(318),Fo=a.n(zo),Vo=a(667),Uo=a.n(Vo),Bo=a(668),Ho=a.n(Bo),Yo=a(669),Qo=a.n(Yo),Ko=a(670),Go=a.n(Ko),$o=a(671),Jo=a.n($o);function Xo(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Zo(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(a),!0).forEach((function(t){ei(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xo(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ei(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ti={Blue:"#356AFF",Red:"#E92828",Green:"#3BD973",Purple:"#604FE9",Cyan:"#50F5ED",Orange:"#FB8D3D","Light Blue":"#799CFF",Lilac:"#B554FF","Light Green":"#8CFFB4",Brown:"#A55F2A",Black:"#000000",Gray:"#494949",Pink:"#FF7DE3","Dark Blue":"#002FB4"},ai=Object(l.values)(ti),ri=Zo(Zo({},ti),{"Indian Red":"#981717","Green 2":"#17BF51","Green 3":"#049235","Dark Turquoise":"#00B6EB","Dark Violet":"#A58AFF","Pink 2":"#C63FA9"}),ni=a(423),oi=a.n(ni);function ii(e){return Object(l.isUndefined)(e)?e:oi()(e)}function li(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"YYYY-MM-DD HH:mm:ss";return"datetime"===t&&Ea.a.utc(e).isValid()&&(e=Ea.a.utc(e)),Ea.a.isMoment(e)?e.format(a):e}function si(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ci(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?si(Object(a),!0).forEach((function(t){ui(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):si(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ui(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function di(e){var t=e.length>2?2:1,a=Math.ceil(e.length/t);return{rows:t,cellsInRow:a,cellWidth:1/a,cellHeight:1/t,xPadding:.02,yPadding:.1}}function mi(e){var t="text";return/{{\s*@@x\s*}}/.test(e.textFormat)||(t+="+label"),t}function pi(e,t){var a=Lr.a.scale.ordinal().domain([]).range(ai),r={};Object(l.each)(t.valuesOptions,(e,t)=>{Object(l.isString)(e.color)&&""!==e.color&&(r[t]=e.color)});var n=ci(ci({},di(e)),{},{hasX:Object(l.includes)(t.columnMapping,"x"),hoverInfoPattern:mi(t),getValueColor:e=>r[e]||a(e)});return Object(l.map)(e,(e,a)=>function(e,t,a){var r=a.cellWidth,n=a.cellHeight,o=a.xPadding,i=a.yPadding,s=a.cellsInRow,c=a.hasX,u=a.index,d=a.hoverInfoPattern,m=a.getValueColor,p=Object(l.extend)({type:t.globalSeriesType,yAxis:0},t.seriesOptions[e.name]),f=u%s*r,g=Math.floor(u/s)*n,b=[],h=[],y=new Map,v=Object(l.reduce)(e.data,(e,t)=>{var a=ii(t.y);return e+Math.abs(a)},0);Object(l.each)(e.data,e=>{var a=c?li(e.x,t.xAxis.type):"Slice ".concat(u),r=ii(e.y);b.push(a),h.push(r),y.set(a,{x:a,y:r,yPercent:r/v*100,row:e})});var w=Object(l.map)(e.data,e=>m(e.x)),O=Object(l.map)(w,e=>rn(e));return{visible:!0,values:h,labels:b,type:"pie",hole:.4,marker:{colors:w},hoverinfo:d,text:[],textinfo:t.showDataLabels?"percent":"none",textposition:"inside",textfont:{color:O},name:p.name||e.name,direction:t.direction.type,domain:{x:[f,f+r-o],y:[g,g+n-i]},sourceData:y}}(e,t,ci(ci({},n),{},{index:a})))}var fi=a(672),gi=a.n(fi),bi=a(162),hi=a.n(bi);hi.a.options.scalePercentBy100=!1;var yi=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,vi=Object.prototype.hasOwnProperty;function wi(e){return Object(l.isString)(e)&&""!==e?t=>{var a=function(e){return Ea.a.isMoment(e)?e:Object(l.isFinite)(e)?Ea()(e):Ea()(Object(l.toString)(e),[Ea.a.ISO_8601,Ea.a.RFC_2822])}(t);return a.isValid()?a.format(e):Object(l.toString)(t)}:e=>Object(l.toString)(e)}function Oi(e){if(Object(l.isString)(e)&&""!==e){var t=hi()(0);return a=>null===a||""===a?"":t.set(a).format(e)}return e=>Object(l.toString)(e)}function _i(e,t){return Object(l.isString)(e)?e.replace(/{{\s*([^\s]+?)\s*}}/g,(e,a)=>vi.call(t,a)&&!Object(l.isUndefined)(t[a])?t[a]:e):""}var Ei=[[0,"#356aff"],[.14,"#4a7aff"],[.28,"#5d87ff"],[.42,"#7398ff"],[.56,"#fb8c8c"],[.71,"#ec6463"],[.86,"#ec4949"],[1,"#e92827"]];function ji(e,t){var a={colorScheme:t.colorScheme?"Custom..."===t.colorScheme?[[0,t.heatMinColor],[1,t.heatMaxColor]]:t.colorScheme:Ei,formatNumber:Oi(t.numberFormat)};return Object(l.flatten)(Object(l.map)(e,e=>function(e,t,a){var r=a.colorScheme,n=a.formatNumber,o={x:[],y:[],z:[],type:"heatmap",name:"",colorscale:r};o.x=Object(l.uniq)(Object(l.map)(e.data,e=>e.x)),o.y=Object(l.uniq)(Object(l.map)(e.data,e=>e.y)),t.sortX&&(o.x=Object(l.sortBy)(o.x)),t.sortY&&(o.y=Object(l.sortBy)(o.y)),t.reverseX&&o.x.reverse(),t.reverseY&&o.y.reverse();for(var i=Object(l.max)(Object(l.map)(e.data,e=>e.zVal)),s={x:[],y:[],mode:"text",hoverinfo:"skip",showlegend:!1,text:[],textfont:{color:[]}},c=0;c<o.y.length;c+=1){for(var u=[],d=0;d<o.x.length;d+=1){var m=Object(l.find)(e.data,{x:o.x[d],y:o.y[c]}),p=m&&m.zVal||0;u.push(p),isFinite(i)&&t.showDataLabels&&(s.x.push(o.x[d]),s.y.push(o.y[c]),s.text.push(n(p)),t.colorScheme&&"Custom..."===t.colorScheme?s.textfont.color.push("white"):s.textfont.color.push(p/i<.25?"white":"black"))}o.z.push(u)}return isFinite(i)&&t.showDataLabels?[o,s]:[o]}(e,t,a)))}function Si(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ci(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(a),!0).forEach((function(t){xi(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Si(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function xi(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Pi(e){var t="text";return/{{\s*@@x\s*}}/.test(e.textFormat)||(t+="+x"),/{{\s*@@name\s*}}/.test(e.textFormat)||(t+="+name"),t}function Li(e,t,a){var r=a,n=r.hoverInfoPattern,o=r.index,i=Object(l.extend)({type:t.globalSeriesType,yAxis:0},t.seriesOptions[e.name]),s=function(e,t){return e.color||ai[t%ai.length]}(i,o),c=function(e,t){var a=t.seriesOptions[e.name]||{type:t.globalSeriesType};return 1!==a.yAxis||t.series.stacking&&"line"!==a.type?"y":"y2"}(e,t),u=t.sortX?Object(l.sortBy)(e.data,e=>li(e.x,t.xAxis.type)):e.data,d=Object(l.includes)(["bubble","scatter"],i.type)?li:e=>(e=ii(e),t.missingValuesAsZero&&Object(l.isNil)(e)?0:e),m=new Map,p=[],f=[],g=[];Object(l.each)(u,e=>{var a=li(e.x,t.xAxis.type),r=d(e.y,"y2"===c?t.yAxis[1].type:t.yAxis[0].type),n=ii(e.yError),o=ii(e.size);m.set(a,{x:a,y:r,yError:n,size:o,yPercent:null,row:e}),p.push(a),f.push(r),g.push(n)});var b={visible:!0,hoverinfo:n,x:p,y:f,error_y:{array:g,color:s},name:i.name||e.name,marker:{color:s},insidetextfont:{color:rn(s)},yaxis:c,sourceData:m};switch(a=Ci(Ci({},a),{},{seriesColor:s,data:u}),i.type){case"column":return function(e,t,a){return e.type="bar",e.offsetgroup=Object(l.toString)(a.index),t.showDataLabels&&(e.textposition="inside"),e}(b,t,a);case"line":return function(e,t){return e.mode="lines"+(t.showDataLabels?"+text":""),e}(b,t);case"area":return function(e,t){return e.mode="lines"+(t.showDataLabels?"+text":""),e.fill=t.series.stacking?"tonexty":"tozeroy",e}(b,t);case"scatter":return function(e,t){return e.type="scatter",e.mode="markers"+(t.showDataLabels?"+text":""),e}(b,t);case"bubble":return function(e,t,a){var r=a.seriesColor,n=a.data,o=t.coefficient||1;return e.mode="markers",e.marker={color:r,size:Object(l.map)(n,e=>e.size*o),sizemode:t.sizemode||"diameter"},e}(b,t,a);case"box":return function(e,t,a){var r=a.seriesColor;return e.type="box",e.mode="markers",e.boxpoints="outliers",e.hoverinfo=!1,e.marker={color:r,size:3},t.showpoints&&(e.boxpoints="all",e.jitter=.3,e.pointpos=-1.8),e}(b,t,a);default:return b}}function ki(e){return e.sortX&&"category"===e.xAxis.type&&"box"!==e.globalSeriesType}function Ni(e){var t=e["@@y"];return void 0!==e["@@yError"]&&(t="".concat(t," ± ").concat(e["@@yError"])),void 0!==e["@@yPercent"]&&(t="".concat(e["@@yPercent"]," (").concat(t,")")),void 0!==e["@@size"]&&(t="".concat(t,": ").concat(e["@@size"])),t}function Ai(e){return e["@@yPercent"]+" ("+e["@@y"]+")"}function Ti(e,t,a){var r=null;switch(t){case"x":r=a.xAxis.type;break;case"y":r=a.yAxis[0].type;break;case"y2":r=a.yAxis[1].type}return li(e,r,a.dateTimeFormat)}function Wi(e,t){var a=Oi(t.numberFormat),r=Oi(t.percentFormat),n=function(e){return""===e.textFormat?"pie"===e.globalSeriesType?Ai:Ni:t=>_i(e.textFormat,t)}(t),o=t.missingValuesAsZero?0:null;Object(l.each)(e,e=>{var i=t.seriesOptions[e.name]||{type:t.globalSeriesType};e.text=[],e.hover=[],("pie"===t.globalSeriesType?e.labels:e.x).forEach(s=>{var c={"@@name":e.name},u=e.sourceData.get(s)||{x:s,y:o,row:{x:s,y:o}},d=Object(l.includes)(["bubble","scatter"],i.type);c["@@x"]=Ti(u.row.x,"x",t),c["@@y"]=d?Ti(u.row.y,e.yaxis,t):a(u.y),void 0!==u.yError&&(c["@@yError"]=a(u.yError)),void 0!==u.size&&(c["@@size"]=a(u.size)),(t.series.percentValues||"pie"===t.globalSeriesType)&&(c["@@yPercent"]=r(Math.abs(u.yPercent))),Object(l.extend)(c,u.row.$raw),e.text.push(n(c))})})}function Ii(e,t){if(t.series.percentValues){var a=new Map;Object(l.each)(e,e=>{e.sourceData.forEach(e=>{var t=a.get(e.x)||0;a.set(e.x,t+Math.abs(e.y||0))})}),Object(l.each)(e,e=>{var r=[];e.sourceData.forEach(e=>{if(Object(l.isNil)(e.y)&&!t.missingValuesAsZero)e.yPercent=null;else{var n=a.get(e.x);e.yPercent=e.y/n*100}r.push(e.yPercent)}),e.y=r})}}function qi(e,t){var a=function(e,t){var a=new Set;Object(l.each)(e,e=>{e.sourceData.forEach(e=>{a.add(e.x)})});var r=[...a];return t?Object(l.sortBy)(r,l.identity):r}(e,t.sortX),r=t.missingValuesAsZero?0:null;Object(l.each)(e,e=>{e.x=[],e.y=[],e.error_y.array=[],Object(l.each)(a,a=>{e.x.push(a);var n=e.sourceData.get(a);n?(e.y.push(t.series.percentValues?n.yPercent:n.y),e.error_y.array.push(n.yError)):(e.y.push(r),e.error_y.array.push(null))})})}function Di(e,t){var a=Object(l.filter)(e,e=>!0===e.visible);if(a.length>0)switch(t.globalSeriesType){case"pie":!function(e,t){Wi(e,t)}(a,t);break;case"line":case"area":!function(e,t){if(Ii(e,t),t.series.stacking){qi(e,t);var a={};Object(l.each)(e,e=>{e.y=Object(l.map)(e.y,(r,n)=>{if(Object(l.isNil)(r)&&!t.missingValuesAsZero)return null;var o=e.x[n],i=r+(a[o]||0);return a[o]=i,i})})}else ki(t)&&qi(e,t);Wi(e,t)}(a,t);break;case"heatmap":break;default:!function(e,t){Ii(e,t),t.series.stacking||ki(t)&&qi(e,t),Wi(e,t)}(a,t)}return e}function Ri(e,t){switch(t.globalSeriesType){case"pie":return Di(pi(e,t),t);case"heatmap":return Di(ji(e,t));default:return Di(function(e,t){var a={hoverInfoPattern:Pi(t)};return Object(l.map)(e,(e,r)=>Li(e,t,Ci(Ci({},a),{},{index:r})))}(e,t),t)}}function Mi(e){return Object(l.isObject)(e.title)?e.title.text:null}function zi(e){switch(e.type){case"datetime":return"date";case"logarithmic":return"log";default:return e.type}}function Fi(e){return{title:Mi(e),type:zi(e),automargin:!0,autorange:!0,range:null}}function Vi(e,t,a){var r,n,o,i=a.filter(e=>"y2"===e.yaxis);return e.xaxis=(r=t.xAxis,n=t,o={title:Mi(r),type:zi(r),automargin:!0},n.sortX&&"category"===o.type&&(n.reverseX?o.categoryorder="category descending":o.categoryorder="category ascending"),Object(l.isUndefined)(r.labels)||(o.showticklabels=r.labels.enabled),o),e.yaxis=Fi(t.yAxis[0]),i.length>0&&(e.yaxis2=Fi(t.yAxis[1]),e.yaxis2.overlaying="y",e.yaxis2.side="right"),t.series.stacking&&(e.barmode="relative"),e}function Ui(e,t,a){var r={margin:{l:10,r:10,b:5,t:20,pad:4},width:Math.max(5,Math.floor(e.offsetWidth)),height:Math.max(5,Math.floor(e.offsetHeight)),autosize:!1,showlegend:t.legend.enabled,legend:{traceorder:t.legend.traceorder},hoverlabel:{namelength:-1}};switch(t.globalSeriesType){case"pie":return function(e,t,a){var r=/{{\s*@@name\s*}}/.test(t.textFormat),n=di(a),o=n.cellsInRow,i=n.cellWidth,s=n.cellHeight,c=n.xPadding;return e.annotations=r?[]:Object(l.filter)(Object(l.map)(a,(e,t)=>{var a=t%o*i,r=Math.floor(t/o)*s;return{x:a+(i-c)/2,y:r+s-.015,xanchor:"center",yanchor:"top",text:e.name,showarrow:!1}})),e}(r,t,a);case"box":return function(e,t,a){return(e=Vi(e,t,a)).boxmode="group",e.boxgroupgap=.5,e}(r,t,a);default:return Vi(r,t,a)}}function Bi(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Hi(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Bi(Object(a),!0).forEach((function(t){Yi(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bi(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Yi(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qi(e,t,a){return[Object(l.isNumber)(t)?t:e[0],Object(l.isNumber)(a)?a:e[1]]}function Ki(e,t,a){return a*t/(1-Math.abs(e)/t-a)}function Gi(e,t,a,r){var n={};return Object(l.isObject)(a.yaxis)&&(n.yaxis=Hi(Hi({},a.yaxis),{},{autorange:!0,range:null})),Object(l.isObject)(a.yaxis2)&&(n.yaxis2=Hi(Hi({},a.yaxis2),{},{autorange:!0,range:null})),[n,()=>{if(Object(l.isObject)(a.yaxis)){var o=r.yAxis[0],i=e.layout.yaxis.range;n.yaxis.autorange=!1,n.yaxis.range=Qi(i,o.rangeMin,o.rangeMax)}if(Object(l.isObject)(a.yaxis2)){var s=r.yAxis[1],c=e.layout.yaxis2.range;n.yaxis2.autorange=!1,n.yaxis2.range=Qi(c,s.rangeMin,s.rangeMax)}if(r.swappedAxes){Object(l.each)(t,e=>{e.orientation="h";var t=e.x,a=e.y;e.x=a,e.y=t});var u=a.xaxis,d=n.yaxis,m=n.yaxis2;Object(l.isObject)(u)&&Object(l.isObject)(d)&&(n.xaxis=d,n.yaxis=u),Object(l.isObject)(m)&&(n.yaxis2=null)}return r.alignYAxesAtZero&&Object(l.isObject)(a.yaxis)&&Object(l.isObject)(a.yaxis2)&&function(e,t){e.range[1]=Math.max(0,e.range[1]),t.range[1]=Math.max(0,t.range[1]),e.range[0]=Math.min(0,e.range[0]),t.range[0]=Math.min(0,t.range[0]);var a=e.range[1]-e.range[0],r=e.range[1]/a,n=t.range[1]-t.range[0],o=t.range[1]/n,i=Math.abs(o-r)/2;i<.01||(r<o?(e.range[1]+=Ki(e.range[1],a,i),t.range[0]-=Ki(e.range[0],n,i)):(t.range[1]+=Ki(t.range[1],n,i),e.range[0]-=Ki(e.range[0],a,i)))}(n.yaxis,n.yaxis2),[n,null]}]}function $i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ji(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ji(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ji(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Xi(e,t){var a=Object(l.find)(["transform","WebkitTransform","MozTransform","MsTransform","OTransform"],t=>t in e.style),r=t.height;return t.legend=Object(l.extend)({},t.legend,{orientation:"h",y:0,x:0,xanchor:"left",yanchor:"bottom"}),function(e){var t=e.querySelector(".legend");if(t)for(var a=t.parentNode;a;){if("svg"===a.tagName.toLowerCase()){a.style.overflow="visible";break}a=a.parentNode}}(e),[Object(l.pick)(t,["width","height","legend"]),()=>{var n=e.querySelector(".legend");if(n){var o=n.getBoundingClientRect();return t.height=Math.floor(Math.max(r/2,r-(o.bottom-o.top))),n.style[a]="translate(0, "+t.height+"px)",[Object(l.pick)(t,["height"]),null]}}]}function Zi(e,t){return t.width<=600?Xi(e,t):function(e,t){var a=Object(l.find)(["transform","WebkitTransform","MozTransform","MsTransform","OTransform"],t=>t in e.style);t.legend=Object(l.extend)({},t.legend,{orientation:"v",y:1,x:1,xanchor:"left",yanchor:"top"});var r=e.querySelector(".legend");return r&&(r.style[a]=null),[Object(l.pick)(t,["width","height","legend"]),null]}(e,t)}function el(e,t,a){t.width=Math.max(5,Math.floor(e.offsetWidth)),t.height=Math.max(5,Math.floor(e.offsetHeight));var r=$i(e.__previousSize||[],2),n=r[0],o=r[1];if(t.width!==n||t.height!==o){if(e.__previousSize=[t.width,t.height],!a.legend.enabled)return[Object(l.pick)(t,["width","height"]),null];switch(a.legend.placement){case"auto":return Zi(e,t);case"below":return Xi(e,t)}}}function tl(e,t,a,r,n){var o,i=(o=n,e=>{Object(l.isString)(e)&&Object(l.startsWith)(e,"ax.dtick error")||o(e)}),s={showLink:!1,displaylogo:!1};r.hidePlotlyModeBar&&(s.displayModeBar=!1);var c=Ri(a,t),u=Ui(e,t,c),d=!1,m=function(){var e=[],t={append:a=>(Object(l.isArray)(a)&&Object(l.isObject)(a[0])&&e.push(a),t),process(a){if(e.length>0){var r=Object(l.reduce)(e,(e,t)=>Object(l.merge)(e,t[0]),{}),n=Object(l.map)(e,e=>Object(l.isFunction)(e[1])?e[1]:()=>null);return e=[],Fo.a.relayout(a,r).then(()=>(Object(l.each)(n,e=>t.append(e())),t.process(a)))}return Promise.resolve()}};return t}();function p(e){return function(){if(!d)try{return e(...arguments)}catch(e){i(e)}}}var f=()=>{},g={initialized:Promise.resolve().then(()=>Fo.a.newPlot(e,c,u,s)).then(p(()=>m.append(Gi(e,c,u,t)).append(el(e,u,t)).process(e))).then(p(()=>{e.on("plotly_restyle",p(a=>{Object(l.isArray)(a)&&Object(l.isObject)(a[0])&&a[0].visible&&(Di(c,t),m.append(Gi(e,c,u,t)).process(e))})),t.onHover&&e.on("plotly_hover",t.onHover),t.onUnHover&&e.on("plotly_unhover",t.onUnHover),f=Ar(e,p(()=>{m.append(el(e,u,t)).process(e)}))})).catch(i).then(()=>g),setZoomEnabled:p(t=>{var a={dragmode:!!t&&"zoom"};return Fo.a.relayout(e,a)}),destroy:p(()=>{d=!0,e.removeAllListeners("plotly_restyle"),f(),delete e.__previousSize,Fo.a.purge(e)})};return g}function al(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rl(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return rl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function nl(e){var t=e.options,a=e.data,o=al(Object(r.useState)(null),2),i=o[0],l=o[1],s=al(Object(r.useState)(null),2),c=s[0],u=s[1],d=Object(r.useContext)(_),m=Object(r.useRef)();m.current=d;var p=Do()({maxWidth:768});return Object(r.useRef)().current=p,Object(r.useEffect)(()=>{if(i){var e=!1,r=Mo(a.rows,t),n=tl(i,t,r,vo,e=>{m.current.handleError(e)});return n.initialized.then(()=>{e||u(n)}),()=>{e=!0,n.destroy()}}},[t,a,i]),Object(r.useEffect)(()=>{c&&c.setZoomEnabled(!p)},[c,p]),n.a.createElement("div",{className:"chart-visualization-container",ref:l})}function ol(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return il(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return il(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function il(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ll(e){var t=e.options,a=e.data,o=ol(Object(r.useState)(null),2),i=o[0],s=o[1],c=Object(r.useMemo)(()=>function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=()=>{};try{a=new Function("x, ys, element, Plotly",e)}catch(e){t&&console.log("Error while executing custom graph: ".concat(e))}return(e,r,n,o)=>{try{a(e,r,n,o)}catch(e){t&&console.log("Error while executing custom graph: ".concat(e))}}}(t.customCode,t.enableConsoleLogs),[t.customCode,t.enableConsoleLogs]),u=Object(r.useMemo)(()=>{return e=Mo(a.rows,t),r=[],n={},Object(l.each)(e,e=>{var t=e.name,a=e.data;n[t]=[],Object(l.each)(a,e=>{r.push(li(e.x)),n[t].push(li(e.y))})}),{x:r,ys:n};var e,r,n},[t,a]);return Object(r.useEffect)(()=>{if(i)return Ar(i,()=>{Fo.a.purge(i),c(u.x,u.ys,i,Fo.a)})},[i,u,c]),Object(r.useEffect)(()=>{if(i)return()=>Fo.a.purge(i)},[i]),n.a.createElement("div",{className:"chart-visualization-container",ref:s})}Fo.a.register([Uo.a,Ho.a,Qo.a,Go.a,Jo.a]),Fo.a.setPlotConfig({modeBarButtonsToRemove:["sendDataToCloud"]}),nl.propTypes=qr,ll.propTypes=qr;a(1144);function sl(){return(sl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function cl(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function ul(e){var t=e.options,a=cl(e,["options"]);return"custom"===t.globalSeriesType&&vo.allowCustomJSVisualizations?n.a.createElement(ll,sl({options:t},a)):n.a.createElement(nl,sl({options:t},a))}function dl(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}ul.propTypes=qr;var ml=[{type:"line",name:"线形图(Line)",icon:"line-chart"},{type:"column",name:"条形图(Bar)",icon:"bar-chart"},{type:"area",name:"面积图(Area)",icon:"area-chart"},{type:"pie",name:"饼形图(Pie)",icon:"pie-chart"},{type:"scatter",name:"散点图(Scatter)",icon:"circle-o"},{type:"bubble",name:"气泡图(Bubble)",icon:"circle-o"},{type:"heatmap",name:"热力图(Heatmap)",icon:"th"},{type:"box",name:"箱线图(Box)",icon:"square-o"}];function pl(e){var t=e.hiddenChartTypes,a=dl(e,["hiddenChartTypes"]),o=Object(r.useMemo)(()=>{var e=[...ml];return vo.allowCustomJSVisualizations&&e.push({type:"custom",name:"自定义(Custom)",icon:"code"}),t.length>0?Object(l.filter)(e,e=>{var a=e.type;return!Object(l.includes)(t,a)}):e},[]);return n.a.createElement(Eo,a,Object(l.map)(o,e=>{var t=e.type,a=e.name,r=e.icon;return n.a.createElement(Eo.Option,{key:t,value:t,"data-test":"Chart.ChartType.".concat(t)},n.a.createElement("i",{className:"fa fa-".concat(r),style:{marginRight:5}}),a)}))}function fl(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function gl(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fl(Object(a),!0).forEach((function(t){bl(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fl(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function bl(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}pl.defaultProps={hiddenChartTypes:[]};var hl={x:{label:window.W_L.x_column},y:{label:window.W_L.y_column,multiple:!0},series:{label:window.W_L.group_by},yError:{label:window.W_L.errors_column},size:{label:"气泡尺寸(Bubble Size)"},zVal:{label:window.W_L.color_column}},yl=gl(gl({},hl),{},{x:{label:window.W_L.y_column},y:{label:window.W_L.x_column,multiple:!0}});function vl(e){var t=e.value,a=e.availableColumns,r=e.type,o=e.onChange,i=e.areAxesSwapped,s=Object(l.sortBy)(Object(l.filter)(Object(l.uniq)(Object(l.flatten)([a,t])),e=>Object(l.isString)(e)&&""!==e)),c=i?yl[r]:hl[r],u=c.label,d=c.multiple;return n.a.createElement(io,null,n.a.createElement(Eo,{label:u,"data-test":"Chart.ColumnMapping.".concat(r),mode:d?"multiple":"default",allowClear:!0,showSearch:!0,placeholder:d?window.W_L.choose_columns:window.W_L.choose_column,value:t||void 0,onChange:e=>o(e||null,r)},Object(l.map)(s,e=>n.a.createElement(Eo.Option,{key:e,value:e,"data-test":"Chart.ColumnMapping.".concat(r,".").concat(e)},e))))}function wl(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ol(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wl(Object(a),!0).forEach((function(t){_l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wl(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function El(e,t){var a={},r=function(e){var t=["x","y"];return Object(l.includes)(["custom","heatmap"],e.globalSeriesType)||t.push("series"),("bubble"===e.globalSeriesType||Object(l.some)(e.seriesOptions,{type:"bubble"}))&&t.push("size"),"heatmap"===e.globalSeriesType&&t.push("zVal"),Object(l.includes)(["custom","bubble","heatmap"],e.globalSeriesType)||t.push("yError"),t}(e);Object(l.each)(r,e=>{a[e]=vl.MappingTypes[e].multiple?[]:null}),t=Object(l.map)(t,e=>e.name);var n=[];return Object(l.each)(e.columnMapping,(e,o)=>{Object(l.includes)(t,o)&&Object(l.includes)(r,e)&&(vl.MappingTypes[e].multiple?a[e].push(o):a[e]=o,n.push(o))}),{mappedColumns:a,unusedColumns:Object(l.difference)(t,n)}}function jl(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>El(t,a.columns),[t,a.columns]),s=i.mappedColumns,c=i.unusedColumns;function u(e,t){var a=function(e){var t={};return Object(l.each)(e,(e,a)=>{Object(l.isArray)(e)?Object(l.each)(e,e=>{t[e]=a}):e&&(t[e]=a)}),t}(Ol(Ol({},s),{},{[t]:e}));o({columnMapping:a},eo.shallowMerge)}return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(pl,{label:"Chart Type","data-test":"Chart.GlobalSeriesType",defaultValue:t.globalSeriesType,onChange:function(e){o({globalSeriesType:e,showDataLabels:"pie"===e,swappedAxes:!1,seriesOptions:Object(l.mapValues)(t.seriesOptions,t=>Ol(Ol({},t),{},{type:e}))})}})),Object(l.includes)(["column","line","box"],t.globalSeriesType)&&n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Chart.SwappedAxes",defaultChecked:t.swappedAxes,checked:t.swappedAxes,onChange:function(){var e=Object(l.mapValues)(t.seriesOptions,e=>Ol(Ol({},e),{},{yAxis:0}));o({swappedAxes:!t.swappedAxes,seriesOptions:e})}},window.W_L.Horizontal_Chart)),Object(l.map)(s,(e,a)=>n.a.createElement(vl,{key:a,type:a,value:e,areAxesSwapped:t.swappedAxes,availableColumns:c,onChange:u})),Object(l.includes)(["bubble"],t.globalSeriesType)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(So,{label:window.W_L.bubble_size_coefficient,"data-test":"Chart.BubbleCoefficient",defaultValue:t.coefficient,onChange:e=>o({coefficient:Object(l.toNumber)(e)})})),n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.bubble_size_proportional_to,"data-test":"Chart.SizeMode",defaultValue:t.sizemode,onChange:e=>o({sizemode:e})},n.a.createElement(Eo.Option,{value:"area","data-test":"Chart.SizeMode.Area"},window.W_L.Area),n.a.createElement(Eo.Option,{value:"diameter","data-test":"Chart.SizeMode.Diameter"},window.W_L.Diameter)))),Object(l.includes)(["pie"],t.globalSeriesType)&&n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.direction,"data-test":"Chart.PieDirection",defaultValue:t.direction.type,onChange:e=>o({direction:{type:e}})},n.a.createElement(Eo.Option,{value:"counterclockwise","data-test":"Chart.PieDirection.Counterclockwise"},window.W_L.Counterclockwise),n.a.createElement(Eo.Option,{value:"clockwise","data-test":"Chart.PieDirection.Clockwise"},window.W_L.Clockwise))),!Object(l.includes)(["custom","heatmap"],t.globalSeriesType)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.legend_placement,"data-test":"Chart.LegendPlacement",value:t.legend.enabled?t.legend.placement:"hidden",onChange:function(e){o("hidden"===e?{legend:{enabled:!1}}:{legend:{enabled:!0,placement:e}})}},n.a.createElement(Eo.Option,{value:"hidden","data-test":"Chart.LegendPlacement.HideLegend"},window.W_L.Hide_legend),n.a.createElement(Eo.Option,{value:"auto","data-test":"Chart.LegendPlacement.Auto"},window.W_L.Right),n.a.createElement(Eo.Option,{value:"below","data-test":"Chart.LegendPlacement.Below"},window.W_L.Bottom))),t.legend.enabled&&n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.legend_items_order,"data-test":"Chart.LegendItemsOrder",value:t.legend.traceorder,onChange:e=>o({legend:{traceorder:e}})},n.a.createElement(Eo.Option,{value:"normal","data-test":"Chart.LegendItemsOrder.Normal"},window.W_L.Normal),n.a.createElement(Eo.Option,{value:"reversed","data-test":"Chart.LegendItemsOrder.Reversed"},window.W_L.Reversed)))),Object(l.includes)(["box"],t.globalSeriesType)&&n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Chart.ShowPoints",defaultChecked:t.showpoints,onChange:e=>o({showpoints:e.target.checked})},window.W_L.Show_All_Points)),!Object(l.includes)(["custom","heatmap"],t.globalSeriesType)&&n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.stacking,"data-test":"Chart.Stacking",defaultValue:t.series.stacking,disabled:!Object(l.includes)(["line","area","column"],t.globalSeriesType),onChange:e=>o({series:{stacking:e}})},n.a.createElement(Eo.Option,{value:null,"data-test":"Chart.Stacking.Disabled"},window.W_L.Disabled),n.a.createElement(Eo.Option,{value:"stack","data-test":"Chart.Stacking.Stack"},window.W_L.Stack))),Object(l.includes)(["line","area","column"],t.globalSeriesType)&&n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Chart.NormalizeValues",defaultChecked:t.series.percentValues,onChange:e=>o({series:{percentValues:e.target.checked}})},window.W_L.Normalize_values_to_percentage)),!Object(l.includes)(["custom","heatmap","bubble","scatter"],t.globalSeriesType)&&n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.missing_and_NULL_values,"data-test":"Chart.MissingValues",defaultValue:t.missingValuesAsZero?1:0,onChange:e=>o({missingValuesAsZero:!!e})},n.a.createElement(Eo.Option,{value:0,"data-test":"Chart.MissingValues.Keep"},window.W_L.Do_not_display_in_chart),n.a.createElement(Eo.Option,{value:1,"data-test":"Chart.MissingValues.Zero"},window.W_L.Convert_to_0_and_display_in_chart))))}vl.defaultProps={value:null,availableColumns:[],type:null,onChange:()=>{}},vl.MappingTypes=hl,jl.propTypes=Dr;var Sl=a(1841);function Cl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xl(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xl(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Pl(e){return e=Object(l.isNumber)(e)?e:parseFloat(e),Object(l.isFinite)(e)?e:null}function Ll(e){var t=e.id,a=e.options,r=e.features,o=e.onChange;function i(e){o(Object(l.merge)({},a,e))}var s=Cl(Object(Sl.a)(e=>{i({title:Object(l.isString)(e)&&""!==e?{text:e}:null})},200),1)[0],c=Cl(Object(Sl.a)(e=>i(e),200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.scale,"data-test":"Chart.".concat(t,".Type"),defaultValue:a.type,onChange:e=>i({type:e})},r.autoDetectType&&n.a.createElement(Eo.Option,{value:"-","data-test":"Chart.".concat(t,".Type.Auto")},window.W_L.auto_detect),n.a.createElement(Eo.Option,{value:"datetime","data-test":"Chart.".concat(t,".Type.DateTime")},window.W_L.datetime),n.a.createElement(Eo.Option,{value:"linear","data-test":"Chart.".concat(t,".Type.Linear")},window.W_L.linear),n.a.createElement(Eo.Option,{value:"logarithmic","data-test":"Chart.".concat(t,".Type.Logarithmic")},window.W_L.logarithmic),n.a.createElement(Eo.Option,{value:"category","data-test":"Chart.".concat(t,".Type.Category")},window.W_L.category))),n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.name,"data-test":"Chart.".concat(t,".Name"),defaultValue:Object(l.isObject)(a.title)?a.title.text:null,onChange:e=>s(e.target.value)})),r.range&&n.a.createElement(io,null,n.a.createElement(Vn.Row,{gutter:15,type:"flex",align:"middle"},n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{label:window.W_L.min_value,placeholder:window.W_L.auto,"data-test":"Chart.".concat(t,".RangeMin"),defaultValue:Pl(a.rangeMin),onChange:e=>c({rangeMin:Pl(e)})})),n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{label:window.W_L.max_value,placeholder:window.W_L.auto,"data-test":"Chart.".concat(t,".RangeMax"),defaultValue:Pl(a.rangeMax),onChange:e=>c({rangeMax:Pl(e)})})))))}function kl(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ll,{id:"XAxis",features:{autoDetectType:!0},options:t.xAxis,onChange:e=>a({xAxis:e})}),n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"Chart.XAxis.Sort",defaultChecked:t.sortX,onChange:e=>a({sortX:e})},window.W_L.sort_values)),n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"Chart.XAxis.Reverse",defaultChecked:t.reverseX,onChange:e=>a({reverseX:e})},window.W_L.reverse_order)),n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"Chart.XAxis.ShowLabels",defaultChecked:t.xAxis.labels.enabled,onChange:e=>a({xAxis:{labels:{enabled:e}}})},window.W_L.Show_Labels)))}function Nl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Al(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Al(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Al(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Tl(e){var t=e.options,a=e.onOptionsChange,r=Nl(t.yAxis,2),o=r[0],i=r[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io.Title,null,t.swappedAxes?window.W_L.x_axis:window.W_L.left_y_axis),n.a.createElement(io,null,n.a.createElement(Ll,{id:"LeftYAxis",features:{range:!0},options:o,onChange:e=>a({yAxis:[e,i]})})),"heatmap"!==t.globalSeriesType&&!t.swappedAxes&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io.Title,null,window.W_L.right_y_axis),n.a.createElement(io,null,n.a.createElement(Ll,{id:"RightYAxis",features:{range:!0},options:i,onChange:e=>a({yAxis:[o,e]})})),n.a.createElement(io,null,n.a.createElement(mo,{id:"chart-editor-y-axis-align-at-zero","data-test":"Chart.YAxis.AlignAtZero",defaultChecked:t.alignYAxesAtZero,onChange:e=>a({alignYAxesAtZero:e})},window.W_L.align_Y_axes_at_zero))),"heatmap"===t.globalSeriesType&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(mo,{id:"chart-editor-y-axis-sort","data-test":"Chart.LeftYAxis.Sort",defaultChecked:t.sortY,onChange:e=>a({sortY:e})},window.W_L.sort_values)),n.a.createElement(io,null,n.a.createElement(mo,{id:"chart-editor-y-axis-reverse","data-test":"Chart.LeftYAxis.Reverse",defaultChecked:t.reverseY,onChange:e=>a({reverseY:e})},window.W_L.reverse_order))))}Ll.defaultProps={features:{},onChange:()=>{}},kl.propTypes=Dr,Tl.propTypes=Dr;var Wl=a(48),Il=a.n(Wl),ql=a(161);a(1145);function Dl(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Rl(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(a),!0).forEach((function(t){Ml(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dl(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ml(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function zl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fl(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Fl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fl(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Vl(){return(Vl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ul(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Bl=Object(ql.c)(e=>{var t=e.className,a=Ul(e,["className"]);return n.a.createElement("div",Vl({className:me()("drag-handle",t)},a))}),Hl=Object(ql.a)(e=>e.children),Yl=Object(ql.b)(e=>e.children);function Ql(e){var t=e.disabled,a=e.containerComponent,o=e.containerProps,i=e.children,s=Ul(e,["disabled","containerComponent","containerProps","children"]),c=Object(r.useRef)(),u=zl(Object(r.useState)(!1),2),d=u[0],m=u[1];s=Rl({},s),o=Rl({},o),t?s.shouldCancelStart=()=>!0:(s.helperContainer=Object(l.wrap)(s.helperContainer,e=>Object(l.isFunction)(e)?e(c.current):c.current),s.updateBeforeSortStart=Object(l.wrap)(s.updateBeforeSortStart,(function(e){if(m(!0),Object(l.isFunction)(e)){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];e(...a)}})),s.onSortStart=Object(l.wrap)(s.onSortStart,(function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];if(Object(l.isFunction)(e))e(...a);else{var n=a[1];n.preventDefault()}})),s.onSortEnd=Object(l.wrap)(s.onSortEnd,(function(e){if(m(!1),Object(l.isFunction)(e)){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];e(...a)}})),o.className=me()("sortable-container",{"sortable-container-dragging":d},o.className),o.ref=c);var p=a;return n.a.createElement(Hl,s,n.a.createElement(p,o,i))}function Kl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gl(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Gl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gl(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}Ql.defaultProps={disabled:!1,containerComponent:"div",containerProps:{},children:null};var $l=Object(ql.b)(e=>n.a.createElement("tr",e));function Jl(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>Object(l.map)(Mo(a.rows,t),(e,a)=>{var r=e.name;return Object(l.extend)({key:r,type:t.globalSeriesType},t.seriesOptions[r],{zIndex:a})}),[t,a]),s=Object(r.useCallback)(e=>{var t=e.oldIndex,a=e.newIndex,r=[...i];r.splice(a,0,...r.splice(t,1)),o({seriesOptions:Object(l.fromPairs)(Object(l.map)(r,(e,t)=>[e.key,{zIndex:t}]))})},[o,i]),c=Object(r.useCallback)((e,t,a)=>{o({seriesOptions:{[e]:{[t]:a}}})},[o]),u=Kl(Object(Sl.a)(c,200),1)[0],d=Object(r.useMemo)(()=>function(e,t,a){var r=[{title:window.W_L.order,dataIndex:"zIndex",render:(e,t)=>n.a.createElement("span",{className:"series-settings-order"},n.a.createElement(Bl,null),t.zIndex+1)},{title:window.W_L.label,dataIndex:"name",render:(e,t)=>n.a.createElement(ta.a,{"data-test":"Chart.Series.".concat(t.key,".Label"),placeholder:t.key,defaultValue:t.name,onChange:e=>a(t.key,"name",e.target.value)})}];return Object(l.includes)(["pie","heatmap"],e.globalSeriesType)||(e.swappedAxes||r.push({title:window.W_L.y_axis,dataIndex:"yAxis",render:(e,a)=>n.a.createElement(kn.a.Group,{className:"series-settings-y-axis",value:1===a.yAxis?1:0,onChange:e=>t(a.key,"yAxis",e.target.value)},n.a.createElement(kn.a,{value:0,"data-test":"Chart.Series.".concat(a.key,".UseLeftAxis")},window.W_L.Left),n.a.createElement(kn.a,{value:1,"data-test":"Chart.Series.".concat(a.key,".UseRightAxis")},window.W_L.Right))}),r.push({title:window.W_L.type,dataIndex:"type",render:(e,a)=>n.a.createElement(pl,{"data-test":"Chart.Series.".concat(a.key,".Type"),dropdownMatchSelectWidth:!1,value:a.type,hiddenChartTypes:["pie","heatmap","bubble","box"],onChange:e=>t(a.key,"type",e)})})),r}(t,c,u),[t,c,u]);return n.a.createElement(Ql,{axis:"y",lockAxis:"y",lockToContainerEdges:!0,useDragHandle:!0,helperClass:"chart-editor-series-dragged-item",helperContainer:e=>e.querySelector("tbody"),onSortEnd:s,containerProps:{className:"chart-editor-series"}},n.a.createElement(Il.a,{dataSource:i,columns:d,components:{body:{row:$l}},onRow:e=>({index:e.zIndex}),pagination:!1}))}function Xl(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Zl(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function es(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xl(Object(a),!0).forEach((function(t){Zl(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xl(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({Automatic:null},ri),[]),s=Object(r.useMemo)(()=>{return Object(l.map)((e=Mo(a.rows,t),r=new Set,Object(l.each)(e,e=>{Object(l.each)(e.data,e=>{r.add(e.x)})}),[...r]),e=>({key:e,color:(t.valuesOptions[e]||{}).color||null}));var e,r},[t,a]),c=Object(r.useCallback)((e,t,a)=>{o({valuesOptions:{[e]:{[t]:a}}})},[o]),u=[{title:window.W_L.value,dataIndex:"key"},{title:window.W_L.color,dataIndex:"color",width:"1%",render:(e,t)=>n.a.createElement(Pn,{"data-test":"Chart.Series.".concat(t.key,".Color"),interactive:!0,presetColors:i,placement:"topRight",color:t.color,onChange:e=>c(t.key,"color",e),addonAfter:n.a.createElement(Pn.Label,{color:t.color,presetColors:i})})}];return n.a.createElement(Il.a,{showHeader:!1,dataSource:s,columns:u,pagination:!1})}Jl.propTypes=Dr,es.propTypes=Dr;var ts=["Blackbody","Bluered","Blues","Earth","Electric","Greens","Greys","Hot","Jet","Picnic","Portland","Rainbow","RdBu","Reds","Viridis","YlGnBu","YlOrRd","Custom..."];function as(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.color_scheme,"data-test":"Chart.Colors.Heatmap.ColorScheme",placeholder:window.W_L.choose_color_scheme,allowClear:!0,value:t.colorScheme||void 0,onChange:e=>a({colorScheme:e||null})},Object(l.map)(ts,e=>n.a.createElement(Eo.Option,{key:e,value:e,"data-test":"Chart.Colors.Heatmap.ColorScheme.".concat(e)},e)))),"Custom..."===t.colorScheme&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.min_color,"data-test":"Chart.Colors.Heatmap.MinColor",interactive:!0,placement:"topLeft",presetColors:ri,color:t.heatMinColor,onChange:e=>a({heatMinColor:e}),addonAfter:n.a.createElement(Co.Label,{color:t.heatMinColor,presetColors:ri})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.max_color,"data-test":"Chart.Colors.Heatmap.MaxColor",interactive:!0,placement:"topRight",presetColors:ri,color:t.heatMaxColor,onChange:e=>a({heatMaxColor:e}),addonAfter:n.a.createElement(Co.Label,{color:t.heatMaxColor,presetColors:ri})}))))}function rs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ns(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function os(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rs(Object(a),!0).forEach((function(t){ns(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({Automatic:null},ri),[]),s=Object(r.useMemo)(()=>Object(l.map)(Mo(a.rows,t),e=>{var a=e.name;return{key:a,color:(t.seriesOptions[a]||{}).color||null}}),[t,a]),c=Object(r.useCallback)((e,t,a)=>{o({seriesOptions:{[e]:{[t]:a}}})},[o]),u=[{title:window.W_L.series,dataIndex:"key"},{title:window.W_L.color,dataIndex:"color",width:"1%",render:(e,t)=>n.a.createElement(Pn,{"data-test":"Chart.Series.".concat(t.key,".Color"),interactive:!0,presetColors:i,placement:"topRight",color:t.color,onChange:e=>c(t.key,"color",e),addonAfter:n.a.createElement(Pn.Label,{color:t.color,presetColors:i})})}];return n.a.createElement(Il.a,{showHeader:!1,dataSource:s,columns:u,pagination:!1})}function is(){return(is=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ls(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}as.propTypes=Dr,os.propTypes=Dr;var ss={pie:es,heatmap:as};function cs(e){var t=e.options,a=ls(e,["options"]),r=ss[t.globalSeriesType]||os;return n.a.createElement(r,is({options:t},a))}function us(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ds(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ds(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ds(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ms(e){var t=e.options,a=e.onOptionsChange,r=Object(l.includes)(["line","area","column","scatter","pie","heatmap"],t.globalSeriesType),o=us(Object(Sl.a)(a,200),1)[0];return n.a.createElement(n.a.Fragment,null,r&&n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Chart.DataLabels.ShowDataLabels",defaultChecked:t.showDataLabels,onChange:e=>a({showDataLabels:e.target.checked})},window.W_L.Show_Data_Labels)),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Number_format,n.a.createElement(_o.NumberFormatSpecs,null)),"data-test":"Chart.DataLabels.NumberFormat",defaultValue:t.numberFormat,onChange:e=>o({numberFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Percent_Values_Format,n.a.createElement(_o.NumberFormatSpecs,null)),"data-test":"Chart.DataLabels.PercentFormat",defaultValue:t.percentFormat,onChange:e=>o({percentFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Date_Time_format,n.a.createElement(_o.DateTimeFormatSpecs,null)),"data-test":"Chart.DataLabels.DateTimeFormat",defaultValue:t.dateTimeFormat,onChange:e=>o({dateTimeFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Data_Labels,n.a.createElement(_o,{placement:"topRight",arrowPointAtCenter:!0},n.a.createElement("div",{style:{paddingBottom:5}},"Use special names to access additional properties:"),n.a.createElement("div",null,n.a.createElement("code",null,"{{ @@name }}")," series name;"),n.a.createElement("div",null,n.a.createElement("code",null,"{{ @@x }}")," x-value;"),n.a.createElement("div",null,n.a.createElement("code",null,"{{ @@y }}")," y-value;"),n.a.createElement("div",null,n.a.createElement("code",null,"{{ @@yPercent }}")," relative y-value;"),n.a.createElement("div",null,n.a.createElement("code",null,"{{ @@yError }}")," y deviation;"),n.a.createElement("div",null,n.a.createElement("code",null,"{{ @@size }}")," bubble size;"),n.a.createElement("div",{style:{paddingTop:5}},window.W_L.Also_all_query_result_columns_can_be_referenced,n.a.createElement("br",null),window.W_L.using,n.a.createElement("code",{style:{whiteSpace:"nowrap"}},"{{ column_name }}"),"  ",window.W_L.syntax))),"data-test":"Chart.DataLabels.TextFormat",placeholder:"(auto)",defaultValue:t.textFormat,onChange:e=>o({textFormat:e.target.value})})))}cs.propTypes=Dr,ms.propTypes=Dr;var ps=Object(l.trimStart)("\n// Available variables are x, ys, element, and Plotly\n// Type console.log(x, ys); for more info about x and ys\n// To plot your graph call Plotly.plot(element, ...)\n// Plotly examples and docs: https://plot.ly/javascript/\n");function fs(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(go,{label:"Custom code","data-test":"Chart.Custom.Code",rows:"10",defaultValue:Object(l.isNil)(t.customCode)?ps:t.customCode,onChange:e=>a({customCode:e.target.value})})),n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"Chart.Custom.EnableConsoleLogs",defaultChecked:t.enableConsoleLogs,onChange:e=>a({enableConsoleLogs:e})},"Show errors in the console")),n.a.createElement(io,null,n.a.createElement(mo,{id:"chart-editor-auto-update-custom-chart","data-test":"Chart.Custom.AutoUpdate",defaultChecked:t.autoRedraw,onChange:e=>a({autoRedraw:e})},"Auto update graph")))}fs.propTypes=Dr;a(1270);var gs=e=>"custom"===e.globalSeriesType,bs=e=>"pie"===e.globalSeriesType,hs={type:"CHART",name:"图表(Chart)",isDefault:!0,getOptions:function(e){var t=Object(l.merge)({},Io,{showDataLabels:"pie"===e.globalSeriesType,dateTimeFormat:vo.dateTimeFormat},e);return["normal","percent"].indexOf(t.series.stacking)>=0&&(t.series.percentValues="percent"===t.series.stacking,t.series.stacking="stack"),t},Renderer:ul,Editor:ao([{key:"General",title:window.W_L.general,component:e=>n.a.createElement(n.a.Fragment,null,n.a.createElement(jl,e),gs(e.options)&&n.a.createElement(fs,e))},{key:"XAxis",title:e=>e.swappedAxes?window.W_L.y_column:window.W_L.x_column,component:kl,isAvailable:e=>!gs(e)&&!bs(e)},{key:"YAxis",title:e=>e.swappedAxes?window.W_L.x_column:window.W_L.y_column,component:Tl,isAvailable:e=>!gs(e)&&!bs(e)},{key:"Series",title:window.W_L.series,component:Jl,isAvailable:e=>!gs(e)},{key:"Colors",title:window.W_L.color,component:cs,isAvailable:e=>!gs(e)},{key:"DataLabels",title:window.W_L.data_labels,component:ms,isAvailable:e=>!gs(e)}]),defaultColumns:3,defaultRows:8,minColumns:1,minRows:5},ys=Object(l.extend)({White:"#ffffff",Black:"#000000","Light Gray":"#dddddd"},ri);var vs={mapType:"countries",keyColumn:null,targetField:null,valueColumn:null,clusteringMode:"e",steps:5,valueFormat:"0,0.00",noValuePlaceholder:"N/A",colors:{min:ys["Light Blue"],max:ys["Dark Blue"],background:ys.White,borders:ys.White,noValue:ys["Light Gray"]},legend:{visible:!0,position:"bottom-left",alignText:"right"},tooltip:{enabled:!0,template:"<b>{{ @@name }}</b>: {{ @@value }}"},popup:{enabled:!0,template:"".concat(window.W_L.region,": <b>{{ @@name_long }} ({{ @@iso_a2 }})</b>\n<br>\n").concat(window.W_L.value,": <b>{{ @@value }}</b>")}};function ws(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Os(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Os(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Os(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var _s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cleanupDelay,a=void 0===t?2e3:t,r={},n=Object(l.debounce)(()=>{Object(l.each)(r,(e,t)=>{e.refCount<=0&&delete r[t]})},a);function o(e,t){r[e]||(r[e]={value:t(),refCount:0});var a=r[e];return a.refCount+=1,a.value}function i(e){if(r[e]){var t=r[e];t.refCount>0&&(t.refCount-=1,t.refCount<=0&&n())}}return{get:o,release:i}}();function Es(e){var t=ws(Object(r.useState)(null),2),a=t[0],n=t[1],o=ws(Object(r.useState)(!1),2),i=o[0],s=o[1];return Object(r.useEffect)(()=>{var t=Object(l.get)(vo,"choroplethAvailableMaps.".concat(e,".url"),void 0);if(Object(l.isString)(t)){s(!0);var a=!1;return _s.get(t,()=>W.a.get(t).catch(()=>null)).then(e=>{var t=e.data;a||(n(Object(l.isObject)(t)?t:null),s(!1))}),()=>{a=!0,_s.release(t)}}n(null),s(!1)},[e]),[a,i]}var js=a(58),Ss=a.n(js);a(589),a(590),a(591);function Cs(e){return an()(e).darken().hex()}function xs(e,t,a){var r=e.properties[a];return Object(l.isString)(r)&&Object(l.isObject)(t[r])?t[r].value:Object(l.isNumber)(r)&&Object(l.isObject)(t[r.toString()])?t[r.toString()].value:void 0}function Ps(e){var t=e.items,a=e.alignText;return n.a.createElement("div",{className:"choropleth-visualization-legend"},Object(l.map)(t,(e,t)=>n.a.createElement("div",{key:"legend".concat(t),className:"legend-item"},n.a.createElement(Pn.Swatch,{color:e.color}),n.a.createElement("div",{className:"legend-item-text text-".concat(a)},e.text))))}function Ls(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ks(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ls(Object(a),!0).forEach((function(t){Ns(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ls(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ns(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Ps.defaultProps={items:[],alignText:"left"};var As=Ss.a.Control.extend({options:{position:"topright"},onAdd(){var e=document.createElement("div");return e.className="leaflet-bar leaflet-custom-toolbar",e.style.background="#fff",e.style.backgroundClip="padding-box",e},onRemove(){i.a.unmountComponentAtNode(this.getContainer())}});function Ts(e){var t=e.feature,a=e.layer,r=e.data,n=e.options,o=e.limits,i=e.colors,s=e.formatValue,c=xs(t,r,n.targetField),u=function(e,t,a,r){var n={};Object(l.each)(e.properties,(e,t)=>{n["@@"+t]=e}),n["@@value"]=t;var o=a[e.properties[r]]||{};return Object(l.extend)(n,o.item)}(t,s(c),r,n.targetField),d=function(e,t,a,r){if(Object(l.isFinite)(e))for(var n=0;n<t.length;n+=1)if(e<=t[n])return a[n];return r}(c,o,i,n.colors.noValue);a.setStyle({color:n.colors.borders,weight:1,fillColor:d,fillOpacity:1}),n.tooltip.enabled&&a.bindTooltip(ke(_i(n.tooltip.template,u)),{sticky:!0}),n.popup.enabled&&a.bindPopup(ke(_i(n.popup.template,u))),a.on("mouseover",()=>{a.setStyle({weight:2,fillColor:Cs(d)})}),a.on("mouseout",()=>{a.setStyle({weight:1,fillColor:d})})}function Ws(e,t){return e&&(e=Ss.a.latLngBounds(e[0],e[1])).isValid()?e:t&&t.isValid()?t:null}function Is(e,t){var a=Ss.a.map(e,{center:[0,0],zoom:1,zoomSnap:0,scrollWheelZoom:!1,maxBoundsViscosity:1,attributionControl:!1,fullscreenControl:!0}),r=null,o=new As;var s=!1,c=()=>{!function(){if(Object(l.isFunction)(t)){var e=a.getBounds();t([[e._southWest.lat,e._southWest.lng],[e._northEast.lat,e._northEast.lng]])}}()};a.on("focus",()=>{s=!0,a.on("moveend",c)}),a.on("blur",()=>{a.off("moveend",c),s=!1});var u=Ar(e,()=>{a.invalidateSize(!1)});return{updateLayers:function(e,t,s){if(a.eachLayer(e=>a.removeLayer(e)),a.removeControl(o),!Object(l.isObject)(e)||!Object(l.isArray)(e.features))return r=null,void a.setMaxBounds(null);var c,u,d,m=function(e,t,a){var r=Object(l.uniq)(Object(l.filter)(Object(l.map)(e,e=>xs(e,t,a.targetField)),l.isFinite));if(0===r.length)return{limits:[],colors:[],legend:[]};var n=Math.min(r.length,a.steps);if(1===n)return{limits:r,colors:[a.colors.max],legend:[{color:a.colors.max,limit:Object(l.first)(r)}]};var o=an.a.limits(r,a.clusteringMode,n-1),i=an.a.scale([a.colors.min,a.colors.max]).colors(o.length),s=Object(l.map)(i,(e,t)=>({color:e,limit:o[t]})).reverse();return{limits:o,colors:i,legend:s}}(e.features,t,s),p=m.limits,f=m.colors,g=m.legend,b=(c=s.valueFormat,u=s.noValuePlaceholder,d=Oi(c),e=>Object(l.isFinite)(e)?d(e):u),h=(r=Ss.a.geoJSON(e,{onEachFeature(e,a){Ts({feature:e,layer:a,data:t,options:s,limits:p,colors:f,formatValue:b})}}).addTo(a)).getBounds(),y=Ws(s.bounds,h);a.fitBounds(y,{animate:!1,duration:0}),a.options.maxBounds=h,a.panInsideBounds(h,{animate:!1,duration:0}),s.legend.visible&&g.length>0&&(o.setPosition(s.legend.position.replace("-","")),a.addControl(o),i.a.render(n.a.createElement(Ps,{items:Object(l.map)(g,e=>ks(ks({},e),{},{text:b(e.limit)})),alignText:s.legend.alignText}),o.getContainer()))},updateBounds:function(e){s||(e=Ws(e,r?r.getBounds():a.getBounds()))&&a.fitBounds(e,{animate:!1,duration:0})},destroy(){u(),a.removeControl(o),a.remove()}}}a(1271);function qs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ds(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qs(Object(a),!0).forEach((function(t){Rs(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Rs(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ms(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zs(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zs(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Fs(e){var t=e.data,a=e.options,o=e.onOptionsChange,i=Ms(Object(r.useState)(null),2),s=i[0],c=i[1],u=Ms(Es(a.mapType),1)[0],d=Object(r.useRef)();d.current=o?e=>o(Ds(Ds({},a),{},{bounds:e})):l.noop;var m,p,f,g,b=(m=()=>Object(l.omit)(a,["bounds"]),p=[a],f=Object(r.useRef)(),g=Object(r.useMemo)(m,p),Object(l.isEqual)(g,f.current)||(f.current=g),f.current),h=Ms(Object(r.useState)(null),2),y=h[0],v=h[1];return Object(r.useEffect)(()=>{if(s){var e=Is(s,(function(){return d.current(...arguments)}));return v(e),()=>{e.destroy()}}},[s]),Object(r.useEffect)(()=>{y&&y.updateLayers(u,function(e,t,a){if(!t||!a)return{};var r={};return Object(l.each)(e,e=>{if(e[t]){var n=parseFloat(e[a]);r[e[t]]={code:e[t],value:Object(l.isFinite)(n)?n:void 0,item:e}}}),r}(t.rows,b.keyColumn,b.valueColumn),a)},[y,u,t.rows,b]),Object(r.useEffect)(()=>{y&&y.updateBounds(a.bounds)},[y,a,o]),n.a.createElement("div",{className:"map-visualization-container",style:{background:a.colors.background},ref:c})}function Vs(e){var t=Object(l.isObject)(e)&&Object(l.isArray)(e.features)?e.features:[];return Object(l.reduce)(t,(e,t)=>{var a=Object(l.isObject)(t)&&Object(l.isObject)(t.properties)?t.properties:{};return Object(l.uniq)([...e,...Object(l.keys)(a)])},[])}function Us(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bs(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Bs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bs(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Hs(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Us(Es(t.mapType),2),s=i[0],c=i[1],u=Object(r.useMemo)(()=>Vs(s),[s]),d=c?Object(l.filter)([t.targetField],l.isString):u,m=Object(l.get)(vo,"choroplethAvailableMaps.".concat(t.mapType,".fieldNames"),{}),p=Object(r.useCallback)(e=>{o({mapType:e||null})},[o]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.Map,"data-test":"Choropleth.Editor.MapType",defaultValue:t.mapType,onChange:p},Object(l.map)(vo.choroplethAvailableMaps,(e,t)=>n.a.createElement(Eo.Option,{key:t,"data-test":"Choropleth.Editor.MapType.".concat(t)},Object(l.get)(vo,"choroplethAvailableMaps.".concat(t,".name"),t))))),n.a.createElement(io,null,n.a.createElement(Vn.Row,{gutter:15},n.a.createElement(Vn.Col,{span:12},n.a.createElement(Eo,{label:window.W_L.Key_Column,className:"w-100","data-test":"Choropleth.Editor.KeyColumn",disabled:0===a.columns.length,defaultValue:t.keyColumn,onChange:e=>o({keyColumn:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"Choropleth.Editor.KeyColumn.".concat(t)},t)}))),n.a.createElement(Vn.Col,{span:12},n.a.createElement(Eo,{label:window.W_L.Target_Field,className:"w-100","data-test":"Choropleth.Editor.TargetField",disabled:c||0===d.length,loading:c,value:t.targetField,onChange:e=>o({targetField:e})},Object(l.map)(d,e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Choropleth.Editor.TargetField.".concat(e)},m[e]||e)))))),n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.Value_Column,"data-test":"Choropleth.Editor.ValueColumn",disabled:0===a.columns.length,defaultValue:t.valueColumn,onChange:e=>o({valueColumn:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"Choropleth.Editor.ValueColumn.".concat(t)},t)}))))}function Ys(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Qs(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qs(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ks(e){var t=e.options,a=e.onOptionsChange,r=Ys(Object(Sl.a)(a,200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:window.W_L.Clustering_Mode,"data-test":"Choropleth.Editor.ClusteringMode",defaultValue:t.clusteringMode,onChange:e=>a({clusteringMode:e})},n.a.createElement(Eo.Option,{value:"q","data-test":"Choropleth.Editor.ClusteringMode.q"},"分位数(quantile)"),n.a.createElement(Eo.Option,{value:"e","data-test":"Choropleth.Editor.ClusteringMode.e"},"等距(equidistant)"),n.a.createElement(Eo.Option,{value:"k","data-test":"Choropleth.Editor.ClusteringMode.k"},"K均值(k-means)"))),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:window.W_L.Steps,"data-test":"Choropleth.Editor.ColorSteps",min:3,max:11,defaultValue:t.steps,onChange:e=>r({steps:e})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.min_color,interactive:!0,presetColors:ys,placement:"topRight",color:t.colors.min,triggerProps:{"data-test":"Choropleth.Editor.Colors.Min"},onChange:e=>a({colors:{min:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.min,presetColors:ys})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.max_color,interactive:!0,presetColors:ys,placement:"topRight",color:t.colors.max,triggerProps:{"data-test":"Choropleth.Editor.Colors.Max"},onChange:e=>a({colors:{max:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.max,presetColors:ys})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.No_Value_Color,interactive:!0,presetColors:ys,placement:"topRight",color:t.colors.noValue,triggerProps:{"data-test":"Choropleth.Editor.Colors.NoValue"},onChange:e=>a({colors:{noValue:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.noValue,presetColors:ys})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.Background_Color,interactive:!0,presetColors:ys,placement:"topRight",color:t.colors.background,triggerProps:{"data-test":"Choropleth.Editor.Colors.Background"},onChange:e=>a({colors:{background:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.background,presetColors:ys})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.Borders_Color,interactive:!0,presetColors:ys,placement:"topRight",color:t.colors.borders,triggerProps:{"data-test":"Choropleth.Editor.Colors.Borders"},onChange:e=>a({colors:{borders:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.borders,presetColors:ys})})))}function Gs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $s(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Js(e){var t=e.geoJsonProperties;return n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0},n.a.createElement("div",{style:{paddingBottom:5}},n.a.createElement("div",null,window.W_L.Also_all_query_result_columns_can_be_referenced,"：",n.a.createElement("code",null,"{{ column_name }}"),"。"),n.a.createElement("div",null,"Use",n.a.createElement("code",null,"{{ @@value }}")," to access formatted value.")),t.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"p-b-5"},"GeoJSON properties could be accessed by these names:"),n.a.createElement("div",{style:{maxHeight:300,overflow:"auto"}},Object(l.map)(t,e=>n.a.createElement("div",{key:e},n.a.createElement("code",null,"{{ @@".concat(e,"}}")))))))}function Xs(e){var t=e.options,a=e.onOptionsChange,o=Gs(Object(Sl.a)(a,200),1)[0],i=Gs(Es(t.mapType),1)[0],l=Object(r.useMemo)(()=>Vs(i),[i]),s=n.a.createElement(Js,{geoJsonProperties:l});return n.a.createElement("div",{className:"choropleth-visualization-editor-format-settings"},n.a.createElement(io,null,n.a.createElement(Vn.Row,{gutter:15},n.a.createElement(Vn.Col,{span:12},n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Value_Format,n.a.createElement(_o.NumberFormatSpecs,null)),"data-test":"Choropleth.Editor.ValueFormat",defaultValue:t.valueFormat,onChange:e=>o({valueFormat:e.target.value})})),n.a.createElement(Vn.Col,{span:12},n.a.createElement(jo,{label:window.W_L.Value_Placeholder,"data-test":"Choropleth.Editor.ValuePlaceholder",defaultValue:t.noValuePlaceholder,onChange:e=>o({noValuePlaceholder:e.target.value})})))),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Choropleth.Editor.LegendVisibility",checked:t.legend.visible,onChange:e=>a({legend:{visible:e.target.checked}})},window.W_L.Show_Legend)),n.a.createElement(io,null,n.a.createElement(Vn.Row,{gutter:15},n.a.createElement(Vn.Col,{span:12},n.a.createElement(Eo,{label:window.W_L.Legend_Position,"data-test":"Choropleth.Editor.LegendPosition",disabled:!t.legend.visible,defaultValue:t.legend.position,onChange:e=>a({legend:{position:e}})},n.a.createElement(Eo.Option,{value:"top-left","data-test":"Choropleth.Editor.LegendPosition.TopLeft"},"top / left"),n.a.createElement(Eo.Option,{value:"top-right","data-test":"Choropleth.Editor.LegendPosition.TopRight"},"top / right"),n.a.createElement(Eo.Option,{value:"bottom-left","data-test":"Choropleth.Editor.LegendPosition.BottomLeft"},"bottom / left"),n.a.createElement(Eo.Option,{value:"bottom-right","data-test":"Choropleth.Editor.LegendPosition.BottomRight"},"bottom / right"))),n.a.createElement(Vn.Col,{span:12},n.a.createElement(xo,{"data-test":"Choropleth.Editor.LegendTextAlignment",label:window.W_L.Legend_Text_Alignment,disabled:!t.legend.visible,defaultValue:t.legend.alignText,onChange:e=>a({legend:{alignText:e.target.value}})})))),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Choropleth.Editor.TooltipEnabled",checked:t.tooltip.enabled,onChange:e=>a({tooltip:{enabled:e.target.checked}})},window.W_L.Show_tooltip)),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Tooltip_template," ",s),"data-test":"Choropleth.Editor.TooltipTemplate",disabled:!t.tooltip.enabled,defaultValue:t.tooltip.template,onChange:e=>o({tooltip:{template:e.target.value}})})),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Choropleth.Editor.PopupEnabled",checked:t.popup.enabled,onChange:e=>a({popup:{enabled:e.target.checked}})},window.W_L.Show_popup)),n.a.createElement(io,null,n.a.createElement(go,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Popup_template," ",s),"data-test":"Choropleth.Editor.PopupTemplate",disabled:!t.popup.enabled,rows:4,defaultValue:t.popup.template,onChange:e=>o({popup:{template:e.target.value}})})))}function Zs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ec(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ec(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ec(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function tc(e){var t=e.options,a=e.onOptionsChange,o=Zs(Object(r.useState)(t.bounds),2),i=o[0],s=o[1],c=Zs(Object(Sl.a)(a,200),1)[0],u=Zs(Es(t.mapType),1)[0];Object(r.useEffect)(()=>{if(t.bounds)s(t.bounds);else{var e=function(e){if(Object(l.isObject)(e)){var t=Ss.a.geoJSON(e).getBounds();if(t.isValid())return[[t._southWest.lat,t._southWest.lng],[t._northEast.lat,t._northEast.lng]]}return null}(u);e&&s(e)}},[t.bounds,u]);var d=Object(r.useCallback)((e,t,a)=>{if(a=parseFloat(a),Object(l.isFinite)(a)){var r=Object(l.cloneDeep)(i);r[e][t]=a,s(r),c({bounds:r})}},[i,c]),m=Object(l.isArray)(i);return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Kn,{label:window.W_L.North_East_Latitude_and_Longitude},n.a.createElement(Vn.Row,{gutter:15},n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{disabled:!m,value:m?i[1][0]:void 0,onChange:e=>d(1,0,e)})),n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{disabled:!m,value:m?i[1][1]:void 0,onChange:e=>d(1,1,e)}))))),n.a.createElement(io,null,n.a.createElement(Kn,{label:window.W_L.South_West_Latitude_and_Longitude},n.a.createElement(Vn.Row,{gutter:15},n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{disabled:!m,value:m?i[0][0]:void 0,onChange:e=>d(0,0,e)})),n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{disabled:!m,value:m?i[0][1]:void 0,onChange:e=>d(0,1,e)}))))))}Fs.propTypes=qr,Hs.propTypes=Dr,Ks.propTypes=Dr,Js.defaultProps={geoJsonProperties:[]},Xs.propTypes=Dr,tc.propTypes=Dr;var ac={type:"CHOROPLETH",name:"地理分布图(Choropleth Map)",getOptions:function(e){var t=Object(l.merge)({},vs,e);return t.bounds=Object(l.get)(e,"bounds"),Object(l.isNil)(vo.choroplethAvailableMaps[t.mapType])&&(t.mapType=Object(l.first)(Object(l.keys)(vo.choroplethAvailableMaps))||null),Object(l.isNil)(t.countryCodeColumn)||(t.keyColumn=t.countryCodeColumn),delete t.countryCodeColumn,Object(l.isNil)(t.countryCodeType)||(t.targetField=t.countryCodeType),delete t.countryCodeType,t},Renderer:Fs,Editor:ao([{key:"General",title:window.W_L.general,component:Hs},{key:"Colors",title:window.W_L.color,component:Ks},{key:"Format",title:window.W_L.formatting,component:Xs},{key:"Bounds",title:window.W_L.border,component:tc}]),defaultColumns:3,defaultRows:8,minColumns:2},rc={timeInterval:"daily",mode:"diagonal",dateColumn:"date",stageColumn:"day_number",totalColumn:"total",valueColumn:"value",showTooltips:!0,percentValues:!0,timeColumnTitle:"Time",peopleColumnTitle:"Users",stageColumnTitle:"{{ @ }}",numberFormat:"0,0[.]00",percentFormat:"0.00%",noValuePlaceholder:"-",colors:{min:"#ffffff",max:ri["Dark Blue"],steps:7}};var nc={weekly:"weeks",daily:"days",monthly:"months"};function oc(e){var t={};return s.a.each(e,e=>{var a=Ea()(e.date),r=a.valueOf();t[r]=t[r]||{date:a,total:parseInt(e.total,10)||0,values:{}},t[r].values[e.stage]=parseInt(e.value,10)||null}),s.a.values(t)}function ic(e,t){if(!function(e,t){var a=s.a.map(e.columns,e=>e.name);return e.rows.length>0&&s.a.includes(a,t.dateColumn)&&s.a.includes(a,t.stageColumn)&&s.a.includes(a,t.totalColumn)&&s.a.includes(a,t.valueColumn)}(e,t))return{data:[],initialDate:null};e=s.a.map(e.rows,e=>({date:e[t.dateColumn],stage:parseInt(e[t.stageColumn],10),total:parseFloat(e[t.totalColumn]),value:parseFloat(e[t.valueColumn])}));var a,r=s.a.sortBy(e,e=>e.date+e.stage),n=Ea()(r[0].date).toDate();switch(t.mode){case"simple":a=function(e,t){var a=t.timeInterval,r=oc(e),n=s.a.map(e,e=>e.stage),o=s.a.min(n),i=s.a.max(n),l=null,c=[];return s.a.each(r,e=>{if(null!==l)for(var t=Math.abs(l.diff(e.date,nc[a]));t>1;)c.push([0]),t-=1;l=e.date;for(var r=[e.total],n=o;n<=i;n+=1)r.push(e.values[n]);c.push(r)}),c}(r,t);break;default:a=function(e,t){var a=t.timeInterval,r=oc(e),n=s.a.min(s.a.map(e,e=>e.stage)),o=Ea()(s.a.last(r).date).diff(s.a.first(r).date,nc[a]),i=n+o,l=null,c=[];return s.a.each(r,e=>{if(null!==l)for(var t=Math.abs(l.diff(e.date,nc[a]));t>1;){for(var r=[0],o=n;o<=i;o+=1)r.push(e.values[o]||0);c.push(r),i-=1,t-=1}l=e.date;for(var s=[e.total],u=n;u<=i;u+=1)s.push(e.values[u]||0);i-=1,c.push(s)}),c}(r,t)}return{data:a,initialDate:n}}a(1272),a(1273);var lc={daily:"days",weekly:"weeks",monthly:"months",yearly:"years"},sc={daily:"MMMM D, YYYY",weekly:"[Week of] MMM D, YYYY",monthly:"MMMM YYYY",yearly:"YYYY"},cc={initialDate:null,timeInterval:"monthly",noValuePlaceholder:"-",rawNumberOnHover:!0,displayAbsoluteValues:!1,initialIntervalNumber:1,maxColumns:1/0,title:null,timeColumnTitle:"Time",peopleColumnTitle:"People",stageColumnTitle:"{{ @ }}",numberFormat:"0,0[.]00",percentFormat:"0.00%",timeLabelFormat:sc.monthly,colors:{min:"#ffffff",max:"#041d66",steps:7}};function uc(e){e=an()(e);return an.a.contrast(e,"#ffffff")<an.a.contrast(e,"#000000")}function dc(e,t){return _i(e.stageColumnTitle,{"@":e.initialIntervalNumber-1+t})}function mc(e){for(var t=e.options,a=e.maxRowLength,r=[],o=1;o<a;o+=1)r.push(n.a.createElement("th",{key:"col".concat(o),className:"cornelius-stage"},dc(t,o)));return n.a.createElement("tr",null,n.a.createElement("th",{className:"cornelius-time"},t.timeColumnTitle),n.a.createElement("th",{className:"cornelius-people"},t.peopleColumnTitle),r)}function pc(e){for(var t=e.options,a=e.data,r=e.index,o=e.maxRowLength,i=a[0]||0,s=[],c=1;c<o;c+=1){var u=a[c],d=Object(l.isFinite)(u/i)?u/i*100:null,m={key:"col".concat(c)};if(Object(l.isNil)(d))m.className="cornelius-empty",m.children=t.noValuePlaceholder;else{m.className=t.displayAbsoluteValues?"cornelius-absolute":"cornelius-percentage",m.children=t.displayAbsoluteValues?t.formatNumber(u):t.formatPercent(d);var p=t.getColorForValue(d);m.style={backgroundColor:p,color:rn(p)},uc(m.style.color)&&(m.className+=" cornelius-white-text"),t.rawNumberOnHover&&!t.displayAbsoluteValues&&(m.children=n.a.createElement(he.a,{title:t.formatNumber(u),mouseEnterDelay:0,mouseLeaveDelay:0},n.a.createElement("div",null,m.children)))}s.push(n.a.createElement("td",m))}return n.a.createElement("tr",null,n.a.createElement("td",{className:"cornelius-label"},function(e,t){var a=lc[e.timeInterval];return e.initialDate.clone().add(t,a).format(e.timeLabelFormat)}(t,r)),n.a.createElement("td",{className:"cornelius-people"},t.formatNumber(i)),s)}function fc(e){var t=e.data,a=e.options;a=Object(r.useMemo)(()=>function(e){return e=Object(l.extend)({},cc,e,{initialDate:Ea()(e.initialDate),colors:Object(l.extend)({},cc.colors,e.colors)}),Object(l.extend)(e,{timeLabelFormat:sc[e.timeInterval],formatNumber:Oi(e.numberFormat),formatPercent:Oi(e.percentFormat),getColorForValue:an.a.scale([e.colors.min,e.colors.max]).mode("hsl").domain([0,100]).classes(e.colors.steps)})}(a),[a]);var o=Object(r.useMemo)(()=>Object(l.min)([Object(l.max)(Object(l.map)(t,e=>e.length))||0,a.maxColumns+1]),[t,a.maxColumns]);return 0===t.length?null:n.a.createElement("div",{className:"cornelius-container"},a.title&&n.a.createElement("div",{className:"cornelius-title"},a.title),n.a.createElement("table",{className:"cornelius-table"},n.a.createElement("thead",null,n.a.createElement(mc,{options:a,maxRowLength:o})),n.a.createElement("tbody",null,Object(l.map)(t,(e,t)=>n.a.createElement(pc,{key:"row".concat(t),options:a,data:e,index:t,maxRowLength:o})))))}function gc(e){var t=e.data,a=e.options,o=Object(r.useMemo)(()=>ic(t,a),[t,a]),i=o.data,l=o.initialDate,s=Object(r.useMemo)(()=>({initialDate:l,timeInterval:a.timeInterval,noValuePlaceholder:a.noValuePlaceholder,rawNumberOnHover:a.showTooltips,displayAbsoluteValues:!a.percentValues,timeColumnTitle:a.timeColumnTitle,peopleColumnTitle:a.peopleColumnTitle,stageColumnTitle:a.stageColumnTitle,numberFormat:a.numberFormat,percentFormat:a.percentFormat,colors:a.colors}),[a,l]);return 0===i.length?null:n.a.createElement("div",{className:"cohort-visualization-container"},n.a.createElement(fc,{data:i,options:s}))}function bc(e){var t=e.options,a=e.data,r=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Date (Bucket)","data-test":"Cohort.DateColumn",value:t.dateColumn,onChange:e=>r({dateColumn:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"Cohort.DateColumn."+t},t)}))),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:window.W_L.Steps,"data-test":"Cohort.StageColumn",value:t.stageColumn,onChange:e=>r({stageColumn:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"Cohort.StageColumn."+t},t)}))),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Bucket Population Size","data-test":"Cohort.TotalColumn",value:t.totalColumn,onChange:e=>r({totalColumn:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"Cohort.TotalColumn."+t},t)}))),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:window.W_L.Stage_Value,"data-test":"Cohort.ValueColumn",value:t.valueColumn,onChange:e=>r({valueColumn:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"Cohort.ValueColumn."+t},t)}))))}fc.defaultProps={data:[],options:{}},gc.propTypes=qr,bc.propTypes=Dr;var hc={daily:window.W_L.Daily,weekly:window.W_L.Weekly,monthly:window.W_L.Monthly},yc={diagonal:window.W_L.Fill_gaps_with_zeros,simple:window.W_L.Show_data_as_is};function vc(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:window.W_L.Time_Interval,"data-test":"Cohort.TimeInterval",value:t.timeInterval,onChange:e=>a({timeInterval:e})},Object(l.map)(hc,(e,t)=>n.a.createElement(Eo.Option,{key:t,"data-test":"Cohort.TimeInterval."+t},e)))),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:window.W_L.Mode,"data-test":"Cohort.Mode",value:t.mode,onChange:e=>a({mode:e})},Object(l.map)(yc,(e,t)=>n.a.createElement(Eo.Option,{key:t,"data-test":"Cohort.Mode."+t},e)))))}function wc(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Oc(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}vc.propTypes=Dr;var _c=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wc(Object(a),!0).forEach((function(t){Oc(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wc(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({White:"#FFFFFF"},ri);function Ec(e){return e=Object(l.isFinite)(e)?e:parseInt(e,10),e=Object(l.isFinite)(e)?e:0,Math.max(3,Math.min(e,20))}function jc(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.min_color,presetColors:_c,interactive:!0,color:t.colors.min,onChange:e=>a({colors:{min:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.min,presetColors:_c})})),n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.max_color,presetColors:_c,interactive:!0,color:t.colors.max,onChange:e=>a({colors:{max:e}}),addonAfter:n.a.createElement(Co.Label,{color:t.colors.max,presetColors:_c})})),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:window.W_L.Steps,min:3,max:20,value:t.colors.steps,onChange:e=>a({colors:{steps:Ec(e)}})})))}function Sc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Cc(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Cc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cc(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function xc(e){var t=e.options,a=e.onOptionsChange,r=Sc(Object(Sl.a)(a,200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:window.W_L.Time_Column_Title,defaultValue:t.timeColumnTitle,onChange:e=>r({timeColumnTitle:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:window.W_L.People_Column_Title,defaultValue:t.peopleColumnTitle,onChange:e=>r({peopleColumnTitle:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:n.a.createElement(n.a.Fragment,null,window.W_L.Stage_Column_Title,n.a.createElement(_o,{placement:"topRight",arrowPointAtCenter:!0},n.a.createElement("div",null,"Use ",n.a.createElement("code",null,"{{ @ }}")," to insert a stage number"))),defaultValue:t.stageColumnTitle,onChange:e=>r({stageColumnTitle:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:n.a.createElement(n.a.Fragment,null,window.W_L.Number_format,n.a.createElement(_o.NumberFormatSpecs,null)),defaultValue:t.numberFormat,onChange:e=>r({numberFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:n.a.createElement(n.a.Fragment,null,window.W_L.Percent_Values_Format,n.a.createElement(_o.NumberFormatSpecs,null)),defaultValue:t.percentFormat,onChange:e=>r({percentFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:window.W_L.No_Value_Placeholder,defaultValue:t.noValuePlaceholder,onChange:e=>r({noValuePlaceholder:e.target.value})})),n.a.createElement(io,null,n.a.createElement($r.a,{defaultChecked:t.showTooltips,onChange:e=>a({showTooltips:e.target.checked})},window.W_L.Show_Tooltips)),n.a.createElement(io,null,n.a.createElement($r.a,{defaultChecked:t.percentValues,onChange:e=>a({percentValues:e.target.checked})},window.W_L.Normalize_values_to_percentage)))}jc.propTypes=Dr,xc.propTypes=Dr;var Pc={type:"COHORT",name:"同期群分析(Cohort)",getOptions:function(e){return Object(l.merge)({},rc,e)},Renderer:gc,Editor:ao([{key:"Columns",title:window.W_L.column,component:bc},{key:"Options",title:window.W_L.option,component:vc},{key:"Colors",title:window.W_L.color,component:jc},{key:"Appearance",title:window.W_L.exterior,component:xc}]),autoHeight:!0,defaultRows:8};function Lc(e,t){if(0===(e=parseInt(e,10)||0))return e;var a=(Math.abs(e)-1)%t;return e>0?a:t-a-1}function kc(e,t){var a=t.stringPrefix,r=t.stringSuffix,n=t.stringDecimal,o=t.stringDecChar,i=t.stringThouSep;return Object(l.isNumber)(e)?(e=function(e,t,a,r){var n=hi.a.localeData(),o=n.delimiters;n.delimiters={thousands:",",decimal:"."};var i="0,0.000";if((Number.isFinite(t)&&t>=0||a||r)&&(n.delimiters={thousands:r,decimal:a||"."},i="0,0",t>0))for(i+=".";t>0;)i+="0",t-=1;var l=hi()(e).format(i);return n.delimiters=o,l}(e,n,o,i),Object(l.toString)(a)+e+Object(l.toString)(r)):Object(l.toString)(e)}function Nc(e,t){return Object(l.isNumber)(e)?hi()(e).format(t):Object(l.toString)(e)}a(1274);function Ac(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Tc(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Tc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tc(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Wc(e){return{msTransform:"scale(".concat(e,")"),MozTransform:"scale(".concat(e,")"),WebkitTransform:"scale(".concat(e,")"),transform:"scale(".concat(e,")")}}function Ic(e){var t=e.firstChild,a=Math.min(e.offsetWidth/t.offsetWidth,e.offsetHeight/t.offsetHeight);return Number(Object(l.isFinite)(a)?a:1).toFixed(2)}function qc(e){var t=e.data,a=e.options,o=e.visualizationName,i=Ac(Object(r.useState)("1.00"),2),s=i[0],c=i[1],u=Ac(Object(r.useState)(null),2),d=u[0],m=u[1];Object(r.useEffect)(()=>{if(d)return Ar(d,()=>{c(Ic(d))})},[d]),Object(r.useEffect)(()=>{d&&c(Ic(d))},[t,a,d]);var p=function(e,t,a){var r={},n=e.length;if(n>0||t.countRow){var o=t.counterColName,i=t.targetColName;if(r.counterLabel=t.counterLabel||a,t.countRow)r.counterValue=n;else if(o){var s=Lc(t.rowNumber,n);r.counterValue=e[s][o]}if(r.showTrend=!1,i){var c=Lc(t.targetRowNumber,n);if(r.targetValue=e[c][i],Number.isFinite(r.counterValue)&&Object(l.isFinite)(r.targetValue)){var u=r.counterValue-r.targetValue;r.showTrend=!0,r.trendPositive=u>=0}}else r.targetValue=null;r.counterValueTooltip=Nc(r.counterValue,t.tooltipFormat),r.targetValueTooltip=Nc(r.targetValue,t.tooltipFormat),r.counterValue=kc(r.counterValue,t),t.formatTargetValue?r.targetValue=kc(r.targetValue,t):Object(l.isFinite)(r.targetValue)&&(r.targetValue=hi()(r.targetValue).format("0[.]00[0]"))}return r}(t.rows,a,o),f=p.showTrend,g=p.trendPositive,b=p.counterValue,h=p.counterValueTooltip,y=p.targetValue,v=p.targetValueTooltip,w=p.counterLabel;return n.a.createElement("div",{className:me()("counter-visualization-container",{"trend-positive":f&&g,"trend-negative":f&&!g})},n.a.createElement("div",{className:"counter-visualization-content",ref:m},n.a.createElement("div",{style:Wc(s)},n.a.createElement("div",{className:"counter-visualization-value",title:h},b),y&&n.a.createElement("div",{className:"counter-visualization-target",title:v},"(",y,")"),n.a.createElement("div",{className:"counter-visualization-label"},w))))}function Dc(e){var t=e.options,a=e.data,r=e.visualizationName,o=e.onOptionsChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Counter Label","data-test":"Counter.General.Label",defaultValue:t.counterLabel,placeholder:r,onChange:e=>o({counterLabel:e.target.value})})),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Counter Value Column Name","data-test":"Counter.General.ValueColumn",defaultValue:t.counterColName,disabled:t.countRow,onChange:e=>o({counterColName:e})},Object(l.map)(a.columns,e=>n.a.createElement(Eo.Option,{key:e.name,"data-test":"Counter.General.ValueColumn."+e.name},e.name)))),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:"Counter Value Row Number","data-test":"Counter.General.ValueRowNumber",defaultValue:t.rowNumber,disabled:t.countRow,onChange:e=>o({rowNumber:e})})),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Target Value Column Name","data-test":"Counter.General.TargetValueColumn",defaultValue:t.targetColName,onChange:e=>o({targetColName:e})},n.a.createElement(Eo.Option,{value:""},"No target value"),Object(l.map)(a.columns,e=>n.a.createElement(Eo.Option,{key:e.name,"data-test":"Counter.General.TargetValueColumn."+e.name},e.name)))),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:"Target Value Row Number","data-test":"Counter.General.TargetValueRowNumber",defaultValue:t.targetRowNumber,onChange:e=>o({targetRowNumber:e})})),n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"Counter.General.CountRows",defaultChecked:t.countRow,onChange:e=>o({countRow:e})},"Count Rows")))}function Rc(e){var t=e.options,a=e.data,r=e.onOptionsChange,o=function(e,t){if(t.countRow)return!0;var a=e.length;if(a>0){var r=Lc(t.rowNumber,a),n=t.counterColName;if(n)return Object(l.isNumber)(e[r][n])}return!1}(a.rows,t);return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:"Formatting Decimal Place","data-test":"Counter.Formatting.DecimalPlace",defaultValue:t.stringDecimal,disabled:!o,onChange:e=>r({stringDecimal:e})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Formatting Decimal Character","data-test":"Counter.Formatting.DecimalCharacter",defaultValue:t.stringDecChar,disabled:!o,onChange:e=>r({stringDecChar:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Formatting Thousands Separator","data-test":"Counter.Formatting.ThousandsSeparator",defaultValue:t.stringThouSep,disabled:!o,onChange:e=>r({stringThouSep:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Formatting String Prefix","data-test":"Counter.Formatting.StringPrefix",defaultValue:t.stringPrefix,disabled:!o,onChange:e=>r({stringPrefix:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Formatting String Suffix","data-test":"Counter.Formatting.StringSuffix",defaultValue:t.stringSuffix,disabled:!o,onChange:e=>r({stringSuffix:e.target.value})})),n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"Counter.Formatting.FormatTargetValue",defaultChecked:t.formatTargetValue,onChange:e=>r({formatTargetValue:e})},"Format Target Value")))}qc.propTypes=qr,Dc.propTypes=Dr,Rc.propTypes=Dr;var Mc=ao([{key:"General",title:window.W_L.general,component:Dc},{key:"Format",title:window.W_L.formatting,component:Rc}]);function zc(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Fc(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?zc(Object(a),!0).forEach((function(t){Vc(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zc(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Vc(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Uc={counterLabel:"",counterColName:"counter",rowNumber:1,targetRowNumber:1,stringDecimal:0,stringDecChar:".",stringThouSep:",",tooltipFormat:"0,0.000"},Bc={type:"COUNTER",name:"计数器(Counter)",getOptions:e=>Fc(Fc({},Uc),e),Renderer:qc,Editor:Mc,defaultColumns:2,defaultRows:5},Hc=a(176),Yc=a.n(Hc),Qc=a(198),Kc=a.n(Qc);a(1275);function Gc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $c(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Jc(e){var t=e.data,a=Gc(Object(r.useState)(0),2),o=a[0],i=a[1];if(!t||!t.rows||0===t.rows.length)return null;var s=Object(l.mapValues)(Object(l.keyBy)(t.columns,"name"),"type"),c=t.columns.map(e=>e.name),u=t.rows[o];return n.a.createElement("div",{className:"details-viz"},n.a.createElement(Yc.a,{size:"small",column:1,bordered:!0},Object(l.map)(c,e=>{return n.a.createElement(Yc.a.Item,{key:e,label:e},(t=u[e],a=s[e],r={date:vo.dateFormat,datetime:vo.dateTimeFormat},"date"!==a&&"datetime"!==a||!Ea.a.isMoment(t)?""+t:t.format(r[a])));var t,a,r})),t.rows.length>1&&n.a.createElement("div",{className:"paginator-container"},n.a.createElement(Kc.a,{showSizeChanger:!1,current:o+1,defaultPageSize:1,total:t.rows.length,onChange:e=>i(e-1)})))}function Xc(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Zc(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xc(Object(a),!0).forEach((function(t){eu(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xc(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function eu(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Jc.propTypes=qr;var tu={},au={type:"DETAILS",name:"<记录明细显示>",getOptions:e=>Zc(Zc({},tu),e),Renderer:Jc,defaultColumns:2,defaultRows:2},ru={stepCol:{colName:null,displayAs:"Steps"},valueCol:{colName:null,displayAs:"Value"},autoSort:!0,sortKeyCol:{colName:null,reverse:!1},itemsLimit:100,percentValuesRange:{min:.01,max:1e3},numberFormat:"0,0[.]00",percentFormat:"0[.]00%"};function nu(e){if(Ea.a.isMoment(e)){var t=vo.dateTimeFormat||"DD/MM/YYYY HH:mm";return e.format(t)}return Object(l.toString)(e)}a(1279);function ou(e){var t=e.color,a=e.value,r=e.align,o=e.className,i=e.children;return n.a.createElement("div",{className:me()("funnel-bar","funnel-bar-".concat(r),o)},n.a.createElement("div",{className:"funnel-bar-value",style:{backgroundColor:t,width:a+"%"}}),n.a.createElement("div",{className:"funnel-bar-label"},i))}ou.defaultProps={color:"#dadada",value:0,align:"left",className:null,children:null};a(1280);function iu(e){var t=e.data,a=e.options,o=Object(r.useMemo)(()=>function(e,t){if(0===e.length||!t.stepCol.colName||!t.valueCol.colName)return[];e=[...e],t.sortKeyCol.colName&&(e=Object(l.sortBy)(e,t.sortKeyCol.colName)),t.sortKeyCol.reverse&&(e=e.reverse());var a=Object(l.map)(e,e=>({step:nu(e[t.stepCol.colName]),value:parseFloat(e[t.valueCol.colName])||0})),r=Object(l.maxBy)(a,e=>e.value).value;return a.forEach((e,t)=>{e.pctMax=e.value/r*100,e.pctPrevious=0===t||e.value===a[t-1].value?100:e.value/a[t-1].value*100}),a.slice(0,t.itemsLimit)}(t.rows,a),[t,a]),i=Object(r.useMemo)(()=>Math.trunc(Math.random()*Number.MAX_SAFE_INTEGER).toString(36)+":",[o]),s=Object(r.useMemo)(()=>Oi(a.numberFormat),[a.numberFormat]),c=Object(r.useMemo)(()=>{var e=Oi(a.percentFormat);return t=>t<a.percentValuesRange.min?"<".concat(e(a.percentValuesRange.min)):t>a.percentValuesRange.max?">".concat(e(a.percentValuesRange.max)):e(t)},[a.percentFormat,a.percentValuesRange]),u=Object(r.useMemo)(()=>{if(0===o.length)return[];var e=Object(l.maxBy)(o,e=>isFinite(e.pctPrevious)?e.pctPrevious:0).pctPrevious;return[{title:a.stepCol.displayAs,dataIndex:"step",width:"25%",className:"text-ellipsis",render:e=>n.a.createElement(he.a,{title:e,mouseEnterDelay:0,mouseLeaveDelay:0},e)},{title:a.valueCol.displayAs,dataIndex:"value",width:"45%",align:"center",render:(e,t)=>n.a.createElement(ou,{align:"center",color:ri.Cyan,value:t.pctMax},s(e))},{title:"% Max",dataIndex:"pctMax",width:"15%",align:"center",render:e=>c(e)},{title:"% Previous",dataIndex:"pctPrevious",width:"15%",align:"center",render:t=>n.a.createElement(ou,{className:"funnel-percent-column",value:t/e*100},c(t))}]},[a.stepCol.displayAs,a.valueCol.displayAs,o,s,c]);return 0===o.length?null:n.a.createElement("div",{className:"funnel-visualization-container"},n.a.createElement(Il.a,{columns:u,dataSource:o,rowKey:(e,t)=>i+t,pagination:!1}))}function lu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return su(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return su(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function su(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function cu(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>Object(l.map)(a.columns,e=>e.name),[a]),s=lu(Object(Sl.a)(o,200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Step Column","data-test":"Funnel.StepColumn",placeholder:"Choose column...",defaultValue:t.stepCol.colName||void 0,onChange:e=>o({stepCol:{colName:e||null}})},Object(l.map)(i,e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Funnel.StepColumn.".concat(e)},e)))),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Step Column Title","data-test":"Funnel.StepColumnTitle",defaultValue:t.stepCol.displayAs,onChange:e=>s({stepCol:{displayAs:e.target.value}})})),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Value Column","data-test":"Funnel.ValueColumn",placeholder:"Choose column...",defaultValue:t.valueCol.colName||void 0,onChange:e=>o({valueCol:{colName:e||null}})},Object(l.map)(i,e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Funnel.ValueColumn.".concat(e)},e)))),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:"Value Column Title","data-test":"Funnel.ValueColumnTitle",defaultValue:t.valueCol.displayAs,onChange:e=>s({valueCol:{displayAs:e.target.value}})})),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Funnel.CustomSort",checked:!t.autoSort,onChange:e=>o({autoSort:!e.target.checked})},"Custom Sorting")),!t.autoSort&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Sort Column","data-test":"Funnel.SortColumn",allowClear:!0,placeholder:"Choose column...",defaultValue:t.sortKeyCol.colName||void 0,onChange:e=>o({sortKeyCol:{colName:e||null}})},Object(l.map)(i,e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Funnel.SortColumn.".concat(e)},e)))),n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:"Sort Order","data-test":"Funnel.SortDirection",disabled:!t.sortKeyCol.colName,defaultValue:t.sortKeyCol.reverse?"desc":"asc",onChange:e=>o({sortKeyCol:{reverse:"desc"===e}})},n.a.createElement(Eo.Option,{value:"asc","data-test":"Funnel.SortDirection.Ascending"},"ascending"),n.a.createElement(Eo.Option,{value:"desc","data-test":"Funnel.SortDirection.Descending"},"descending")))))}function uu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return du(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return du(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function du(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function mu(e){var t=e.options,a=e.onOptionsChange,r=uu(Object(Sl.a)(a,200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:n.a.createElement(n.a.Fragment,null,window.W_L.Number_format,n.a.createElement(_o.NumberFormatSpecs,null)),"data-test":"Funnel.NumberFormat",defaultValue:t.numberFormat,onChange:e=>r({numberFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:n.a.createElement(n.a.Fragment,null,window.W_L.Percent_Values_Format,n.a.createElement(_o.NumberFormatSpecs,null)),"data-test":"Funnel.PercentFormat",defaultValue:t.percentFormat,onChange:e=>r({percentFormat:e.target.value})})),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:window.W_L.Items_Count_Limit,"data-test":"Funnel.ItemsLimit",min:2,defaultValue:t.itemsLimit,onChange:e=>r({itemsLimit:e})})),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:window.W_L.Min_Percent_Value,"data-test":"Funnel.PercentRangeMin",min:0,defaultValue:t.percentValuesRange.min,onChange:e=>r({percentValuesRange:{min:e}})})),n.a.createElement(io,null,n.a.createElement(So,{layout:"horizontal",label:window.W_L.Max_Percent_Value,"data-test":"Funnel.PercentRangeMax",min:0,defaultValue:t.percentValuesRange.max,onChange:e=>r({percentValuesRange:{max:e}})})))}iu.propTypes=qr,cu.propTypes=Dr,mu.propTypes=Dr;var pu={type:"FUNNEL",name:"漏斗分析(Funnel)",getOptions:function(e,t){var a=t.columns;e=Object(l.merge)({},ru,e);var r=Object(l.map)(a,e=>e.name);return Object(l.includes)(r,e.stepCol.colName)||(e.stepCol.colName=null),Object(l.includes)(r,e.valueCol.colName)||(e.valueCol.colName=null),Object(l.includes)(r,e.sortKeyCol.colName)||(e.sortKeyCol.colName=null),Object(l.isFinite)(e.itemsLimit)||(e.itemsLimit=ru.itemsLimit),e.itemsLimit<2&&(e.itemsLimit=2),e.autoSort&&(e.sortKeyCol.colName=e.valueCol.colName,e.sortKeyCol.reverse=!0),e},Renderer:iu,Editor:ao([{key:"General",title:window.W_L.general,component:cu},{key:"Appearance",title:window.W_L.exterior,component:mu}]),defaultRows:10},fu={latColName:"lat",lonColName:"lon",classify:null,groups:{},mapTileUrl:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",clusterMarkers:!0,customizeMarkers:!1,iconShape:"marker",iconFont:"circle",foregroundColor:"#ffffff",backgroundColor:"#356AFF",borderColor:"#356AFF",bounds:null,tooltip:{enabled:!1,template:""},popup:{enabled:!0,template:""}};function gu(e,t){var a=Lr.a.scale.category10(),r=t.classify,n=t.latColName,o=t.lonColName,i=r?Object(l.groupBy)(e.rows,r):{All:e.rows};return Object(l.filter)(Object(l.map)(i,(e,r)=>{var i=Object(l.filter)(Object(l.map)(e,e=>{var t=e[n],a=e[o];return Object(l.isNil)(t)||Object(l.isNil)(a)?null:{lat:t,lon:a,row:Object(l.omit)(e,[n,o])}}));if(0===i.length)return null;var s=Object(l.extend)({},t.groups[r],{name:r,points:i});return Object(l.isNil)(s.color)&&(s.color=a(r)),s}))}a(1281),a(1282),a(1283),a(1284),a(1285);var bu=a(673),hu=a.n(bu),yu=a(674),vu=a.n(yu),wu=a(675),Ou=a.n(wu);Ss.a.Icon.Default.mergeOptions({iconUrl:hu.a,iconRetinaUrl:vu.a,shadowUrl:Ou.a}),delete Ss.a.Icon.Default.prototype._getIconUrl;var _u={marker:[14,32],circle:[10,10],rectangle:[11,11],"circle-dot":[1,2],"rectangle-dot":[1,2],doughnut:[8,8]},Eu={rectangle:[0,-3],circle:[1,-3]};function ju(e,t){var a=t.color,r=t.points,n=e.classify,o=e.clusterMarkers,i=e.customizeMarkers,s=o?function(e){return Ss.a.markerClusterGroup({iconCreateFunction:t=>Ss.a.markerClusterIcon({color:e,html:t.getChildCount()})})}(a):Ss.a.featureGroup();return Object(l.each)(r,t=>{var r,o=t.lat,c=t.lon,u=t.row,d=Object(l.clone)(u);d[e.latColName]=o,d[e.lonColName]=c,r=n?((e,t,a)=>Ss.a.circleMarker([e,t],{fillColor:a,fillOpacity:.9,stroke:!1}))(o,c,a):i?function(e,t,a){var r=a.iconShape,n=a.iconFont,o=a.foregroundColor,i=a.backgroundColor,l=a.borderColor,s=Ss.a.BeautifyIcon.icon({iconShape:r,icon:n,iconSize:"rectangle"===r&&[22,22],iconAnchor:_u[r],popupAnchor:Eu[r],prefix:"fa",textColor:o,backgroundColor:i,borderColor:l});return Ss.a.marker([e,t],{icon:s})}(o,c,e):Ss.a.marker([o,c]),e.tooltip.enabled&&(""!==e.tooltip.template?r.bindTooltip(ke(_i(e.tooltip.template,d))):r.bindTooltip("\n          <strong>".concat(o,", ").concat(c,"</strong>\n        "))),e.popup.enabled&&(""!==e.popup.template?r.bindPopup(ke(_i(e.popup.template,d))):r.bindPopup('\n          <ul style="list-style-type: none; padding-left: 0">\n            <li><strong>'.concat(o,", ").concat(c,"</strong>\n            ").concat(Object(l.map)(u,(e,t)=>"<li>".concat(t,": ").concat(e,"</li>")).join(""),"\n          </ul>\n        "))),s.addLayer(r)}),s}function Su(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Cu(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Cu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cu(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function xu(e){var t,a,o,i,s=e.data,c=e.options,u=e.onOptionsChange,d=Su(Object(r.useState)(null),2),m=d[0],p=d[1],f=(t=()=>Object(l.omit)(c,["bounds"]),a=[c],o=Object(r.useRef)(),i=Object(r.useMemo)(t,a),Object(l.isEqual)(i,o.current)||(o.current=i),o.current),g=Object(r.useMemo)(()=>gu(s,f),[s,f]),b=Su(Object(r.useState)(null),2),h=b[0],y=b[1];return Object(r.useEffect)(()=>{if(m){var e=function(e){var t=Ss.a.map(e,{center:[0,0],zoom:1,scrollWheelZoom:!1,fullscreenControl:!0}),a=Ss.a.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t),r=Ss.a.featureGroup().addTo(t),n=Ss.a.control.layers().addTo(t),o=()=>{},i=!1,s=()=>{o(t.getBounds())};t.on("focus",()=>{i=!0,t.on("moveend",s)}),t.on("blur",()=>{t.off("moveend",s),i=!1});var c=Ar(e,()=>{t.invalidateSize(!1)});return{get onBoundsChange(){return o},set onBoundsChange(e){o=Object(l.isFunction)(e)?e:()=>{}},updateLayers:function(e,o){a.setUrl(o.mapTileUrl),r.eachLayer(e=>{r.removeLayer(e),n.removeLayer(e)}),Object(l.each)(e,e=>{var t=ju(o,e);r.addLayer(t),n.addOverlay(t,e.name)}),e.length>0?n.addTo(t):n.remove()},updateBounds:function(e){i||(e=e?Ss.a.latLngBounds([e._southWest.lat,e._southWest.lng],[e._northEast.lat,e._northEast.lng]):r.getBounds()).isValid()&&t.fitBounds(e,{animate:!1,duration:0})},destroy(){c(),t.remove()}}}(m);return y(e),()=>{e.destroy()}}},[m]),Object(r.useEffect)(()=>{h&&h.updateLayers(g,f)},[h,g,f]),Object(r.useEffect)(()=>{h&&h.updateBounds(c.bounds)},[h,c.bounds]),Object(r.useEffect)(()=>{h&&u&&(h.onBoundsChange=e=>{u(Object(l.merge)({},c,{bounds:e}))})},[h,c,u]),n.a.createElement("div",{className:"map-visualization-container",ref:p})}function Pu(e,t){return Object(l.filter)([e,...t],e=>!Object(l.isNil)(e))}function Lu(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>Object(l.difference)(Object(l.map)(a.columns,e=>e.name),[t.latColName,t.lonColName,t.classify]),[a,t.latColName,t.lonColName,t.classify]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.Latitude_Column_Name,"data-test":"Map.Editor.LatitudeColumnName",value:t.latColName,onChange:e=>o({latColName:e})},Object(l.map)(Pu(t.latColName,i),e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Map.Editor.LatitudeColumnName."+e},e)))),n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.Longitude_Column_Name,"data-test":"Map.Editor.LongitudeColumnName",value:t.lonColName,onChange:e=>o({lonColName:e})},Object(l.map)(Pu(t.lonColName,i),e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Map.Editor.LongitudeColumnName."+e},e)))),n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.group_by,"data-test":"Map.Editor.GroupBy",allowClear:!0,placeholder:"none",value:t.classify||void 0,onChange:e=>o({classify:e||null})},Object(l.map)(Pu(t.classify,i),e=>n.a.createElement(Eo.Option,{key:e,"data-test":"Map.Editor.GroupBy."+e},e)))))}function ku(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Nu(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Au(e){var t=e.options,a=e.data,o=e.onOptionsChange,i=Object(r.useMemo)(()=>Object(l.map)(gu(a,t),e=>{var a=e.name;return{name:a,color:(t.groups[a]||{}).color||null}}),[a,t]),s=Object(r.useMemo)(()=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(a),!0).forEach((function(t){Nu(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ku(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({Automatic:null},ri),[]),c=Object(r.useCallback)((e,t,a)=>{o({groups:{[e]:{[t]:a}}})},[o]),u=[{title:"Group",dataIndex:"name"},{title:"Color",dataIndex:"color",width:"1%",render:(e,t)=>n.a.createElement(Pn,{interactive:!0,presetColors:s,placement:"topRight",color:t.color,triggerProps:{"data-test":"Map.Editor.Groups.".concat(t.name,".Color")},onChange:e=>c(t.name,"color",e),addonAfter:n.a.createElement(Pn.Label,{color:t.color,presetColors:s})})}];return n.a.createElement(Il.a,{columns:u,dataSource:i,rowKey:"name",showHeader:!1,pagination:!1})}function Tu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wu(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Wu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Iu(){return n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0},n.a.createElement("div",{style:{paddingBottom:5}},window.W_L.Also_all_query_result_columns_can_be_referenced," ",n.a.createElement("code",null,"{{ column_name }}")," syntax."),n.a.createElement("div",{style:{paddingBottom:5}},window.W_L.Leave_empty_to_use_default_value))}function qu(e){var t=e.options,a=e.onOptionsChange,r=Tu(Object(Sl.a)(a,200),1)[0],o=n.a.createElement(Iu,null);return n.a.createElement("div",{className:"map-visualization-editor-format-settings"},n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Map.Editor.TooltipEnabled",checked:t.tooltip.enabled,onChange:e=>a({tooltip:{enabled:e.target.checked}})},window.W_L.Show_tooltip)),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Tooltip_template," ",o),"data-test":"Map.Editor.TooltipTemplate",disabled:!t.tooltip.enabled,placeholder:window.W_L.default_template,defaultValue:t.tooltip.template,onChange:e=>r({tooltip:{template:e.target.value}})})),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Map.Editor.PopupEnabled",checked:t.popup.enabled,onChange:e=>a({popup:{enabled:e.target.checked}})},window.W_L.Show_popup)),n.a.createElement(io,null,n.a.createElement(go,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Popup_template," ",o),"data-test":"Map.Editor.PopupTemplate",disabled:!t.popup.enabled,rows:4,placeholder:window.W_L.default_template,defaultValue:t.popup.template,onChange:e=>r({popup:{template:e.target.value}})})))}function Du(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ru(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ru(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ru(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Mu(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function zu(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Ss.a.MarkerClusterIcon=Ss.a.DivIcon.extend({options:{color:null,className:"marker-cluster",iconSize:new Ss.a.Point(40,40)},createIcon(){for(var e=an()(this.options.color),t=rn(e),a=e.alpha(.4).css(),r=e.alpha(.8).css(),n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var s=Ss.a.DivIcon.prototype.createIcon.call(this,...o);return s.innerHTML='\n      <div style="background: '.concat(r,'">\n        <span style="color: ').concat(t,'">').concat(Object(l.toString)(this.options.html),"</span>\n      </div>\n    "),s.style.background=a,s}}),Ss.a.markerClusterIcon=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return new Ss.a.MarkerClusterIcon(...t)},xu.propTypes=qr,Lu.propTypes=Dr,Au.propTypes=Dr,qu.propTypes=Dr;var Fu=[{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"OpenStreetMap BW",url:"//{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png"},{name:"OpenStreetMap DE",url:"//{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png"},{name:"OpenStreetMap FR",url:"//{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png"},{name:"OpenStreetMap Hot",url:"//{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"},{name:"Thunderforest",url:"//{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png"},{name:"Thunderforest Spinal",url:"//{s}.tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png"},{name:"OpenMapSurfer",url:"//korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}"},{name:"Stamen Toner",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"},{name:"Stamen Toner Background",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png"},{name:"Stamen Toner Lite",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png"},{name:"OpenTopoMap",url:"//{s}.tile.opentopomap.org/{z}/{x}/{y}.png"}],Vu=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Mu(Object(a),!0).forEach((function(t){zu(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Mu(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({White:"#ffffff"},ri);function Uu(e){var t=e.options,a=e.onOptionsChange,o=Du(Object(Sl.a)(a,200),1)[0],i=Object(r.useMemo)(()=>function(e){switch(e){case"doughnut":return{showIcon:!1,showBackgroundColor:!0,showBorderColor:!0};case"circle-dot":case"rectangle-dot":return{showIcon:!1,showBackgroundColor:!1,showBorderColor:!0};default:return{showIcon:!0,showBackgroundColor:!0,showBorderColor:!0}}}(t.iconShape),[t.iconShape]),s=i.showIcon,c=i.showBackgroundColor,u=i.showBorderColor,d=Object(l.isNil)(t.classify);return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.Map_Tiles,"data-test":"Map.Editor.Tiles",value:t.mapTileUrl,onChange:e=>a({mapTileUrl:e})},Object(l.map)(Fu,e=>{var t=e.name,a=e.url;return n.a.createElement(Eo.Option,{key:a,"data-test":"Map.Editor.Tiles."+t},t)}))),n.a.createElement(io.Title,null,window.W_L.Markers),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Map.Editor.ClusterMarkers",defaultChecked:t.clusterMarkers,onChange:e=>a({clusterMarkers:e.target.checked})},window.W_L.Cluster_Markers)),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Map.Editor.CustomizeMarkers",disabled:!d,defaultChecked:t.customizeMarkers,onChange:e=>a({customizeMarkers:e.target.checked})},window.W_L.Override_default_style),!d&&n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0},"Custom marker styles are not available",n.a.createElement("br",null),"when ",n.a.createElement("b",null,"Group By")," column selected.")),d&&t.customizeMarkers&&n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{layout:"horizontal",label:window.W_L.Shape,"data-test":"Map.Editor.MarkerShape",value:t.iconShape,onChange:e=>a({iconShape:e})},n.a.createElement(Eo.Option,{key:"marker","data-test":"Map.Editor.MarkerShape.marker"},window.W_L.Markers," + ",window.W_L.icon),n.a.createElement(Eo.Option,{key:"doughnut","data-test":"Map.Editor.MarkerShape.doughnut"},window.W_L.Circle),n.a.createElement(Eo.Option,{key:"circle-dot","data-test":"Map.Editor.MarkerShape.circle-dot"},window.W_L.Circle_Dot),n.a.createElement(Eo.Option,{key:"circle","data-test":"Map.Editor.MarkerShape.circle"},window.W_L.Circle," + ",window.W_L.icon),n.a.createElement(Eo.Option,{key:"rectangle-dot","data-test":"Map.Editor.MarkerShape.rectangle-dot"},window.W_L.Square_Dot),n.a.createElement(Eo.Option,{key:"rectangle","data-test":"Map.Editor.MarkerShape.rectangle"},window.W_L.Square," + ",window.W_L.icon))),s&&n.a.createElement(io,null,n.a.createElement(jo,{layout:"horizontal",label:n.a.createElement(n.a.Fragment,null,window.W_L.icon,n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0},n.a.createElement("div",{style:{marginBottom:5}},window.W_L.Enter_an_icon_name_from," ",n.a.createElement("a",{href:"https://fontawesome.com/v4.7.0/icons/",target:"_blank",rel:"noopener noreferrer"},"Font-Awesome 4.7")),n.a.createElement("div",{style:{marginBottom:5}},window.W_L.Examples,"：",n.a.createElement("code",null,"check"),", ",n.a.createElement("code",null,"times-circle"),", ",n.a.createElement("code",null,"flag")),n.a.createElement("div",null,window.W_L.Leave_blank_to_remove))),"data-test":"Map.Editor.MarkerIcon",defaultValue:t.iconFont,onChange:e=>o({iconFont:e.target.value})})),s&&n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.Icon_Color,interactive:!0,presetColors:Vu,placement:"topRight",color:t.foregroundColor,triggerProps:{"data-test":"Map.Editor.MarkerIconColor"},onChange:e=>a({foregroundColor:e}),addonAfter:n.a.createElement(Co.Label,{color:t.foregroundColor,presetColors:Vu})})),c&&n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.Background_Color,interactive:!0,presetColors:Vu,placement:"topRight",color:t.backgroundColor,triggerProps:{"data-test":"Map.Editor.MarkerBackgroundColor"},onChange:e=>a({backgroundColor:e}),addonAfter:n.a.createElement(Co.Label,{color:t.backgroundColor,presetColors:Vu})})),u&&n.a.createElement(io,null,n.a.createElement(Co,{layout:"horizontal",label:window.W_L.Borders_Color,interactive:!0,presetColors:Vu,placement:"topRight",color:t.borderColor,triggerProps:{"data-test":"Map.Editor.MarkerBorderColor"},onChange:e=>a({borderColor:e}),addonAfter:n.a.createElement(Co.Label,{color:t.borderColor,presetColors:Vu})}))))}Uu.propTypes=Dr;var Bu={type:"MAP",name:"地理标记(Map Markers)",getOptions:function(e){return(e=Object(l.merge)({},fu,e)).mapTileUrl=e.mapTileUrl||fu.mapTileUrl,"none"===e.classify&&(e.classify=null),e},Renderer:xu,Editor:ao([{key:"General",title:window.W_L.general,component:Lu},{key:"Groups",title:window.W_L.role,component:Au},{key:"Format",title:window.W_L.formatting,component:qu},{key:"Style",title:window.W_L.style,component:Uu}]),defaultColumns:3,defaultRows:8,minColumns:2},Hu=a(676),Yu=a.n(Hu);function Qu(e){if(!e)return"";var t=Ea()(e);return t.isValid()?t.format(vo.dateTimeFormat):"-"}function Ku(e){if(!e)return"";var t=Ea()(e);return t.isValid()?t.format(vo.dateFormat):"-"}a(1293),a(1294);function Gu(){return(Gu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function $u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ju(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$u(Object(a),!0).forEach((function(t){Xu(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Xu(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Zu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ed(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ed(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var td=["rows","cols","vals","aggregatorName","valueFilter","sorters","rowOrder","colOrder","derivedAttributes","rendererName","hiddenAttributes","hiddenFromAggregators","hiddenFromDragDrop","menuLimit","unusedOrientationCutoff","controls","rendererOptions"];function ad(e){var t=e.rows,a=e.columns;return Object(l.map)(t,e=>Object(l.mapValues)(e,(e,t)=>function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ea.a.isMoment(e)?"date"===t?Ku(e):Qu(e):"boolean"==typeof e?e.toString():e}(e,Object(l.find)(a,{name:t}).type)))}function rd(e){var t=e.data,a=e.options,o=e.onOptionsChange,i=Zu(Object(r.useState)(Ju({},a)),2),s=i[0],c=i[1],u=Object(r.useMemo)(()=>ad(t),[t]);Object(r.useEffect)(()=>{c(Ju({},a))},[a]);var d=Object(l.get)(a,"controls.enabled"),m=!Object(l.get)(a,"rendererOptions.table.rowTotals"),p=!Object(l.get)(a,"rendererOptions.table.colTotals");return n.a.createElement("div",{className:"pivot-table-visualization-container","data-hide-controls":d||null,"data-hide-row-totals":m||null,"data-hide-column-totals":p||null,"data-test":"PivotTableVisualization"},n.a.createElement(Yu.a,Gu({},Object(l.pick)(s,td),{data:u,onChange:e=>{var t=Object(l.pick)(e,td);c(Ju({},t)),o(t)}})))}function nd(e){var t=e.options,a=e.onOptionsChange,r=e=>{a(Object(l.merge)({},t,e))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(mo,{"data-test":"PivotEditor.HideControls",id:"pivot-show-controls",defaultChecked:!t.controls.enabled,onChange:e=>r({controls:{enabled:!e}})},window.W_L.Show_Pivot_Controls)),n.a.createElement(io,null,n.a.createElement(mo,{id:"pivot-show-row-totals",defaultChecked:t.rendererOptions.table.rowTotals,onChange:e=>r({rendererOptions:{table:{rowTotals:e}}})},window.W_L.Show_Row_Totals)),n.a.createElement(io,null,n.a.createElement(mo,{id:"pivot-show-column-totals",defaultChecked:t.rendererOptions.table.colTotals,onChange:e=>r({rendererOptions:{table:{colTotals:e}}})},window.W_L.Show_Column_Totals)))}rd.propTypes=qr,rd.defaultProps={onOptionsChange:()=>{}},nd.propTypes=Dr;var od={controls:{enabled:!1},rendererOptions:{table:{colTotals:!0,rowTotals:!0}}},id={type:"PIVOT",name:"数据透视表(Pivot Table)",getOptions:e=>Object(l.merge)({},od,e),Renderer:rd,Editor:nd,defaultRows:10,defaultColumns:3,minColumns:2};function ld(e){return e.y+e.dy/2}function sd(e){return e.value}var cd=function(){var e={},t=24,a=8,r=[1,1],n=[],o=[];function i(){var e,a,o=n,i=0;function l(a){a.x=i,a.dx=t,a.sourceLinks.forEach(t=>{e.indexOf(t.target)<0&&e.push(t.target)})}for(;o.length;)e=[],o.forEach(l),o=e,i+=1;!function(e){n.forEach(t=>{t.sourceLinks.length||(t.x=e-1)})}(i),i=Math.max(Lr.a.max(n,e=>e.x),2),a=(r[0]-t)/(i-1),n.forEach(e=>{e.x*=a})}function l(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}n.forEach(a=>{a.sourceLinks.sort(t),a.targetLinks.sort(e)}),n.forEach(e=>{var t=0,a=0;e.sourceLinks.forEach(e=>{e.sy=t,t+=e.dy}),e.targetLinks.forEach(e=>{e.ty=a,a+=e.dy})})}return e.nodeWidth=function(a){return arguments.length?(t=+a,e):t},e.nodePadding=function(t){return arguments.length?(a=+t,e):a},e.nodes=function(t){return arguments.length?(n=t,e):n},e.links=function(t){return arguments.length?(o=t,e):o},e.size=function(t){return arguments.length?(r=t,e):r},e.layout=function(t){return n.forEach(e=>{e.sourceLinks=[],e.targetLinks=[]}),o.forEach(e=>{var t=e.source,a=e.target;"number"==typeof t&&(t=e.source=n[e.source]),"number"==typeof a&&(a=e.target=n[e.target]),t.sourceLinks.push(e),a.targetLinks.push(e)}),n.forEach(e=>{e.value=Math.max(Lr.a.sum(e.sourceLinks,sd),Lr.a.sum(e.targetLinks,sd))}),i(),function(e){var t,i=Lr.a.nest().key(e=>e.x).sortKeys(Lr.a.ascending).entries(n).map(e=>e.values);function l(e){function t(e){return ld(e.source)*e.value}i.forEach(a=>{a.forEach(a=>{if(a.targetLinks.length){var r=Lr.a.sum(a.targetLinks,t)/Lr.a.sum(a.targetLinks,sd);a.y+=(r-ld(a))*e}})})}function s(){i.forEach(e=>{var t,n,o,i=e.length,l=0;for(e.sort(d),o=0;o<i;++o)(n=l-(t=e[o]).y)>0&&(t.y+=n),l=t.y+t.dy+a;if((n=l-a-r[1])>0)for(l=t.y-=n,o=i-2;o>=0;--o)(n=(t=e[o]).y+t.dy+a-l)>0&&(t.y-=n),l=t.y})}t=Lr.a.min(i,e=>(r[1]-(e.length-1)*a)/Lr.a.sum(e,sd)),i.forEach(e=>{e.forEach((e,a)=>{e.y=a,e.dy=e.value*t})}),o.forEach(e=>{e.dy=e.value*t}),s();for(var c=1;e>0;e-=1)u(c*=.99),s(),l(c),s();function u(e){function t(e){return ld(e.target)*e.value}i.slice().reverse().forEach(a=>{a.forEach(a=>{if(a.sourceLinks.length){var r=Lr.a.sum(a.sourceLinks,t)/Lr.a.sum(a.sourceLinks,sd);a.y+=(r-ld(a))*e}})})}function d(e,t){return e.y-t.y}}(t),l(),e},e.relayout=function(){return l(),e},e.link=function(){var e=.5;function t(t){var a=t.source.x+t.source.dx,r=t.target.x,n=Lr.a.interpolateNumber(a,r),o=n(e),i=n(1-e),l=t.source.y+t.sy+t.dy/2,s=t.target.y+t.ty+t.dy/2;return"M".concat(a,",").concat(l,"C").concat(o,",").concat(l," ").concat(i,",").concat(s," ").concat(r,",").concat(s)}return t.curvature=a=>arguments.length?(e=+a,t):e,t},e};function ud(e){var t={},a={},r=[],n=Object(l.sortBy)(Object(l.filter)(Object(l.keys)(e[0]),e=>"value"!==e),l.identity);function o(e,a){e=function(e){return Object(l.isNil)(e)?"Exit":""+e}(e);var n="".concat(e,":").concat(String(a)),o=t[n];return o||((o={name:e}).id=r.push(o)-1,t[n]=o),o}function i(e,t,r,n){if(""!==e&&e||!(n>1)){var i=o(e,n),l=o(t,n+1);(function(e,t){var r=a[[e,t]];return r||(r={target:t,source:e,value:0},a[[e,t]]=r),r}(i.id,l.id)).value+=parseInt(r,10)}}e.forEach(e=>{i(e[n[0]],e[n[1]],e.value||0,1),i(e[n[1]],e[n[2]],e.value||0,2),i(e[n[2]],e[n[3]],e.value||0,3),i(e[n[3]],e[n[4]],e.value||0,4),i(e[n[4]],null,e.value||0,5)});var s=Lr.a.scale.category20();return{nodes:Object(l.map)(r,e=>Object(l.extend)(e,{color:s(e.name.replace(/ .*/,""))})),links:Object(l.values)(a)}}function dd(e){var t;if(e.rows=(t=e.rows,Object(l.map)(t,e=>Object(l.mapValues)(e,e=>!e||Object(l.isNumber)(e)||Object(l.isNaN)(parseFloat(e))?e:parseFloat(e)))),!function(e){return!(!e||!Object(l.find)(e.columns,e=>"value"===e.name))&&Object(l.every)(e.rows,e=>Object(l.every)(e,e=>!(e&&!Object(l.isString)(e))||isFinite(e)))}(e))return e=>{Lr.a.select(e).selectAll("*").remove()};e=ud(e.rows);var a=e=>Lr.a.format(",.0f")(e);return t=>{Lr.a.select(t).selectAll("*").remove();var r=10,n=10,o=10,i=10,s=t.offsetWidth-i-n,c=t.offsetHeight-r-o;if(!(s<=0||c<=0)){var u=Lr.a.select(t).append("svg").attr("class","sankey").attr("width",s+i+n).attr("height",c+r+o).append("g").attr("transform","translate(".concat(i,",").concat(r,")")),d=cd().nodeWidth(15).nodePadding(10).size([s,c]),m=d.link();d.nodes(e.nodes).links(e.links).layout(0),function(e,t){Lr.a.nest().key(e=>e.x).entries(t.nodes).map(e=>e.values).forEach(t=>{t=Object(l.filter)(Object(l.sortBy)(t,e=>-e.value),e=>"Exit"!==e.name);var a=Lr.a.sum(t,e=>e.dy),r=(e-a)/t.length;Object(l.reduce)(t,(e,t)=>(t.y=e,e+t.dy+r),0)})}(c,e),d.relayout();var p=u.append("g").selectAll(".link").data(e.links).enter().append("path").filter(e=>"Exit"!==e.target.name).attr("class","link").attr("d",m).style("stroke-width",e=>Math.max(1,e.dy)).sort((e,t)=>t.dy-e.dy);p.append("title").text(e=>"".concat(e.source.name," → ").concat(e.target.name,"\n").concat(a(e.value)));var f=u.append("g").selectAll(".node").data(e.nodes).enter().append("g").filter(e=>"Exit"!==e.name).attr("class","node").attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")"));f.on("mouseover",(function(e){var t=function(e){console.log(e);var t=[];return e.sourceLinks.forEach(e=>{t.push(e.target)}),e.targetLinks.forEach(e=>{t.push(e.source)}),t}(e);t=Object(l.map)(t,e=>e.id),f.filter(a=>a!==e&&!Object(l.includes)(t,a.id)).style("opacity",.2),p.filter(t=>!(Object(l.includes)(e.sourceLinks,t)||Object(l.includes)(e.targetLinks,t))).style("opacity",.2)})).on("mouseout",(function(){f.style("opacity",1),p.style("opacity",1)})),f.append("rect").attr("height",e=>e.dy).attr("width",d.nodeWidth()).style("fill",e=>e.color).style("stroke",e=>Lr.a.rgb(e.color).darker(2)).append("title").text(e=>"".concat(e.name,"\n").concat(a(e.value))),f.append("text").attr("x",-6).attr("y",e=>e.dy/2).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(e=>e.name).filter(e=>e.x<s/2).attr("x",6+d.nodeWidth()).attr("text-anchor","start")}}}a(1295);function md(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pd(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return pd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pd(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function fd(e){var t=e.data,a=md(Object(r.useState)(null),2),o=a[0],i=a[1],l=Object(r.useMemo)(()=>dd(t),[t]);return Object(r.useEffect)(()=>{if(o)return l(o),Ar(o,()=>{l(o)})},[o,l]),n.a.createElement("div",{className:"sankey-visualization-container",ref:i})}function gd(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function bd(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}fd.propTypes=qr;var hd={type:"SANKEY",name:"桑基图(Sankey)",getOptions:e=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?gd(Object(a),!0).forEach((function(t){bd(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gd(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),Renderer:fd,Editor:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,window.W_L.This_visualization_expects_the_query_result_to_have_rows_in_one_of_the_following_formats,"："),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("strong",null,"stage1")," - ",window.W_L.stage_1_value),n.a.createElement("li",null,n.a.createElement("strong",null,"stage2")," - ",window.W_L.stage_2_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"stage3")," - ",window.W_L.stage_3_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"stage4")," - ",window.W_L.stage_4_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"stage5")," - ",window.W_L.stage_5_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"value")," -",window.W_L.number_of_times_this_sequence_occurred)))},defaultRows:7},yd=Pr.scale.category10();function vd(e){return yd(e.name)}function wd(e){e=function(e){var t=Object(l.first)(e);return Object(l.every)(["sequence","stage","node","value"],e=>Object(l.has)(t,e))}(e)?function(e){var t=Object(l.groupBy)(e,"sequence");return Object(l.map)(t,e=>{var t=Object(l.sortBy)(e,"stage");return{size:e[0].value||0,sequence:e[0].sequence,nodes:Object(l.map)(t,e=>e.node)}})}(e):function(e){var t=Object(l.sortBy)(Object(l.filter)(Object(l.keys)(e[0]),e=>"value"!==e),l.identity);return Object(l.map)(e,(e,a)=>({size:e.value||0,sequence:a,nodes:Object(l.compact)(Object(l.map)(t,t=>e[t]))}))}(e);var t={name:"root",children:[]};return e.forEach(e=>{for(var a=e.nodes,r=parseInt(e.size,10),n=t,o=function(e){var t=n.children,o=a[e],i=e+1===a.length;t||(n.children=t=[],t.push({name:"<<<Exit>>>",size:n.size}));var s=Object(l.find)(t,e=>e.name===o);i&&s?(s.children=s.children||[],s.children.push({name:"<<<Exit>>>",size:r})):i?t.push({name:o,size:r}):(s||(s={name:o,children:[]},t.push(s)),n=s)},i=0;i<a.length;i+=1)o(i)}),t}function Od(e){return function(e){return e&&e.rows.length>0}(e)?(e=wd(e.rows),t=>{Pr.select(t).selectAll("*").remove();var a=t.clientWidth,r=t.offsetHeight,n={w:a/6,h:30,s:3,t:10},o=Math.min(a-n.h,r-n.h)/2-5;if(!(o<=0)){var i,l={top:o,bottom:50,left:o,right:0},s=0,c=Pr.layout.partition().size([2*Math.PI,o*o]).value(e=>e.size),u=Pr.svg.arc().startAngle(e=>e.x).endAngle(e=>e.x+e.dx).innerRadius(e=>Math.sqrt(e.y)).outerRadius(e=>Math.sqrt(e.y+e.dy)),d=Pr.select(t),m=d.append("div").classed("breadcrumbs-container",!0).append("svg").attr("width",a).attr("height",n.h).attr("fill","white").attr("font-weight",600),p=d.append("div"),f=p.append("div").classed("summary-container",!0),g=p.append("div").classed("sunburst-container",!0).append("svg").attr("width",2*o).attr("height",2*o).append("g").attr("transform","translate(".concat(l.left,",").concat(l.top,")")),b=m.append("text").classed("lastCrumb",!0),h=c.nodes(e).filter(e=>e.dx>.005&&"<<<Exit>>>"!==e.name),y=(i=[],h.forEach(e=>{-1===i.indexOf(e.name)&&i.push(e.name)}),i);yd.domain(y);var v=g.data([e]).selectAll("path").data(h).enter().append("path").classed("nodePath",!0).attr("display",e=>e.depth?null:"none").attr("d",u).attr("fill",vd).attr("opacity",1).attr("stroke","white").on("mouseover",O);d.on("click",(function(){g.selectAll("path").on("mouseover",null),g.selectAll("path").transition().duration(1e3).attr("opacity",1).each("end",(function(){Pr.select(this).on("mouseover",O)})),m.style("visibility","hidden"),f.style("visibility","hidden")})),s=v.node().__data__.value}function w(e,t){var a=[];return a.push("0,0"),a.push("".concat(n.w,",0")),a.push("".concat(n.w+n.t,",").concat(n.h/2)),a.push("".concat(n.w,",").concat(n.h)),a.push("0,".concat(n.h)),t>0&&a.push("".concat(n.t,",").concat(n.h/2)),a.join(" ")}function O(e){var t=(100*e.value/s).toPrecision(3),a="".concat(t,"%");t<1&&(a="< 1.0%");var r=function(e){for(var t=[],a=e;a.parent;)t.unshift(a),a=a.parent;return t}(e);!function(e,t){var a=m.selectAll("g").data(e,e=>e.name+e.depth),r=a.enter().append("g");r.append("polygon").classed("breadcrumbs-shape",!0).attr("points",w).attr("fill",vd),r.append("text").classed("breadcrumbs-text",!0).attr("x",(n.w+n.t)/2).attr("y",n.h/2).attr("dy","0.35em").attr("font-size","10px").attr("text-anchor","middle").text(e=>e.name),a.attr("transform",(e,t)=>"translate(".concat(t*(n.w+n.s),", 0)")),a.exit().remove(),b.attr("x",(e.length+.5)*(n.w+n.s)).attr("y",n.h/2).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","black").attr("font-weight",600).text(t)}(r,a),g.selectAll("path").attr("opacity",.3),g.selectAll("path").filter(e=>r.indexOf(e)>=0).attr("opacity",1),f.html("\n      <span>层级:".concat(e.depth,"</span>\n      <span class='percentage' style='font-size: 2em;'>").concat(a,"</span>\n      <span>").concat(e.value," / ").concat(s,"</span>\n    ")),f.style("visibility",""),m.style("visibility","")}}):e=>{Pr.select(e).selectAll("*").remove()}}a(1296);function _d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ed(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ed(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function jd(e){var t=e.data,a=_d(Object(r.useState)(null),2),o=a[0],i=a[1],l=Object(r.useMemo)(()=>Od(t),[t]);return Object(r.useEffect)(()=>{if(o)return l(o),Ar(o,()=>{l(o)})},[o,l]),n.a.createElement("div",{className:"sunburst-visualization-container",ref:i})}function Sd(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Cd(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}jd.propTypes=qr;var xd={type:"SUNBURST_SEQUENCE",name:"旭辉图(Sunburst Sequence)",getOptions:e=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Sd(Object(a),!0).forEach((function(t){Cd(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Sd(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),Renderer:jd,Editor:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,window.W_L.This_visualization_expects_the_query_result_to_have_rows_in_one_of_the_following_formats,"："),n.a.createElement(io,null,n.a.createElement("p",null,n.a.createElement("strong",null,window.W_L.Option,"1：")),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("strong",null,"sequence")," - ",window.W_L.sequence_id),n.a.createElement("li",null,n.a.createElement("strong",null,"stage")," - ",window.W_L.what_stage_in_sequence_this_is_1_2),n.a.createElement("li",null,n.a.createElement("strong",null,"node")," - ",window.W_L.stage_name),n.a.createElement("li",null,n.a.createElement("strong",null,"value")," - ",window.W_L.number_of_times_this_sequence_occurred))),n.a.createElement(io,null,n.a.createElement("p",null,n.a.createElement("strong",null,window.W_L.Option,"2：")),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("strong",null,"stage1")," - ",window.W_L.stage_1_value),n.a.createElement("li",null,n.a.createElement("strong",null,"stage2")," - ",window.W_L.stage_2_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"stage3")," - ",window.W_L.stage_3_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"stage4")," - ",window.W_L.stage_4_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"stage5")," - ",window.W_L.stage_5_value_or_null),n.a.createElement("li",null,n.a.createElement("strong",null,"value")," - ",window.W_L.number_of_times_this_sequence_occurred))))},defaultRows:7};function Pd(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ld(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pd(Object(a),!0).forEach((function(t){kd(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pd(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function kd(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Nd={itemsPerPage:25,paginationSize:"default"},Ad=["filter","multi-filter","multiFilter"];function Td(e){var t;if(-1!==e.indexOf("::"))t="::";else{if(-1===e.indexOf("__"))return e;t="__"}var a=e.split(t);return""===a[0]&&2===a.length?a[1]:s.a.includes(Ad,a[1])?a[0]:e}function Wd(e,t){var a=function(e){var t={integer:"number",float:"number",boolean:"boolean",date:"datetime",datetime:"datetime"};return s.a.map(e,(e,a)=>{return{name:e.name,type:e.type,displayAs:t[e.type]||"string",visible:!0,order:1e5+a,title:Td(e.name),allowSearch:!1,alignContent:(r=e.type,["integer","float","boolean","date","datetime"].indexOf(r)>=0?"right":"left"),allowHTML:!0,highlightLinks:!1};var r})}(e);return t=function(e,t){e=s.a.map(e,e=>e.name),t=s.a.map(t,e=>e.name),t=s.a.filter(t,t=>s.a.includes(e,t)),e=s.a.filter(e,e=>s.a.includes(t,e));for(var a=0;a<e.length;a+=1)if(t[a]!==e[a])return!0;return!1}(e,t)?s.a.fromPairs(s.a.map(t,(e,t)=>[e.name,s.a.extend({},e,{order:t})])):s.a.fromPairs(s.a.map(t,e=>[e.name,s.a.omit(e,"order")])),s.a.each(a,e=>s.a.extend(e,t[e.name])),s.a.sortBy(a,"order")}var Id=a(305),qd=a.n(Id);function Dd(e){var t=e.allowHTML&&e.highlightLinks?e=>{if(Object(l.isString)(e)){var t=vo.LinkComponent;e=e.replace(yi,(e,a,r)=>a+gi.a.renderToStaticMarkup(n.a.createElement(t,{href:r,target:"_blank",rel:"noopener noreferrer"},r)))}return Object(l.toString)(e)}:e=>Object(l.toString)(e);function a(a){return{text:t(a[e.name])}}function r(t){var r=a(t.row).text;return e.allowHTML?n.a.createElement(We,null,r):r}return r.prepareData=a,r}function Rd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Md(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Md(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Md(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function zd(e){var t=Oi(e.numberFormat);function a(a){return{text:t(a[e.name])}}function r(e){return a(e.row).text}return r.prepareData=a,r}function Fd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vd(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Vd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vd(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ud(e){var t=wi(e.dateTimeFormat);function a(a){return{text:t(a[e.name])}}function r(e){return a(e.row).text}return r.prepareData=a,r}function Bd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Hd(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Hd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hd(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Yd(e){var t=function(e){if(Object(l.isArray)(e)){if(e.length>=2)return t=>Object(l.isNil)(t)?"":""+e[t?1:0];if(1===e.length)return t=>t?e[0]:""}return e=>Object(l.isNil)(e)?"":e?"true":"false"}(e.booleanValues);function a(a){return{text:t(a[e.name])}}function r(e){return a(e.row).text}return r.prepareData=a,r}function Qd(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Kd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gd(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Gd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gd(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function $d(e){function t(t){t=Object(l.extend)({"@":t[e.name]},t);var a=Object(l.trim)(_i(e.linkUrlTemplate,t));if(""===a)return{};var r=Object(l.trim)(_i(e.linkTitleTemplate,t)),n=Object(l.trim)(_i(e.linkTextTemplate,t)),o={href:a,text:""!==n?n:a};return""!==r&&(o.title=r),e.linkOpenInNewTab&&(o.target="_blank"),o}function a(e){var a=t(e.row),r=a.text,o=Qd(a,["text"]);return n.a.createElement("a",o,r)}return a.prepareData=t,a}function Jd(){return(Jd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Xd(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Zd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return em(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return em(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function em(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function tm(e){function t(t){t=Object(l.extend)({"@":t[e.name]},t);var a=Object(l.trim)(_i(e.imageUrlTemplate,t));if(""===a)return{};var r=parseInt(_i(e.imageWidth,t),10),n=parseInt(_i(e.imageHeight,t),10),o=Object(l.trim)(_i(e.imageTitleTemplate,t)),i={src:a};return Number.isFinite(r)&&r>0&&(i.width=r),Number.isFinite(n)&&n>0&&(i.height=n),""!==o&&(i.text=o,i.title=o,i.alt=o),i}function a(e){var a=t(e.row),r=(a.text,Xd(a,["text"]));return n.a.createElement("img",Jd({alt:""},r))}return a.prepareData=t,a}Dd.friendlyName=window.W_L.text,Dd.Editor=function(e){var t=e.column,a=e.onChange;return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Table.ColumnEditor.Text.AllowHTML",checked:t.allowHTML,onChange:e=>a({allowHTML:e.target.checked})},window.W_L.Allow_HTML_content)),t.allowHTML&&n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Table.ColumnEditor.Text.HighlightLinks",checked:t.highlightLinks,onChange:e=>a({highlightLinks:e.target.checked})},window.W_L.Highlight_links)))},zd.friendlyName=window.W_L.number,zd.Editor=function(e){var t=e.column,a=e.onChange,r=Rd(Object(Sl.a)(a,200),1)[0];return n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Number_format,n.a.createElement(_o.NumberFormatSpecs,null)),"data-test":"Table.ColumnEditor.Number.Format",defaultValue:t.numberFormat,onChange:e=>r({numberFormat:e.target.value})}))},Ud.friendlyName=window.W_L.datetime,Ud.Editor=function(e){var t=e.column,a=e.onChange,r=Fd(Object(Sl.a)(a,200),1)[0];return n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Date_Time_format,n.a.createElement(_o.DateTimeFormatSpecs,null)),"data-test":"Table.ColumnEditor.DateTime.Format",defaultValue:t.dateTimeFormat,onChange:e=>r({dateTimeFormat:e.target.value})}))},Yd.friendlyName=window.W_L.Boolean,Yd.Editor=function(e){var t=e.column,a=e.onChange,r=Bd(Object(Sl.a)((function(e,r){var n=[...t.booleanValues];n.splice(e,1,r),a({booleanValues:n})}),200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Value_for," ",n.a.createElement("code",null,"false")),"data-test":"Table.ColumnEditor.Boolean.False",defaultValue:t.booleanValues[0],onChange:e=>r(0,e.target.value)})),n.a.createElement(io,null,n.a.createElement(jo,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Value_for," ",n.a.createElement("code",null,"true")),"data-test":"Table.ColumnEditor.Boolean.True",defaultValue:t.booleanValues[1],onChange:e=>r(1,e.target.value)})))},$d.friendlyName=window.W_L.Link,$d.Editor=function(e){var t=e.column,a=e.onChange,r=Kd(Object(Sl.a)(a,200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.URL_template,"data-test":"Table.ColumnEditor.Link.UrlTemplate",defaultValue:t.linkUrlTemplate,onChange:e=>r({linkUrlTemplate:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.Text_template,"data-test":"Table.ColumnEditor.Link.TextTemplate",defaultValue:t.linkTextTemplate,onChange:e=>r({linkTextTemplate:e.target.value})})),n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.Title_template,"data-test":"Table.ColumnEditor.Link.TitleTemplate",defaultValue:t.linkTitleTemplate,onChange:e=>r({linkTitleTemplate:e.target.value})})),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Table.ColumnEditor.Link.OpenInNewTab",checked:t.linkOpenInNewTab,onChange:e=>a({linkOpenInNewTab:e.target.checked})},window.W_L.Open_in_new_tab)),n.a.createElement(io,null,n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0,icon:n.a.createElement("span",{style:{cursor:"default"}},"Format specs ",_o.defaultIcon)},n.a.createElement("div",null,window.W_L.All_columns_can_be_referenced_using,n.a.createElement("code",null,"{{ column_name }}")," ",window.W_L.syntax),n.a.createElement("div",null,window.W_L.Use," ",n.a.createElement("code",null,"{{ @ }}")," ",window.W_L.to_reference_current_this_column),n.a.createElement("div",null,window.W_L.This_syntax_is_applicable_to_URL_Text_and_Title_options))))},tm.friendlyName=window.W_L.Image,tm.Editor=function(e){var t=e.column,a=e.onChange,r=Zd(Object(Sl.a)(a,200),1)[0];return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.URL_template,"data-test":"Table.ColumnEditor.Image.UrlTemplate",defaultValue:t.imageUrlTemplate,onChange:e=>r({imageUrlTemplate:e.target.value})})),n.a.createElement(io,null,n.a.createElement(Kn,{label:n.a.createElement(n.a.Fragment,null,window.W_L.Size,n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0},n.a.createElement("div",{style:{marginBottom:5}},window.W_L.Any_positive_integer_value_that_specifies_size_in_pixels),n.a.createElement("div",null,window.W_L.Leave_empty_to_use_default_value)))},n.a.createElement("div",{className:"image-dimension-selector"},n.a.createElement(jo,{"data-test":"Table.ColumnEditor.Image.Width",placeholder:window.W_L.Width,defaultValue:t.imageWidth,onChange:e=>r({imageWidth:e.target.value})}),n.a.createElement("span",{className:"image-dimension-selector-spacer"},"×"),n.a.createElement(jo,{"data-test":"Table.ColumnEditor.Image.Height",placeholder:window.W_L.Height,defaultValue:t.imageHeight,onChange:e=>r({imageHeight:e.target.value})})))),n.a.createElement(io,null,n.a.createElement(jo,{label:window.W_L.Title_template,"data-test":"Table.ColumnEditor.Image.TitleTemplate",defaultValue:t.imageTitleTemplate,onChange:e=>r({imageTitleTemplate:e.target.value})})),n.a.createElement(io,null,n.a.createElement(_o,{placement:"topLeft",arrowPointAtCenter:!0,icon:n.a.createElement("span",{style:{cursor:"default"}},"Format specs ",_o.defaultIcon)},n.a.createElement("div",null,window.W_L.All_columns_can_be_referenced_using,n.a.createElement("code",null,"{{ column_name }}")," ",window.W_L.syntax),n.a.createElement("div",null,window.W_L.Use," ",n.a.createElement("code",null,"{{ @ }}")," ",window.W_L.to_reference_current_this_column),n.a.createElement("div",null,window.W_L.This_syntax_is_applicable_to_URL_Text_and_Title_options))))};a(1297);function am(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rm(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return rm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rm(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function nm(e){var t=e.value,a=e.children,o=e.openingBrace,i=e.closingBrace,s=e.withKeys,c=am(Object(r.useState)(!1),2),u=c[0],d=c[1],m=Object(l.keys)(t),p=m.length;return n.a.createElement(n.a.Fragment,null,p>0&&n.a.createElement("span",{className:"jvi-toggle",onClick:()=>d(!u)},n.a.createElement("i",{className:me()("fa",{"fa-caret-right":!u,"fa-caret-down":u})})),n.a.createElement("span",{className:"jvi-punctuation jvi-braces"},o),!u&&p>0&&n.a.createElement("span",{className:"jvi-punctuation jvi-ellipsis",onClick:()=>d(!0)},"…"),u&&n.a.createElement("span",{className:"jvi-block"},Object(l.map)(m,(e,a)=>{var r=0===a,o=a===p-1,i=o?null:n.a.createElement("span",{className:"jvi-punctuation jvi-comma"},",");return n.a.createElement("span",{key:"item-"+e,className:me()("jvi-item",{"jvi-nested-first":r,"jvi-nested-last":o})},s&&n.a.createElement("span",{className:"jvi-object-key"},n.a.createElement(om,{value:e},n.a.createElement("span",{className:"jvi-punctuation"},": "))),n.a.createElement(om,{value:t[e]},i))})),n.a.createElement("span",{className:"jvi-punctuation jvi-braces"},i),a,!u&&n.a.createElement("span",{className:"jvi-comment"}," // "+p+" "+(1===p?"item":"items")))}function om(e){var t=e.value,a=e.children;return null===t||!1===t||!0===t||Object(l.isFinite)(t)?n.a.createElement("span",{className:"jvi-value jvi-primitive"},""+t,a):Object(l.isString)(t)?n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"jvi-punctuation jvi-string"},'"'),n.a.createElement("span",{className:"jvi-value jvi-string"},t),n.a.createElement("span",{className:"jvi-punctuation jvi-string"},'"'),a):Object(l.isArray)(t)?n.a.createElement(nm,{value:t,openingBrace:"[",closingBrace:"]"},a):Object(l.isObject)(t)?n.a.createElement(nm,{value:t,openingBrace:"{",closingBrace:"}",withKeys:!0},a):null}function im(e){var t=e.value;return n.a.createElement("span",{className:"jvi-item jvi-root"},n.a.createElement(om,{value:t}))}function lm(e){function t(t){var a=t[e.name];if(Object(l.isString)(a)&&a.length<=vo.tableCellMaxJSONSize)try{return{text:a,value:JSON.parse(a)}}catch(e){}return{text:a,value:void 0}}function a(e){var a=t(e.row),r=a.text,o=a.value;return Object(l.isUndefined)(o)?n.a.createElement("div",{className:"json-cell-invalid"},""+r):n.a.createElement("div",{className:"json-cell-valid"},n.a.createElement(im,{value:o}))}return a.prepareData=t,a}im.defaultProps={value:void 0},lm.friendlyName="JSON";var sm={string:Dd,number:zd,datetime:Ud,boolean:Yd,link:$d,image:tm,json:lm};function cm(e){switch(e){case"ascend":return"descend";case"descend":return null;default:return"ascend"}}function um(e,t,a,r){e=Object(l.filter)(e,"visible"),e=Object(l.sortBy)(e,"order");var o=a.length>1,i=function(e){var t={};return Object(l.each)(e,(e,a)=>{var r=e.name,n=e.direction;t[r]={direction:n,index:a+1}}),t}(a),s=Object(l.map)(e,e=>{var t=i[e.name]&&"ascend"===i[e.name].direction,s=i[e.name]&&"descend"===i[e.name].direction,c=o&&i[e.name]?i[e.name].index:null,u={key:e.name,dataIndex:"record[".concat(JSON.stringify(e.name),"]"),align:e.alignContent,sorter:{multiple:1},sortOrder:Object(l.get)(i,[e.name,"direction"],null),title:n.a.createElement(n.a.Fragment,null,e.description&&n.a.createElement("span",{style:{paddingRight:5}},n.a.createElement(he.a,{placement:"top",title:e.description},n.a.createElement("div",{className:"table-visualization-heading"},n.a.createElement("i",{className:"fa fa-info-circle","aria-hidden":"true"})))),n.a.createElement(he.a,{placement:"top",title:e.title},n.a.createElement("div",{className:"table-visualization-heading","data-sort-column-index":c},e.title))),onHeaderCell:()=>({className:me()({"table-visualization-column-is-sorted":t||s}),onClick:t=>r(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object(l.findIndex)(t,t=>t.name===e),n={name:e,direction:"ascend"};return r>=0&&(n.direction=cm(t[r].direction)),a?n.direction?(r>=0?t[r]=n:t.push(n),[...t]):Object(l.filter)(t,t=>t.name!==e):n.direction?[n]:[]}(e.name,a,t.shiftKey))})},d=(0,sm[e.displayAs])(e);return u.render=(t,a)=>({children:n.a.createElement(d,{row:a.record}),props:{className:"display-as-".concat(e.displayAs)}}),u});return s.push({key:"###Redash::Visualizations::Table::Spacer###",dataIndex:null,title:"",className:"table-visualization-spacer",render:()=>"",onHeaderCell:()=>({className:"table-visualization-spacer"})}),t&&(s=[{key:"table-search",title:t,onHeaderCell:()=>({className:"table-visualization-search"}),children:s}]),s}a(1298);function dm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mm(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return mm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mm(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function pm(){return(pm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fm(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function gm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:", ";return Object(l.reduce)(e,(e,a,r)=>(r>0&&e.push(t),e.push(a),e),[])}function bm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.limit,r=void 0===a?1/0:a,n=t.renderColumn,o=void 0===n?e=>e.title:n,i=Object(l.map)(e.slice(0,r),e=>o(e)),s=Object(l.map)(e.slice(r),e=>e.title);return s.length>0?[...gm(i)," and ".concat(s.length," others")]:i.length>1?[...gm(Object(l.initial)(i))," and ",Object(l.last)(i)]:i}function hm(e){var t=e.searchColumns;return n.a.createElement(Xr.a,{arrowPointAtCenter:!0,placement:"topRight",content:n.a.createElement("div",{className:"table-visualization-search-info-content"},window.W_L.search," ",bm(t,{renderColumn:e=>n.a.createElement("code",{key:e.name},e.title)}))},n.a.createElement(qd.a,{className:"table-visualization-search-info-icon"}))}function ym(e){var t=e.searchColumns,a=fm(e,["searchColumns"]);if(t.length<=0)return null;return n.a.createElement(ta.a.Search,pm({},a,{placeholder:"".concat(window.W_L.search," ").concat(bm(t,{limit:3}).join(""),"..."),suffix:t.length>3?n.a.createElement(hm,{searchColumns:t}):null}))}function vm(e){var t=e.options,a=e.data,o=dm(Object(r.useState)(""),2),i=o[0],s=o[1],c=dm(Object(r.useState)([]),2),u=c[0],d=c[1],m=Object(r.useMemo)(()=>Object(l.filter)(t.columns,"allowSearch"),[t.columns]),p=Object(r.useMemo)(()=>{var e=m.length>0?n.a.createElement(ym,{searchColumns:m,onChange:e=>s(e.target.value)}):null;return um(t.columns,e,u,e=>{d(e),document.getSelection().removeAllRanges()})},[t.columns,m,u]),f=Object(r.useMemo)(()=>{return function(e,t){if(0===t.length||0===e.length)return e;var a={ascend:1,descend:-1};return[...e].sort((e,r)=>{for(var n,o,i=0;i<t.length;i+=1){if(n=e.record[t[i].name],o=r.record[t[i].name],Object(l.isNil)(n)||n<o)return-1*a[t[i].direction];if(n>o||Object(l.isNil)(o))return 1*a[t[i].direction]}return 0})}(function(e,t,a){if(""!==t&&a.length>0){t=t.toUpperCase();var r=Object(l.map)(a,e=>{var a=(0,sm[e.displayAs])(e).prepareData;return e=>{var r=a(e).text;return Object(l.toString)(r).toUpperCase().indexOf(t)>=0}});return Object(l.filter)(e,e=>Object(l.some)(r,t=>t(e.record)))}return e}((e=a.rows,Object(l.map)(e,(e,t)=>({key:"record".concat(t),record:e}))),i,m),u);var e},[a.rows,i,m,u]);return Object(r.useEffect)(()=>{d([])},[t.columns,a.columns]),0===a.rows.length?null:n.a.createElement("div",{className:"table-visualization-container"},n.a.createElement(Il.a,{className:"table-fixed-header","data-percy":"show-scrollbars","data-test":"TableVisualization",columns:p,dataSource:f,pagination:{size:Object(l.get)(t,"paginationSize",""),position:"bottom",pageSize:t.itemsPerPage,hideOnSinglePage:!0,showSizeChanger:!1},showSorterTooltip:!1}))}ym.defaultProps={onChange:()=>{}},vm.propTypes=qr;var wm=a(210),Om=a.n(wm),_m=a(306),Em=a.n(_m),jm=a(422),Sm=a.n(jm);function Cm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xm(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xm(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Pm(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Lm(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pm(Object(a),!0).forEach((function(t){km(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pm(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function km(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Nm(e){var t=e.column,a=e.onChange;function r(e){a(Lm(Lm({},t),e))}var o=Cm(Object(Sl.a)(r,200),1)[0],i=sm[t.displayAs].Editor||null;return n.a.createElement("div",{className:"table-visualization-editor-column"},n.a.createElement(io,null,n.a.createElement(Vn.Row,{gutter:15,type:"flex",align:"middle"},n.a.createElement(Vn.Col,{span:16},n.a.createElement(jo,{"data-test":"Table.Column.".concat(t.name,".Title"),defaultValue:t.title,onChange:e=>o({title:e.target.value})})),n.a.createElement(Vn.Col,{span:8},n.a.createElement(xo,{"data-test":"Table.Column.".concat(t.name,".TextAlignment"),defaultValue:t.alignContent,onChange:e=>r({alignContent:e.target.value})})))),n.a.createElement(io,null,n.a.createElement($r.a,{"data-test":"Table.Column.".concat(t.name,".UseForSearch"),defaultChecked:t.allowSearch,onChange:e=>r({allowSearch:e.target.checked})},"Use for search")),n.a.createElement(io,null,n.a.createElement(jo,{label:"Description",defaultValue:t.description,onChange:e=>o({description:e.target.value})})),n.a.createElement(io,null,n.a.createElement(Eo,{label:"Display as:","data-test":"Table.Column.".concat(t.name,".DisplayAs"),defaultValue:t.displayAs,onChange:e=>r({displayAs:e})},Object(l.map)(sm,(e,a)=>{var r=e.friendlyName;return n.a.createElement(Eo.Option,{key:a,"data-test":"Table.Column.".concat(t.name,".DisplayAs.").concat(a)},r)}))),i&&n.a.createElement(i,{column:t,onChange:r}))}function Am(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Tm(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Am(Object(a),!0).forEach((function(t){Wm(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Am(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Wm(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Nm.defaultProps={onChange:()=>{}};var Im=un.a.Text,qm=Object(ql.b)(Om.a.Panel);function Dm(e){var t=e.options,a=e.onOptionsChange;function r(e,r){r&&r.stopPropagation();var n=Object(l.map)(t.columns,t=>t.name===e.name?e:t);a({columns:n})}return n.a.createElement(Ql,{axis:"y",lockAxis:"y",useDragHandle:!0,helperClass:"table-editor-columns-dragged-item",helperContainer:e=>e.firstChild,onSortEnd:function(e){var r=e.oldIndex,n=e.newIndex,o=[...t.columns];o.splice(n,0,...o.splice(r,1)),a({columns:o})},containerProps:{className:"table-visualization-editor-columns"}},n.a.createElement(Om.a,{bordered:!1,defaultActiveKey:[],expandIconPosition:"right"},Object(l.map)(t.columns,(e,t)=>n.a.createElement(qm,{key:e.name,index:t,header:n.a.createElement(n.a.Fragment,null,n.a.createElement(Bl,null),n.a.createElement("span",{"data-test":"Table.Column.".concat(e.name,".Name")},e.name,""!==e.title&&e.title!==e.name&&n.a.createElement(Im,{type:"secondary",style:{marginLeft:5}},n.a.createElement("i",null,"(",e.title,")")))),extra:n.a.createElement(he.a,{title:window.W_L.toggle_visibility,mouseEnterDelay:0,mouseLeaveDelay:0},e.visible?n.a.createElement(Em.a,{"data-test":"Table.Column.".concat(e.name,".Visibility"),onClick:t=>r(Tm(Tm({},e),{},{visible:!e.visible}),t)}):n.a.createElement(Sm.a,{"data-test":"Table.Column.".concat(e.name,".Visibility"),onClick:t=>r(Tm(Tm({},e),{},{visible:!e.visible}),t)}))},n.a.createElement(Nm,{column:e,onChange:r})))))}Dm.propTypes=Dr;var Rm=[5,10,15,20,25,50,100,150,200,250,500];function Mm(e){var t=e.options,a=e.onOptionsChange;return n.a.createElement(io,null,n.a.createElement(Eo,{label:window.W_L.items_per_page,"data-test":"Table.ItemsPerPage",defaultValue:t.itemsPerPage,onChange:e=>a({itemsPerPage:e})},Object(l.map)(Rm,e=>n.a.createElement(Eo.Option,{key:"ipp".concat(e),value:e,"data-test":"Table.ItemsPerPage.".concat(e)},e))))}Mm.propTypes=Dr;a(1302);var zm={type:"TABLE",name:"表格(Table)",getOptions:function(e,t){var a=t.columns;return(e=Ld(Ld({},Nd),e)).columns=s.a.map(Wd(a,e.columns),e=>{return Ld(Ld({},(a={integer:vo.integerFormat||"0,0",float:vo.floatFormat||"0,0.00"},{dateTimeFormat:{date:vo.dateFormat||"DD/MM/YYYY",datetime:vo.dateTimeFormat||"DD/MM/YYYY HH:mm"}[(t=e).type],numberFormat:a[t.type],booleanValues:vo.booleanValues||["false","true"],imageUrlTemplate:"{{ @ }}",imageTitleTemplate:"{{ @ }}",imageWidth:"",imageHeight:"",linkUrlTemplate:"{{ @ }}",linkTextTemplate:"{{ @ }}",linkTitleTemplate:"{{ @ }}",linkOpenInNewTab:!0})),e);var t,a}),e},Renderer:vm,Editor:ao([{key:"Columns",title:window.W_L.columns,component:Dm},{key:"Grid",title:window.W_L.grid,component:Mm}]),autoHeight:!0,defaultRows:14,defaultColumns:3,minColumns:2},Fm=a(677),Vm=a.n(Fm);a(1303);function Um(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bm(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Bm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bm(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Hm(e,t){var a=[];t.column&&(a=t.frequenciesColumn?function(e,t,a){var r={};return Object(l.each)(e,e=>{var n=parseFloat(e[a]);if(Number.isFinite(n)&&n>0){var o=Object(l.toString)(e[t]);r[o]=n}}),r}(e,t.column,t.frequenciesColumn):function(e,t){var a={};return Object(l.each)(e,e=>{var r=Object(l.toString)(e[t]).split(/\s/g);Object(l.each)(r,e=>{a[e]=(a[e]||0)+1})}),a}(e,t.column),a=Object(l.sortBy)(Object(l.map)(a,(e,t)=>({text:t,count:e})),[e=>-e.count,e=>-e.text.length]));var r,n,o,i,s=Object(l.map)(a,e=>e.count),c=Lr.a.scale.linear().domain([Object(l.min)(s),Object(l.max)(s)]).range([10,100]),u=Lr.a.scale.category20();return Object(l.each)(a,(e,t)=>{e.size=c(e.count),e.color=u(t),e.angle=t%2*90}),r=a,n={wordLength:t.wordLengthLimit,wordCount:t.wordCountLimit},o=n.wordLength,i=n.wordCount,o.min=Number.isFinite(o.min)?o.min:null,o.max=Number.isFinite(o.max)?o.max:null,i.min=Number.isFinite(i.min)?i.min:null,i.max=Number.isFinite(i.max)?i.max:null,Object(l.filter)(r,e=>{var t=e.text,a=e.count,r=(!o.min||t.length>=o.min)&&(!o.max||t.length<=o.max),n=(!i.min||a>=i.min)&&(!i.max||a<=i.max);return r&&n})}function Ym(e,t){e.style.transform=null;var a=e.getBoundingClientRect(),r=a.width,n=a.height,o=t.getBoundingClientRect(),i=o.width/r,l=o.height/n;e.style.transform="scale(".concat(Math.min(i,l),")")}function Qm(){var e=window.getComputedStyle(document.body).fontFamily;return Vm()().size([5e3,5e3]).padding(3).font(e).rotate(e=>e.angle).fontSize(e=>e.size).random(()=>.5)}function Km(e){var t=e.data,a=e.options,o=Um(Object(r.useState)(null),2),i=o[0],l=o[1],s=Um(Object(r.useState)([]),2),c=s[0],u=s[1],d=Object(r.useMemo)(Qm,[]);return Object(r.useEffect)(()=>(d.words(Hm(t.rows,a)).on("end",e=>u(e)).start(),()=>d.on("end",null).stop()),[d,t,a,u]),Object(r.useEffect)(()=>{i&&function(e,t){(e=Lr.a.select(e)).selectAll("*").remove();var a=e.append("svg"),r=a.append("g");r.selectAll("text").data(t).enter().append("text").style("font-size",e=>"".concat(e.size,"px")).style("font-family",e=>e.font).style("fill",e=>e.color).attr("text-anchor","middle").attr("transform",e=>"translate(".concat([e.x,e.y],") rotate(").concat(e.rotate,")")).text(e=>e.text);var n=a.node().getBoundingClientRect(),o=r.node().getBoundingClientRect();a.attr("width",Math.ceil(o.width)).attr("height",Math.ceil(o.height)),r.attr("transform","translate(".concat(n.left-o.left,",").concat(n.top-o.top,")")),Ym(a.node(),e.node())}(i,c)},[i,c]),Object(r.useEffect)(()=>{if(i)return Ar(i,()=>{var e=i.querySelector("svg");e&&Ym(e,i)})},[i]),n.a.createElement("div",{className:"word-cloud-visualization-container",ref:l})}function Gm(e){var t=e.options,a=e.data,r=e.onOptionsChange,o=e=>{r(Object(l.merge)({},t,e))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(io,null,n.a.createElement(Eo,{label:"Words Column","data-test":"WordCloud.WordsColumn",value:t.column,onChange:e=>o({column:e})},Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:t,"data-test":"WordCloud.WordsColumn."+t},t)}))),n.a.createElement(io,null,n.a.createElement(Eo,{label:"Frequencies Column","data-test":"WordCloud.FrequenciesColumn",value:t.frequenciesColumn,onChange:e=>o({frequenciesColumn:e})},n.a.createElement(Eo.Option,{key:"none",value:""},n.a.createElement("i",null,"(count word frequencies automatically)")),Object(l.map)(a.columns,e=>{var t=e.name;return n.a.createElement(Eo.Option,{key:"column-"+t,value:t,"data-test":"WordCloud.FrequenciesColumn."+t},t)}))),n.a.createElement(io,null,n.a.createElement(Kn,{label:"Words Length Limit"},n.a.createElement(Vn.Row,{gutter:15,type:"flex"},n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{"data-test":"WordCloud.WordLengthLimit.Min",placeholder:"Min",min:0,value:t.wordLengthLimit.min,onChange:e=>o({wordLengthLimit:{min:e>0?e:null}})})),n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{"data-test":"WordCloud.WordLengthLimit.Max",placeholder:"Max",min:0,value:t.wordLengthLimit.max,onChange:e=>o({wordLengthLimit:{max:e>0?e:null}})}))))),n.a.createElement(io,null,n.a.createElement(Kn,{label:"Frequencies Limit"},n.a.createElement(Vn.Row,{gutter:15,type:"flex"},n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{"data-test":"WordCloud.WordCountLimit.Min",placeholder:"Min",min:0,value:t.wordCountLimit.min,onChange:e=>o({wordCountLimit:{min:e>0?e:null}})})),n.a.createElement(Vn.Col,{span:12},n.a.createElement(So,{"data-test":"WordCloud.WordCountLimit.Max",placeholder:"Max",min:0,value:t.wordCountLimit.max,onChange:e=>o({wordCountLimit:{max:e>0?e:null}})}))))))}Km.propTypes=qr,Gm.propTypes=Dr;var $m={column:"",frequenciesColumn:"",wordLengthLimit:{min:null,max:null},wordCountLimit:{min:null,max:null}},Jm={type:"WORD_CLOUD",name:"词云图(Word Cloud)",getOptions:e=>Object(l.merge)({},$m,e),Renderer:Km,Editor:Gm,defaultRows:8};function Xm(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Zm(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xm(Object(a),!0).forEach((function(t){ep(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xm(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ep(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var tp=ae.a.shape({type:ae.a.string.isRequired,name:ae.a.string.isRequired,getOptions:ae.a.func.isRequired,isDefault:ae.a.bool,isDeprecated:ae.a.bool,Renderer:ae.a.func.isRequired,Editor:ae.a.func,autoHeight:ae.a.bool,defaultRows:ae.a.number,defaultColumns:ae.a.number,minRows:ae.a.number,maxRows:ae.a.number,minColumns:ae.a.number,maxColumns:ae.a.number}),ap={};Object(l.each)(Object(l.flatten)([Wo,hs,ac,Pc,Bc,au,pu,Bu,id,hd,xd,zm,Jm]),(function(e){if(function(e){var t={config:tp},a={config:e};ae.a.checkPropTypes(t,a,"prop","registerVisualization")}(e),e=Zm(Zm({Editor:()=>null},e),{},{isDefault:e.isDefault&&!e.isDeprecated}),ap[e.type])throw new Error("Visualization ".concat(e.type," already registered."));ap[e.type]=e}));var rp=ap;function np(){return Object(l.find)(ap,e=>e.isDefault)||Object(l.find)(ap,e=>!e.isDeprecated)}function op(){return(op=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ip(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function lp(){return(lp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function sp(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var cp="textbox",up="visualization",dp="restricted";var mp,pp,fp,gp={DashboardLevel:"dashboard-level",WidgetLevel:"widget-level",StaticValue:"static-value"};class bp{constructor(e){Object(l.extend)(this,e);var t=function(e){e.width=1;var t={autoHeight:!1,sizeX:Math.round(ma/2),sizeY:ha,minSizeX:ya,maxSizeX:va,minSizeY:wa,maxSizeY:Oa},a=e.visualization?rp[e.visualization.type]:null;if(Object(l.isObject)(a)){Object.prototype.hasOwnProperty.call(a,"autoHeight")&&(t.autoHeight=a.autoHeight);var r=parseInt(a.minColumns,10);isFinite(r)&&r>=0&&(t.minSizeX=r);var n=parseInt(a.maxColumns,10);isFinite(n)&&n>=0&&(t.maxSizeX=Math.min(n,ma));var o=parseInt(a.height,10);isFinite(o)&&(t.minSizeY=Math.ceil(o/pa));var i=parseInt(a.minRows,10);isFinite(i)&&(t.minSizeY=i);var s=parseInt(a.maxRows,10);isFinite(s)&&s>=0&&(t.maxSizeY=s);var c=parseInt(a.defaultColumns,10);isFinite(c)&&c>0&&(t.sizeX=c);var u=parseInt(a.defaultRows,10);isFinite(u)&&u>0&&(t.sizeY=u)}return t}(this);this.options=this.options||{},this.options.position=Object(l.extend)({},t,Object(l.pick)(this.options.position,["col","row","sizeX","sizeY","autoHeight"])),this.options.position.sizeY<0&&(this.options.position.autoHeight=!0)}get type(){return this.visualization?up:this.restricted?dp:cp}getQuery(){return!this.query&&this.visualization&&(this.query=new Za(this.visualization.query)),this.query}getQueryResult(){return this.data}getName(){return this.visualization?"".concat(this.visualization.query.name," (").concat(this.visualization.name,")"):Object(l.truncate)(this.text,20)}load(e,t){if(!this.visualization)return Promise.resolve();if(e||void 0===this.queryResult){this.loading=!0,this.refreshStartedAt=Ea()(),(void 0===t||e)&&(t=e?0:void 0);var a=this.getQuery().getQueryResult(t);this.queryResult=a,a.toPromise().then(e=>(this.queryResult===a&&(this.loading=!1,this.data=e),e)).catch(e=>(this.queryResult===a&&(this.loading=!1,this.data=e),e))}return this.queryResult.toPromise()}save(e,t){var a=Object(l.pick)(this,"options","text","id","width","dashboard_id","visualization_id");e&&t&&(a[e]=Object(l.merge)({},a[e],t));var r="api/widgets";return this.id&&(r="".concat(r,"/").concat(this.id)),B.post(r,a).then(e=>(Object(l.each)(e,(e,t)=>{this[t]=e}),this))}delete(){var e="api/widgets/".concat(this.id);return B.delete(e)}isStaticParam(e){return this.getParameterMappings()[e.name].type===bp.MappingType.StaticValue}getParametersDefs(){var e=this.getParameterMappings(),t=this.getQuery()?this.getQuery().getParametersDefs():[],a=A.search,r=[bp.MappingType.WidgetLevel,bp.MappingType.StaticValue],n=Object(l.map)(Object(l.filter)(t,t=>r.indexOf(e[t.name].type)>=0),t=>{var r=e[t.name],n=xr(t);return n.title=r.title||t.title,n.locals=[t],n.urlPrefix="p_w".concat(this.id,"_"),r.type===bp.MappingType.StaticValue?n.setValue(r.value):n.fromUrlParams(a),n});return Object(l.sortBy)(n,e=>Object(l.includes)(this.options.paramOrder,e.name)?Object(l.indexOf)(this.options.paramOrder,e.name):Object(l.size)(this.options.paramOrder))}getParameterMappings(){Object(l.isObject)(this.options.parameterMappings)||(this.options.parameterMappings={});var e={},t=this.getQuery()?this.getQuery().getParametersDefs(!1):[];Object(l.each)(t,t=>{e[t.name]=!0,Object(l.isObject)(this.options.parameterMappings[t.name])||(this.options.parameterMappings[t.name]={name:t.name,type:t.global?bp.MappingType.DashboardLevel:bp.MappingType.WidgetLevel,mapTo:t.name,value:null,title:""})});var a=Object(l.difference)(Object(l.keys)(this.options.parameterMappings),Object(l.keys)(e));return Object(l.each)(a,e=>{delete this.options.parameterMappings[e]}),this.options.parameterMappings}getLocalParameters(){return Object(l.filter)(this.getParametersDefs(),e=>!this.isStaticParam(e))}}fp=gp,(pp="MappingType")in(mp=bp)?Object.defineProperty(mp,pp,{value:fp,enumerable:!0,configurable:!0,writable:!0}):mp[pp]=fp;var hp=bp;function yp(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function vp(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yp(Object(a),!0).forEach((function(t){wp(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yp(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function wp(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Op(e,t,a){var r={};return s.a.each(t,t=>{var n=t&&t.getFilters?t.getFilters():[];s.a.each(n,t=>{var n=s.a.has(a,t.name);if(n||e.dashboard_filters_enabled){n&&(t.current=a[t.name]);var o=vp({},t);s.a.has(r,t.name)?r[o.name].values=s.a.union(r[o.name].values,o.values):r[o.name]=o}})}),s.a.values(r)}function _p(e){var t=Math.max(s.a.chain(e).map(e=>e.options.position.sizeY).max().value(),20)+5;return s.a.chain(e).sortBy(e=>e.options.position.row).groupBy(e=>e.options.position.row).reduce((e,a)=>{var r=1;return s.a.each(a,a=>{r=Math.max(r,a.options.position.autoHeight?t:a.options.position.sizeY),a.options.position.row=e,a.options.position.sizeY<1&&(a.options.position.sizeY=t)}),e+r},0).value(),e=s.a.sortBy(e,e=>e.options.position.col),e=s.a.sortBy(e,e=>e.options.position.row)}function Ep(e,t){var a=s.a.extend({sizeX:ba},s.a.extend({},t.options).position).sizeX,r=s.a.chain(e).map(e=>{var t=s.a.extend({},e.options),a=s.a.extend({row:0,sizeY:0},t.position);return{left:a.col,top:a.row,right:a.col+a.sizeX,bottom:a.row+a.sizeY,width:a.sizeX,height:a.sizeY}}).reduce((e,t)=>{for(var a=Math.max(t.left,0),r=Math.min(t.right,e.length+1),n=a;n<r;n+=1)e[n]=Math.max(e[n],t.bottom);return e},s.a.map(new Array(ma),s.a.constant(0))).value();return s.a.chain(s.a.range(0,ma-a+1)).map(e=>({col:e,row:s.a.chain(r).slice(e,e+a).max().value()})).sortBy("row").first().value()}function jp(e){s.a.extend(this,e),Object.defineProperty(this,"url",{get:function(){return t=(e=this).id,a=e.slug,"dashboards/".concat(t,"-").concat(a);var e,t,a}})}function Sp(e){return _p(s.a.map(e,e=>new hp(e)))}function Cp(e){return(e=new jp(e)).widgets&&(e.widgets=Sp(e.widgets)),e.publicAccessEnabled=void 0!==e.public_url,e}function xp(e){return e=e.results?vp(vp({},e),{},{results:s.a.map(e.results,Cp)}):Cp(e)}var Pp={get:e=>{var t=e.id,a=e.slug,r={};return t||(r.legacy=null),B.get("api/dashboards/".concat(t||a),{params:r}).then(xp)},getByToken:e=>{var t=e.token;return B.get("api/dashboards/public/".concat(t)).then(xp)},save:e=>B.post((e=>e.id?"api/dashboards/".concat(e.id):"api/dashboards")(e),e).then(xp),delete:e=>{var t=e.id;return B.delete("api/dashboards/".concat(t)).then(xp)},query:e=>B.get("api/dashboards",{params:e}).then(xp),recent:e=>B.get("api/dashboards/recent",{params:e}).then(xp),myDashboards:e=>B.get("api/dashboards/my",{params:e}).then(xp),favorites:e=>B.get("api/dashboards/favorites",{params:e}).then(xp),favorite:e=>{var t=e.id;return B.post("api/dashboards/".concat(t,"/favorite"))},unfavorite:e=>{var t=e.id;return B.delete("api/dashboards/".concat(t,"/favorite"))}};function Lp(){return(Lp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function kp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Np(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Np(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Np(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ap(e){var t=e.dialog,a=kp(Object(r.useState)(""),2),o=a[0],i=a[1],s=kp(Object(r.useState)(!1),2),c=s[0],u=s[1],d=kp(Object(r.useState)(!1),2),m=d[0],p=d[1],f=Z.isCreateDashboardEnabled();function g(){""!==o&&(p(!0),jp.save({name:o}).then(e=>{t.close(),sa("".concat(e.url,"?edit"))}),da("create","dashboard"))}return n.a.createElement(R.a,Lp({},t.props,f?{}:{footer:null},{title:window.W_L.new_dashboard,okText:window.W_L.save,cancelText:window.W_L.cancel,okButtonProps:{disabled:!c||m,loading:m,"data-test":"DashboardSaveButton"},cancelButtonProps:{disabled:m},onOk:g,closable:!m,maskClosable:!m,wrapProps:{"data-test":"CreateDashboardDialog"}}),n.a.createElement(se,{name:"CreateDashboardDialogExtra",disabled:!f},n.a.createElement(ta.a,{defaultValue:o,onChange:function(e){var t=Object(l.trim)(e.target.value);i(t),u(""!==t)},onPressEnter:g,placeholder:window.W_L.dashboard_name,"aria-label":window.W_L.dashboard_name,disabled:m,autoFocus:!0})))}s.a.extend(jp,Pp),jp.prepareDashboardWidgets=Sp,jp.prepareWidgetsForDashboard=_p,jp.prototype.canEdit=function(){return Z.canEdit(this)},jp.prototype.getParametersDefs=function(){var e={},t=A.search;s.a.each(this.widgets,t=>{if(t.getQuery()){var a=t.getParameterMappings();t.getQuery().getParametersDefs(!1).forEach(t=>{var r=a[t.name];r.type===hp.MappingType.DashboardLevel&&(e[r.mapTo]||(e[r.mapTo]=xr(t),e[r.mapTo].name=r.mapTo,e[r.mapTo].title=r.title||t.title,e[r.mapTo].locals=[]),e[r.mapTo].locals.push(t))})}});var a=s.a.values(s.a.each(e,e=>{e.setValue(e.value),e.fromUrlParams(t)}));return s.a.sortBy(a,e=>s.a.includes(this.options.globalParamOrder,e.name)?s.a.indexOf(this.options.globalParamOrder,e.name):s.a.size(this.options.globalParamOrder))},jp.prototype.addWidget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={dashboard_id:this.id,options:vp(vp({},t),{},{isHidden:!1,position:{}}),text:"",visualization_id:null,visualization:null};s.a.isString(e)?a.text=e:s.a.isObject(e)&&(a.visualization_id=e.id,a.visualization=e);var r=new hp(a),n=Ep(this.widgets,r);return r.options.position.col=n.col,r.options.position.row=n.row,r.save().then(()=>(this.widgets=[...this.widgets,r],r))},jp.prototype.favorite=function(){return jp.favorite(this)},jp.prototype.unfavorite=function(){return jp.unfavorite(this)},Ap.propTypes={dialog:ia.isRequired};var Tp=la(Ap);a(1304);function Wp(){return(Wp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ip(e){var t=e.show,a=e.completed,r=e.text,o=e.url,i=e.urlText,l=e.onClick;if(!t)return null;var s={children:i,onClick:l};return n.a.createElement("li",{className:me()({done:a})},o?n.a.createElement(h,Wp({href:o},s)):n.a.createElement(ge,Wp({type:"link"},s))," ",r)}function qp(e){e.helpTriggerType;return n.a.createElement(n.a.Fragment,null)}function Dp(e){var t=e.icon,a=e.header,o=e.description,i=e.illustration,s=e.helpMessage,c=e.closable,u=e.onClose,d=e.onboardingMode,m=e.showAlertStep,p=e.showDashboardStep,f=e.showDataSourceStep,g=e.showInviteStep,b=e.getStepsItems,h=e.illustrationPath,y={dataSource:f,query:!0,alert:m,dashboard:p,inviteUsers:g},v={dataSource:ee.objectCounters.data_sources>0,query:ee.objectCounters.queries>0,alert:ee.objectCounters.alerts>0,dashboard:ee.objectCounters.dashboards>0,inviteUsers:ee.objectCounters.users>1},w=Object(r.useCallback)(()=>{Tp.showModal()},[]);if(!(!d||Object(l.some)(Object(l.keys)(y),e=>y[e]&&!v[e])))return null;var O=[{key:"dataSources",node:H.isAdmin?n.a.createElement(Ip,{key:"dataSources",show:y.dataSource,completed:v.dataSource,url:"data_sources/new",urlText:window.W_L.connect_new_datasource}):n.a.createElement(Ip,{key:"dataSources",show:y.dataSource,completed:v.dataSource,text:window.W_L.ask_database_info})},{key:"queries",node:n.a.createElement(Ip,{key:"queries",show:y.query,completed:v.query,url:"queries/new",urlText:window.W_L.create_query})},{key:"alerts",node:n.a.createElement(Ip,{key:"alerts",show:y.alert,completed:v.alert,url:"alerts/new",urlText:window.W_L.create_alert})},{key:"dashboards",node:n.a.createElement(Ip,{key:"dashboards",show:y.dashboard,completed:v.dashboard,onClick:w,urlText:window.W_L.create_dashboard})},{key:"users",node:n.a.createElement(Ip,{key:"users",show:y.inviteUsers,completed:v.inviteUsers,url:"users/new",urlText:window.W_L.invite_new_user})}],_=b?b(O):O,E=h||"static/images/illustrations/"+i+".svg";return n.a.createElement("div",{className:"empty-state-wrapper"},n.a.createElement("div",{className:"empty-state bg-white tiled"},n.a.createElement("div",{className:"empty-state__summary"},a&&n.a.createElement("h4",null,a),n.a.createElement("h2",null,n.a.createElement("i",{className:t,"aria-hidden":"true"})),n.a.createElement("p",null,o),n.a.createElement("img",{src:E,alt:i+" Illustration",width:"75%"})),n.a.createElement("div",{className:"empty-state__steps"},n.a.createElement("h4",null,window.W_L.start),n.a.createElement("ol",null,_.map(e=>e.node)),s)),c&&n.a.createElement(ge,{className:"close-button","aria-label":"Close",onClick:u},n.a.createElement(je.a,null)))}Ip.propTypes={show:ae.a.bool.isRequired,completed:ae.a.bool.isRequired,text:ae.a.node,url:ae.a.string,urlTarget:ae.a.string,urlText:ae.a.node,onClick:ae.a.func},Ip.defaultProps={url:null,urlTarget:null,urlText:null,text:null,onClick:null},qp.propTypes={helpTriggerType:ae.a.string.isRequired},Dp.propTypes={icon:ae.a.string,header:ae.a.string,description:ae.a.string.isRequired,illustration:ae.a.string.isRequired,illustrationPath:ae.a.string,helpMessage:ae.a.node,closable:ae.a.bool,onClose:ae.a.func,onboardingMode:ae.a.bool,showAlertStep:ae.a.bool,showDashboardStep:ae.a.bool,showDataSourceStep:ae.a.bool,showInviteStep:ae.a.bool,getStepItems:ae.a.func},Dp.defaultProps={icon:null,header:null,helpMessage:null,closable:!1,onClose:()=>{},onboardingMode:!1,showAlertStep:!1,showDashboardStep:!1,showDataSourceStep:!0,showInviteStep:!1};var Rp=Dp,Mp=a(250),zp=a.n(Mp);function Fp(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Vp(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fp(Object(a),!0).forEach((function(t){Up(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fp(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Up(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}zp.a.config({placement:"bottomRight",duration:3});var Bp={};["success","error","info","warning","warn"].forEach(e=>{Bp[e]=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return zp.a[e](Vp(Vp({},r),{},{message:t,description:a}))}});var Hp=Vp(Vp({},zp.a),Bp),Yp=()=>B.get("api/settings/organization"),Qp=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.W_L.save_success;return B.post("api/settings/organization",e).then(e=>(Hp.success(t),e)).catch(()=>{Hp.error(window.W_L.save_failed)})};function Kp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gp(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Gp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gp(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var $p=un.a.Text;var Jp=function(){var e=Kp(Object(r.useState)(!1),2),t=e[0],a=e[1];if(!Y.showBeaconConsentMessage||t)return null;var o=()=>{Y.showBeaconConsentMessage=!1,a(!0)},i=e=>{var t=window.W_L.thank_you;e||(t=window.W_L.setting_saved_success),Qp({beacon_consent:e},t).finally(o)};return n.a.createElement(se,{name:"BeaconConsent"},n.a.createElement("div",{className:"m-t-10 tiled"},n.a.createElement(en.a,{title:n.a.createElement(n.a.Fragment,null,window.W_L.share_info," ",n.a.createElement(Ge,{type:"USAGE_DATA_SHARING"})),bordered:!1},n.a.createElement($p,null,window.W_L.help_redash,"："),n.a.createElement("div",{className:"m-t-5"},n.a.createElement("ul",null,n.a.createElement("li",null," ",window.W_L.redash_about_1),n.a.createElement("li",null," ",window.W_L.redash_about_2))),n.a.createElement($p,null,window.W_L.redash_info),n.a.createElement("div",{className:"m-t-5"},n.a.createElement(m.a,{type:"primary",className:"m-r-5",onClick:()=>i(!0)},window.W_L.accept),n.a.createElement(m.a,{type:"default",onClick:()=>i(!1)},window.W_L.reject)),n.a.createElement("div",{className:"m-t-15"},n.a.createElement($p,{type:"secondary"},window.W_L.set_info_in," ",n.a.createElement(h,{href:"settings/general"},window.W_L.sys_setting)," ",window.W_L.sys_setting_add,"。")))))},Xp=a(252),Zp=a.n(Xp);function ef(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function tf(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ef(Object(a),!0).forEach((function(t){af(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ef(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function af(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var rf=new class{constructor(){af(this,"_items",[]),af(this,"_sorted",!1)}get items(){return this._sorted||(this._items=Object(l.sortBy)(this._items,[e=>{return t=e.path,a=Zp.a.parse(t),Object(l.filter)(a,l.isObject).length;var t,a},e=>-e.path.length,e=>e.path]),this._sorted=!0),this._items}register(e,t){var a=Object(l.isString)(e)?e:null;this.unregister(a),Object(l.isObject)(t)&&(this._items=[...this.items,tf(tf({},t),{},{id:a})],this._sorted=!1)}unregister(e){Object(l.isString)(e)&&(this._items=Object(l.filter)(this.items,t=>t.id!==e))}navigate(e,t){var a=this._items.find(t=>t.id===e);if(a){var r=a.path;for(var n in t)r=r.replace(":".concat(n),String(t[n]));window.location.href=r}else console.error("No route found with id: ".concat(e))}},nf=a(94),of=a.n(nf);function lf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sf(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sf(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function cf(e){var t=e.title,a=e.resource,o=e.itemUrl,i=e.emptyState,s=lf(Object(r.useState)([]),2),c=s[0],u=s[1],d=lf(Object(r.useState)(!0),2),m=d[0],p=d[1];return Object(r.useEffect)(()=>{p(!0),a.favorites().then(e=>{var t=e.results;return u(t)}).finally(()=>p(!1))},[a]),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"d-flex align-items-center m-b-20"},n.a.createElement("p",{className:"flex-fill f-500 c-black m-0"},t),m&&n.a.createElement(of.a,null)),!Object(l.isEmpty)(c)&&n.a.createElement("div",{role:"list",className:"list-group"},c.map(e=>n.a.createElement(h,{key:o(e),role:"listitem",className:"list-group-item",href:o(e)},n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:"fa fa-star","aria-hidden":"true"})),e.name,e.is_draft&&n.a.createElement("span",{className:"label label-default m-l-5"},window.W_L.unpublished)))),Object(l.isEmpty)(c)&&!m&&i)}function uf(){return n.a.createElement("div",{className:"tile"},n.a.createElement("div",{className:"t-body tb-padding"},n.a.createElement("div",{className:"row home-favorites-list"},n.a.createElement("div",{className:"col-sm-6 m-t-20"},n.a.createElement(cf,{title:window.W_L.my_favorite_dashboard,resource:jp,itemUrl:e=>e.url,emptyState:n.a.createElement("p",null,n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:"fa fa-star","aria-hidden":"true"})),n.a.createElement(h,{href:"dashboards"},window.W_L.my_favorite_dashboard))})),n.a.createElement("div",{className:"col-sm-6 m-t-20"},n.a.createElement(cf,{title:window.W_L.my_favorite_query,resource:Za,itemUrl:e=>"queries/".concat(e.id),emptyState:n.a.createElement("p",null,n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:"fa fa-star","aria-hidden":"true"})),n.a.createElement(h,{href:"queries"},window.W_L.my_favorite_query))})))))}cf.propTypes={title:ae.a.string.isRequired,resource:ae.a.func.isRequired,itemUrl:ae.a.func.isRequired,emptyState:ae.a.node},cf.defaultProps={emptyState:null};a(1305);function df(){return n.a.createElement(u.a,{className:"m-b-15",type:"warning",message:n.a.createElement(n.a.Fragment,null,"你已设置参数 ",n.a.createElement("code",null,"ALLOW_PARAMETERS_IN_EMBEDS"),"，但该特征暂时不可用。"," ",n.a.createElement(h,{href:"https://discuss.redash.io/t/support-for-parameters-in-embedded-visualizations/3337",target:"_blank",rel:"noopener noreferrer"},"Read more"),".")})}function mf(){return n.a.createElement(u.a,{className:"m-b-15",type:"warning",message:n.a.createElement(n.a.Fragment,null,window.W_L.email_send," ",n.a.createElement(ge,{type:"link",onClick:()=>{B.post("verification_email/").then(e=>{Hp.success(e.message)})}},window.W_L.re_send_email),".")})}function pf(){return Object(r.useEffect)(()=>{da("view","page","personal_homepage")},[]),n.a.createElement("div",{className:"home-page"},n.a.createElement("div",{className:"container"},Object(l.includes)(Q,"using-deprecated-embed-feature")&&n.a.createElement(df,null),Object(l.includes)(Q,"email-not-verified")&&n.a.createElement(mf,null),n.a.createElement(se,{name:"Home.EmptyState"},n.a.createElement(Rp,{header:window.W_L.redash_welcome,description:window.W_L.redash_desc,illustration:"dashboard",helpMessage:n.a.createElement(qp,{helpTriggerType:"GETTING_STARTED"}),showDashboardStep:!0,showInviteStep:!0,onboardingMode:!0})),n.a.createElement(se,{name:"HomeExtra"}),n.a.createElement(uf,null),n.a.createElement(Jp,null)))}rf.register("Home",Zt({path:"/home",title:"DeepBI",render:e=>n.a.createElement(pf,e)}));a(1306);function ff(e){var t=e.title,a=e.actions;return n.a.createElement("div",{className:"page-header-wrapper"},n.a.createElement("h3",null,t),a&&n.a.createElement("div",{className:"page-header-actions"},a))}ff.propTypes={title:ae.a.string,actions:ae.a.node},ff.defaultProps={title:"",actions:null};a(1307);function gf(e){var t=e.activeTab,a=e.children;return n.a.createElement("div",{className:"admin-page-layout"},n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:"Admin"}),n.a.createElement("div",{className:"bg-white tiled"},n.a.createElement(ue.a,{selectedKeys:[t],selectable:!1,mode:"horizontal"},n.a.createElement(ue.a.Item,{key:"system_status"},n.a.createElement(h,{href:"admin/status"},window.W_L.sys_status)),n.a.createElement(ue.a.Item,{key:"jobs"},n.a.createElement(h,{href:"admin/queries/jobs"},window.W_L.task_queen_status)),n.a.createElement(ue.a.Item,{key:"outdated_queries"},n.a.createElement(h,{href:"admin/queries/outdated"},window.W_L.outdated_query))),a)))}gf.propTypes={activeTab:ae.a.string,children:ae.a.node},gf.defaultProps={activeTab:"system_status",children:null};var bf=a(206),hf=a.n(bf),yf=a(158),vf=a.n(yf),wf=a(79),Of=a.n(wf);function _f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ef extends n.a.Component{toggleItem(e,t,a){var r=t.is_favorite?t.unfavorite.bind(t):t.favorite.bind(t),n=t.is_favorite;r().then(()=>{t.is_favorite=!n,this.forceUpdate(),a()})}render(){var e=this.props,t=e.item,a=e.onChange,r=t.is_favorite?"fa fa-star":"fa fa-star-o",o=t.is_favorite?window.W_L.add_favorite:window.W_L.remove_favorite;return n.a.createElement(ge,{title:o,"aria-label":o,className:"favorites-control btn-favorite",onClick:e=>this.toggleItem(e,t,a)},n.a.createElement("i",{className:r,"aria-hidden":"true"}))}}_f(Ef,"propTypes",{item:ae.a.shape({is_favorite:ae.a.bool.isRequired}).isRequired,onChange:ae.a.func}),_f(Ef,"defaultProps",{onChange:()=>{}});ae.a.shape({syntax:ae.a.string,options:ae.a.shape({doc:ae.a.string,doc_url:ae.a.string}),type_name:ae.a.string});var jf=ae.a.shape({columns:ae.a.arrayOf(ae.a.string).isRequired}),Sf=(ae.a.arrayOf(jf),ae.a.shape({interval:ae.a.number,time:ae.a.string,day_of_week:ae.a.string,until:ae.a.string})),Cf={interval:null,time:null,day_of_week:null,until:null},xf=ae.a.shape({id:ae.a.number.isRequired,name:ae.a.string.isRequired,email:ae.a.string.isRequired,profileImageUrl:ae.a.string,apiKey:ae.a.string,isDisabled:ae.a.bool}),Pf=ae.a.shape({id:ae.a.number.isRequired,name:ae.a.string.isRequired,icon:ae.a.string.isRequired,type:ae.a.string.isRequired}),Lf=ae.a.shape({id:ae.a.any.isRequired,name:ae.a.string.isRequired,description:ae.a.string,data_source_id:ae.a.any.isRequired,created_at:ae.a.string.isRequired,updated_at:ae.a.string,user:xf,query:ae.a.string,queryHash:ae.a.string,is_safe:ae.a.bool.isRequired,is_draft:ae.a.bool.isRequired,is_archived:ae.a.bool.isRequired,api_key:ae.a.string.isRequired}),kf=ae.a.shape({column:ae.a.string,op:ae.a.oneOf([">",">=","<","<=","==","!="]),value:ae.a.oneOfType([ae.a.string,ae.a.number]),custom_subject:ae.a.string,custom_body:ae.a.string}),Nf=ae.a.shape({id:ae.a.any,name:ae.a.string,created_at:ae.a.string,last_triggered_at:ae.a.string,updated_at:ae.a.string,rearm:ae.a.number,state:ae.a.oneOf(["ok","triggered","unknown"]),user:xf,query:Lf,options:ae.a.shape({column:ae.a.string,op:ae.a.string,value:ae.a.oneOfType([ae.a.string,ae.a.number])}).isRequired});function Af(e,t,a,r){var n=t[a],o=e&&null!=n&&Ea.a.isMoment(n),i=!e&&(null==n||Ea.a.isMoment(n));if(!o&&!i)return new Error("Prop `"+a+"` supplied to `"+r+"` should be a Moment.js instance.")}var Tf=Object(l.wrap)(!1,Af);function Wf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return If(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return If(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function If(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function qf(e){var t=e.date,a=e.placeholder,o=e.autoUpdate,i=e.variation,s=function(e){return(e=Object(l.isNil)(e)?null:Ea()(e))&&e.isValid()?e:null}(t),c=Wf(Object(r.useState)(null),2),u=c[0],d=c[1],m=Object(r.useMemo)(()=>s?s.format(Y.dateTimeFormat):null,[s]);return Object(r.useEffect)(()=>{function e(){d(s?s.fromNow():a)}if(e(),o){var t=setInterval(e,3e4);return()=>clearInterval(t)}},[o,s,a]),"timeAgoInTooltip"===i?n.a.createElement(we,{title:u},n.a.createElement("span",{"data-test":"TimeAgo"},m)):n.a.createElement(we,{title:m},n.a.createElement("span",{"data-test":"TimeAgo"},u))}function Df(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rf(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Rf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rf(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}Tf.isRequired=Object(l.wrap)(!0,Af),qf.propTypes={date:ae.a.oneOfType([ae.a.string,ae.a.number,ae.a.instanceOf(Date),Tf]),placeholder:ae.a.string,autoUpdate:ae.a.bool,variation:ae.a.oneOf(["timeAgoInTooltip"])},qf.defaultProps={date:null,placeholder:"",autoUpdate:!0};var Mf={NEVER:"不自动刷新",SECONDS:"秒",MINUTES:"分钟",HOURS:"小时",DAYS:"天",WEEKS:"周",MILLISECONDS:"毫秒"},zf={SECONDS:"s",MINUTES:"m",HOURS:"h",DAYS:"d",WEEKS:"w",MILLISECONDS:"ms"};function Ff(e,t){if(!e)return"";var a=Ea()(e);return a.isValid()?a.format(t):"-"}function Vf(e){return Ff(e,Y.dateTimeFormat)}function Uf(e){return Ff(e,Y.dateFormat)}function Bf(e){var t=Df(e.split(":"),2),a=t[0],r=t[1];return Ea.a.utc().hour(a).minute(r).local().format("HH:mm")}function Hf(e){var t="CN"===window.W_L.language_mode?Mf:zf;if(!e)return{interval:t.NEVER};var a=t.SECONDS;return e>=60&&(e/=60,a=t.MINUTES),e>=60&&(e/=60,a=t.HOURS),e>=24&&a===t.HOURS&&(e/=24,a=t.DAYS),e>=7&&!(e%7)&&a===t.DAYS&&(e/=7,a=t.WEEKS),{count:e,interval:a}}function Yf(e,t){return e+""}function Qf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"-";var a="",r=Hf(e),n=r.interval,o=r.count,i=Math.round(o);return 1===i&&t.omitSingleValueNumber||(a="".concat(i," ")),a+=Yf(n)}function Kf(e){return e.replace(/_/g," ").replace(/(?:^|\s)\S/g,e=>e.toUpperCase())}function Gf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return Math.round(e)!==e?e.toFixed(t):e.toString()}function $f(e,t){return function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;if(isNaN(parseFloat(e))||!isFinite(e))return{value:"",unit:"",divisor:1};for(var n=0,o=1;e>=t&&n<a.length-1;)e/=t,o*=t,n+=1;return{value:Gf(e,r),unit:a[n],divisor:o}}(e,1024,["bytes","KB","MB","GB","TB","PB"],t)}function Jf(e){var t=$f(e),a=t.value,r=t.unit;return a?a+" "+r:"?"}function Xf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ea.a.isMoment(e)?"date"===t?Uf(e):Vf(e):"boolean"==typeof e?e.toString():e}function Zf(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function eg(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Zf(Object(a),!0).forEach((function(t){tg(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zf(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function tg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ag(){return(ag=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function rg(){return Object(l.extend)(this(...arguments),{sorter:!0})}var ng={favorites:e=>Object(l.extend)({width:"1%",render:(e,t)=>n.a.createElement(Ef,{item:t})},e),avatar:(e,t)=>(t=Object(l.isFunction)(t)?t:l.identity,Object(l.extend)({width:"1%",render:(e,a)=>n.a.createElement("img",{src:a.user.profile_image_url,className:"profile__image_thumb",alt:t(e.name,a),title:t(e.name,a)})},e)),date:e=>Object(l.extend)({render:e=>Uf(e)},e),dateTime:e=>Object(l.extend)({render:e=>Vf(e)},e),duration:e=>Object(l.extend)({width:"1%",className:"text-nowrap",render:e=>Qf(e)},e),timeAgo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return Object(l.extend)({render:e=>n.a.createElement(qf,ag({date:e},t))},e)},custom:(e,t)=>Object(l.extend)({render:e},t)};ng.date.sortable=rg,ng.dateTime.sortable=rg,ng.duration.sortable=rg,ng.timeAgo.sortable=rg,ng.custom.sortable=rg;class og extends n.a.Component{constructor(){super(...arguments),tg(this,"getRowKey",e=>{var t=this.props.rowKey;return t?Object(l.isFunction)(t)?t(e.item):e.item[t]:e.key})}prepareColumns(){var e=this.props,t=e.orderByField,a=e.orderByReverse,r=e.toggleSorting,n=a?"descend":"ascend";return Object(l.map)(Object(l.map)(Object(l.filter)(this.props.columns,e=>!Object(l.isFunction)(e.isAvailable)||e.isAvailable()),e=>Object(l.extend)(e,{orderByField:e.orderByField||e.field})),(e,a)=>{var o=e.sorter?()=>({onClick:()=>r(e.orderByField)}):null,i=Object(l.isFunction)(e.render)?(t,a)=>e.render(t,a.item):l.identity;return Object(l.extend)(Object(l.omit)(e,["field","orderByField","render"]),{key:"column"+a,dataIndex:["item",e.field],defaultSortOrder:e.orderByField===t?n:null,onHeaderCell:o,render:i})})}render(){var e={columns:this.prepareColumns(),dataSource:Object(l.map)(this.props.items,(e,t)=>({key:"row"+t,item:e}))},t=Object(l.isFunction)(this.props.onRowClick)?e=>({onClick:t=>{this.props.onRowClick(t,e.item)}}):null,a=this.props.showHeader;return this.props.loading&&(Object(l.isEmpty)(e.dataSource)?(e.columns=e.columns.map(e=>eg(eg({},e),{},{sorter:!1,render:()=>n.a.createElement(Of.a,{active:!0,paragraph:!1})})),e.dataSource=Object(l.range)(10).map(e=>({key:"".concat(e)}))):e.loading={indicator:null}),n.a.createElement(Il.a,ag({className:me()("table-data",{"ant-table-headerless":!a}),showHeader:a,rowKey:this.getRowKey,pagination:!1,onRow:t,"data-test":this.props["data-test"]},e))}}function ig(e){var t=e.title,a=e.value,r=e.loading;return n.a.createElement(vf.a,{spinning:r},n.a.createElement(en.a,null,t,n.a.createElement("div",{className:"f-20"},a)))}tg(og,"propTypes",{loading:ae.a.bool,items:ae.a.arrayOf(ae.a.object),columns:ae.a.arrayOf(ae.a.shape({field:ae.a.string,orderByField:ae.a.string,render:ae.a.func,isAvailable:ae.a.func})),showHeader:ae.a.bool,onRowClick:ae.a.func,orderByField:ae.a.string,orderByReverse:ae.a.bool,toggleSorting:ae.a.func,"data-test":ae.a.string,rowKey:ae.a.oneOfType([ae.a.string,ae.a.func])}),tg(og,"defaultProps",{loading:!1,items:[],columns:[],showHeader:!0,onRowClick:null,orderByField:null,orderByReverse:!1,toggleSorting:()=>{}}),ig.propTypes={title:ae.a.string.isRequired,value:ae.a.oneOfType([ae.a.number,ae.a.string]),loading:ae.a.bool.isRequired},ig.defaultProps={value:""};var lg=[{title:window.W_L.queue,dataIndex:"origin"},{title:window.W_L.query_id,dataIndex:["meta","query_id"]},{title:window.W_L.org_id,dataIndex:["meta","org_id"]},{title:window.W_L.data_source_id,dataIndex:["meta","data_source_id"]},{title:window.W_L.user_id,dataIndex:["meta","user_id"]},ng.custom(e=>e.toString(),{title:window.W_L.scheduled,dataIndex:["meta","scheduled"]}),ng.timeAgo({title:window.W_L.start_time,dataIndex:"started_at"}),ng.timeAgo({title:window.W_L.queue_time,dataIndex:"enqueued_at"})],sg=[{title:window.W_L.queue,dataIndex:"origin"},{title:window.W_L.job_name,dataIndex:"name"},ng.timeAgo({title:window.W_L.start_time,dataIndex:"started_at"}),ng.timeAgo({title:window.W_L.queue_time,dataIndex:"enqueued_at"})],cg=[ng.custom(e=>n.a.createElement("span",null,n.a.createElement(hf.a,{status:{busy:"processing",idle:"default",started:"success",suspended:"warning"}[e]})," ",e),{title:"State",dataIndex:"state"})].concat(Object(l.map)(["Hostname","PID","Name","Queues","Current Job","Successful Jobs","Failed Jobs"],e=>({title:e,dataIndex:e.toLowerCase().replace(/\s/g,"_")}))).concat([ng.dateTime({title:window.W_L.birth_date,dataIndex:"birth_date"}),ng.duration({title:window.W_L.total_work_time,dataIndex:"total_working_time"})]),ug=Object(l.map)(["Name","Started","Queued"],e=>({title:e,dataIndex:e.toLowerCase()})),dg={loading:ae.a.bool.isRequired,items:ae.a.arrayOf(ae.a.object).isRequired};function mg(e){var t=e.loading,a=e.items;return n.a.createElement(Il.a,{loading:t,columns:cg,rowKey:"name",dataSource:a,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function pg(e){var t=e.loading,a=e.items;return n.a.createElement(Il.a,{loading:t,columns:ug,rowKey:"name",dataSource:a,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function fg(e){var t=e.loading,a=e.items;return n.a.createElement(Il.a,{loading:t,columns:lg,rowKey:"id",dataSource:a,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function gg(e){var t=e.loading,a=e.items;return n.a.createElement(Il.a,{loading:t,columns:sg,rowKey:"id",dataSource:a,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function bg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return hg(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return hg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hg(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function yg(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function vg(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yg(Object(a),!0).forEach((function(t){Og(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yg(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function wg(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Og(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}mg.propTypes=dg,pg.propTypes=dg,fg.propTypes=dg,gg.propTypes=dg;class _g extends n.a.Component{constructor(){super(...arguments),Og(this,"state",{activeTab:A.hash,isLoading:!0,error:null,queueCounters:[],overallCounters:{started:0,queued:0},startedJobs:[],workers:[]}),Og(this,"_refreshTimer",null),Og(this,"refresh",()=>{B.get("/api/admin/queries/rq_status").then(e=>this.processQueues(e)).catch(e=>this.handleError(e)),this._refreshTimer=setTimeout(this.refresh,6e4)}),Og(this,"processQueues",e=>{var t=e.queues,a=e.workers,r=Object(l.values)(t).map(e=>{var t=e.started,a=wg(e,["started"]);return vg({started:t.length},a)}),n=r.reduce((e,t)=>({started:e.started+t.started,queued:e.queued+t.queued}),{started:0,queued:0}),o=Object(l.flatMap)(Object(l.values)(t),e=>e.started.map(e=>vg(vg({},e),{},{enqueued_at:Ea.a.utc(e.enqueued_at),started_at:Ea.a.utc(e.started_at)})));this.setState({isLoading:!1,queueCounters:r,startedJobs:o,overallCounters:n,workers:a})}),Og(this,"handleError",e=>{this.setState({isLoading:!1,error:e})})}componentDidMount(){da("view","page","admin/rq_status"),this.refresh()}componentWillUnmount(){clearTimeout(this._refreshTimer),this.processQueues=()=>{},this.handleError=()=>{}}render(){var e=this.state,t=e.isLoading,a=e.error,r=e.queueCounters,o=e.startedJobs,i=e.overallCounters,s=e.workers,c=e.activeTab,d=bg(Object(l.partition)(o,["name","redash.tasks.queries.execution.execute_query"]),2),m=d[0],p=d[1];return n.a.createElement(gf,{activeTab:"jobs"},n.a.createElement("div",{className:"p-15"},a&&n.a.createElement(u.a,{type:"error",message:window.W_L.loading_failed}),!a&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Vn.Row,{gutter:15,className:"m-b-15"},n.a.createElement(Vn.Col,{span:8},n.a.createElement(ig,{title:window.W_L.started_job,value:i.started,loading:t})),n.a.createElement(Vn.Col,{span:8},n.a.createElement(ig,{title:window.W_L.queen_job,value:i.queued,loading:t}))),n.a.createElement(Jn.a,{activeKey:c||"queues",onTabClick:e=>{A.setHash(e),this.setState({activeTab:e})},animated:!1},n.a.createElement(Jn.a.TabPane,{key:"queues",tab:"Queues"},n.a.createElement(pg,{loading:t,items:r})),n.a.createElement(Jn.a.TabPane,{key:"workers",tab:"Workers"},n.a.createElement(mg,{loading:t,items:s})),n.a.createElement(Jn.a.TabPane,{key:"queries",tab:"Queries"},n.a.createElement(fg,{loading:t,items:m})),n.a.createElement(Jn.a.TabPane,{key:"other",tab:"Other Jobs"},n.a.createElement(gg,{loading:t,items:p}))))))}}rf.register("Admin.Jobs",Zt({path:"/admin/queries/jobs",title:window.W_L.queen_status,render:e=>n.a.createElement(_g,e)}));function Eg(e){var t=e.page,a=e.showPageSizeSelect,r=e.pageSize,o=e.onPageSizeChange,i=e.totalCount,l=e.onChange;return i<=(a?5:r)?null:n.a.createElement("div",{className:"paginator-container"},n.a.createElement(Kc.a,{showSizeChanger:a,pageSizeOptions:["5","10","20","50","100"],onShowSizeChange:(e,t)=>o(t),defaultCurrent:t,pageSize:r,total:i,onChange:l}))}function jg(){return(jg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Sg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Cg(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Cg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cg(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function xg(e){var t=e.dialog,a=e.tags,o=e.getAvailableTags,i=Sg(Object(r.useState)([]),2),s=i[0],c=i[1],u=Sg(Object(r.useState)(!0),2),d=u[0],m=u[1],p=Sg(Object(r.useState)(()=>Object(l.uniq)(Object(l.map)(a,l.trim))),2),f=p[0],g=p[1],b=Sg(Object(r.useState)(null),2),h=b[0],y=b[1];return Object(r.useEffect)(()=>{h&&!d&&h.focus()},[h,d]),Object(r.useEffect)(()=>{var e=!1;return o().then(t=>{e||(c(Object(l.uniq)(Object(l.compact)(Object(l.map)(t,l.trim)))),m(!1))}),()=>{e=!0}},[o]),n.a.createElement(R.a,jg({},t.props,{onOk:()=>t.close(f),title:window.W_L.add_edit_tag,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,className:"shortModal",wrapProps:{"data-test":"EditTagsDialog"}}),n.a.createElement(Yr.a,{ref:y,mode:"tags",className:"w-100",placeholder:window.W_L.add_more_tag,defaultValue:f,onChange:e=>g(Object(l.compact)(Object(l.map)(e,l.trim))),disabled:d,loading:d},Object(l.map)(s,e=>n.a.createElement(Yr.a.Option,{key:e},e))))}Eg.propTypes={page:ae.a.number.isRequired,showPageSizeSelect:ae.a.bool,pageSize:ae.a.number.isRequired,totalCount:ae.a.number.isRequired,onPageSizeChange:ae.a.func,onChange:ae.a.func},Eg.defaultProps={showPageSizeSelect:!1,onChange:()=>{},onPageSizeChange:()=>{}},xg.propTypes={dialog:ia.isRequired,tags:ae.a.arrayOf(ae.a.string),getAvailableTags:ae.a.func.isRequired},xg.defaultProps={tags:[]};var Pg=la(xg);function Lg(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function kg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ng extends n.a.Component{constructor(){super(...arguments),kg(this,"editTags",(e,t)=>{Pg.showModal({tags:e,getAvailableTags:t}).onClose(this.props.onEdit)})}renderEditButton(){var e=Object(l.map)(this.props.tags,l.trim);return n.a.createElement(ge,{className:"label label-tag hidden-xs",onClick:()=>this.editTags(e,this.props.getAvailableTags),"data-test":"EditTagsButton"},0===e.length&&n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"zmdi zmdi-plus m-r-5","aria-hidden":"true"}),window.W_L.add_tag),e.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"zmdi zmdi-edit","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Edit")))}render(){var e=this.props,t=e.tags,a=e.tagSeparator;return n.a.createElement("div",{className:"tags-control "+this.props.className,"data-test":"TagsControl"},this.props.children,Object(l.map)(t,(e,t)=>n.a.createElement(n.a.Fragment,{key:e},a&&t>0&&n.a.createElement("span",{className:"tag-separator"},a),n.a.createElement("span",{className:"label label-tag",key:e,title:e,"data-test":"TagLabel"},e))),this.props.canEdit&&this.renderEditButton(),this.props.tagsExtra)}}function Ag(e){var t=e.archivedTooltip;function a(e){var a=e.isDraft,r=e.isArchived,o=Lg(e,["isDraft","isArchived"]);return n.a.createElement(Ng,o,!r&&a&&n.a.createElement("span",{className:"label label-tag-unpublished"},window.W_L.draft),r&&n.a.createElement(we,{placement:"right",title:t},n.a.createElement("span",{className:"label label-tag-archived"},window.W_L.archived)))}return a.propTypes={isDraft:ae.a.bool,isArchived:ae.a.bool},a.defaultProps={isDraft:!1,isArchived:!1},a}kg(Ng,"propTypes",{tags:ae.a.arrayOf(ae.a.string),canEdit:ae.a.bool,getAvailableTags:ae.a.func,onEdit:ae.a.func,className:ae.a.string,tagsExtra:ae.a.node,tagSeparator:ae.a.node,children:ae.a.node}),kg(Ng,"defaultProps",{tags:[],canEdit:!1,getAvailableTags:()=>Promise.resolve([]),onEdit:()=>{},className:"",tagsExtra:null,tagSeparator:null,children:null});var Tg=Ag({archivedTooltip:window.W_L.archived_info}),Wg=Ag({archivedTooltip:window.W_L.archived_info});a(592);function Ig(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qg(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return qg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qg(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Dg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Rg extends n.a.Component{get content(){var e=(this.props.schedule||Rg.defaultProps.schedule).interval;if(!e)return[window.W_L.flush_never];var t=Qf(e,{omitSingleValueNumber:!0}),a=window.W_L.every+"".concat(t),r=window.W_L.every+"".concat(t)+window.W_L.auto_flush,n=this.props.schedule,o=n.time,i=n.day_of_week;return o&&(r+=window.W_L.at+"  ".concat(Bf(o))),i&&(r+=window.W_L.on+"  ".concat(i)),[a,r]}render(){if(this.props.isNew)return window.W_L.flush_never;var e=Ig(this.content,2),t=e[0],a=e[1],r=a?n.a.createElement(we,{title:a},t):t;return this.props.isLink?n.a.createElement(ge,{type:"link",className:"schedule-phrase",onClick:this.props.onClick,"data-test":"EditSchedule"},r):r}}function Mg(){return(Mg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function zg(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Fg(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Vg(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fg(Object(a),!0).forEach((function(t){Ug(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fg(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ug(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Dg(Rg,"propTypes",{schedule:Sf,isNew:ae.a.bool.isRequired,isLink:ae.a.bool,onClick:ae.a.func}),Dg(Rg,"defaultProps",{schedule:Cf,isLink:!1,onClick:()=>{}});var Bg=ae.a.shape({params:ae.a.object.isRequired,isLoaded:ae.a.bool.isRequired,isEmpty:ae.a.bool.isRequired,searchTerm:ae.a.string,updateSearch:ae.a.func.isRequired,selectedTags:ae.a.array.isRequired,updateSelectedTags:ae.a.func.isRequired,orderByField:ae.a.string,orderByReverse:ae.a.bool.isRequired,toggleSorting:ae.a.func.isRequired,page:ae.a.number.isRequired,itemsPerPage:ae.a.number.isRequired,totalItemsCount:ae.a.number.isRequired,pageSizeOptions:ae.a.arrayOf(ae.a.number).isRequired,pageItems:ae.a.array.isRequired,updatePagination:ae.a.func.isRequired,handleError:ae.a.func.isRequired});function Hg(e,t,a){class r extends n.a.Component{constructor(e){super(e),Ug(this,"_itemsSource",void 0);var r=a(),n=t();this._itemsSource=n,n.setState(Vg(Vg({},r.getState()),{},{validate:!1})),n.getCallbackContext=()=>this.state,n.onBeforeUpdate=()=>{var e=n.getState();r.setState(e),this.setState(this.getState(Vg(Vg({},e),{},{isLoaded:!1})))},n.onAfterUpdate=()=>{var e=n.getState();this.setState(this.getState(Vg(Vg({},e),{},{isLoaded:!0})))},n.onError=e=>this.props.onError(e);var o=this.getState(Vg(Vg({},n.getState()),{},{isLoaded:!1})),i=n.updatePagination,s=n.toggleSorting,c=n.updateSearch,u=n.updateSelectedTags,d=n.update,m=n.handleError;this.state=Vg(Vg({},o),{},{toggleSorting:s,updateSearch:Object(l.debounce)(c,200),updateSelectedTags:u,updatePagination:i,update:d,handleError:m})}componentDidMount(){this.state.update()}componentWillUnmount(){this._itemsSource.onBeforeUpdate=()=>{},this._itemsSource.onAfterUpdate=()=>{},this._itemsSource.onError=()=>{}}getState(e){var t=e.isLoaded,a=e.totalCount,r=e.pageItems,n=e.params;return Vg(Vg({},zg(e,["isLoaded","totalCount","pageItems","params"])),{},{params:Vg(Vg({},n),Object(l.omit)(this.props,["onError","children"])),isLoaded:t,isEmpty:!t||0===a,totalItemsCount:a||0,pageSizeOptions:Y.pageSizeOptions,pageItems:r||[]})}render(){var t=this.props,a=t.children,r=(t.onError,zg(t,["children","onError"]));return n.a.createElement(e,Mg({},r,{controller:this.state}),a)}}return Ug(r,"propTypes",{onError:ae.a.func,children:ae.a.node}),Ug(r,"defaultProps",{onError:e=>{setTimeout(()=>{throw e})},children:null}),Fn()(r,e),r}function Yg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Qg{get totalPages(){return Math.ceil(this.totalCount/this.itemsPerPage)}setPage(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(l.isUndefined)(e)||(e=parseInt(e,10)||1,this.page=t?e>=1&&e<=this.totalPages?e:1:e>=1?e:1)}setItemsPerPage(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(l.isUndefined)(e)||(e=parseInt(e,10)||20,this.itemsPerPage=e>=1?e:1,t&&this.setPage(this.page,t))}setTotalCount(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(l.isUndefined)(e)||(e=parseInt(e,10)||0,this.totalCount=e,t&&this.setPage(this.page,t))}constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,a=e.itemsPerPage,r=e.totalCount,n=e.validate,o=void 0===n||n;Yg(this,"page",1),Yg(this,"itemsPerPage",20),Yg(this,"totalCount",0),this.setItemsPerPage(a,o),this.setTotalCount(r,o),this.setPage(t,o)}getItemsForPage(e){var t=this.itemsPerPage*(this.page-1),a=t+this.itemsPerPage;return e.slice(t,a)}}function Kg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Gg(e,t){return e?t?"-"+e:e:null}function $g(e){var t=(e=Object(l.isString)(e)?e:"").startsWith("-");return t&&(e=e.substring(1)),{field:""!==e?e:null,reverse:t}}class Jg{get compiled(){return Gg(this.field,this.reverse)}set compiled(e){var t=$g(e),a=t.field,r=t.reverse;this.field=a,this.reverse=r}setField(e){this.field=Object(l.isString)(e)&&""!==e?e:null}setReverse(e){this.reverse=!!e}constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.orderByField,a=e.orderByReverse,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;Kg(this,"field",null),Kg(this,"reverse",!1),Kg(this,"sortByIteratees",null),this.setField(t),this.setReverse(a),this.sortByIteratees=r}toggleField(e){Object(l.isString)(e)&&""!==e&&(e===this.field?this.reverse=!this.reverse:(this.field=e,this.reverse=!1))}sort(e){if(this.field){var t=this.sortByIteratees&&this.sortByIteratees[this.field];return e=Object(l.sortBy)(e,t?[t]:this.field),this.reverse&&e.reverse(),e}}}class Xg{_getRequest(e,t){return this._originalGetRequest({},t)}_processResults(e,t,a){var r=e.results,n=e.count;return{results:this._originalProcessResults(r,a),count:n}}constructor(e){var t=e.getRequest,a=e.doRequest,r=e.processResults;this._originalGetRequest=Object(l.isFunction)(t)?t:l.identity,this._originalDoRequest=a,this._originalProcessResults=Object(l.isFunction)(r)?r:l.identity}fetch(e,t,a){var r=this._getRequest(t,a);return this._originalDoRequest(r,a).then(e=>this._processResults(e,t,a))}}class Zg extends Xg{constructor(){super(...arguments),function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(this,"_allItems",[])}_getRequest(e,t){var a=e.searchTerm,r=e.selectedTags;return this._originalGetRequest({q:Object(l.isString)(a)&&""!==a?a:void 0,tags:r},t)}_processResults(e,t,a){var r=t.paginator,n=t.sorter;return this._allItems=this._originalProcessResults(e,a),this._allItems=n.sort(this._allItems),{results:r.getItemsForPage(this._allItems),count:this._allItems.length,allResults:this._allItems}}fetch(e,t,a){if(Object(l.isNil)(e)||e.tags||e.sorting)return super.fetch(e,t,a);var r=t.paginator,n=t.sorter;return e.sorting&&(this._allItems=n.sort(this._allItems)),Promise.resolve({results:r.getItemsForPage(this._allItems),count:this._allItems.length,allResults:this._allItems})}}class eb extends Xg{_getRequest(e,t){var a=e.paginator,r=e.sorter,n=e.searchTerm,o=e.selectedTags;return this._originalGetRequest({page:a.page,page_size:a.itemsPerPage,order:r.compiled,q:Object(l.isString)(n)&&""!==n?n:void 0,tags:o},t)}}function tb(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function ab(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function rb(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ab(Object(a),!0).forEach((function(t){nb(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ab(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function nb(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class ob{_beforeUpdate(){return Object(l.isFunction)(this.onBeforeUpdate)?Promise.resolve(this.onBeforeUpdate(this.getState(),this.getCallbackContext())):Promise.resolve()}_afterUpdate(){return Object(l.isFunction)(this.onAfterUpdate)?Promise.resolve(this.onAfterUpdate(this.getState(),this.getCallbackContext())):Promise.resolve()}_changed(e){var t={paginator:this._paginator,sorter:this._sorter,searchTerm:this._searchTerm,selectedTags:this._selectedTags},a={},r=rb(rb({},this.getCallbackContext()),{},{setCustomParams:e=>{Object(l.extend)(a,e)}});return this._beforeUpdate().then(()=>{var n=Math.random().toString(36).substr(2);return this._currentFetchToken=n,this._fetcher.fetch(e,t,r).then(e=>{var t=e.results,r=e.count,o=e.allResults;if(this._currentFetchToken===n)return this._pageItems=t,this._allItems=o||null,this._paginator.setTotalCount(r),this._params=rb(rb({},this._params),a),this._afterUpdate()}).catch(e=>this.handleError(e))})}constructor(e){var t=e.getRequest,a=e.doRequest,r=e.processResults,n=e.isPlainList,o=void 0!==n&&n,i=e.sortByIteratees,s=void 0===i?void 0:i,c=tb(e,["getRequest","doRequest","processResults","isPlainList","sortByIteratees"]);nb(this,"onBeforeUpdate",null),nb(this,"onAfterUpdate",null),nb(this,"onError",null),nb(this,"sortByIteratees",void 0),nb(this,"getCallbackContext",()=>null),nb(this,"updatePagination",e=>{var t=e.page,a=e.itemsPerPage,r=this._paginator,n=r.page,o=r.itemsPerPage;this._paginator.setItemsPerPage(a),this._paginator.setPage(t),this._changed({pagination:{page:n!==this._paginator.page,itemsPerPage:o!==this._paginator.itemsPerPage}})}),nb(this,"toggleSorting",e=>{this._sorter.toggleField(e),this._savedOrderByField=this._sorter.field,this._changed({sorting:!0})}),nb(this,"updateSearch",e=>{this._searchTerm=e,""===e?this._sorter.setField(this._savedOrderByField):this._sorter.setField(null),this._paginator.setPage(1),this._changed({search:!0,pagination:{page:!0}})}),nb(this,"updateSelectedTags",e=>{this._selectedTags=e,this._paginator.setPage(1),this._changed({tags:!0,pagination:{page:!0}})}),nb(this,"update",()=>this._changed()),nb(this,"handleError",e=>{Object(l.isFunction)(this.onError)&&this.onError(e)}),Object(l.isFunction)(t)||(t=l.identity),this._fetcher=o?new Zg({getRequest:t,doRequest:a,processResults:r}):new eb({getRequest:t,doRequest:a,processResults:r}),this.sortByIteratees=s,this.setState(c),this._pageItems=[],this._params={}}getState(){return{page:this._paginator.page,itemsPerPage:this._paginator.itemsPerPage,orderByField:this._sorter.field,orderByReverse:this._sorter.reverse,searchTerm:this._searchTerm,selectedTags:this._selectedTags,totalCount:this._paginator.totalCount,pageItems:this._pageItems,allItems:this._allItems,params:this._params}}setState(e){this._paginator=new Qg(e),this._sorter=new Jg(e,this.sortByIteratees),this._searchTerm=e.searchTerm||"",this._selectedTags=e.selectedTags||[],this._savedOrderByField=this._sorter.field}}class ib extends ob{constructor(e){var t=e.getResource,a=e.getItemProcessor,r=tb(e,["getResource","getItemProcessor"]);a=Object(l.isFunction)(a)?a:()=>null,super(rb(rb({},r),{},{doRequest:(e,a)=>t(a)(e),processResults:(e,t)=>{var r=a(t);return r=Object(l.isFunction)(r)?r:l.identity,Object(l.map)(e,e=>r(e,t))}}))}}function lb(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function sb(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class cb{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?lb(Object(a),!0).forEach((function(t){sb(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lb(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)}getState(){return Object(l.defaults)(this._state,{page:1,itemsPerPage:Y.pageSize,orderByField:"created_at",orderByReverse:!1,searchTerm:"",tags:[]})}setState(){}}class ub extends cb{getState(){var e=super.getState(),t=A.search,a=t.q||"",r=""!==a?"":Gg(e.orderByField,e.orderByReverse),n=$g(t.order||r),o=n.field,i=n.reverse;return{page:parseInt(t.page,10)||e.page,itemsPerPage:parseInt(t.page_size,10)||e.itemsPerPage,orderByField:o,orderByReverse:i,searchTerm:a}}setState(e){var t=e.page,a=e.itemsPerPage,r=e.orderByField,n=e.orderByReverse,o=e.searchTerm;A.setSearch({page:t,page_size:a,order:Gg(r,n),q:""!==o?o:null},!0)}}function db(){return(db=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function mb(e){return n.a.createElement("div",{className:"text-center"},n.a.createElement(xe,db({icon:"fa-spinner fa-2x fa-pulse",message:window.W_L.loading},e)))}function pb(){return(pb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fb(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class gb extends n.a.Component{constructor(){var e;super(...arguments),e=this,fb(this,"listColumns",[{title:"ID",field:"id",width:"1%",align:"right",sorter:!0},ng.custom.sortable((e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(h,{className:"table-main-title",href:"queries/"+t.id},t.name),n.a.createElement(Tg,{className:"d-block",tags:t.tags,isDraft:t.is_draft,isArchived:t.is_archived})),{title:window.W_L.name,field:"name",width:null}),ng.avatar({field:"user",className:"p-l-0 p-r-0"},e=>window.W_L.create_user+" ".concat(e)),ng.dateTime.sortable({title:window.W_L.create_time,field:"created_at"}),ng.duration.sortable({title:window.W_L.run_time,field:"runtime"}),ng.dateTime.sortable({title:window.W_L.last_exec_datetime,field:"retrieved_at",orderByField:"executed_at"}),ng.custom.sortable((e,t)=>n.a.createElement(Rg,{schedule:t.schedule,isNew:t.isNew()}),{title:window.W_L.update_schedule,field:"schedule"})]),fb(this,"state",{autoUpdate:!0}),fb(this,"_updateTimer",null),fb(this,"autoUpdateSwitchId",Object(l.uniqueId)("auto-update-switch")),fb(this,"update",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!t&&e.state.autoUpdate&&e.props.controller.update(),e._updateTimer=setTimeout(e.update,6e4)}))}componentDidMount(){da("view","page","admin/queries/outdated"),this.update(!0)}componentWillUnmount(){clearTimeout(this._updateTimer)}render(){var e=this.props.controller;return n.a.createElement(gf,{activeTab:e.params.currentPage},n.a.createElement("div",{className:"m-15"},n.a.createElement("div",null,n.a.createElement("label",{htmlFor:this.autoUpdateSwitchId,className:"m-0"},window.W_L.auto_update),n.a.createElement(so.a,{id:this.autoUpdateSwitchId,className:"m-l-10",checked:this.state.autoUpdate,onChange:e=>this.setState({autoUpdate:e})})),e.params.lastUpdatedAt&&n.a.createElement("div",{className:"m-t-5"},window.W_L.last_update_time,"：",n.a.createElement(qf,{date:1e3*e.params.lastUpdatedAt}))),!e.isLoaded&&n.a.createElement(mb,null),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center p-15"},"There are no outdated queries."),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(og,{items:e.pageItems,columns:this.listColumns,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))}}fb(gb,"propTypes",{controller:Bg.isRequired});var bb=Hg(gb,()=>new ob({doRequest:(e,t)=>B.get("/api/admin/queries/outdated").then(e=>{var a=e.queries,r=e.updated_at;return t.setCustomParams({lastUpdatedAt:parseFloat(r)}),a}),processResults:e=>Object(l.map)(e,e=>new Za(e)),isPlainList:!0}),()=>new cb({orderByField:"created_at",orderByReverse:!0}));rf.register("Admin.OutdatedQueries",Zt({path:"/admin/queries/outdated",title:window.W_L.out_date_query,render:e=>n.a.createElement(bb,pb({},e,{currentPage:"outdated_queries"}))}));var hb=a(67),yb=a.n(hb);function vb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wb(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return wb(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wb(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ob(e){var t=e.info;return t=Object(l.toPairs)(t),n.a.createElement(en.a,{title:window.W_L.general,size:"small"},0===t.length&&n.a.createElement("div",{className:"text-muted text-center"},window.W_L.no_data),t.length>0&&n.a.createElement(yb.a,{size:"small",itemLayout:"vertical",dataSource:t,renderItem:e=>{var t=vb(e,2),a=t[0],r=t[1];return n.a.createElement(yb.a.Item,{extra:n.a.createElement("span",{className:"badge"},r)},Kf(a))}}))}function _b(e){var t=e.info;return n.a.createElement(en.a,{title:window.W_L.database,size:"small"},0===t.length&&n.a.createElement("div",{className:"text-muted text-center"},window.W_L.no_data),t.length>0&&n.a.createElement(yb.a,{size:"small",itemLayout:"vertical",dataSource:t,renderItem:e=>{var t=vb(e,2),a=t[0],r=t[1];return n.a.createElement(yb.a.Item,{extra:n.a.createElement("span",{className:"badge"},Jf(r))},a)}}))}function Eb(e){var t=e.info;return t=Object(l.toPairs)(t),n.a.createElement(en.a,{title:window.W_L.queue,size:"small"},0===t.length&&n.a.createElement("div",{className:"text-muted text-center"},window.W_L.no_data),t.length>0&&n.a.createElement(yb.a,{size:"small",itemLayout:"vertical",dataSource:t,renderItem:e=>{var t=vb(e,2),a=t[0],r=t[1];return n.a.createElement(yb.a.Item,{extra:n.a.createElement("span",{className:"badge"},r.size)},a)}}))}function jb(e){var t=e.info,a=t?[n.a.createElement(yb.a.Item,{extra:n.a.createElement("span",{className:"badge"},n.a.createElement(qf,{date:t.lastRefreshAt,placeholder:"n/a"}))},window.W_L.last_fresh),n.a.createElement(yb.a.Item,{extra:n.a.createElement("span",{className:"badge"},n.a.createElement(qf,{date:t.startedAt,placeholder:"n/a"}))},window.W_L.started),n.a.createElement(yb.a.Item,{extra:n.a.createElement("span",{className:"badge"},t.outdatedQueriesCount)},window.W_L.outdated_query_count)]:[];return n.a.createElement(en.a,{title:window.W_L.manage,size:"small"},!t&&n.a.createElement("div",{className:"text-muted text-center"},window.W_L.no_data),t&&n.a.createElement(yb.a,{size:"small",itemLayout:"vertical",dataSource:a,renderItem:e=>e}))}a(1317);function Sb(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Cb extends n.a.Component{constructor(){super(...arguments),Sb(this,"state",{queues:[],manager:null,databaseMetrics:{},status:{}}),Sb(this,"_refreshTimer",null),Sb(this,"refresh",()=>{B.get("/status.json").then(e=>{this.setState({queues:e.manager.queues,manager:{startedAt:1e3*e.manager.started_at,lastRefreshAt:1e3*e.manager.last_refresh_at,outdatedQueriesCount:e.manager.outdated_queries_count},databaseMetrics:e.database_metrics.metrics||[],status:Object(l.omit)(e,["workers","manager","database_metrics"])})}).catch(e=>this.props.onError(e)),this._refreshTimer=setTimeout(this.refresh,6e4)})}componentDidMount(){da("view","page","admin/status"),this.refresh()}componentWillUnmount(){clearTimeout(this._refreshTimer)}render(){return n.a.createElement(gf,{activeTab:"system_status"},n.a.createElement("div",{className:"system-status-page"},n.a.createElement("div",{className:"system-status-page-blocks"},n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(Ob,{info:this.state.status})),n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(jb,{info:this.state.manager})),n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(Eb,{info:this.state.queues})),n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(_b,{info:this.state.databaseMetrics})))))}}function xb(){return(xb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}Sb(Cb,"propTypes",{onError:ae.a.func}),Sb(Cb,"defaultProps",{onError:()=>{}}),rf.register("Admin.SystemStatus",Zt({path:"/admin/status",title:window.W_L.out_date_query,render:e=>n.a.createElement(Cb,e)}));var Pb={"greater than":">","less than":"<",equals:"="},Lb=e=>Object(l.merge)({},e,{options:{op:Pb[e.options.op]||e.options.op}}),kb={query:()=>B.get("api/alerts"),get:e=>{var t=e.id;return B.get("api/alerts/".concat(t)).then(Lb)},save:e=>B.post((e=>e.id?"api/alerts/".concat(e.id):"api/alerts")(e),(e=>{var t=xb({},e);return void 0===t.query_id&&(t.query_id=t.query.id,t.destination_id=t.destinations,delete t.query,delete t.destinations),t})(e)),delete:e=>B.delete("api/alerts/".concat(e.id)),mute:e=>B.post("api/alerts/".concat(e.id,"/mute")),unmute:e=>B.delete("api/alerts/".concat(e.id,"/mute"))};function Nb(){return(Nb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ab(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Tb={unknown:"label-warning",ok:"label-success",triggered:"label-danger"};class Wb extends n.a.Component{constructor(){super(...arguments),Ab(this,"listColumns",[ng.custom.sortable((e,t)=>n.a.createElement("span",{title:t.options.muted?"Muted":"Active"},n.a.createElement("i",{className:"fa fa-bell-".concat(t.options.muted?"slash":"o"," p-r-0"),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},t.options.muted?"Muted":"Active")),{title:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-bell p-r-0","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Sort by notification status.")),field:"muted",width:"1%"}),ng.custom.sortable((e,t)=>n.a.createElement("div",null,n.a.createElement(h,{className:"table-main-title",href:"alerts/"+t.id},t.name)),{title:window.W_L.name,field:"name"}),ng.custom((e,t)=>t.user.name,{title:window.W_L.create_user,width:"1%"}),ng.custom.sortable((e,t)=>n.a.createElement("div",null,n.a.createElement("span",{className:"label ".concat(Tb[t.state])},Object(l.toUpper)(t.state))),{title:window.W_L.status,field:"state",width:"1%",className:"text-nowrap"}),ng.timeAgo.sortable({title:window.W_L.last_update_time,field:"updated_at",width:"1%"}),ng.dateTime.sortable({title:window.W_L.create_time,field:"created_at",width:"1%"})])}render(){var e=this.props.controller;return n.a.createElement("div",{className:"page-alerts-list"},n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:e.params.pageTitle,actions:H.hasPermission("list_alerts")?n.a.createElement(h.Button,{block:!0,type:"primary",href:"alerts/new"},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.new_alert):null}),n.a.createElement("div",null,e.isLoaded&&e.isEmpty?n.a.createElement(se,{name:"AlertsList.EmptyState"},n.a.createElement(Rp,{icon:"fa fa-bell-o",illustration:"alert",description:window.W_L.get_notice_event,helpMessage:n.a.createElement(qp,{helpTriggerType:"ALERTS"}),showAlertStep:!0})):n.a.createElement("div",{className:"table-responsive bg-white tiled"},n.a.createElement(og,{loading:!e.isLoaded,items:e.pageItems,columns:this.listColumns,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}Ab(Wb,"propTypes",{controller:Bg.isRequired});var Ib=Hg(Wb,()=>new ib({isPlainList:!0,getRequest:()=>({}),getResource:()=>kb.query.bind(kb)}),()=>new cb({orderByField:"created_at",orderByReverse:!0,itemsPerPage:20}));rf.register("Alerts.List",Zt({path:"/alerts",title:window.W_L.alerts,render:e=>n.a.createElement(Ib,Nb({},e,{currentPage:"alerts"}))}));var qb=a(127),Db=a.n(qb);function Rb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Mb(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Mb(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mb(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function zb(e){var t=e.doDelete,a=e.canEdit,o=e.mute,i=e.unmute,l=e.muted,s=Rb(Object(r.useState)(!1),2),c=s[0],u=s[1],d=Object(r.useCallback)(e=>{u(!0),e().finally(()=>{u(!1)})},[]),p=Object(r.useCallback)(()=>{R.a.confirm({title:window.W_L.delete_alert,content:window.W_L.delete_alert_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:()=>{u(!0),t().catch(()=>{u(!1)})},maskClosable:!0,autoFocusButton:null})},[t]);return n.a.createElement(Vt.a,{className:me()("m-l-5",{disabled:!a}),trigger:[a?"click":void 0],placement:"bottomRight",overlay:n.a.createElement(ue.a,null,n.a.createElement(ue.a.Item,null,l?n.a.createElement(ge,{onClick:()=>d(i)},window.W_L.alert_unmute):n.a.createElement(ge,{onClick:()=>d(o)},window.W_L.alert_mute)),n.a.createElement(ue.a.Item,null,n.a.createElement(ge,{onClick:p},window.W_L.delete)))},n.a.createElement(m.a,{"aria-label":"More actions"},c?n.a.createElement(of.a,null):n.a.createElement(Db.a,{rotate:90,"aria-hidden":"true"})))}zb.propTypes={doDelete:ae.a.func.isRequired,canEdit:ae.a.bool.isRequired,mute:ae.a.func.isRequired,unmute:ae.a.func.isRequired,muted:ae.a.bool},zb.defaultProps={muted:!1};var Fb=a(25),Vb=a.n(Fb);a(1318);function Ub(e){var t=e.alert,a=e.editMode,r=e.name,o=e.onChange,i=e.children,l=ty(t);return n.a.createElement("div",{className:"alert-header"},n.a.createElement("div",{className:"alert-title"},n.a.createElement("h3",null,a&&t.query?n.a.createElement(ta.a,{className:"f-inherit",placeholder:l,value:r,"aria-label":"Alert title",onChange:e=>o(e.target.value)}):r||l)),n.a.createElement("div",{className:"alert-actions"},i))}Ub.propTypes={alert:Nf.isRequired,name:ae.a.string,children:ae.a.node,onChange:ae.a.func,editMode:ae.a.bool},Ub.defaultProps={name:null,children:null,onChange:null,editMode:!1};var Bb=a(207),Hb=a.n(Bb),Yb=a(133),Qb=a.n(Yb),Kb=(a(1319),{">":">",">=":"≥","<":"<","<=":"≤","==":"=","!=":"≠"}),Gb=["==","!="];function $b(e){var t=e.children,a=e.minWidth;return n.a.createElement("div",{className:"criteria-disabled-input",style:{minWidth:a}},t)}function Jb(e){var t=e.columnNames,a=e.resultValues,r=e.alertOptions,o=e.onChange,i=e.editMode,s=Object(l.isEmpty)(a)?null:Object(l.head)(a)[r.column],c=Object(l.includes)(Gb,r.op)?null:isNaN(r.value)?window.W_L.type_not_match_value:isNaN(s)?window.W_L.type_not_match_condition:null,u=n.a.createElement("small",{className:"alert-criteria-hint"},window.W_L.top_value," ",n.a.createElement("code",{className:"p-0"},Object(l.toString)(s)||"unknown"));return n.a.createElement("div",{"data-test":"Criteria"},n.a.createElement("div",{className:"input-title"},n.a.createElement("span",{className:"input-label"},window.W_L.column_value),i?n.a.createElement(Yr.a,{value:r.column,onChange:e=>o({column:e}),dropdownMatchSelectWidth:!1,style:{minWidth:100}},t.map(e=>n.a.createElement(Yr.a.Option,{key:e},e))):n.a.createElement($b,{minWidth:70},r.column)),n.a.createElement("div",{className:"input-title"},n.a.createElement("span",{className:"input-label"},window.W_L.condition),i?n.a.createElement(Yr.a,{value:r.op,onChange:e=>o({op:e}),optionLabelProp:"label",dropdownMatchSelectWidth:!1,style:{width:55}},n.a.createElement(Yr.a.Option,{value:">",label:Kb[">"]},Kb[">"]," ",window.W_L.great_then),n.a.createElement(Yr.a.Option,{value:">=",label:Kb[">="]},Kb[">="]," ",window.W_L.great_and_equals),n.a.createElement(Yr.a.Option,{disabled:!0,key:"dv1"},n.a.createElement(Qb.a,{className:"select-option-divider m-t-10 m-b-5"})),n.a.createElement(Yr.a.Option,{value:"<",label:Kb["<"]},Kb["<"]," ",window.W_L.less_then),n.a.createElement(Yr.a.Option,{value:"<=",label:Kb["<="]},Kb["<="]," ",window.W_L.less_and_equals),n.a.createElement(Yr.a.Option,{disabled:!0,key:"dv2"},n.a.createElement(Qb.a,{className:"select-option-divider m-t-10 m-b-5"})),n.a.createElement(Yr.a.Option,{value:"==",label:Kb["=="]},Kb["=="],"  ",window.W_L.equals),n.a.createElement(Yr.a.Option,{value:"!=",label:Kb["!="]},Kb["!="],"  ",window.W_L.not_equals)):n.a.createElement($b,{minWidth:50},Kb[r.op])),n.a.createElement("div",{className:"input-title"},n.a.createElement("label",{className:"input-label",htmlFor:"threshold-criterion"},window.W_L.threshold),i?n.a.createElement(ta.a,{id:"threshold-criterion",style:{width:90},value:r.value,onChange:e=>o({value:e.target.value})}):n.a.createElement($b,{minWidth:50},r.value)),n.a.createElement("div",{className:"ant-form-item-explain"},u,n.a.createElement("br",null),c&&n.a.createElement("small",null,n.a.createElement(Hb.a,{className:"warning-icon-danger"})," ",c)))}$b.propTypes={children:ae.a.node.isRequired,minWidth:ae.a.number.isRequired},Jb.propTypes={columnNames:ae.a.arrayOf(ae.a.string).isRequired,resultValues:ae.a.arrayOf(ae.a.object).isRequired,alertOptions:kf.isRequired,onChange:ae.a.func,editMode:ae.a.bool},Jb.defaultProps={onChange:()=>{},editMode:!1};a(1322);function Xb(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Zb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return eh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return eh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var th=[[window.W_L.second,1],[window.W_L.minute,60],[window.W_L.hour,3600],[window.W_L.day,86400],[window.W_L.week,604800]];function ah(e){var t=e.value,a=e.onChange,o=e.editMode,i=Zb(Object(r.useState)(),2),s=i[0],c=i[1],u=Zb(Object(r.useState)(),2),d=u[0],m=u[1];if(Object(r.useEffect)(()=>{for(var e=th.length-1;e>=0;e-=1){var a=Zb(th[e],2)[1];if(t%a==0){c(e),m(t/a);break}}},[t]),!Object(l.isNumber)(d)||!Object(l.isNumber)(s))return null;var p=1!==d?"s":"";if(o)return n.a.createElement(n.a.Fragment,null,n.a.createElement(Kr.a,{value:d,onChange:e=>{m(e),a(e*th[s][1])},min:1,precision:0}),n.a.createElement(Yr.a,{value:s,onChange:e=>{c(e),a(d*th[e][1])}},th.map((e,t)=>{var a=Zb(e,1)[0];return n.a.createElement(Yr.a.Option,{value:t,key:a},a,p)})));var f=Zb(th[s],1)[0];return d+" "+Object(l.toLower)(f)+p}function rh(e){var t=e.value,a=e.onChange,o=Zb(Object(r.useState)(t<2?t:2),2),i=o[0],l=o[1];return n.a.createElement("div",{className:"alert-rearm"},n.a.createElement(Yr.a,{optionLabelProp:"label",defaultValue:i||0,dropdownMatchSelectWidth:!1,onChange:e=>{l(e),a(e<2?e:3600)}},n.a.createElement(Yr.a.Option,{value:0,label:window.W_L.alert_one_time},window.W_L.alert_one_time_tip),n.a.createElement(Yr.a.Option,{value:1,label:window.W_L.alert_every_time},window.W_L.alert_every_time_tip),n.a.createElement(Yr.a.Option,{value:2,label:window.W_L.alert_most_once},window.W_L.alert_most_once_tip)),2===i&&t&&n.a.createElement(ah,{value:t,onChange:a,editMode:!0}))}function nh(e){var t=e.value,a="";switch(t){case 0:a=window.W_L.alert_one_time_tip;break;case 1:a=window.W_L.alert_every_time_tip;break;default:a=n.a.createElement(n.a.Fragment,null,window.W_L.alert_most_once_tip," ",n.a.createElement(ah,{value:t,editMode:!1}))}return n.a.createElement("span",null,window.W_L.notice_will_send," ",a,".")}function oh(e){var t=e.editMode,a=Xb(e,["editMode"]);return t?n.a.createElement(rh,a):n.a.createElement(nh,a)}function ih(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return lh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return lh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function sh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.initialResults,n=void 0===a?null:a,o=t.debounceTimeout,i=void 0===o?200:o,l=Object(r.useState)(n),s=ih(l,2),c=s[0],u=s[1],d=Object(r.useState)(!1),m=ih(d,2),p=m[0],f=m[1],g=Object(r.useRef)(null),b=Object(r.useRef)(!1),h=Object(Sl.a)(t=>{f(!0),g.current=t,e(t).catch(()=>n).then(e=>{t!==g.current||b.current||(u(e),f(!1))})},i),y=ih(h,1),v=y[0];return Object(r.useEffect)(()=>()=>{b.current=!0},[]),[v,c,p]}function ch(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return uh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return uh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}ah.propTypes={onChange:ae.a.func,value:ae.a.number.isRequired,editMode:ae.a.bool.isRequired},ah.defaultProps={onChange:()=>{}},rh.propTypes={onChange:ae.a.func.isRequired,value:ae.a.number.isRequired},nh.propTypes={value:ae.a.number.isRequired},oh.propTypes={onChange:ae.a.func,value:ae.a.number.isRequired,editMode:ae.a.bool},oh.defaultProps={onChange:null,editMode:!1};var dh=Yr.a.Option;function mh(e){return null===e?Promise.resolve(null):e?Za.query({q:e}).then(e=>e.results):Za.recent().then(e=>e.filter(e=>!e.is_draft))}function ph(e){var t=ch(Object(r.useState)(""),2),a=t[0],o=t[1],i=ch(Object(r.useState)(),2),s=i[0],c=i[1],u=ch(sh(mh,{initialResults:[]}),3),d=u[0],m=u[1],p=u[2],f=window.W_L.search_by_name,g=n.a.createElement("i",{className:"fa fa-times hide-in-percy",role:"button",tabIndex:0,"aria-label":"Clear",onClick:()=>h(null)}),b=n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:me()("fa fa-spinner fa-pulse hide-in-percy",{hidden:!p}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Searching..."));function h(t){var a=null;t&&((a=Object(l.find)(m,{id:t}))||Hp.error("Something went wrong...","Couldn't select query")),o(a?null:""),c(a),e.onChange(a)}if(Object(r.useEffect)(()=>{d(a)},[d,a]),Object(r.useEffect)(()=>{e.selectedQuery&&c(e.selectedQuery)},[e.selectedQuery]),e.disabled)return n.a.createElement(ta.a,{value:s&&s.name,"aria-label":"Tied query",placeholder:f,disabled:!0});if("select"===e.type){var y=s?g:null,v=s?s.name:a;return n.a.createElement(Yr.a,{showSearch:!0,dropdownMatchSelectWidth:!1,placeholder:f,value:v||void 0,onSearch:o,onChange:h,suffixIcon:p?b:y,notFoundContent:null,filterOption:!1,defaultActiveFirstOption:!1,className:e.className,"data-test":"QuerySelector"},m&&m.map(e=>{var t=e.is_draft;return n.a.createElement(dh,{value:e.id,key:e.id,disabled:t,className:"query-selector-result","data-test":"QueryId".concat(e.id)},e.name," ",n.a.createElement(Tg,{isDraft:e.is_draft,tags:e.tags,className:me()("inline-tags-control",{disabled:t})}))}))}return n.a.createElement("span",{"data-test":"QuerySelector"},s?n.a.createElement(ta.a,{value:s.name,"aria-label":"Tied query",suffix:g,readOnly:!0}):n.a.createElement(ta.a,{placeholder:f,value:a,"aria-label":"Tied query",onChange:e=>o(e.target.value),suffix:b}),n.a.createElement("div",{className:"scrollbox",style:{maxHeight:"50vh",marginTop:15}},m&&(m.length?n.a.createElement("ul",{className:"list-group"},m.map(e=>n.a.createElement(ge,{className:me()("query-selector-result","list-group-item",{inactive:e.is_draft}),key:e.id,role:"listitem",onClick:()=>h(e.id),"data-test":"QueryId".concat(e.id)},e.name," ",n.a.createElement(Tg,{isDraft:e.is_draft,tags:e.tags,className:"inline-tags-control"})))):n.a.createElement("div",{className:"text-muted"},window.W_L.find_nothing))))}ph.propTypes={onChange:ae.a.func.isRequired,selectedQuery:ae.a.object,type:ae.a.oneOf(["select","default"]),className:ae.a.string,disabled:ae.a.bool},ph.defaultProps={selectedQuery:null,type:"default",className:null,disabled:!1};var fh=a(678),gh=a.n(fh);a(1323);function bh(e){var t=e.query,a=e.queryResult,r=e.onChange,o=e.editMode,i=t&&t.schedule?n.a.createElement("small",null,"Scheduled to refresh"," ",n.a.createElement("i",{className:"alert-query-schedule"},n.a.createElement(Rg,{schedule:t.schedule,isNew:!1}))):n.a.createElement("small",null,n.a.createElement(Hb.a,{className:"warning-icon-danger"})," ",window.W_L.query_not_setting," ",n.a.createElement("i",null,window.W_L.auto_flush),"."," ",n.a.createElement(we,{title:window.W_L.query_setting_tip},n.a.createElement("a",{role:"presentation"},window.W_L.recommend," ",n.a.createElement(gh.a,null))));return n.a.createElement(n.a.Fragment,null,o?n.a.createElement(ph,{onChange:r,selectedQuery:t,className:"alert-query-selector",type:"select"}):n.a.createElement(we,{title:window.W_L.open_query_in_new_tab},n.a.createElement(h,{href:"queries/".concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"alert-query-link"},t.name," ",n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))),n.a.createElement("div",{className:"ant-form-item-explain"},t&&i),t&&!a&&n.a.createElement("div",{className:"m-t-30"},n.a.createElement(of.a,{className:"m-r-5"})," ",window.W_L.load_query_result))}bh.propTypes={query:Lf,queryResult:ae.a.object,onChange:ae.a.func,editMode:ae.a.bool},bh.defaultProps={query:null,queryResult:null,onChange:()=>{},editMode:!1};a(1326);function hh(){return(hh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function yh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return vh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function wh(e){var t=e.items,a=e.renderItem,o=e.onItemClick,i=Object(r.useCallback)(e=>{var t=a(e),r=t.content,i=t.className,l=t.isDisabled;return n.a.createElement(yb.a.Item,{className:me()("select-items-list","w-100","p-l-10","p-r-10",{disabled:l},i),onClick:l?null:()=>o(e)},r)},[a,o]);return n.a.createElement(yb.a,{size:"small",dataSource:t,renderItem:i})}function Oh(e){var t=e.dialog,a=e.dialogTitle,o=e.inputPlaceholder,i=e.itemKey,s=e.renderItem,c=e.renderStagedItem,u=e.searchItems,d=e.selectedItemsTitle,p=e.width,f=e.showCount,g=e.extraFooterContent,b=yh(Object(r.useState)([]),2),h=b[0],y=b[1],v=yh(sh(u,{initialResults:[]}),3),w=v[0],O=v[1],_=v[2],E=O.length>0;Object(r.useEffect)(()=>{w()},[w]);var j=Object(r.useCallback)(e=>{var t=i(e);return!!Object(l.find)(h,e=>i(e)===t)},[h,i]),S=Object(r.useCallback)(e=>{if(j(e)){var t=i(e);y(Object(l.filter)(h,e=>i(e)!==t))}else y([...h,e])},[h,i,j]),C=Object(r.useCallback)(()=>{t.close(h).catch(e=>{e&&Hp.error(window.W_L.save_failed)})},[t,h]);return n.a.createElement(R.a,hh({},t.props,{className:"select-items-dialog",width:p,title:a,footer:n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement("span",{className:"flex-fill m-r-5",style:{textAlign:"left",color:"rgba(0, 0, 0, 0.5)"}},g),n.a.createElement(m.a,hh({},t.props.cancelButtonProps,{onClick:t.dismiss}),window.W_L.cancel),n.a.createElement(m.a,hh({},t.props.okButtonProps,{onClick:C,disabled:0===h.length||t.props.okButtonProps.disabled,type:"primary"}),window.W_L.save,f&&!Object(l.isEmpty)(h)?" (".concat(Object(l.size)(h),")"):null))}),n.a.createElement("div",{className:"d-flex align-items-center m-b-10"},n.a.createElement("div",{className:"flex-fill"},n.a.createElement(ta.a.Search,{onChange:e=>w(e.target.value),placeholder:o,"aria-label":o,autoFocus:!0})),c&&n.a.createElement("div",{className:"w-50 m-l-20"},n.a.createElement("h5",{className:"m-0"},d))),n.a.createElement("div",{className:"d-flex align-items-stretch",style:{minHeight:"30vh",maxHeight:"50vh"}},n.a.createElement("div",{className:"flex-fill scrollbox"},_&&n.a.createElement(mb,{className:""}),!_&&!E&&n.a.createElement(xe,{icon:"fa-search",message:window.W_L.find_nothing,className:""}),!_&&E&&n.a.createElement(wh,{items:O,renderItem:e=>s(e,{isSelected:j(e)}),onItemClick:S})),c&&n.a.createElement("div",{className:"w-50 m-l-20 scrollbox"},h.length>0&&n.a.createElement(wh,{items:h,renderItem:e=>c(e,{isSelected:!0}),onItemClick:S}))))}wh.propTypes={items:ae.a.array,renderItem:ae.a.func,onItemClick:ae.a.func},wh.defaultProps={items:[],renderItem:()=>{},onItemClick:()=>{}},Oh.propTypes={dialog:ia.isRequired,dialogTitle:ae.a.string,inputPlaceholder:ae.a.string,selectedItemsTitle:ae.a.string,searchItems:ae.a.func.isRequired,itemKey:ae.a.func,renderItem:ae.a.func,renderStagedItem:ae.a.func,width:ae.a.oneOfType([ae.a.string,ae.a.number]),extraFooterContent:ae.a.node,showCount:ae.a.bool},Oh.defaultProps={dialogTitle:window.W_L.add,inputPlaceholder:window.W_L.search,selectedItemsTitle:window.W_L.selected,itemKey:e=>e.id,renderItem:()=>"",renderStagedItem:null,width:"80%",extraFooterContent:null,showCount:!1};var _h=la(Oh),Eh="static/images/destinations",jh={query:()=>B.get("api/destinations"),get:e=>{var t=e.id;return B.get("api/destinations/".concat(t))},types:()=>B.get("api/destinations/types"),create:e=>B.post("api/destinations",e),save:e=>B.post("api/destinations/".concat(e.id),e),delete:e=>{var t=e.id;return B.delete("api/destinations/".concat(t))}},Sh={query:e=>{var t=e.alertId;return B.get("api/alerts/".concat(t,"/subscriptions"))},create:e=>B.post("api/alerts/".concat(e.alert_id,"/subscriptions"),e),delete:e=>B.delete("api/alerts/".concat(e.alert_id,"/subscriptions/").concat(e.id))};function Ch(e){var t=e.isSelected,a=e.isStaged,r=e.alreadyInGroup,o=e.deselectedIcon;return a?n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-remove","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Remove")):r?n.a.createElement(we,{title:window.W_L.selected_ready},n.a.createElement("span",{tabIndex:0},n.a.createElement("i",{className:"fa fa-check","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},window.W_L.selected_ready))):t?n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-check","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Selected")):n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa ".concat(o),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Select"))}function xh(e){var t=e.featureName,a=e.className,r=e.mode,o=e.adminOnly,i=Se("sr-mail-description");if(!Y.mailSettingsMissing)return null;if(o&&!H.isAdmin)return null;var l=n.a.createElement("span",{id:i},window.W_L.email_need_set,"，“",t," ” ",window.W_L.email_will_work," ",n.a.createElement(Ge,{type:"MAIL_CONFIG",className:"f-inherit"}));return"icon"===r?n.a.createElement(we,{title:l,placement:"topRight",arrowPointAtCenter:!0},n.a.createElement("span",{className:a,"aria-label":"Mail alert","aria-describedby":i,tabIndex:0},n.a.createElement("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}))):n.a.createElement(u.a,{message:l,type:"error",className:a})}Ch.propTypes={isSelected:ae.a.bool,isStaged:ae.a.bool,alreadyInGroup:ae.a.bool,deselectedIcon:ae.a.string},Ch.defaultProps={isSelected:!1,isStaged:!1,alreadyInGroup:!1,deselectedIcon:"fa-angle-double-right"},xh.propTypes={featureName:ae.a.string.isRequired,className:ae.a.string,mode:ae.a.oneOf(["alert","icon"]),adminOnly:ae.a.bool},xh.defaultProps={className:null,mode:"alert",adminOnly:!1};a(1327);function Ph(){return(Ph=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Lh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return kh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Nh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ah(e){return e.destination||(e.destination={id:-1,name:e.user.email,icon:"DEPRECATED",type:"email"}),e}function Th(e){var t=e.destination,a=t.name,r=t.type,o=e.user,i=e.unsubscribe,l=H.isAdmin||H.id===o.id;return n.a.createElement("li",{className:"destination-wrapper"},n.a.createElement("img",{src:"".concat(Eh,"/").concat(r,".png"),className:"destination-icon",alt:a}),n.a.createElement("span",{className:"flex-fill"},a),"email"===r&&n.a.createElement(xh,{className:"destination-warning",featureName:"alert emails",mode:"icon"}),l&&n.a.createElement(we,{title:window.W_L.delete,mouseEnterDelay:.5},n.a.createElement(ge,{className:"remove-button",onClick:i},n.a.createElement(je.a,null))))}Th.propTypes={destination:Pf.isRequired,user:xf.isRequired,unsubscribe:ae.a.func.isRequired};class Wh extends n.a.Component{constructor(){super(...arguments),Nh(this,"state",{dests:[],subs:null}),Nh(this,"showAddAlertSubDialog",()=>{var e=this.state,t=e.dests,a=e.subs;_h.showModal({width:570,showCount:!0,extraFooterContent:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-info-circle","aria-hidden":"true"})," Create new destinations in"," ",n.a.createElement(we,{title:window.W_L.open_new_window},n.a.createElement(h,{href:"destinations/new",target:"_blank"},window.W_L.alert_setting))),dialogTitle:window.W_L.add_alert_setting,inputPlaceholder:window.W_L.search,searchItems:e=>(e=Object(l.toLower)(e),Promise.resolve(t.filter(t=>Object(l.includes)(Object(l.toLower)(t.name),e)))),renderItem:(e,t)=>{var r=t.isSelected,o=!!Object(l.find)(a,t=>t.destination.id===e.id);return{content:n.a.createElement("div",{className:"destination-wrapper"},n.a.createElement("img",{src:"".concat(Eh,"/").concat(e.type,".png"),className:"destination-icon",alt:e.name}),n.a.createElement("span",{className:"flex-fill"},e.name),n.a.createElement(Ch,{isSelected:r,alreadyInGroup:o,deselectedIcon:"fa-plus"})),isDisabled:o,className:r||o?"selected":""}}}).onClose(e=>{var t=Object(l.map)(e,e=>this.subscribe(e));return Promise.all(t).then(()=>{Hp.success(window.W_L.subscribed)}).catch(()=>(Hp.error(window.W_L.subscribe_failed),Promise.reject(null)))})}),Nh(this,"onUserEmailToggle",e=>{e?this.unsubscribe(e):this.subscribe()}),Nh(this,"subscribe",e=>{var t={alert_id:this.props.alertId};return e&&(t.destination_id=e.id),Sh.create(t).then(e=>{var t=this.state.subs;this.setState({subs:[...t,Ah(e)]})})}),Nh(this,"unsubscribe",e=>{Sh.delete(e).then(()=>{var t=this.state.subs;this.setState({subs:Object(l.without)(t,e)})}).catch(()=>{Hp.error(window.W_L.subscribe_failed)})})}componentDidMount(){var e=this.props.alertId;Promise.all([jh.query(),Sh.query({alertId:e})]).then(e=>{var t=Lh(e,2),a=t[0],r=t[1];r=r.map(Ah),this.setState({dests:a,subs:r})})}render(){if(!this.props.alertId)return null;var e=this.state.subs,t=Object(l.find)(e,{destination:{id:-1},user:{id:H.id}}),a=Object(l.without)(e,t),r=Y.mailSettingsMissing;return n.a.createElement("div",{className:"alert-destinations","data-test":"AlertDestinations"},n.a.createElement(we,{title:window.W_L.add_alert_setting,mouseEnterDelay:.5},n.a.createElement(m.a,{"data-test":"ShowAddAlertSubDialog",type:"primary",size:"small",className:"add-button",onClick:this.showAddAlertSubDialog},n.a.createElement("i",{className:"fa fa-plus f-12 m-r-5","aria-hidden":"true"})," ",window.W_L.add)),n.a.createElement("ul",null,n.a.createElement("li",{className:"destination-wrapper"},n.a.createElement("i",{className:"destination-icon fa fa-envelope","aria-hidden":"true"}),n.a.createElement("span",{className:"flex-fill"},H.email),n.a.createElement(xh,{className:"destination-warning",featureName:"alert emails",mode:"icon"}),!r&&n.a.createElement(so.a,{size:"small",className:"toggle-button",checked:!!t,loading:!e,onChange:()=>this.onUserEmailToggle(t),"data-test":"UserEmailToggle"})),a.map(e=>n.a.createElement(Th,Ph({key:e.id,unsubscribe:()=>this.unsubscribe(e)},e)))))}}function Ih(){return(Ih=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function qh(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Dh(e){var t=e.children,a=e.label,r=e.className,o=qh(e,["children","label","className"]),i={span:16};return a||(i.offset=4),r=me()("alert-form-item",r),n.a.createElement(Vb.a.Item,Ih({labelCol:{span:4},wrapperCol:i,label:a,className:r},o),t)}function Rh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Mh(e){var t=e.state,a=e.lastTriggered;return n.a.createElement("div",{className:"alert-state"},n.a.createElement("span",{className:"alert-state-indicator label ".concat(Tb[t])},window.W_L.status,": ",t),"unknown"===t&&n.a.createElement("div",{className:"ant-form-item-explain"},window.W_L.alert_setting_sure),a&&n.a.createElement("div",{className:"ant-form-item-explain"},window.W_L.last_trigger_time," "," ",n.a.createElement("span",{className:"alert-last-triggered"},n.a.createElement(qf,{date:a}))))}Nh(Wh,"propTypes",{alertId:ae.a.any.isRequired}),Dh.propTypes={children:ae.a.node,label:ae.a.string,className:ae.a.string},Dh.defaultProps={children:null,label:null,className:null},Mh.propTypes={state:ae.a.string.isRequired,lastTriggered:ae.a.string},Mh.defaultProps={lastTriggered:null};class zh extends n.a.Component{constructor(){super(...arguments),Rh(this,"state",{unmuting:!1}),Rh(this,"unmute",()=>{this.setState({unmuting:!0}),this.props.unmute().finally(()=>{this.setState({unmuting:!1})})})}render(){var e=this.props,t=e.alert,a=e.queryResult,r=e.canEdit,o=e.onEdit,i=e.menuButton,l=t.query,s=t.name,c=t.options,d=t.rearm;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ub,{name:s,alert:t},n.a.createElement(se,{name:"AlertView.HeaderExtra",alert:t}),n.a.createElement(we,{title:r?"":window.W_L.no_permission_edit_alert},n.a.createElement(m.a,{type:"default",onClick:r?o:null,className:me()({disabled:!r})},n.a.createElement("i",{className:"fa fa-edit m-r-5","aria-hidden":"true"}),window.W_L.edit),i)),n.a.createElement("div",{className:"bg-white tiled p-20"},n.a.createElement(Vn.Row,{type:"flex",gutter:16},n.a.createElement(Vn.Col,{xs:24,md:16,className:"d-flex"},n.a.createElement(Vb.a,{className:"flex-fill"},n.a.createElement(Dh,null,n.a.createElement(Mh,{state:t.state,lastTriggered:t.last_triggered_at})),n.a.createElement(Dh,{label:window.W_L.query},n.a.createElement(bh,{query:l,queryResult:a})),a&&c&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Dh,{label:window.W_L.trigger_condition,className:"alert-criteria"},n.a.createElement(Jb,{columnNames:a.getColumnNames(),resultValues:a.getData(),alertOptions:c})),n.a.createElement(Dh,{label:window.W_L.notice,className:"form-item-line-height-normal"},n.a.createElement(oh,{value:d||0}),n.a.createElement("br",null),window.W_L.set," ",c.custom_subject||c.custom_body?window.W_L.custom:window.W_L.default," ",window.W_L.notice_template)))),n.a.createElement(Vn.Col,{xs:24,md:8},c.muted&&n.a.createElement(u.a,{className:"m-b-20",message:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-bell-slash-o","aria-hidden":"true"})," ",window.W_L.set_mute),description:n.a.createElement(n.a.Fragment,null,window.W_L.alert_not_sent_info,n.a.createElement("br",null),r&&n.a.createElement(n.a.Fragment,null,window.W_L.reset_alert_sent_info,n.a.createElement(m.a,{size:"small",type:"primary",onClick:this.unmute,loading:this.state.unmuting,className:"m-t-5 m-l-5"},window.W_L.set_unmute))),type:"warning"}),n.a.createElement("h4",null,window.W_L.destination," ",n.a.createElement(we,{title:window.W_L.set_alert_open_tab},n.a.createElement(h,{href:"destinations",target:"_blank"},n.a.createElement("i",{className:"fa fa-external-link f-13","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)")))),n.a.createElement(Wh,{alertId:t.id})))))}}zh.propTypes={alert:Nf.isRequired,queryResult:ae.a.object,canEdit:ae.a.bool.isRequired,onEdit:ae.a.func.isRequired,menuButton:ae.a.node.isRequired,unmute:ae.a.func},zh.defaultProps={queryResult:null,unmute:null};a(1339);function Fh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Vh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Uh(e){var t=e.alert,a=e.query,o=e.columnNames,i=e.resultValues,s=e.subject,c=e.setSubject,u=e.body,d=e.setBody,m=!(!s&&!u),p=Fh(Object(r.useState)(m?1:0),2),f=p[0],g=p[1],b=Fh(Object(r.useState)(!1),2),h=b[0],y=b[1],v=function(e,t,a,r){var n=Object(l.isEmpty)(r)?null:Object(l.head)(r)[e.options.column];return{ALERT_STATUS:"TRIGGERED",ALERT_CONDITION:e.options.op,ALERT_THRESHOLD:e.options.value,ALERT_NAME:e.name,ALERT_URL:"".concat(window.location.origin,"/alerts/").concat(e.id),QUERY_NAME:t.name,QUERY_URL:"".concat(window.location.origin,"/queries/").concat(t.id),QUERY_RESULT_VALUE:Object(l.isNull)(n)||Object(l.isUndefined)(n)?"UNKNOWN":n,QUERY_RESULT_ROWS:r,QUERY_RESULT_COLS:a}}(t,a,o,i),w=e=>La.a.render(e||"",v);return n.a.createElement("div",{className:"alert-template"},n.a.createElement(Yr.a,{value:f,onChange:e=>{e||!m?(g(e),y(!1)):R.a.confirm({title:window.W_L.are_you_sure,content:window.W_L.switch_warning,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,onOk:()=>{c(null),d(null),g(e),y(!1)},maskClosable:!0,autoFocusButton:null})},optionLabelProp:"label",dropdownMatchSelectWidth:!1,style:{width:"fit-content"}},n.a.createElement(Yr.a.Option,{value:0,label:window.W_L.use_default_template},window.W_L.default_template),n.a.createElement(Yr.a.Option,{value:1,label:window.W_L.use_custom_template},window.W_L.custom_template)),!!f&&n.a.createElement("div",{className:"alert-custom-template","data-test":"AlertCustomTemplate"},n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement("h5",{className:"flex-fill"},window.W_L.subject," / ",window.W_L.content),window.W_L.preview," ",n.a.createElement(so.a,{size:"small",className:"alert-template-preview",value:h,onChange:y})),n.a.createElement(ta.a,{value:h?w(s):s,"aria-label":"Subject",onChange:e=>c(e.target.value),disabled:h,"data-test":"CustomSubject"}),n.a.createElement(ta.a.TextArea,{value:h?w(u):u,"aria-label":"Body",autoSize:{minRows:9},onChange:e=>d(e.target.value),disabled:h,"data-test":"CustomBody"}),n.a.createElement(Ge,{type:"ALERT_NOTIF_TEMPLATE_GUIDE",className:"f-13"},n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"})," ",window.W_L.guide_format," ",n.a.createElement("span",{className:"sr-only"},"(",window.W_L.help,")"))))}Uh.propTypes={alert:Nf.isRequired,query:Lf.isRequired,columnNames:ae.a.arrayOf(ae.a.string).isRequired,resultValues:ae.a.arrayOf(ae.a.any).isRequired,subject:ae.a.string,setSubject:ae.a.func.isRequired,body:ae.a.string,setBody:ae.a.func.isRequired},Uh.defaultProps={subject:"",body:""};var Bh=Uh;function Hh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Yh extends n.a.Component{constructor(){super(...arguments),Hh(this,"_isMounted",!1),Hh(this,"state",{saving:!1}),Hh(this,"save",()=>{this.setState({saving:!0}),this.props.save().catch(()=>{this._isMounted&&this.setState({saving:!1})})}),Hh(this,"cancel",()=>{this.props.cancel()})}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){var e=this.props,t=e.alert,a=e.queryResult,r=e.pendingRearm,o=e.onNotificationTemplateChange,i=e.menuButton,l=this.props,s=l.onQuerySelected,c=l.onNameChange,u=l.onRearmChange,d=l.onCriteriaChange,p=t.query,f=t.name,g=t.options,b=this.state.saving;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ub,{name:f,alert:t,onChange:c,editMode:!0},n.a.createElement(se,{name:"AlertEdit.HeaderExtra",alert:t}),n.a.createElement(m.a,{className:"m-r-5",onClick:()=>this.cancel()},n.a.createElement("i",{className:"fa fa-times m-r-5","aria-hidden":"true"}),window.W_L.cancel),n.a.createElement(m.a,{type:"primary",onClick:()=>this.save()},b?n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse m-r-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},window.W_L.saving)):n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-check m-r-5","aria-hidden":"true"})),window.W_L.save),i),n.a.createElement("div",{className:"bg-white tiled p-20"},n.a.createElement("div",{className:"d-flex"},n.a.createElement(Vb.a,{className:"flex-fill"},n.a.createElement(Dh,{label:"{window.W_L.query}"},n.a.createElement(bh,{query:p,queryResult:a,onChange:s,editMode:!0})),a&&g&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Dh,{label:window.W_L.trigger_condition,className:"alert-criteria"},n.a.createElement(Jb,{columnNames:a.getColumnNames(),resultValues:a.getData(),alertOptions:g,onChange:d,editMode:!0})),n.a.createElement(Dh,{label:window.W_L.trigger_send_notice},n.a.createElement(oh,{value:r||0,onChange:u,editMode:!0})),n.a.createElement(Dh,{label:window.W_L.template},n.a.createElement(Bh,{alert:t,query:p,columnNames:a.getColumnNames(),resultValues:a.getData(),subject:g.custom_subject,setSubject:e=>o({custom_subject:e}),body:g.custom_body,setBody:e=>o({custom_body:e})})))),n.a.createElement("div",null,n.a.createElement(Ge,{className:"f-13",type:"ALERT_SETUP"},window.W_L.setup_tip," ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"( ",window.W_L.help," )"))))))}}function Qh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Yh.propTypes={alert:Nf.isRequired,queryResult:ae.a.object,pendingRearm:ae.a.number,menuButton:ae.a.node.isRequired,save:ae.a.func.isRequired,cancel:ae.a.func.isRequired,onQuerySelected:ae.a.func.isRequired,onNameChange:ae.a.func.isRequired,onCriteriaChange:ae.a.func.isRequired,onRearmChange:ae.a.func.isRequired,onNotificationTemplateChange:ae.a.func.isRequired},Yh.defaultProps={queryResult:null,pendingRearm:null};class Kh extends n.a.Component{constructor(){super(...arguments),Qh(this,"state",{saving:!1}),Qh(this,"save",()=>{this.setState({saving:!0}),this.props.save().catch(()=>{this.setState({saving:!1})})})}render(){var e=this.props,t=e.alert,a=e.queryResult,r=e.pendingRearm,o=e.onNotificationTemplateChange,i=this.props,l=i.onQuerySelected,s=i.onNameChange,c=i.onRearmChange,u=i.onCriteriaChange,d=t.query,p=t.name,f=t.options,g=this.state.saving;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ub,{alert:t,name:p,onChange:s,editMode:!0}),n.a.createElement("div",{className:"bg-white tiled p-20"},n.a.createElement("div",{className:"d-flex"},n.a.createElement(Vb.a,{className:"flex-fill"},n.a.createElement("div",{className:"m-b-30"},window.W_L.selector_query_tip),n.a.createElement(Dh,{label:window.W_L.query},n.a.createElement(bh,{query:d,queryResult:a,onChange:l,editMode:!0})),a&&f&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Dh,{label:window.W_L.trigger_condition,className:"alert-criteria"},n.a.createElement(Jb,{columnNames:a.getColumnNames(),resultValues:a.getData(),alertOptions:f,onChange:u,editMode:!0})),n.a.createElement(Dh,{label:window.W_L.trigger_send_notice},n.a.createElement(oh,{value:r||0,onChange:c,editMode:!0})),n.a.createElement(Dh,{label:window.W_L.template},n.a.createElement(Bh,{alert:t,query:d,columnNames:a.getColumnNames(),resultValues:a.getData(),subject:f.custom_subject,setSubject:e=>o({custom_subject:e}),body:f.custom_body,setBody:e=>o({custom_body:e})}))),n.a.createElement(Dh,null,n.a.createElement(m.a,{type:"primary",onClick:this.save,disabled:!d,className:"btn-create-alert"},g&&n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse m-r-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"}," ",window.W_L.saving," ")),window.W_L.create_alert))),n.a.createElement(Ge,{className:"f-13",type:"ALERT_SETUP"},window.W_L.setup_tip,"  ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"( ",window.W_L.help," )")))))}}function Gh(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Gh(Object(a),!0).forEach((function(t){Xh(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Gh(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Jh(){return(Jh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Xh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Kh.propTypes={alert:Nf.isRequired,queryResult:ae.a.object,pendingRearm:ae.a.number,onQuerySelected:ae.a.func.isRequired,save:ae.a.func.isRequired,onNameChange:ae.a.func.isRequired,onRearmChange:ae.a.func.isRequired,onCriteriaChange:ae.a.func.isRequired,onNotificationTemplateChange:ae.a.func.isRequired},Kh.defaultProps={queryResult:null,pendingRearm:null};var Zh={NEW:0,VIEW:1,EDIT:2},ey=Object(l.template)("<%= query.name %>: <%= options.column %> <%= options.op %> <%= options.value %>");function ty(e){return e.query?ey(e):window.W_L.new_alert_tip}class ay extends n.a.Component{constructor(){super(...arguments),Xh(this,"_isMounted",!1),Xh(this,"state",{alert:null,queryResult:null,pendingRearm:null,canEdit:!1,mode:null}),Xh(this,"save",()=>{var e=this.state,t=e.alert,a=e.pendingRearm;return t.name=Object(l.trim)(t.name)||ty(t),t.rearm=a||null,kb.save(t).then(e=>{Hp.success(window.W_L.save_success),sa("alerts/".concat(e.id),!0),this.setState({alert:e,mode:Zh.VIEW})}).catch(()=>{Hp.error(window.W_L.save_failed)})}),Xh(this,"onQuerySelected",e=>{this.setState(t=>({alert:Jh(t.alert,{query:e}),queryResult:null})),e&&new Za(e).getQueryResultPromise().then(e=>{if(this._isMounted){this.setState({queryResult:e});var t=this.state.alert.options.column,a=e.getColumnNames();t&&Object(l.includes)(a,t)||(t=Object(l.head)(e.getColumnNames())),this.setAlertOptions({column:t})}})}),Xh(this,"onNameChange",e=>{var t=this.state.alert;this.setState({alert:Jh(t,{name:e})})}),Xh(this,"onRearmChange",e=>{this.setState({pendingRearm:e})}),Xh(this,"setAlertOptions",e=>{var t=this.state.alert,a=$h($h({},t.options),e);this.setState({alert:Jh(t,{options:a})})}),Xh(this,"delete",()=>{var e=this.state.alert;return kb.delete(e).then(()=>{Hp.success(window.W_L.alert_delete_success),sa("alerts")}).catch(()=>{Hp.error(window.W_L.alert_delete_failed)})}),Xh(this,"mute",()=>{var e=this.state.alert;return kb.mute(e).then(()=>{this.setAlertOptions({muted:!0}),Hp.warn(window.W_L.set_mute_success)}).catch(()=>{Hp.error(window.W_L.set_mute_failed)})}),Xh(this,"unmute",()=>{var e=this.state.alert;return kb.unmute(e).then(()=>{this.setAlertOptions({muted:!1}),Hp.success(window.W_L.set_unmute_success)}).catch(()=>{Hp.error(window.W_L.set_unmute_failed)})}),Xh(this,"edit",()=>{var e=this.state.alert.id;sa("alerts/".concat(e,"/edit"),!0),this.setState({mode:Zh.EDIT})}),Xh(this,"cancel",()=>{var e=this.state.alert.id;sa("alerts/".concat(e),!0),this.setState({mode:Zh.VIEW})})}componentDidMount(){this._isMounted=!0;var e=this.props.mode;if(this.setState({mode:e}),e===Zh.NEW)this.setState({alert:{options:{op:">",value:1,muted:!1}},pendingRearm:0,canEdit:!0});else{var t=this.props.alertId;kb.get({id:t}).then(e=>{if(this._isMounted){var t=H.canEdit(e);t||(this.setState({mode:Zh.VIEW}),Hp.warn(window.W_L.can_not_edit_alert,window.W_L.no_permission_readonly,{duration:0})),this.setState({alert:e,canEdit:t,pendingRearm:e.rearm}),this.onQuerySelected(e.query)}}).catch(e=>{this._isMounted&&this.props.onError(e)})}}componentWillUnmount(){this._isMounted=!1}render(){var e=this.state.alert;if(!e)return n.a.createElement(mb,{className:"m-t-30"});var t=!!e.options.muted,a=this.state,r=a.queryResult,o=a.mode,i=a.canEdit,l=a.pendingRearm,s=n.a.createElement(zb,{doDelete:this.delete,muted:t,mute:this.mute,unmute:this.unmute,canEdit:i}),c={alert:e,queryResult:r,pendingRearm:l,save:this.save,menuButton:s,onQuerySelected:this.onQuerySelected,onRearmChange:this.onRearmChange,onNameChange:this.onNameChange,onCriteriaChange:this.setAlertOptions,onNotificationTemplateChange:this.setAlertOptions};return n.a.createElement("div",{className:"alert-page"},n.a.createElement("div",{className:"container"},o===Zh.NEW&&n.a.createElement(Kh,c),o===Zh.VIEW&&n.a.createElement(zh,Jh({canEdit:i,onEdit:this.edit,muted:t,unmute:this.unmute},c)),o===Zh.EDIT&&n.a.createElement(Yh,Jh({cancel:this.cancel},c))))}}Xh(ay,"propTypes",{mode:ae.a.oneOf(Object(l.values)(Zh)),alertId:ae.a.string,onError:ae.a.func}),Xh(ay,"defaultProps",{mode:null,alertId:null,onError:()=>{}}),rf.register("Alerts.New",Zt({path:"/alerts/new",title:window.W_L.new_alert,render:e=>n.a.createElement(ay,Jh({},e,{mode:Zh.NEW}))})),rf.register("Alerts.View",Zt({path:"/alerts/:alertId",title:window.W_L.alert,render:e=>n.a.createElement(ay,Jh({},e,{mode:Zh.VIEW}))})),rf.register("Alerts.Edit",Zt({path:"/alerts/:alertId/edit",title:window.W_L.alert,render:e=>n.a.createElement(ay,Jh({},e,{mode:Zh.EDIT}))}));var ry=a(434),ny=a(435),oy=a.n(ny),iy=(a(1347),/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"Cmd":"Ctrl"),ly=/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"Option":"Alt";var sy={};function cy(e,t){e.preventDefault(),e.retunValue=!1,Object(l.each)(sy[t],e=>e())}var uy={modKey:iy,altKey:ly,bind:e=>{Object(l.each)(e,(e,t)=>{var a=t.toLowerCase().split(",").map(l.trim);Object(l.each)(a,t=>{sy[t]=[...Object(l.without)(sy[t],e),e],oy.a.bindGlobal(t,cy)})})},unbind:e=>{Object(l.each)(e,(e,t)=>{var a=t.toLowerCase().split(",").map(l.trim);Object(l.each)(a,t=>{sy[t]=Object(l.without)(sy[t],e),0===sy[t].length&&(sy[t]=void 0,oy.a.unbind(t))})})}};function dy(e){var t=e.paramCount,a=e.onClick,r=t?n.a.createElement("i",{className:"fa fa-check","aria-hidden":"true"}):n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading..."));return n.a.createElement("div",{className:"parameter-apply-button","data-show":!!t,"data-test":"ParameterApplyButton"},n.a.createElement(hf.a,{count:t},n.a.createElement(we,{title:t?"".concat(uy.modKey," + Enter"):null},n.a.createElement("span",null,n.a.createElement(m.a,{onClick:a},r," ",window.W_L.apply_change)))))}dy.propTypes={onClick:ae.a.func.isRequired,paramCount:ae.a.number.isRequired};var my=dy,py=document.createElement("canvas");function fy(){return(fy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function gy(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}py.style.display="none",document.body.appendChild(py);var by=function(e){var t=e.options,a=gy(e,["options"]),o=Object(r.useMemo)(()=>{if(t&&t.length>400){var e=Object(l.maxBy)(t,"label.length");if(e){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,a=py.getContext("2d");if(a){var r=window.getComputedStyle(t);a.font="".concat(r.fontSize," ").concat(r.fontFamily);var n=a.measureText(e),o=n.width;return"actualBoundingBoxLeft"in n&&(o=Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight)),o}return null}(e.label);if(a)return a+40}return!0}return!1},[t]);return n.a.createElement(Yr.a,fy({dropdownMatchSelectWidth:o,options:t,allowClear:!0,optionFilterProp:"label"},a))},hy=a(115),yy=a.n(hy);function vy(){return(vy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function wy(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Oy=n.a.forwardRef((e,t)=>{var a=e.defaultValue,r=e.value,o=e.onSelect,i=e.className,l=wy(e,["defaultValue","value","onSelect","className"]),s=Y.dateFormat||"YYYY-MM-DD",c={};return a&&a.isValid()&&(c.defaultValue=a),(null===r||r&&r.isValid())&&(c.value=r),n.a.createElement(yy.a,vy({ref:t,className:i},c,{format:s,placeholder:window.W_L.date_select,onChange:o},l))});Oy.propTypes={defaultValue:Tf,value:Tf,onSelect:ae.a.func,className:ae.a.string},Oy.defaultProps={defaultValue:null,value:void 0,onSelect:()=>{},className:""};var _y=Oy;function Ey(){return(Ey=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function jy(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Sy=n.a.forwardRef((e,t)=>{var a=e.defaultValue,r=e.value,o=e.withSeconds,i=e.onSelect,l=e.className,s=jy(e,["defaultValue","value","withSeconds","onSelect","className"]),c=(Y.dateFormat||"YYYY-MM-DD")+(o?" HH:mm:ss":" HH:mm"),u={};return a&&a.isValid()&&(u.defaultValue=a),(null===r||r&&r.isValid())&&(u.value=r),n.a.createElement(yy.a,Ey({ref:t,className:l,showTime:!0},u,{format:c,placeholder:window.W_L.datetime_select,onChange:i},s))});Sy.propTypes={defaultValue:Tf,value:Tf,withSeconds:ae.a.bool,onSelect:ae.a.func,className:ae.a.string},Sy.defaultProps={defaultValue:null,value:void 0,withSeconds:!1,onSelect:()=>{},className:""};var Cy=Sy,xy=a(319),Py=a.n(xy),Ly=a(679),ky=a.n(Ly),Ny=a(680),Ay=a.n(Ny),Ty=(a(1361),un.a.Text);function Wy(e){var t=e.options,a=e.selectedDynamicValue,o=e.onSelect,i=e.enabled,s=e.staticValueLabel,c=n.a.createElement(ue.a,{className:"dynamic-menu",onClick:e=>{var a=e.key;return o(Object(l.get)(t,a,"static"))},selectedKeys:["".concat(Object(l.findIndex)(t,{value:a}))],"data-test":"DynamicButtonMenu"},t.map((e,t)=>n.a.createElement(ue.a.Item,{key:t},e.name," ",e.label&&n.a.createElement("em",null,Object(l.isFunction)(e.label)?e.label():e.label))),i&&n.a.createElement(ue.a.Divider,null),i&&n.a.createElement(ue.a.Item,null,n.a.createElement(Py.a,null),n.a.createElement(Ty,{type:"secondary"},s))),u=Object(r.useRef)(null);return n.a.createElement("div",{ref:u},n.a.createElement("div",{role:"presentation",onClick:e=>e.stopPropagation()},n.a.createElement(Vt.a.Button,{overlay:c,className:"dynamic-button",placement:"bottomRight",trigger:["click"],icon:i?n.a.createElement(ky.a,{className:"dynamic-icon"}):n.a.createElement(Ay.a,{className:"dynamic-icon"}),getPopupContainer:()=>u.current,"data-test":"DynamicButton"})))}Wy.propTypes={options:ae.a.arrayOf(ae.a.object),selectedDynamicValue:ae.a.oneOfType([sr,yr]),onSelect:ae.a.func,enabled:ae.a.bool,staticValueLabel:ae.a.string},Wy.defaultProps={options:[],selectedDynamicValue:null,onSelect:()=>{},enabled:!1,staticValueLabel:"Back to Static Value"};var Iy=Wy;a(602);function qy(){return(qy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Dy(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ry extends n.a.Component{constructor(e){super(e),Dy(this,"onDynamicValueSelect",e=>{var t=this.props,a=t.onSelect,r=t.parameter;if("static"===e){var n=r.getExecutionValue();a(n?Ea()(n):null)}else a(e.value);this.dateComponentRef.current.focus()}),this.dateComponentRef=n.a.createRef()}render(){var e=this.props,t=e.type,a=e.value,r=e.className,o=e.dateOptions,i=e.dynamicButtonOptions,s=e.onSelect,c=ur(a),u=Object(l.includes)(t,"datetime"),d={},m=_y;if(u&&(m=Cy,Object(l.includes)(t,"with-seconds")&&(d.withSeconds=!0)),(Ea.a.isMoment(a)||null===a)&&(d.value=a),c){var p=a;d.placeholder=p&&p.name,d.value=null}return n.a.createElement("div",{className:me()("date-parameter",r)},n.a.createElement(m,qy({},o,{ref:this.dateComponentRef,className:me()("redash-datepicker",t,{"dynamic-value":c}),onSelect:s,suffixIcon:null},d)),n.a.createElement(Iy,{options:i.options,staticValueLabel:i.staticValueLabel,selectedDynamicValue:c?a:null,enabled:c,onSelect:this.onDynamicValueSelect}))}}Dy(Ry,"propTypes",{type:ae.a.string,className:ae.a.string,value:ae.a.any,parameter:ae.a.any,onSelect:ae.a.func,dynamicButtonOptions:ae.a.shape({staticValueLabel:ae.a.string,options:ae.a.arrayOf(ae.a.shape({name:ae.a.string,value:ae.a.object,label:ae.a.oneOfType([ae.a.string,ae.a.func])}))}),dateOptions:ae.a.any}),Dy(Ry,"defaultProps",{type:"",className:"",value:null,parameter:null,dynamicButtonOptions:{options:[]},onSelect:()=>{}});var My=Ry;function zy(){return(zy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var Fy=[{name:"Today/Now",value:dr("d_now"),label:()=>dr("d_now").value().format("MMM D")},{name:"Yesterday",value:dr("d_yesterday"),label:()=>dr("d_yesterday").value().format("MMM D")}];function Vy(e){return n.a.createElement(My,zy({dynamicButtonOptions:{options:Fy}},e,{dateOptions:{"aria-label":"Parameter date value"}}))}Vy.propTypes={type:ae.a.string,className:ae.a.string,value:ae.a.any,parameter:ae.a.any,onSelect:ae.a.func},Vy.defaultProps={type:"",className:"",value:null,parameter:null,onSelect:()=>{}};var Uy=Vy;function By(){return(By=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Hy(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Yy=yy.a.RangePicker,Qy=n.a.forwardRef((e,t)=>{var a=e.defaultValue,r=e.value,o=e.onSelect,i=e.className,s=Hy(e,["defaultValue","value","onSelect","className"]),c=Y.dateFormat||"YYYY-MM-DD",u={};return Object(l.isArray)(a)&&a[0].isValid()&&a[1].isValid()&&(u.defaultValue=a),(null===r||Object(l.isArray)(r)&&r[0].isValid()&&r[1].isValid())&&(u.value=r),n.a.createElement(Yy,By({ref:t,className:i},u,{format:c,onChange:o},s))});Qy.propTypes={defaultValue:ae.a.arrayOf(Tf),value:ae.a.arrayOf(Tf),onSelect:ae.a.func,className:ae.a.string},Qy.defaultProps={defaultValue:null,value:void 0,onSelect:()=>{},className:""};var Ky=Qy;function Gy(){return(Gy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function $y(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Jy=yy.a.RangePicker,Xy=n.a.forwardRef((e,t)=>{var a=e.defaultValue,r=e.value,o=e.withSeconds,i=e.onSelect,s=e.className,c=$y(e,["defaultValue","value","withSeconds","onSelect","className"]),u=(Y.dateFormat||"YYYY-MM-DD")+(o?" HH:mm:ss":" HH:mm"),d={};return Object(l.isArray)(a)&&a[0].isValid()&&a[1].isValid()&&(d.defaultValue=a),(null===r||Object(l.isArray)(r)&&r[0].isValid()&&r[1].isValid())&&(d.value=r),n.a.createElement(Jy,Gy({ref:t,className:s,showTime:!0},d,{format:u,onChange:i},c))});Xy.propTypes={defaultValue:ae.a.arrayOf(Tf),value:ae.a.arrayOf(Tf),withSeconds:ae.a.bool,onSelect:ae.a.func,className:ae.a.string},Xy.defaultProps={defaultValue:null,value:void 0,withSeconds:!1,onSelect:()=>{},className:""};var Zy=Xy;function ev(){return(ev=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function tv(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function av(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class rv extends n.a.Component{constructor(e){super(e),av(this,"onDynamicValueSelect",e=>{var t=this.props,a=t.onSelect,r=t.parameter;if("static"===e){var n=r.getExecutionValue();Object(l.isObject)(n)&&n.start&&n.end?a([Ea()(n.start),Ea()(n.end)]):a(null)}else a(e.value);this.dateRangeComponentRef.current.focus()}),this.dateRangeComponentRef=n.a.createRef()}render(){var e=this.props,t=e.type,a=e.value,r=e.onSelect,o=e.className,i=e.dynamicButtonOptions,s=e.dateRangeOptions,c=(e.parameter,tv(e,["type","value","onSelect","className","dynamicButtonOptions","dateRangeOptions","parameter"])),u=Object(l.includes)(t,"datetime-range"),d=wr(a),m={},p=Ky;return u&&(p=Zy,Object(l.includes)(t,"with-seconds")&&(m.withSeconds=!0)),(function(e){return Object(l.isArray)(e)&&2===e.length&&Ea.a.isMoment(e[0])&&Ea.a.isMoment(e[1])}(a)||null===a)&&(m.value=a),d&&(m.placeholder=[a&&a.name],m.value=null),n.a.createElement("div",ev({},c,{className:me()("date-range-parameter",o)}),n.a.createElement(p,ev({},s,{ref:this.dateRangeComponentRef,className:me()("redash-datepicker date-range-input",t,{"dynamic-value":d}),onSelect:r,suffixIcon:null},m)),n.a.createElement(Iy,{options:i.options,staticValueLabel:i.staticValueLabel,selectedDynamicValue:d?a:null,enabled:d,onSelect:this.onDynamicValueSelect}))}}av(rv,"propTypes",{type:ae.a.oneOf(["date-range","datetime-range","datetime-range-with-seconds"]).isRequired,className:ae.a.string,value:ae.a.any,parameter:ae.a.any,onSelect:ae.a.func,dynamicButtonOptions:ae.a.shape({staticValueLabel:ae.a.string,options:ae.a.arrayOf(ae.a.shape({name:ae.a.string,value:ae.a.object,label:ae.a.oneOfType([ae.a.string,ae.a.func])}))}),dateRangeOptions:ae.a.any}),av(rv,"defaultProps",{type:"date-range",className:"",value:null,parameter:null,dynamicButtonOptions:{options:[]},onSelect:()=>{}});var nv=rv;function ov(){return(ov=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var iv=[{name:"This week",title:window.W_L.this_week,value:Or("d_this_week"),label:()=>Or("d_this_week").value()[0].format("MMM D")+" - "+Or("d_this_week").value()[1].format("MMM D")},{name:"This month",title:window.W_L.this_month,value:Or("d_this_month"),label:()=>Or("d_this_month").value()[0].format("MMMM")},{name:"This year",title:window.W_L.this_year,value:Or("d_this_year"),label:()=>Or("d_this_year").value()[0].format("YYYY")},{name:"Last week",title:window.W_L.last_week,value:Or("d_last_week"),label:()=>Or("d_last_week").value()[0].format("MMM D")+" - "+Or("d_last_week").value()[1].format("MMM D")},{name:"Last month",title:window.W_L.last_month,value:Or("d_last_month"),label:()=>Or("d_last_month").value()[0].format("MMMM")},{name:"Last year",title:window.W_L.last_year,value:Or("d_last_year"),label:()=>Or("d_last_year").value()[0].format("YYYY")},{name:"Last 7 days",title:window.W_L.last_7_days,value:Or("d_last_7_days"),label:()=>Or("d_last_7_days").value()[0].format("MMM D")+" - Today"},{name:"Last 14 days",title:"window.W_L.last_14_days",value:Or("d_last_14_days"),label:()=>Or("d_last_14_days").value()[0].format("MMM D")+" - Today"},{name:"Last 30 days",title:window.W_L.last_30_days,value:Or("d_last_30_days"),label:()=>Or("d_last_30_days").value()[0].format("MMM D")+" - Today"},{name:"Last 60 days",title:window.W_L.last_60_days,value:Or("d_last_60_days"),label:()=>Or("d_last_60_days").value()[0].format("MMM D")+" - Today"},{name:"Last 90 days",title:window.W_L.last_90_days,value:Or("d_last_90_days"),label:()=>Or("d_last_90_days").value()[0].format("MMM D")+" - Today"},{name:"Last 12 months",title:window.W_L.last_12_months,value:Or("d_last_12_months"),label:null}],lv=[{name:"Today",value:Or("d_today"),label:()=>Or("d_today").value()[0].format("MMM D")},{name:"Yesterday",value:Or("d_yesterday"),label:()=>Or("d_yesterday").value()[0].format("MMM D")},...iv];function sv(e){var t=Object(l.includes)(e.type,"datetime-range")?lv:iv;return n.a.createElement(nv,ov({},e,{dynamicButtonOptions:{options:t}}))}sv.propTypes={type:ae.a.string,className:ae.a.string,value:ae.a.any,parameter:ae.a.any,onSelect:ae.a.func},sv.defaultProps={type:"",className:"",value:null,parameter:null,onSelect:()=>{}};var cv=sv;function uv(){return(uv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function dv(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function mv(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class pv extends n.a.Component{constructor(e){super(e),this.state={options:[],value:null,loading:!1}}componentDidMount(){this._loadOptions(this.props.queryId)}componentDidUpdate(e){this.props.queryId!==e.queryId&&this._loadOptions(this.props.queryId),this.props.value!==e.value&&this.setValue(this.props.value)}setValue(e){var t=this.state.options;if("multiple"===this.props.mode){e=Object(l.isArray)(e)?e:[e];var a=Object(l.map)(t,e=>e.value),r=Object(l.intersection)(e,a);return this.setState({value:r}),r}return e=void 0!==Object(l.find)(t,e=>e.value===this.props.value)?e:Object(l.get)(Object(l.first)(t),"value"),this.setState({value:e}),e}_loadOptions(e){var t,a=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e||e===a.state.queryId){r.next=6;break}return a.setState({loading:!0}),r.next=4,regeneratorRuntime.awrap(a.props.parameter.loadDropdownValues());case 4:t=r.sent,a.props.queryId===e&&a.setState({options:t,loading:!1},()=>{var e=a.setValue(a.props.value);Object(l.isEqual)(e,a.props.value)||a.props.onSelect(e)});case 6:case"end":return r.stop()}}),null,null,null,Promise)}render(){var e=this.props,t=e.className,a=e.mode,r=e.onSelect,o=(e.queryId,e.value,dv(e,["className","mode","onSelect","queryId","value"])),i=this.state,s=i.loading,c=i.options;return n.a.createElement("span",null,n.a.createElement(by,uv({className:t,disabled:s,loading:s,mode:a,value:this.state.value,onChange:r,options:Object(l.map)(c,e=>{var t=e.value,a=e.name;return{label:String(a),value:t}}),showSearch:!0,showArrow:!0,notFoundContent:Object(l.isEmpty)(c)?window.W_L.no_option:null},o)))}}mv(pv,"propTypes",{parameter:ae.a.any,value:ae.a.any,mode:ae.a.oneOf(["default","multiple"]),queryId:ae.a.number,onSelect:ae.a.func,className:ae.a.string}),mv(pv,"defaultProps",{value:null,mode:"default",parameter:null,queryId:null,onSelect:()=>{},className:""});a(1368);function fv(){return(fv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function gv(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var bv={maxTagCount:3,maxTagTextLength:10,maxTagPlaceholder:e=>"+".concat(e.length," more")};class hv extends n.a.Component{constructor(e){super(e),gv(this,"componentDidUpdate",e=>{var t=this.props,a=t.value,r=t.parameter;e.value===a&&e.parameter===r||this.setState({value:r.hasPendingValue?r.pendingValue:a,isDirty:r.hasPendingValue})}),gv(this,"onSelect",e=>{var t=!Object(l.isEqual)(e,this.props.value);this.setState({value:e,isDirty:t}),this.props.onSelect(e,t)}),this.state={value:e.parameter.hasPendingValue?e.parameter.pendingValue:e.value,isDirty:e.parameter.hasPendingValue}}renderDateParameter(){var e=this.props,t=e.type,a=e.parameter,r=this.state.value;return n.a.createElement(Uy,{type:t,className:this.props.className,value:r,parameter:a,onSelect:this.onSelect})}renderDateRangeParameter(){var e=this.props,t=e.type,a=e.parameter,r=this.state.value;return n.a.createElement(cv,{type:t,className:this.props.className,value:r,parameter:a,onSelect:this.onSelect})}renderEnumInput(){var e,t=this.props,a=t.enumOptions,r=t.parameter,o=this.state.value,i=a.split("\n").filter(e=>""!==e);return n.a.createElement(by,fv({className:this.props.className,mode:r.multiValuesOptions?"multiple":"default",value:(e=o,r.multiValuesOptions&&null===e?[]:e),onChange:this.onSelect,options:Object(l.map)(i,e=>({label:String(e),value:e})),showSearch:!0,showArrow:!0,notFoundContent:Object(l.isEmpty)(i)?window.W_L.no_option:null},bv))}renderQueryBasedInput(){var e=this.props,t=e.queryId,a=e.parameter,r=this.state.value;return n.a.createElement(pv,fv({className:this.props.className,mode:a.multiValuesOptions?"multiple":"default",parameter:a,value:r,queryId:t,onSelect:this.onSelect,style:{minWidth:60}},bv))}renderNumberInput(){var e=this.props.className,t=this.state.value,a=e=>isNaN(e)?void 0:e;return n.a.createElement(Kr.a,{className:e,value:a(t),"aria-label":"Parameter number value",onChange:e=>this.onSelect(a(e))})}renderTextInput(){var e=this.props.className,t=this.state.value;return n.a.createElement(ta.a,{className:e,value:t,"aria-label":"Parameter text value","data-test":"TextParamInput",onChange:e=>this.onSelect(e.target.value)})}renderInput(){switch(this.props.type){case"datetime-with-seconds":case"datetime-local":case"date":return this.renderDateParameter();case"datetime-range-with-seconds":case"datetime-range":case"date-range":return this.renderDateRangeParameter();case"enum":return this.renderEnumInput();case"query":return this.renderQueryBasedInput();case"number":return this.renderNumberInput();default:return this.renderTextInput()}}render(){var e=this.state.isDirty;return n.a.createElement("div",{className:"parameter-input","data-dirty":e||null,"data-test":"ParameterValueInput"},this.renderInput())}}gv(hv,"propTypes",{type:ae.a.string,value:ae.a.any,enumOptions:ae.a.string,queryId:ae.a.number,parameter:ae.a.any,onSelect:ae.a.func,className:ae.a.string}),gv(hv,"defaultProps",{type:"text",value:null,enumOptions:"",queryId:null,parameter:null,onSelect:()=>{},className:""});var yv=hv;function vv(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function wv(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?vv(Object(a),!0).forEach((function(t){Ov(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vv(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ov(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ev(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ev(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ev(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function jv(){return(jv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var Sv=Yr.a.Option,Cv={labelCol:{span:6},wrapperCol:{span:16}};function xv(e){return Object(l.capitalize)(Object(l.words)(e).join(" "))}function Pv(e){var t=e.name,a=e.type,r=e.onChange,o=e.existingNames,i=e.setValidation,s="",c="";return t?Object(l.includes)(o,t)?(s=window.W_L.params_ready_exist,i(!1),c="error"):(function(e){return/-range/.test(e)}(a)&&(s=n.a.createElement(n.a.Fragment,null,window.W_L.query_show_as," ",n.a.createElement("code",{style:{display:"inline-block",color:"inherit"}},"{{".concat(t,".start}} {{").concat(t,".end}}")))),i(!0)):(s=window.W_L.params_name,i(!1)),n.a.createElement(Vb.a.Item,jv({required:!0,label:window.W_L.name,help:s,validateStatus:c},Cv),n.a.createElement(ta.a,{onChange:e=>r(e.target.value),autoFocus:!0}))}function Lv(e){var t=_v(Object(r.useState)(Object(l.clone)(e.parameter)),2),a=t[0],o=t[1],i=_v(Object(r.useState)(!0),2),s=i[0],c=i[1],u=_v(Object(r.useState)(),2),d=u[0],p=u[1],f=!e.parameter.name;Object(r.useEffect)(()=>{var t=e.parameter.queryId;t&&Za.get({id:t}).then(p)},[e.parameter.queryId]);var g,b,h,y=Se("paramForm");return n.a.createElement(R.a,jv({},e.dialog.props,{title:f?window.W_L.new_params:a.name,width:600,footer:[n.a.createElement(m.a,{key:"cancel",onClick:e.dialog.dismiss},window.W_L.cancel),n.a.createElement(m.a,{key:"submit",htmlType:"submit",disabled:!!(!s||""===a.title||"query"===a.type&&!a.queryId),type:"primary",form:y,"data-test":"SaveParameterSettings"},f?window.W_L.new_params:window.W_L.ok_text)]}),n.a.createElement(Vb.a,{layout:"horizontal",onFinish:function(){a.title||(a.title=xv(a.name),o(a)),e.dialog.close(a)},id:y},f&&n.a.createElement(Pv,{name:a.name,onChange:e=>o(wv(wv({},a),{},{name:e})),setValidation:c,existingNames:e.existingParams,type:a.type}),n.a.createElement(Vb.a.Item,jv({required:!0,label:window.W_L.title},Cv),n.a.createElement(ta.a,{value:Object(l.isNull)(a.title)?xv(a.name):a.title,onChange:e=>o(wv(wv({},a),{},{title:e.target.value})),"data-test":"ParameterTitleInput"})),n.a.createElement(Vb.a.Item,jv({label:window.W_L.type},Cv),n.a.createElement(Yr.a,{value:a.type,onChange:e=>o(wv(wv({},a),{},{type:e})),"data-test":"ParameterTypeSelect"},n.a.createElement(Sv,{value:"text","data-test":"TextParameterTypeOption"},window.W_L.text),n.a.createElement(Sv,{value:"number","data-test":"NumberParameterTypeOption"},window.W_L.number),n.a.createElement(Sv,{value:"enum"},window.W_L.select),n.a.createElement(Sv,{value:"query"},window.W_L.query_result),n.a.createElement(Sv,{disabled:!0,key:"dv1"},n.a.createElement(Qb.a,{className:"select-option-divider"})),n.a.createElement(Sv,{value:"date","data-test":"DateParameterTypeOption"},window.W_L.date_day),n.a.createElement(Sv,{value:"datetime-local","data-test":"DateTimeParameterTypeOption"},window.W_L.date_datetime),n.a.createElement(Sv,{value:"datetime-with-seconds"},window.W_L.date_time_second),n.a.createElement(Sv,{disabled:!0,key:"dv2"},n.a.createElement(Qb.a,{className:"select-option-divider"})),n.a.createElement(Sv,{value:"date-range","data-test":"DateRangeParameterTypeOption"},window.W_L.date_range_day),n.a.createElement(Sv,{value:"datetime-range"}," ",window.W_L.date_range_datetime),n.a.createElement(Sv,{value:"datetime-range-with-seconds"},window.W_L.date_range_time_second))),"enum"===a.type&&n.a.createElement(Vb.a.Item,jv({label:window.W_L.value,help:window.W_L.list_select_help},Cv),n.a.createElement(ta.a.TextArea,{rows:3,value:a.enumOptions,onChange:e=>o(wv(wv({},a),{},{enumOptions:e.target.value}))})),"query"===a.type&&n.a.createElement(Vb.a.Item,jv({label:window.W_L.query_result,help:window.W_L.wait_query},Cv),n.a.createElement(ph,{selectedQuery:d,onChange:e=>o(wv(wv({},a),{},{queryId:e&&e.id})),type:"select"})),("enum"===a.type||"query"===a.type)&&n.a.createElement(Vb.a.Item,jv({className:"m-b-0",label:" ",colon:!1},Cv),n.a.createElement($r.a,{defaultChecked:!!a.multiValuesOptions,onChange:e=>o(wv(wv({},a),{},{multiValuesOptions:e.target.checked?{prefix:"",suffix:"",separator:","}:null})),"data-test":"AllowMultipleValuesCheckbox"},window.W_L.allow_multi)),("enum"===a.type||"query"===a.type)&&a.multiValuesOptions&&n.a.createElement(Vb.a.Item,jv({label:window.W_L.quotation,help:n.a.createElement(n.a.Fragment,null,window.W_L.replace_query_info,": ",n.a.createElement("code",null,(g=a.multiValuesOptions,b=g.prefix,h=g.suffix,[window.W_L.value+"1",window.W_L.value+"2",window.W_L.value+"3"].map(e=>"".concat(b).concat(e).concat(h)).join(","))))},Cv),n.a.createElement(Yr.a,{value:a.multiValuesOptions.prefix,onChange:e=>o(wv(wv({},a),{},{multiValuesOptions:wv(wv({},a.multiValuesOptions),{},{prefix:e,suffix:e})})),"data-test":"QuotationSelect"},n.a.createElement(Sv,{value:""},window.W_L.no_quotation,"(",window.W_L.default,")"),n.a.createElement(Sv,{value:"'"},window.W_L.single_quotation),n.a.createElement(Sv,{value:'"',"data-test":"DoubleQuotationMarkOption"},window.W_L.double_quotation)))))}Pv.propTypes={name:ae.a.string.isRequired,onChange:ae.a.func.isRequired,existingNames:ae.a.arrayOf(ae.a.string).isRequired,setValidation:ae.a.func.isRequired,type:ae.a.string.isRequired},Lv.propTypes={parameter:ae.a.object.isRequired,dialog:ia.isRequired,existingParams:ae.a.arrayOf(ae.a.string)},Lv.defaultProps={existingParams:[]};var kv=la(Lv);a(1369);function Nv(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Av(e){var t=Object(l.extend)({},A.search);e.forEach(e=>{Object(l.extend)(t,e.toUrlParams())}),A.setSearch(t,!0)}class Tv extends n.a.Component{constructor(e){super(e),Nv(this,"componentDidUpdate",e=>{var t=this.props,a=t.parameters,r=t.disableUrlUpdate,n=e.parameters!==a,o=e.disableUrlUpdate!==r;n&&this.setState({parameters:a}),!n&&!o||r||Av(a)}),Nv(this,"handleKeyDown",e=>{13===e.keyCode&&(e.ctrlKey||e.metaKey||e.altKey)&&(e.stopPropagation(),this.applyChanges())}),Nv(this,"setPendingValue",(e,t,a)=>{var r=this.props.onPendingValuesChange;this.setState(n=>{var o=n.parameters;return a?e.setPendingValue(t):e.clearPendingValue(),r(),{parameters:o}})}),Nv(this,"moveParameter",e=>{var t=e.oldIndex,a=e.newIndex,r=this.props.onParametersEdit;t!==a&&this.setState(e=>{var n=e.parameters;return n.splice(a,0,n.splice(t,1)[0]),r(n),{parameters:n}})}),Nv(this,"applyChanges",()=>{var e=this.props,t=e.onValuesChange,a=e.disableUrlUpdate;this.setState(e=>{var r=e.parameters,n=r.filter(e=>e.hasPendingValue);return Object(l.forEach)(r,e=>e.applyPendingValue()),a||Av(r),t(n),{parameters:r}})}),Nv(this,"showParameterSettings",(e,t)=>{var a=this.props.onParametersEdit;kv.showModal({parameter:e}).onClose(r=>{this.setState(n=>{var o=n.parameters,i=Object(l.extend)(e,r);return o[t]=Cr(i,i.parentQueryId),a(o),{parameters:o}})})});var t=e.parameters;this.state={parameters:t},e.disableUrlUpdate||Av(t)}renderParameter(e,t){var a=this.props.editable;return n.a.createElement("div",{key:e.name,className:"di-block","data-test":"ParameterName-".concat(e.name)},n.a.createElement("div",{className:"parameter-heading"},n.a.createElement("label",null,e.title||Kf(e.name)),a&&n.a.createElement(ge,{className:"btn btn-default btn-xs m-l-5","aria-label":"Edit",onClick:()=>this.showParameterSettings(e,t),"data-test":"ParameterSettings-".concat(e.name),type:"button"},n.a.createElement("i",{className:"fa fa-cog","aria-hidden":"true"}))),n.a.createElement(yv,{type:e.type,value:e.normalizedValue,parameter:e,enumOptions:e.enumOptions,queryId:e.queryId,onSelect:(t,a)=>this.setPendingValue(e,t,a)}))}render(){var e=this.state.parameters,t=this.props,a=t.sortable,r=t.appendSortableToParent,o=Object(l.size)(Object(l.filter)(e,"hasPendingValue"));return n.a.createElement(Ql,{disabled:!a,axis:"xy",useDragHandle:!0,lockToContainerEdges:!0,helperClass:"parameter-dragged",helperContainer:e=>r?e:document.body,updateBeforeSortStart:this.onBeforeSortStart,onSortEnd:this.moveParameter,containerProps:{className:"parameter-container",onKeyDown:o?this.handleKeyDown:null}},e.map((e,t)=>n.a.createElement(Yl,{key:e.name,index:t},n.a.createElement("div",{className:"parameter-block","data-editable":a||null,"data-test":"ParameterBlock-".concat(e.name)},a&&n.a.createElement(Bl,{"data-test":"DragHandle-".concat(e.name)}),this.renderParameter(e,t)))),n.a.createElement(my,{onClick:this.applyChanges,paramCount:o}))}}function Wv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Iv(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Iv(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Iv(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function qv(e){var t=e.from,a=Object(r.useMemo)(()=>Ea()(t).valueOf(),[t]),o=Wv(Object(r.useState)(null),2),i=o[0],l=o[1];return Object(r.useEffect)(()=>{function e(){var e=Ea.a.now()-a,t=e>36e5?"HH:mm:ss":"mm:ss";l(Ea.a.utc(e).format(t))}e();var t=setInterval(e,1e3);return()=>clearInterval(t)},[a]),n.a.createElement("span",{className:"rd-timer"},i)}Nv(Tv,"propTypes",{parameters:ae.a.arrayOf(ae.a.instanceOf(ja)),editable:ae.a.bool,sortable:ae.a.bool,disableUrlUpdate:ae.a.bool,onValuesChange:ae.a.func,onPendingValuesChange:ae.a.func,onParametersEdit:ae.a.func,appendSortableToParent:ae.a.bool}),Nv(Tv,"defaultProps",{parameters:[],editable:!1,sortable:!1,disableUrlUpdate:!1,onValuesChange:()=>{},onPendingValuesChange:()=>{},onParametersEdit:()=>{},appendSortableToParent:!0}),qv.propTypes={from:ae.a.oneOfType([ae.a.string,ae.a.number,ae.a.instanceOf(Date),Tf])},qv.defaultProps={from:null};a(1370);function Dv(e){var t=e.visualization,a=rp[t.type];return n.a.createElement("span",{className:"visualization-name"},a&&t.name!==a.name?t.name:null)}Dv.propTypes={visualization:Ir.isRequired};var Rv=Dv;a(1371);function Mv(){return(Mv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function zv(e){var t=e.query,a=e.visualization,r=e.readOnly;return n.a.createElement(e=>{return r?n.a.createElement("span",e):n.a.createElement(h,Mv({href:(o=null,a&&(o="TABLE"===a.type?"table":a.id),t.getUrl(!1,o))},e));var o},{className:"query-link"},n.a.createElement(Rv,{visualization:a})," ",n.a.createElement("span",null,t.name))}zv.propTypes={query:ae.a.object.isRequired,visualization:Ir,readOnly:ae.a.bool},zv.defaultProps={visualization:null,readOnly:!1};var Fv=zv;function Vv(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Uv(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Vv(Object(a),!0).forEach((function(t){Bv(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Vv(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Bv(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Hv="###Redash::Filters::SelectAll###",Yv=ae.a.shape({name:ae.a.string.isRequired,friendlyName:ae.a.string.isRequired,multiple:ae.a.bool,current:ae.a.oneOfType([ae.a.any,ae.a.arrayOf(ae.a.any)]),values:ae.a.arrayOf(ae.a.any).isRequired}),Qv=ae.a.arrayOf(Yv);function Kv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!Object(l.isArray)(e))return[];var a=e;return Object(l.isArray)(t)&&t.length>0&&(a=a.filter(e=>Object(l.every)(t,t=>{var a=e[t.name],r=Object(l.isArray)(t.current)?t.current:[t.current];return Object(l.some)(r,e=>Ea.a.isMoment(a)?a.isSame(e):e===a||String(a)===e)}))),a}function Gv(e){var t=e.filters,a=e.onChange;return 0===t.length?null:(a=function(e,t){return(a,r)=>{if(Object(l.isArray)(r))r=Object(l.map)(r,e=>a.values[Object(l.toNumber)(e.key)]||e.key);else{var n=a.values[Object(l.toNumber)(r.key)];r=void 0!==n?n:r.key}a.multiple&&Object(l.includes)(r,Hv)&&(r=[...a.values]),a.multiple&&Object(l.includes)(r,"###Redash::Filters::Clear###")&&(r=[]),e=Object(l.map)(e,e=>e.name===a.name?Uv(Uv({},a),{},{current:r}):e),t(e)}}(t,a),n.a.createElement("div",{className:"filters-wrapper","data-test":"Filters"},n.a.createElement("div",{className:"container bg-white"},n.a.createElement("div",{className:"row"},Object(l.map)(t,e=>{var t=Object(l.map)(e.values,(t,a)=>n.a.createElement(Yr.a.Option,{key:a},Xf(t,Object(l.get)(e,"column.type"))));return n.a.createElement("div",{key:e.name,className:"col-sm-6 p-l-0 filter-container","data-test":"FilterName-".concat(e.name)},n.a.createElement("label",null,e.friendlyName),0===t.length&&n.a.createElement(Yr.a,{className:"w-100",disabled:!0,value:"No values"}),t.length>0&&n.a.createElement(Yr.a,{labelInValue:!0,className:"w-100",mode:e.multiple?"multiple":"default",value:Object(l.isArray)(e.current)?Object(l.map)(e.current,t=>({key:"".concat(Object(l.indexOf)(e.values,t)),label:Xf(t)})):{key:"".concat(Object(l.indexOf)(e.values,e.current)),label:Xf(e.current)},allowClear:e.multiple,optionFilterProp:"children",showSearch:!0,maxTagCount:3,maxTagTextLength:10,maxTagPlaceholder:e=>"+".concat(e.length," more"),onChange:t=>a(e,t)},!e.multiple&&t,e.multiple&&[n.a.createElement(Yr.a.Option,{key:"###Redash::Filters::Clear###","data-test":"ClearOption"},n.a.createElement("i",{className:"fa fa-square-o m-r-5","aria-hidden":"true"}),window.W_L.clear),n.a.createElement(Yr.a.Option,{key:Hv,"data-test":"SelectAllOption"},n.a.createElement("i",{className:"fa fa-check-square-o m-r-5","aria-hidden":"true"}),window.W_L.select_all),n.a.createElement(Yr.a.OptGroup,{key:"Values",label:window.W_L.value},t)]))})))))}Gv.propTypes={filters:Qv.isRequired,onChange:ae.a.func},Gv.defaultProps={onChange:()=>{}};var $v=Gv;function Jv(e){var t=Object(l.invoke)(e,"getStatus");return Object(r.useMemo)(()=>function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{status:t||Object(l.invoke)(e,"getStatus")||null,columns:Object(l.invoke)(e,"getColumns")||[],rows:Object(l.invoke)(e,"getData")||[],filters:Object(l.invoke)(e,"getFilters")||[],updatedAt:Object(l.invoke)(e,"getUpdatedAt")||null,retrievedAt:Object(l.get)(e,"query_result.retrieved_at",null),truncated:Object(l.invoke)(e,"getTruncated")||null,log:Object(l.invoke)(e,"getLog")||[],error:Object(l.invoke)(e,"getError")||null,runtime:Object(l.invoke)(e,"getRuntime")||null,metadata:Object(l.get)(e,"query_result.data.metadata",{})}}(e,t),[e,t])}function Xv(e){var t=Object(r.useRef)();return t.current=Object(l.isFunction)(e)?e:l.noop,Object(r.useCallback)((function(){return t.current(...arguments)}),[])}var Zv=a(681),ew=a.n(Zv),tw=a(682),aw=a.n(tw),rw=a(683),nw=a.n(rw),ow=a(684),iw=a.n(ow),lw=a(685),sw=a.n(lw),cw=a(686),uw=a.n(cw),dw=a(687),mw=a.n(dw),pw=a(688),fw=a.n(pw),gw=a(689),bw=a.n(gw),hw=a(690),yw=a.n(hw),vw=a(691),ww=a.n(vw),Ow=a(692),_w=a.n(Ow),Ew=a(693),jw=a.n(Ew),Sw=a(694),Cw=a.n(Sw),xw=a(695),Pw=a.n(xw),Lw=a(696),kw=a.n(Lw),Nw=a(697),Aw=a.n(Nw),Tw=a(698),Ww=a.n(Tw),Iw=a(699),qw=a.n(Iw),Dw=a(700),Rw=a.n(Dw),Mw=a(701),zw=a.n(Mw),Fw=a(702),Vw=a.n(Fw),Uw=a(703),Bw=a.n(Uw),Hw=a(704),Yw=a.n(Hw),Qw=a(705),Kw=a.n(Qw),Gw=a(706),$w=a.n(Gw),Jw=a(707),Xw=a.n(Jw),Zw=a(708),eO=a.n(Zw),tO=a(709),aO=a.n(tO),rO=a(710),nO=a.n(rO),oO=a(711),iO=a.n(oO),lO=a(712),sO=a.n(lO),cO=a(713),uO=a.n(cO),dO=a(714),mO=a.n(dO),pO=a(715),fO=a.n(pO),gO=a(716),bO=a.n(gO),hO=a(717),yO=a.n(hO),vO=a(718),wO=a.n(vO);function OO(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _O(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function EO(e){return function(t){var a;return a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?OO(Object(a),!0).forEach((function(t){_O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):OO(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({HelpTriggerComponent:Ge,LinkComponent:h,choroplethAvailableMaps:{countries:{name:window.W_L.country,url:ew.a,fieldNames:{name:window.W_L.short_name,name_long:window.W_L.full_name,abbrev:window.W_L.abbreviated_name,iso_a2:"ISO code(2 letters)",iso_a3:"ISO code(3 letters)",iso_n3:"ISO code(3 digits)"}},china:{name:"中国行政区划图",url:iw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_110000:{name:"(110000)北京市行政区划图",url:sw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_120000:{name:"(120000)天津市行政区划图",url:uw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_130000:{name:"(130000)河北省行政区划图",url:mw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_140000:{name:"(140000)山西省行政区划图",url:fw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_150000:{name:"(150000)内蒙古行政区划图",url:bw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_210000:{name:"(210000)辽宁省行政区划图",url:yw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_220000:{name:"(220000)吉林省行政区划图",url:ww.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_230000:{name:"(230000)黑龙江省行政区划图",url:_w.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_310000:{name:"(310000)上海市行政区划图",url:jw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_320000:{name:"(320000)江苏省行政区划图",url:Cw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_330000:{name:"(330000)浙江省行政区划图",url:Pw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_340000:{name:"(340000)安徽省行政区划图",url:kw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_350000:{name:"(350000)福建省行政区划图",url:Aw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_360000:{name:"(360000)江西省行政区划图",url:Ww.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_370000:{name:"(370000)山东省行政区划图",url:qw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_410000:{name:"(410000)河南省行政区划图",url:Rw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_420000:{name:"(420000)湖北省行政区划图",url:zw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_430000:{name:"(430000)湖南省行政区划图",url:Vw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_440000:{name:"(440000)广东省行政区划图",url:Bw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_450000:{name:"(450000)广西行政区划图",url:Yw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_460000:{name:"(460000)海南省行政区划图",url:Kw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_500000:{name:"(500000)重庆市行政区划图",url:$w.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_510000:{name:"(510000)四川省行政区划图",url:Xw.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_520000:{name:"(520000)贵州省行政区划图",url:eO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_530000:{name:"(530000)云南省行政区划图",url:aO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_540000:{name:"(540000)西藏行政区划图",url:nO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_610000:{name:"(610000)陕西省行政区划图",url:iO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_620000:{name:"(620000)甘肃省行政区划图",url:sO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_630000:{name:"(630000)青海省行政区划图",url:uO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_640000:{name:"(640000)宁夏行政区划图",url:mO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_650000:{name:"(650000)新疆行政区划图",url:fO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_710000:{name:"(710000)台湾行政区划图",url:bO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_810000:{name:"(810000)香港行政区划图",url:yO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},china_820000:{name:"(820000)澳门行政区划图",url:wO.a,fieldNames:{name:"简称",adcode:"行政区划编码(6字母)"}},usa:{name:"USA",url:aw.a,fieldNames:{name:"Name",ns_code:"USA ANSI Code(8 character)",geoid:"Geographic ID",usps_abbrev:"USPS Abbreviation",fips_code:"FIPS Code (2-character)"}},subdiv_japan:{name:"Japan/Prefectures",url:nw.a,fieldNames:{name:"Name",name_alt:"Name (alternative)",name_local:"Name (local)",iso_3166_2:"ISO-3166-2",postal:"Postal Code",type:"Type",type_en:"Type (EN)",region:"Region",region_code:"Region Code"}}}},Object(l.pick)(Y,["dateFormat","dateTimeFormat","integerFormat","floatFormat","booleanValues","tableCellMaxJSONSize","allowCustomJSVisualizations","hidePlotlyModeBar"])),Object(l.extend)(vo,a),n.a.createElement(e,t)}}var jO=EO((function(e){var t=e.type,a=e.data,o=e.options,i=e.visualizationName,s=e.addonBefore,c=e.addonAfter,u=ip(e,["type","data","options","visualizationName","addonBefore","addonAfter"]),d=Object(r.useRef)(),m=Object(r.useRef)(),p=rp[t],f=p.Renderer,g=(0,p.getOptions)(o,a);return Object(l.isEqual)(d.current,g)&&(g=d.current),d.current=g,Object(r.useEffect)(()=>{m.current&&m.current.reset()},[o,a]),n.a.createElement("div",{className:"visualization-renderer"},s,n.a.createElement(j,{ref:m,renderError:()=>n.a.createElement(E,null,window.W_L.Error_while_rendering_visualization)},n.a.createElement("div",{className:"visualization-renderer-wrapper"},n.a.createElement(f,op({options:g,data:a,visualizationName:i},u)))),c)})),SO=EO((function(e){var t=e.type,a=e.options,o=e.data,i=sp(e,["type","options","data"]),l=rp[t],s=l.Editor,c=l.getOptions,u=Object(r.useMemo)(()=>c(a,o),[a,o]);return n.a.createElement(s,lp({options:u,data:o},i))}));function CO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xO(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xO(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function PO(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function LO(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?PO(Object(a),!0).forEach((function(t){kO(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):PO(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function kO(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function NO(e,t){return 0===e.length||0===t.length?e:Object(l.map)(e,e=>{var a=Object(l.find)(t,t=>t.name===e.name);return a?LO(LO({},e),{},{current:a.current}):e})}function AO(e){var t=Jv(e.queryResult),a=CO(Object(r.useState)(()=>NO(t.filters,e.filters)),2),o=a[0],i=a[1],s=Object(r.useRef)();s.current=o;var c=Xv(t=>{var a,r;r=o,(a=t).length===r.length&&(a=Object(l.fromPairs)(Object(l.map)(a,e=>[e.name,e])),r=Object(l.fromPairs)(Object(l.map)(r,e=>[e.name,e])),Object(l.isEqual)(a,r))||(i(t),e.onFiltersChange(t))});Object(r.useEffect)(()=>{c(NO(t.filters,e.filters))},[t.filters,e.filters,c]),Object(r.useEffect)(()=>{c(NO(s.current,e.filters))},[e.filters,c]);var u=Object(r.useMemo)(()=>({columns:t.columns,rows:Kv(t.rows,o)}),[t,o]),d=e.showFilters,m=e.visualization,p=LO({},m.options);return"TABLE"===m.type&&(p.paginationSize="widget"===e.context?"small":"default"),n.a.createElement(jO,{key:"visualization".concat(m.id),type:m.type,options:p,data:u,visualizationName:m.name,addonBefore:d&&n.a.createElement($v,{filters:o,onChange:c})})}function TO(){return(TO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function WO(e){var t=e.dialog,a=e.widget,r=e.filters;return n.a.createElement(R.a,TO({},t.props,{title:n.a.createElement(n.a.Fragment,null,n.a.createElement(Rv,{visualization:a.visualization})," ",n.a.createElement("span",null,a.getQuery().name)),width:"95%",footer:n.a.createElement(m.a,{onClick:t.dismiss},window.W_L.close)}),n.a.createElement(AO,{visualization:a.visualization,queryResult:a.getQueryResult(),filters:r,context:"widget"}))}AO.propTypes={visualization:Ir.isRequired,queryResult:ae.a.object.isRequired,showFilters:ae.a.bool,filters:Qv,onFiltersChange:ae.a.func,context:ae.a.oneOf(["query","widget"]).isRequired},AO.defaultProps={showFilters:!0,filters:[],onFiltersChange:()=>{}},WO.propTypes={dialog:ia.isRequired,widget:ae.a.object.isRequired,filters:Qv},WO.defaultProps={filters:[]};var IO=la(WO),qO=a(82),DO=a.n(qO),RO=a(315),MO=a.n(RO);a(1372);function zO(){return(zO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function FO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return VO(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return VO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VO(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function UO(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var BO="dashboard-add-new",HO="dashboard-map-to-existing",YO="widget-level",QO="static-value";function KO(e){return Object(l.fromPairs)(Object(l.map)(e,e=>{var t=Object(l.extend)({},e);switch(e.type){case BO:case HO:t.type=gp.DashboardLevel,t.value=null;break;case QO:t.type=gp.StaticValue,t.param=xr(e.param),t.param.setValue(t.value),t.value=t.param.value;break;case YO:t.type=gp.WidgetLevel,t.value=null}return delete t.param,[t.name,t]}))}function GO(e,t){var a=[];return Object(l.each)(e,e=>{e.type===gp.DashboardLevel&&Object(l.each)(t,t=>{var r=t.options.parameterMappings;Object(l.each)(r,r=>{r.type===gp.DashboardLevel&&r.mapTo===e.mapTo&&r.title!==e.title&&(r.title=e.title,a.push(t))})})}),a}class $O extends n.a.Component{constructor(){super(...arguments),UO(this,"formItemProps",{labelCol:{span:5},wrapperCol:{span:16},className:"form-item"}),UO(this,"updateSourceType",e=>{var t=this.props.mapping.mapTo,a=this.props.existingParamNames;e!==HO||Object(l.includes)(a,t)||(t=a[0]),this.updateParamMapping({type:e,mapTo:t})}),UO(this,"updateParamMapping",e=>{var t=this.props,a=t.onChange,r=t.mapping,n=Object(l.extend)({},r,e);n.value!==r.value&&(n.param=xr(n.param),n.param.setValue(n.value)),Object(l.has)(e,"type")&&(e.type===QO?n.value=n.param.value:n.value=null),a(n)})}renderMappingTypeSelector(){var e=Object(l.isEmpty)(this.props.existingParamNames);return n.a.createElement(kn.a.Group,{value:this.props.mapping.type,onChange:e=>this.updateSourceType(e.target.value)},n.a.createElement(kn.a,{className:"radio",value:BO,"data-test":"NewDashboardParameterOption"},window.W_L.new_dashboard_parm),n.a.createElement(kn.a,{className:"radio",value:HO,disabled:e},window.W_L.exist_dashboard_parm," ",e?n.a.createElement(we,{title:window.W_L.dashboard_param_error},n.a.createElement(ho.a,null)):null),n.a.createElement(kn.a,{className:"radio",value:YO,"data-test":"WidgetParameterOption"},window.W_L.widget_parm),n.a.createElement(kn.a,{className:"radio",value:QO,"data-test":"StaticValueOption"},window.W_L.static_value))}renderDashboardAddNew(){var e=this.props.mapping.mapTo;return n.a.createElement(ta.a,{value:e,"aria-label":"Parameter name (key)",onChange:e=>this.updateParamMapping({mapTo:e.target.value})})}renderDashboardMapToExisting(){var e=this.props,t=e.mapping,a=e.existingParamNames,r=Object(l.map)(a,e=>({label:e,value:e}));return n.a.createElement(Yr.a,{value:t.mapTo,onChange:e=>this.updateParamMapping({mapTo:e}),options:r})}renderStaticValue(){var e=this.props.mapping;return n.a.createElement(yv,{type:e.param.type,value:e.param.normalizedValue,enumOptions:e.param.enumOptions,queryId:e.param.queryId,parameter:e.param,onSelect:e=>this.updateParamMapping({value:e})})}renderInputBlock(){switch(this.props.mapping.type){case BO:return["Key",window.W_L.enter_parm_name,this.renderDashboardAddNew()];case HO:return["Key",window.W_L.select_parm,this.renderDashboardMapToExisting()];case QO:return["Value",null,this.renderStaticValue()];default:return[]}}render(){var e=this.props.inputError,t=FO(this.renderInputBlock(),3),a=t[0],r=t[1],o=t[2];return n.a.createElement(Vb.a,{layout:"horizontal"},n.a.createElement(Vb.a.Item,zO({label:window.W_L.source},this.formItemProps),this.renderMappingTypeSelector()),n.a.createElement(Vb.a.Item,zO({style:{height:60,visibility:o?"visible":"hidden"},label:a},this.formItemProps,{validateStatus:e?"error":"",help:e||r}),o))}}UO($O,"propTypes",{mapping:ae.a.object,existingParamNames:ae.a.arrayOf(ae.a.string),onChange:ae.a.func,inputError:ae.a.string}),UO($O,"defaultProps",{mapping:{},existingParamNames:[],onChange:()=>{},inputError:null});class JO extends n.a.Component{constructor(e){super(e),UO(this,"onVisibleChange",e=>{e?this.show():this.hide()}),UO(this,"onChange",e=>{var t=null;e.type===BO&&(Object(l.isEmpty)(e.mapTo)?t=window.W_L.code_mast_have_value:Object(l.includes)(this.props.existingParamNames,e.mapTo)&&(t=window.W_L.exist_save_parm)),this.setState({mapping:e,inputError:t})}),UO(this,"save",()=>{this.props.onChange(this.props.mapping,this.state.mapping),this.hide()}),UO(this,"show",()=>{this.setState({visible:!0,mapping:Object(l.clone)(this.props.mapping)})}),UO(this,"hide",()=>{this.setState({visible:!1})}),this.state={visible:!1,mapping:Object(l.clone)(this.props.mapping),inputError:null}}renderContent(){var e=this.state,t=e.mapping,a=e.inputError;return n.a.createElement("div",{className:"parameter-mapping-editor","data-test":"EditParamMappingPopover"},n.a.createElement("header",null,window.W_L.edit_source_value," ",n.a.createElement(Ge,{type:"VALUE_SOURCE_OPTIONS"})),n.a.createElement($O,{mapping:t,existingParamNames:this.props.existingParamNames,onChange:this.onChange,inputError:a}),n.a.createElement("footer",null,n.a.createElement(m.a,{onClick:this.hide},window.W_L.cancel),n.a.createElement(m.a,{onClick:this.save,disabled:!!a,type:"primary"},window.W_L.ok_text)))}render(){var e=this.state,t=e.visible,a=e.mapping;return n.a.createElement(Xr.a,{placement:"left",trigger:"click",content:this.renderContent(),visible:t,onVisibleChange:this.onVisibleChange},n.a.createElement(m.a,{size:"small",type:"dashed","data-test":"EditParamMappingButton-".concat(a.param.name)},n.a.createElement(MO.a,null)))}}UO(JO,"propTypes",{mapping:ae.a.object.isRequired,existingParamNames:ae.a.arrayOf(ae.a.string).isRequired,onChange:ae.a.func.isRequired});class XO extends n.a.Component{constructor(){super(...arguments),UO(this,"state",{showPopup:!1,title:""}),UO(this,"onPopupVisibleChange",e=>{this.setState({showPopup:e,title:e?this.getMappingTitle():""})}),UO(this,"onEditingTitleChange",e=>{this.setState({title:e.target.value})}),UO(this,"save",()=>{var e=Object(l.extend)({},this.props.mapping,{title:this.state.title});this.props.onChange(e),this.hide()}),UO(this,"hide",()=>{this.setState({showPopup:!1})})}getMappingTitle(){var e=this.props.mapping;if(Object(l.isString)(e.title)&&""!==e.title)return e.title;if(e.type===HO){var t=Object(l.find)(this.props.existingParams,{name:e.mapTo});t&&(e=t)}return e.title||e.param.title}renderPopover(){var e=this.props.mapping.param.title;return n.a.createElement("div",{className:"parameter-mapping-title-editor"},n.a.createElement(ta.a,{size:"small",value:this.state.title,placeholder:e,"aria-label":"Edit parameter title",onChange:this.onEditingTitleChange,onPressEnter:this.save,maxLength:100,autoFocus:!0}),n.a.createElement(m.a,{size:"small",type:"dashed",onClick:this.hide},n.a.createElement(je.a,null)),n.a.createElement(m.a,{size:"small",type:"dashed",onClick:this.save},n.a.createElement(on.a,null)))}renderEditButton(){return this.props.mapping.type===QO?n.a.createElement(we,{placement:"right",title:window.W_L.title_set_hidden_in_widget},n.a.createElement("span",{tabIndex:0},n.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"}))):n.a.createElement(Xr.a,{placement:"right",trigger:"click",content:this.renderPopover(),visible:this.state.showPopup,onVisibleChange:this.onPopupVisibleChange},n.a.createElement(m.a,{size:"small",type:"dashed"},n.a.createElement(MO.a,null)))}render(){var e=this.props.mapping.type===QO;return n.a.createElement("div",{className:me()("parameter-mapping-title",{disabled:e})},n.a.createElement("span",{className:"text"},this.getMappingTitle()),this.renderEditButton())}}UO(XO,"propTypes",{existingParams:ae.a.arrayOf(ae.a.object),mapping:ae.a.object.isRequired,onChange:ae.a.func.isRequired}),UO(XO,"defaultProps",{existingParams:[]});class ZO extends n.a.Component{static getStringValue(e){return e?e instanceof Object&&"start"in e&&"end"in e?"".concat(e.start," ~ ").concat(e.end):"object"==typeof e?Object(l.map)(e,e=>this.getStringValue(e)).join(", "):e.toString():""}static getDefaultValue(e,t){var a=e.type,r=e.mapTo,n=e.name,o=e.param;if(a===HO&&r!==n){var i=Object(l.find)(t,{name:r});i&&(o=i)}else a===QO&&(o=xr(o).setValue(e.value));var s=ja.getExecutionValue(o);return o.hasDynamicValue&&(s=o.normalizedValue.name),this.getStringValue(s)}static getSourceTypeLabel(e){var t=e.type,a=e.mapTo;switch(t){case BO:case HO:return n.a.createElement(r.Fragment,null,window.W_L.dashboard_parm," ",n.a.createElement(DO.a,{className:"tag"},a));case YO:return window.W_L.widget_parm;case QO:return window.W_L.static_value;default:return""}}updateParamMapping(e,t){var a=[...this.props.mappings],r=Object(l.findIndex)(a,e);r>=0?a[r]=t:a.push(t),this.props.onChange(a)}render(){var e=this.props.existingParams,t=this.props.mappings.map(e=>({mapping:e}));return n.a.createElement("div",{className:"parameters-mapping-list"},n.a.createElement(Il.a,{dataSource:t,size:"middle",pagination:!1,rowKey:(e,t)=>"row".concat(t)},n.a.createElement(Il.a.Column,{title:window.W_L.name,dataIndex:"mapping",key:"title",render:t=>n.a.createElement(XO,{existingParams:e,mapping:t,onChange:e=>this.updateParamMapping(t,e)})}),n.a.createElement(Il.a.Column,{title:window.W_L.code,dataIndex:"mapping",key:"keyword",className:"keyword",render:e=>n.a.createElement("code",null,"{{ ".concat(e.name," }}"))}),n.a.createElement(Il.a.Column,{title:window.W_L.default_value,dataIndex:"mapping",key:"value",render:e=>this.constructor.getDefaultValue(e,this.props.existingParams)}),n.a.createElement(Il.a.Column,{title:window.W_L.source,dataIndex:"mapping",key:"source",render:t=>{var a=e.filter(e=>e.type===t.param.type).map(e=>e.name);return n.a.createElement(r.Fragment,null,this.constructor.getSourceTypeLabel(t)," ",n.a.createElement(JO,{mapping:t,existingParamNames:a,onChange:(e,t)=>this.updateParamMapping(e,t)}))}})))}}function e_(){return(e_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function t_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function a_(e,t){return Object(l.map)(Object(l.sortBy)(e,e=>e.name),e=>{var a;switch(e.type){case QO:return[e.name,e.value];case YO:return[e.name,e.param.value];case BO:case HO:return a=Object(l.find)(t,t=>t.name===e.mapTo),[e.name,a?a.value:null]}})}UO(ZO,"propTypes",{mappings:ae.a.arrayOf(ae.a.object),existingParams:ae.a.arrayOf(ae.a.object),onChange:ae.a.func}),UO(ZO,"defaultProps",{mappings:[],existingParams:[],onChange:()=>{}});class r_ extends n.a.Component{constructor(e){super(e),t_(this,"originalParamValuesSnapshot",null);var t=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object(l.map)(e,e=>{var r=Object(l.extend)({},e),n=Object(l.includes)(a,e.mapTo);switch(r.param=Object(l.find)(t,t=>t.name===e.name),e.type){case gp.DashboardLevel:r.type=n?HO:BO,r.value=null;break;case gp.StaticValue:r.type=QO,r.param=xr(r.param),r.param.setValue(r.value);break;case gp.WidgetLevel:r.type=YO,r.value=null}return r})}(e.widget.options.parameterMappings,e.widget.query.getParametersDefs(),Object(l.map)(this.props.dashboard.getParametersDefs(),e=>e.name));this.originalParamValuesSnapshot=a_(t,this.props.dashboard.getParametersDefs()),this.state={saveInProgress:!1,parameterMappings:t}}saveWidget(){var e=this.props.widget;this.setState({saveInProgress:!0});var t=KO(this.state.parameterMappings);e.options.parameterMappings=t;var a=!Object(l.isMatch)(this.originalParamValuesSnapshot,a_(this.state.parameterMappings,this.props.dashboard.getParametersDefs())),r=[e,...GO(e.options.parameterMappings,this.props.dashboard.widgets)];Promise.all(Object(l.map)(r,e=>e.save())).then(()=>{this.props.dialog.close(a)}).catch(()=>{Hp.error("Widget cannot be updated")}).finally(()=>{this.setState({saveInProgress:!1})})}updateParamMappings(e){this.setState({parameterMappings:e})}render(){var e=this.props.dialog;return n.a.createElement(R.a,e_({},e.props,{title:window.W_L.params,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,onOk:()=>this.saveWidget(),okButtonProps:{loading:this.state.saveInProgress},width:700}),this.state.parameterMappings.length>0&&n.a.createElement(ZO,{mappings:this.state.parameterMappings,existingParams:this.props.dashboard.getParametersDefs(),onChange:e=>this.updateParamMappings(e)}))}}t_(r_,"propTypes",{dashboard:ae.a.object.isRequired,widget:ae.a.object.isRequired,dialog:ia.isRequired});var n_=la(r_);a(1373);function o_(){return(o_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function i_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l_(e){var t=e.extraOptions,a=e.showDeleteOption,r=e.onDelete,o=n.a.createElement(ue.a,{"data-test":"WidgetDropdownButtonMenu"},t,a&&t&&n.a.createElement(ue.a.Divider,null),a&&n.a.createElement(ue.a.Item,{onClick:r},window.W_L.delete));return n.a.createElement("div",{className:"widget-menu-regular"},n.a.createElement(Vt.a,{overlay:o,placement:"bottomRight",trigger:["click"]},n.a.createElement(ge,{className:"action p-l-15 p-r-15","data-test":"WidgetDropdownButton","aria-label":"More options"},n.a.createElement("i",{className:"zmdi zmdi-more-vert","aria-hidden":"true"}))))}function s_(e){var t=e.onClick;return n.a.createElement("div",{className:"widget-menu-remove"},n.a.createElement(ge,{className:"action",title:"{window.W_L.delete}",onClick:t,"data-test":"WidgetDeleteButton","aria-label":"Close"},n.a.createElement("i",{className:"zmdi zmdi-close","aria-hidden":"true"})))}l_.propTypes={extraOptions:ae.a.node,showDeleteOption:ae.a.bool,onDelete:ae.a.func},l_.defaultProps={extraOptions:null,showDeleteOption:!1,onDelete:()=>{}},s_.propTypes={onClick:ae.a.func},s_.defaultProps={onClick:()=>{}};class c_ extends n.a.Component{constructor(){super(...arguments),i_(this,"deleteWidget",()=>{var e=this.props,t=e.widget,a=e.onDelete;R.a.confirm({title:window.W_L.delete_widget,content:window.W_L.delete_widget_confirm,cancelText:window.W_L.cancel,okText:window.W_L.ok_text,okType:"danger",onOk:()=>t.delete().then(a),maskClosable:!0,autoFocusButton:null})})}componentDidMount(){da("view","widget",this.props.widget.id)}render(){var e=this.props,t=e.className,a=e.children,r=e.header,o=e.footer,i=e.canEdit,s=e.isPublic,c=e.menuOptions,u=e.tileProps,d=!s&&(i||!Object(l.isEmpty)(c));return n.a.createElement("div",{className:"widget-wrapper"},n.a.createElement("div",o_({className:me()("tile body-container",t)},u),n.a.createElement("div",{className:"widget-actions"},d&&n.a.createElement(l_,{extraOptions:c,showDeleteOption:i,onDelete:this.deleteWidget}),i&&n.a.createElement(s_,{onClick:this.deleteWidget})),n.a.createElement("div",{className:"body-row widget-header"},r),a,o&&n.a.createElement("div",{className:"body-row tile__bottom-control"},o)))}}i_(c_,"propTypes",{widget:ae.a.object.isRequired,className:ae.a.string,children:ae.a.node,header:ae.a.node,footer:ae.a.node,canEdit:ae.a.bool,isPublic:ae.a.bool,refreshStartedAt:Tf,menuOptions:ae.a.node,tileProps:ae.a.object,onDelete:ae.a.func}),i_(c_,"defaultProps",{className:"",children:null,header:null,footer:null,canEdit:!1,isPublic:!1,refreshStartedAt:null,menuOptions:null,tileProps:{},onDelete:()=>{}});var u_=c_;function d_(){return(d_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function m_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f_(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return f_(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f_(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function g_(e){var t=e.widget,a=e.canEditDashboard,r=e.onParametersEdit,o=(e.isShowReport,H.hasPermission("view_query")),i=a&&!Object(l.isEmpty)(Object(l.invoke)(t,"query.getParametersDefs")),s=t.getQueryResult(),c=!s||!s.isEmpty||s.isEmpty(),u=e=>s.getLink(t.getQuery().id,e),d=e=>s.getName(t.getQuery().name,e);return Object(l.compact)([n.a.createElement(ue.a.Item,{key:"download_csv",disabled:c},c?window.W_L.save_as_csv:n.a.createElement(h,{href:u("csv"),download:d("csv"),target:"_self"},window.W_L.save_as_csv)),n.a.createElement(ue.a.Item,{key:"download_tsv",disabled:c},c?window.W_L.save_as_tsv:n.a.createElement(h,{href:u("tsv"),download:d("tsv"),target:"_self"},window.W_L.save_as_tsv)),n.a.createElement(ue.a.Item,{key:"download_excel",disabled:c},c?window.W_L.save_as_excel:n.a.createElement(h,{href:u("xlsx"),download:d("xlsx"),target:"_self"},window.W_L.save_as_excel)),(o||i)&&n.a.createElement(ue.a.Divider,{key:"divider"}),o&&n.a.createElement(ue.a.Item,{key:"view_query"},n.a.createElement(h,{href:t.getQuery().getUrl(!0,t.visualization.id)},window.W_L.edit_query)),i&&n.a.createElement(ue.a.Item,{key:"edit_parameters",onClick:r},window.W_L.edit_param)])}function b_(e){var t=e.refreshStartedAt;return n.a.createElement("div",{className:"refresh-indicator"},n.a.createElement("div",{className:"refresh-icon"},n.a.createElement("i",{className:"zmdi zmdi-refresh zmdi-hc-spin","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Refreshing...")),n.a.createElement(qv,{from:t}))}function h_(e){var t=e.widget,a=e.refreshStartedAt,r=e.parameters,o=e.isEditing,i=e.onParametersUpdate,s=e.onParametersEdit,c=H.hasPermission("view_query");return n.a.createElement(n.a.Fragment,null,n.a.createElement(b_,{refreshStartedAt:a}),n.a.createElement("div",{className:"t-header widget clearfix"},n.a.createElement("div",{className:"th-title"},n.a.createElement("p",null,n.a.createElement(Fv,{query:t.getQuery(),visualization:t.visualization,readOnly:!c})),!Object(l.isEmpty)(t.getQuery().description)&&n.a.createElement(We,{className:"text-muted markdown query--description"},Ie.markdown.toHTML(t.getQuery().description||"")))),!Object(l.isEmpty)(r)&&n.a.createElement("div",{className:"m-b-10"},n.a.createElement(Tv,{parameters:r,sortable:o,appendSortableToParent:!1,onValuesChange:i,onParametersEdit:s})))}function y_(e){var t=e.widget,a=e.isPublic,o=e.onRefresh,i=e.onExpand,s=t.getQueryResult(),c=Object(l.invoke)(s,"getUpdatedAt"),u=p_(Object(r.useState)(),2),d=u[0],m=u[1],p=e=>{d||(m(e),o().finally(()=>m(null)))};return s?n.a.createElement(n.a.Fragment,null,n.a.createElement("span",null,!a&&!!s&&n.a.createElement(ge,{className:"refresh-button hidden-print btn btn-sm btn-default btn-transparent",onClick:()=>p(1),"data-test":"RefreshButton"},n.a.createElement("i",{className:me()("zmdi zmdi-refresh",{"zmdi-hc-spin":1===d}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},1===d?"Refreshing, please wait. ":"Press to refresh. ")," ",n.a.createElement(qf,{date:c})),n.a.createElement("span",{className:"visible-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",Vf(c)),a&&n.a.createElement("span",{className:"small hidden-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",n.a.createElement(qf,{date:c}))),n.a.createElement("span",null,!a&&n.a.createElement(ge,{className:"btn btn-sm btn-default hidden-print btn-transparent btn__refresh",onClick:()=>p(2)},n.a.createElement("i",{className:me()("zmdi zmdi-refresh",{"zmdi-hc-spin":2===d}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},2===d?"Refreshing, please wait.":"Press to refresh.")),n.a.createElement(ge,{className:"btn btn-sm btn-default hidden-print btn-transparent btn__refresh",onClick:i},n.a.createElement("i",{className:"zmdi zmdi-fullscreen","aria-hidden":"true"})))):null}b_.propTypes={refreshStartedAt:Tf},b_.defaultProps={refreshStartedAt:null},h_.propTypes={widget:ae.a.object.isRequired,refreshStartedAt:Tf,parameters:ae.a.arrayOf(ae.a.object),isEditing:ae.a.bool,onParametersUpdate:ae.a.func,onParametersEdit:ae.a.func},h_.defaultProps={refreshStartedAt:null,onParametersUpdate:()=>{},onParametersEdit:()=>{},isEditing:!1,parameters:[]},y_.propTypes={widget:ae.a.object.isRequired,isPublic:ae.a.bool,onRefresh:ae.a.func.isRequired,onExpand:ae.a.func.isRequired},y_.defaultProps={isPublic:!1};class v_ extends n.a.Component{constructor(e){super(e),m_(this,"onLocalFiltersChange",e=>{this.setState({localFilters:e})}),m_(this,"expandWidget",()=>{IO.showModal({widget:this.props.widget,filters:this.state.localFilters})}),m_(this,"editParameterMappings",()=>{var e=this.props,t=e.widget,a=e.dashboard,r=e.onRefresh,n=e.onParameterMappingsChange;n_.showModal({dashboard:a,widget:t}).onClose(e=>{e&&r(),n(),this.setState({localParameters:t.getLocalParameters()})})}),this.state={localParameters:e.widget.getLocalParameters(),localFilters:e.filters}}componentDidMount(){var e=this.props,t=e.widget,a=e.onLoad;da("view","query",t.visualization.query.id,{dashboard:!0}),da("view","visualization",t.visualization.id,{dashboard:!0}),a()}renderVisualization(){var e=this.props,t=e.widget,a=e.filters,r=t.getQueryResult();switch(r&&r.getStatus()){case"failed":return n.a.createElement("div",{className:"body-row-auto scrollbox"},r.getError()&&n.a.createElement("div",{className:"alert alert-danger m-5"},window.W_L.query_error,"： ",n.a.createElement("strong",null,r.getError())));case"done":return n.a.createElement("div",{className:"body-row-auto scrollbox"},n.a.createElement(AO,{visualization:t.visualization,queryResult:r,filters:a,onFiltersChange:this.onLocalFiltersChange,context:"widget"}));default:return n.a.createElement("div",{className:"body-row-auto spinner-container",role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("div",{className:"spinner"},n.a.createElement("i",{className:"zmdi zmdi-refresh zmdi-hc-spin zmdi-hc-5x","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading...")))}}render(){var e=this.props,t=e.widget,a=e.isLoading,r=e.isPublic,o=e.canEdit,i=e.isEditing,s=e.onRefresh,c=e.isShowReport,u=this.state.localParameters,d=t.getQueryResult(),m=a&&!(!d||!d.getStatus());return n.a.createElement(u_,d_({},this.props,{className:"widget-visualization",menuOptions:g_({widget:t,canEditDashboard:o,onParametersEdit:this.editParameterMappings,isShowReport:c}),header:n.a.createElement(h_,{widget:t,refreshStartedAt:m?t.refreshStartedAt:null,parameters:u,isEditing:i,onParametersUpdate:s,onParametersEdit:e=>{var a=Object(l.map)(e,"name");t.options.paramOrder=a,t.save("options",{paramOrder:a})}}),footer:n.a.createElement(y_,{widget:t,isPublic:r,onRefresh:s,onExpand:this.expandWidget}),tileProps:{"data-refreshing":m}}),this.renderVisualization())}}m_(v_,"propTypes",{widget:ae.a.object.isRequired,dashboard:ae.a.object.isRequired,filters:Qv,isPublic:ae.a.bool,isLoading:ae.a.bool,canEdit:ae.a.bool,isEditing:ae.a.bool,onLoad:ae.a.func,onRefresh:ae.a.func,onDelete:ae.a.func,onParameterMappingsChange:ae.a.func,isShowReport:ae.a.bool}),m_(v_,"defaultProps",{filters:[],isPublic:!1,isLoading:!1,canEdit:!1,isEditing:!1,onLoad:()=>{},onRefresh:()=>{},onDelete:()=>{},onParameterMappingsChange:()=>{},isShowReport:!0});var w_=v_;a(1374);function O_(){return(O_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function __(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E_(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return E_(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E_(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function j_(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function S_(e){var t=e.dialog,a=e.isNew,o=j_(e,["dialog","isNew"]),i=__(Object(r.useState)(Object(l.toString)(o.text)),2),s=i[0],c=i[1],u=__(Object(r.useState)(null),2),d=u[0],m=u[1];Object(r.useEffect)(()=>{c(o.text),m(Ie.markdown.toHTML(o.text))},[o.text]);var p=__(Object(Sl.a)(()=>{m(Ie.markdown.toHTML(s))},200),1)[0],f=Object(r.useCallback)(e=>{c(e.target.value),p()},[p]),g=Object(r.useCallback)(()=>{t.close(s).catch(()=>{Hp.error(a?window.W_L.widget_will_not_add:window.W_L.widget_will_not_save)})},[t,a,s]),b=Object(r.useCallback)(()=>{var e=o.text;s!==e?R.a.confirm({title:window.W_L.quit_edit,content:window.W_L.quit_edit_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:()=>t.dismiss(),maskClosable:!0,autoFocusButton:null,style:{top:170}}):t.dismiss()},[t,s,o.text]);return n.a.createElement(R.a,O_({},t.props,{title:a?window.W_L.add_text:window.W_L.edit_text,onOk:g,okText:a?window.W_L.add_to_dashboard:window.W_L.save,cancelText:window.W_L.save,onCancel:b,width:500,wrapProps:{"data-test":"TextboxDialog"}}),n.a.createElement("div",{className:"textbox-dialog"},n.a.createElement(ta.a.TextArea,{className:"resize-vertical",rows:"5",value:s,"aria-label":"Textbox widget content",onChange:f,autoFocus:!0,placeholder:window.W_L.input_text}),n.a.createElement("small",null,window.W_L.support_basic," ",n.a.createElement(h,{target:"_blank",rel:"noopener noreferrer",href:"https://www.markdownguide.org/cheat-sheet/#basic-syntax"},n.a.createElement(we,{title:window.W_L.open_markdown},"Markdown")),"；",n.a.createElement(h,{target:"_blank",rel:"noopener noreferrer",href:"https://www.runoob.com/markdown/md-tutorial.html"},n.a.createElement(we,{title:window.W_L.open_markdown_teach},window.W_L.open_markdown_teach," ")),"。"),s&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Qb.a,{dashed:!0}),n.a.createElement("strong",{className:"preview-title"},window.W_L.preview,"："),n.a.createElement(We,{className:"preview markdown"},d))))}S_.propTypes={dialog:ia.isRequired,isNew:ae.a.bool,text:ae.a.string},S_.defaultProps={isNew:!1,text:""};var C_=la(S_);function x_(){return(x_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function P_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L_(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return L_(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L_(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function k_(e){var t=e.widget,a=e.canEdit,o=P_(Object(r.useState)(t.text),2),i=o[0],l=o[1],s=[n.a.createElement(ue.a.Item,{key:"edit",onClick:()=>{C_.showModal({text:t.text}).onClose(e=>(t.text=e,l(e),t.save()))}},window.W_L.edit)];return t.width?n.a.createElement(u_,x_({},e,{menuOptions:a?s:null,className:"widget-text"}),n.a.createElement(We,{className:"body-row-auto scrollbox t-body p-15 markdown"},Ie.markdown.toHTML(i||""))):null}k_.propTypes={widget:ae.a.object.isRequired,canEdit:ae.a.bool},k_.defaultProps={canEdit:!1};var N_=k_;function A_(){return(A_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var T_=function(e){return n.a.createElement(u_,A_({},e,{className:"d-flex justify-content-center align-items-center widget-restricted"}),n.a.createElement("div",{className:"t-body scrollbox"},n.a.createElement("div",{className:"text-center"},n.a.createElement("h1",null,n.a.createElement("span",{className:"zmdi zmdi-lock"})),n.a.createElement("p",{className:"text-muted"},window.W_L.widget_have_no_access))))};function W_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I_(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return I_(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I_(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function q_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var D_=[".widget-header",".visualization-renderer",".scrollbox .alert",".spinner-container",".tile__bottom-control"].join(",");class R_{constructor(e){q_(this,"widgets",{}),q_(this,"interval",null),q_(this,"onHeightChange",null),q_(this,"add",e=>{this.isEmpty()&&this.start();var t='[data-widgetid="{0}"]'.replace("{0}",e);this.widgets[e]=[function(){var e=document.querySelector(t);if(e){var a=e.querySelectorAll(D_);return Object(l.reduce)(a,(e,t)=>e+(t?t.getBoundingClientRect().height:0),0)}}]}),q_(this,"remove",e=>{this.exists(e)&&(this.widgets[e.toString()]=!1,this.isEmpty()&&this.stop())}),q_(this,"exists",e=>!!this.widgets[e.toString()]),q_(this,"isEmpty",()=>!Object(l.some)(this.widgets)),q_(this,"checkHeightChanges",()=>{Object.keys(this.widgets).filter(this.exists).forEach(e=>{var t=W_(this.widgets[e],2),a=t[0],r=t[1],n=a();n&&n!==r&&(this.widgets[e][1]=n,this.onHeightChange(e,n))})}),q_(this,"start",()=>{this.stop(),this.interval=setInterval(this.checkHeightChanges,200)}),q_(this,"stop",()=>{clearInterval(this.interval)}),q_(this,"resume",()=>{this.isEmpty()||this.start()}),q_(this,"destroy",()=>{this.stop(),this.widgets=null}),this.onHeightChange=e}update(e){var t=e.filter(e=>e.options.position.autoHeight).map(e=>e.id.toString());t.filter(e=>!Object(l.includes)(Object.keys(this.widgets),e)).forEach(this.add),Object.keys(this.widgets).filter(e=>!Object(l.includes)(t,e)).forEach(this.remove)}}a(1375),a(1376);function M_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var z_=Object(ry.WidthProvider)(ry.Responsive),F_=ae.a.shape({id:ae.a.number.isRequired,options:ae.a.shape({position:ae.a.shape({col:ae.a.number.isRequired,row:ae.a.number.isRequired,sizeY:ae.a.number.isRequired,minSizeY:ae.a.number.isRequired,maxSizeY:ae.a.number.isRequired,sizeX:ae.a.number.isRequired,minSizeX:ae.a.number.isRequired,maxSizeX:ae.a.number.isRequired}).isRequired}).isRequired}),V_="single-column",U_="multi-column",B_=n.a.memo((function(e){var t=e.widget,a=e.dashboard,r=e.onLoadWidget,o=e.onRefreshWidget,i=e.onRemoveWidget,l=e.onParameterMappingsChange,s=e.isEditing,c=e.canEdit,u=e.isPublic,d=e.isLoading,m=e.filters,p=e.isShowReport,f=t.type,g=()=>i(t.id);return f===up?n.a.createElement(w_,{isShowReport:p,widget:t,dashboard:a,filters:m,isEditing:s,canEdit:c,isPublic:u,isLoading:d,onLoad:()=>r(t),onRefresh:()=>o(t),onDelete:g,onParameterMappingsChange:l}):f===cp?n.a.createElement(N_,{widget:t,canEdit:c,isPublic:u,onDelete:g}):n.a.createElement(T_,{widget:t})}),(e,t)=>e.widget===t.widget&&e.canEdit===t.canEdit&&e.isPublic===t.isPublic&&e.isLoading===t.isLoading&&e.filters===t.filters&&e.isEditing===t.isEditing);class H_ extends n.a.Component{static normalizeFrom(e){var t=e.id,a=e.options.position;return{i:t.toString(),x:a.col,y:a.row,w:a.sizeX,h:a.sizeY,minW:a.minSizeX,maxW:a.maxSizeX,minH:a.minSizeY,maxH:a.maxSizeY}}constructor(e){super(e),M_(this,"mode",null),M_(this,"autoHeightCtrl",null),M_(this,"onLayoutChange",(e,t)=>{if(t[U_]&&this.setState({layouts:t}),this.mode=document.body.offsetWidth<=ga?V_:U_,this.mode!==V_){var a=Object(l.chain)(t[U_]).keyBy("i").mapValues(this.normalizeTo).value();this.props.onLayoutChange(a)}}),M_(this,"onBreakpointChange",e=>{this.mode=e,this.props.onBreakpointChange(e===V_)}),M_(this,"onWidgetHeightUpdated",(e,t)=>{this.setState(a=>{var r=a.layouts,n=Object(l.cloneDeep)(r[U_]),o=Object(l.find)(n,{i:e.toString()});return o&&(o.h=Math.ceil((t+fa)/pa)),{layouts:{[U_]:n}}})}),M_(this,"onWidgetResize",(e,t,a)=>{t.h!==a.h&&this.autoHeightCtrl.remove(Number(a.i)),this.autoHeightCtrl.resume()}),M_(this,"normalizeTo",e=>({col:e.x,row:e.y,sizeX:e.w,sizeY:e.h,autoHeight:this.autoHeightCtrl.exists(e.i)})),this.state={layouts:{},disableAnimations:!0},this.autoHeightCtrl=new R_(this.onWidgetHeightUpdated),this.autoHeightCtrl.update(this.props.widgets)}componentDidMount(){this.onBreakpointChange(document.body.offsetWidth<=ga?V_:U_),setTimeout(()=>{this.setState({disableAnimations:!1})},50)}componentDidUpdate(){this.autoHeightCtrl.update(this.props.widgets)}componentWillUnmount(){this.autoHeightCtrl.destroy()}render(){var e=this.props,t=e.onLoadWidget,a=e.onRefreshWidget,r=e.onRemoveWidget,o=e.onParameterMappingsChange,i=e.filters,l=e.dashboard,s=e.isPublic,c=e.isEditing,u=e.widgets,d=e.isShowReport,m=me()("dashboard-wrapper",c?"editing-mode":"preview-mode");return n.a.createElement("div",{className:m},n.a.createElement(z_,{draggableCancel:"input,.sortable-container",className:me()("layout",{"disable-animations":this.state.disableAnimations}),cols:{[U_]:ma,[V_]:1},rowHeight:pa-fa,margin:[fa,fa],isDraggable:c,isResizable:c,onResizeStart:this.autoHeightCtrl.stop,onResizeStop:this.onWidgetResize,layouts:this.state.layouts,onLayoutChange:this.onLayoutChange,onBreakpointChange:this.onBreakpointChange,breakpoints:{[U_]:ga,[V_]:0}},u.map(e=>n.a.createElement("div",{key:e.id,"data-grid":H_.normalizeFrom(e),"data-widgetid":e.id,"data-test":"WidgetId".concat(e.id),className:me()("dashboard-widget-wrapper",{"widget-auto-height-enabled":this.autoHeightCtrl.exists(e.id)})},n.a.createElement(B_,{dashboard:l,widget:e,filters:i,isPublic:s,isLoading:e.loading,isEditing:c,canEdit:l.canEdit(),onLoadWidget:t,onRefreshWidget:a,isShowReport:d,onRemoveWidget:r,onParameterMappingsChange:o})))))}}M_(H_,"propTypes",{isEditing:ae.a.bool.isRequired,isPublic:ae.a.bool,dashboard:ae.a.object.isRequired,widgets:ae.a.arrayOf(F_).isRequired,filters:Qv,onBreakpointChange:ae.a.func,onLoadWidget:ae.a.func,onRefreshWidget:ae.a.func,onRemoveWidget:ae.a.func,onLayoutChange:ae.a.func,onParameterMappingsChange:ae.a.func,isShowReport:ae.a.bool}),M_(H_,"defaultProps",{isPublic:!1,filters:[],onLoadWidget:()=>{},onRefreshWidget:()=>{},onRemoveWidget:()=>{},onLayoutChange:()=>{},onBreakpointChange:()=>{},onParameterMappingsChange:()=>{},isShowReport:!0});var Y_=H_;function Q_(){return(Q_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function K_(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function G_(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K_(Object(a),!0).forEach((function(t){$_(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function $_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function J_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return X_(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return X_(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X_(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Z_(e){var t=e.query,a=e.visualization,o=e.onChange,i=Object(r.useMemo)(()=>t?Object(l.groupBy)(t.visualizations,"type"):{},[t]),s=Se("visualization-select"),c=Object(r.useCallback)(e=>{var a=t?Object(l.find)(t.visualizations,{id:e}):null;o(a||null)},[t,o]);if(!t)return null;var u={BOXPLOT:window.W_L.BOXPLOT,CHART:window.W_L.CHART,CHOROPLETH:window.W_L.CHOROPLETH,COHORT:window.W_L.COHORT,COUNTER:window.W_L.COUNTER,DETAILS:window.W_L.DETAILS,FUNNEL:window.W_L.FUNNEL,MAP:window.W_L.MAP,PIVOT:window.W_L.PIVOT,SANKEY:window.W_L.SANKEY,SUNBURST_SEQUENCE:window.W_L.SUNBURST_SEQUENCE,TABLE:window.W_L.TABLE,WORD_CLOUD:window.W_L.WORD_CLOUD};return n.a.createElement("div",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:s},window.W_L.select_view),n.a.createElement(Yr.a,{id:s,className:"w-100",value:a?a.id:void 0,onChange:c},Object(l.map)(i,(e,t)=>n.a.createElement(Yr.a.OptGroup,{key:t,label:u[t]},Object(l.map)(e,e=>n.a.createElement(Yr.a.Option,{key:"".concat(e.id),value:e.id},e.name)))))))}function eE(e){var t=e.dialog,a=e.dashboard,o=J_(Object(r.useState)(null),2),i=o[0],s=o[1],c=J_(Object(r.useState)(null),2),u=c[0],d=c[1],m=J_(Object(r.useState)([]),2),p=m[0],f=m[1],g=Object(r.useCallback)(e=>{s(null),d(null),f([]),e&&Za.get({id:e}).then(e=>{if(e){var t=Object(l.map)(a.getParametersDefs(),e=>e.name);s(e),f(Object(l.map)(e.getParametersDefs(),e=>({name:e.name,type:Object(l.includes)(t,e.name)?HO:BO,mapTo:e.name,value:e.normalizedValue,title:"",param:e}))),e.visualizations.length>0&&d(Object(l.first)(e.visualizations))}})},[a]),b=Object(r.useCallback)(()=>{t.close({visualization:u,parameterMappings:p}).catch(()=>{Hp.error(window.W_L.widget_not_add)})},[t,u,p]),h=a.getParametersDefs(),y=Se("parameter-mappings");return n.a.createElement(R.a,Q_({},t.props,{title:window.W_L.add_widget,onOk:b,okButtonProps:G_(G_({},t.props.okButtonProps),{},{disabled:!i||t.props.okButtonProps.disabled}),okText:window.W_L.add_widget_to_dashboard,cancelText:window.W_L.cancel,width:700}),n.a.createElement("div",{"data-test":"AddWidgetDialog"},n.a.createElement(ph,{onChange:e=>g(e?e.id:null)}),i&&n.a.createElement(Z_,{query:i,visualization:u,onChange:d}),p.length>0&&[n.a.createElement("label",{key:"parameters-title",htmlFor:y},window.W_L.params),n.a.createElement(ZO,{key:"parameters-list",id:y,mappings:p,existingParams:h,onChange:f})]))}Z_.propTypes={query:ae.a.object,visualization:ae.a.object,onChange:ae.a.func},Z_.defaultProps={query:null,visualization:null,onChange:()=>{}},eE.propTypes={dialog:ia.isRequired,dashboard:ae.a.object.isRequired};var tE=la(eE);function aE(){return(aE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function rE(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function nE(e){var t=e.imageUrl,a=e.roundedImage,r=e.title,o=e.body,i=e.children,l=e.className,s=rE(e,["imageUrl","roundedImage","title","body","children","className"]);return n.a.createElement("div",aE({},s,{className:l+" w-100 d-flex align-items-center"}),n.a.createElement("img",{src:""+t,"data-pr":"",width:"32",data:t,height:"32",className:me()({"profile__image--settings":a},"m-r-5"),alt:window.W_L.icon}),n.a.createElement("div",{className:"flex-fill"},n.a.createElement("div",null,r),o&&n.a.createElement("div",{className:"text-muted"},o)),i)}function oE(e){var t=e.user,a=e.withLink,r=e.children,o=rE(e,["user","withLink","children"]),i=a?n.a.createElement(h,{href:"users/"+t.id},t.name):t.name;return n.a.createElement(nE,aE({},o,{imageUrl:t.profile_image_url,title:i,body:t.email}),r)}function iE(e){var t=e.dataSource,a=e.withLink,r=e.children,o=rE(e,["dataSource","withLink","children"]),i="/static/images/db-logos/".concat(t.type,".png"),l=a?n.a.createElement(h,{href:"data_sources/"+t.id},t.name):t.name;return n.a.createElement(nE,aE({},o,{imageUrl:i,title:l}),r)}function lE(e){return Object(l.find)([Object(l.get)(e,"response.data.message"),Object(l.get)(e,"response.statusText"),"Unknown error"],l.isString)}function sE(e){return"api/users/".concat(e.id,"/disable")}nE.propTypes={imageUrl:ae.a.string.isRequired,title:ae.a.node.isRequired,body:ae.a.node,roundedImage:ae.a.bool,className:ae.a.string,children:ae.a.node},nE.defaultProps={body:null,roundedImage:!0,className:"",children:null},oE.propTypes={user:ae.a.shape({profile_image_url:ae.a.string.isRequired,name:ae.a.string.isRequired,email:ae.a.string.isRequired}).isRequired,withLink:ae.a.bool,children:ae.a.node},oE.defaultProps={withLink:!1,children:null},iE.propTypes={dataSource:ae.a.shape({name:ae.a.string.isRequired,type:ae.a.string.isRequired}).isRequired,withLink:ae.a.bool,children:ae.a.node},iE.defaultProps={withLink:!1,children:null};var cE={query:e=>B.get("api/users",{params:e}),get:e=>{var t=e.id;return B.get("api/users/".concat(t))},create:e=>B.post("api/users",e),save:e=>B.post("api/users/".concat(e.id),e),enableUser:function(e){var t=ke(e.name);return B.delete(sE(e)).then(a=>(Hp.success(window.W_L.account+t+window.W_L.activated+"！"),e.is_disabled=!1,e.profile_image_url=a.profile_image_url,a)).catch(e=>{Hp.error(window.W_L.Cannot_enable_user,lE(e))})},disableUser:function(e){var t=ke(e.name);return B.post(sE(e)).then(a=>(Hp.warning(window.W_L.account+t+window.W_L.terminated+"。"),e.is_disabled=!0,e.profile_image_url=a.profile_image_url,a)).catch(e=>{Hp.error(window.W_L.Cannot_deactivate_user,lE(e))})},deleteUser:function(e){var t=ke(e.name);return B.delete("api/users/".concat(e.id)).then(e=>(Hp.warning(window.W_L.account+t+window.W_L.has_been_deleted+"!"),e)).catch(e=>{Hp.error(window.W_L.Cannot_delete_user,lE(e))})},convertUserInfo:function(e){return{id:e.id,name:e.name,email:e.email,profileImageUrl:e.profile_image_url,apiKey:e.api_key,groupIds:e.groups,isDisabled:e.is_disabled,isInvitationPending:e.is_invitation_pending}},regenerateApiKey:function(e){return B.post("api/users/".concat(e.id,"/regenerate_api_key")).then(e=>(Hp.success(window.W_L.api_Key_has_been_regenerated),e.api_key)).catch(e=>{Hp.error(window.W_L.failed_to_regenerate_api_key,lE(e))})},sendPasswordReset:function(e){return B.post("api/users/".concat(e.id,"/reset_password")).then(e=>{if(Y.mailSettingsMissing)return Hp.warning(window.W_L.the_email_server_is_not_configured),e.reset_link;Hp.success(window.W_L.password_reset_email_has_been_sent)}).catch(e=>{Hp.error(window.W_L.the_password_reset_email_was_not_sent_successfully,lE(e))})},resendInvitation:function(e){return B.post("api/users/".concat(e.id,"/invite")).then(e=>{if(Y.mailSettingsMissing)return Hp.warning(window.W_L.the_email_server_is_not_configured),e.invite_link;Hp.success(window.W_L.user_invitation_email_has_been_sent)}).catch(e=>{Hp.error(window.W_L.the_user_invitation_email_failed_to_be_sent,lE(e))})}};a(1377);function uE(){return(uE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function dE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mE(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return mE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mE(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var pE=Yr.a.Option;function fE(e){e.context;return n.a.createElement(n.a.Fragment,null,window.W_L.mange_permissions,n.a.createElement("div",{className:"modal-header-desc"},window.W_L.can_not_manage_permissions,n.a.createElement(Ge,{type:"MANAGE_PERMISSIONS"})))}function gE(e){var t=e.onSelect,a=e.shouldShowUser,o=dE(Object(r.useState)(!0),2),i=o[0],s=o[1],c=dE(Object(r.useState)([]),2),u=c[0],d=c[1],m=dE(Object(r.useState)(""),2),p=m[0],f=m[1],g=Object(r.useCallback)(Object(l.debounce)(e=>(e=>cE.query({q:e}).then(e=>e.results).catch(()=>[]))(e).then(d).finally(()=>s(!1)),200),[]);return Object(r.useEffect)(()=>{s(!0),g(p)},[g,p]),n.a.createElement(Yr.a,{className:"w-100 m-b-10",placeholder:window.W_L.add_user,showSearch:!0,onSearch:f,suffixIcon:i?n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading...")):n.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"}),filterOption:!1,notFoundContent:null,value:void 0,getPopupContainer:e=>e.parentNode,onSelect:t},u.filter(a).map(e=>n.a.createElement(pE,{key:e.id,value:e.id},n.a.createElement(oE,{user:e}))))}function bE(e){var t,a=e.dialog,o=e.author,i=e.context,s=e.aclUrl,c=dE(Object(r.useState)(!0),2),u=c[0],d=c[1],p=dE(Object(r.useState)([]),2),f=p[0],g=p[1],b=(t=s,{loadGrantees:Object(r.useCallback)(()=>B.get(t).then(e=>{var t=[];return Object(l.each)(e,(e,a)=>{e.forEach(e=>{e.accessType=Kf(a),t.push(e)})}),t}),[t]),addPermission:Object(r.useCallback)((function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modify";return B.post(t,{access_type:a,user_id:e}).catch(()=>Hp.error(window.W_L.unauthorized))}),[t]),removePermission:Object(r.useCallback)((function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modify";return B.delete(t,{data:{access_type:a,user_id:e}}).catch(()=>Hp.error(window.W_L.can_not_delete_user))}),[t])}),h=b.loadGrantees,y=b.addPermission,v=b.removePermission,w=Object(r.useCallback)(()=>{d(!0),h().then(g).catch(()=>Hp.error(window.W_L.fail_load_list)).finally(()=>d(!1))},[h]),O=Object(r.useCallback)(e=>e.id===o.id||!!Object(l.get)(Object(l.find)(f,{id:e.id}),"accessType"),[o.id,f]);return Object(r.useEffect)(()=>{w()},[s,w]),n.a.createElement(R.a,uE({},a.props,{className:"permissions-editor-dialog",title:n.a.createElement(fE,{context:i}),footer:n.a.createElement(m.a,{onClick:a.dismiss},window.W_L.close)}),n.a.createElement(gE,{onSelect:e=>y(e).then(w),shouldShowUser:e=>!O(e)}),n.a.createElement("div",{className:"d-flex align-items-center m-t-5"},n.a.createElement("h5",{className:"flex-fill"},window.W_L.user_permissions),u&&n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},window.W_L.loading))),n.a.createElement("div",{className:"scrollbox p-5",style:{maxHeight:"40vh"}},n.a.createElement(yb.a,{size:"small",dataSource:[o,...f],renderItem:e=>n.a.createElement(yb.a.Item,null,n.a.createElement(oE,{key:e.id,user:e},e.id===o.id?n.a.createElement(DO.a,{className:"m-0"},window.W_L.author):n.a.createElement(we,{title:"{window.W_L.remove_user_permission}"},n.a.createElement(ge,{"aria-label":"{window.W_L.remove_user_permission}",onClick:()=>v(e.id).then(w)},n.a.createElement("i",{className:"fa fa-remove clickable","aria-hidden":"true"})))))})))}fE.propTypes={context:ae.a.oneOf([window.W_L.queries,window.W_L.dashboards])},fE.defaultProps={context:window.W_L.queries},gE.propTypes={onSelect:ae.a.func,shouldShowUser:ae.a.func},gE.defaultProps={onSelect:()=>{},shouldShowUser:()=>!0},bE.propTypes={dialog:ia.isRequired,author:ae.a.object.isRequired,context:ae.a.oneOf([window.W_L.query,window.W_L.dashboards]),aclUrl:ae.a.string.isRequired},bE.defaultProps={context:window.W_L.query};var hE=la(bE),yE=a(130),vE=a.n(yE);function wE(){return(wE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}class OE extends n.a.Component{constructor(e){super(e),function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(this,"copy",()=>{this.ref.current.select();try{if(!document.execCommand("copy"))throw new Error;this.setState({copied:window.W_L.copy_success})}catch(e){this.setState({copied:window.W_L.copy_failed})}this.resetCopyState=setTimeout(()=>this.setState({copied:null}),2e3)}),this.state={copied:null},this.ref=n.a.createRef(),this.copyFeatureSupported=document.queryCommandSupported("copy"),this.resetCopyState=null}componentWillUnmount(){this.resetCopyState&&clearTimeout(this.resetCopyState)}render(){var e=n.a.createElement(we,{title:this.state.copied||window.W_L.copy},n.a.createElement(ge,{onClick:this.copy},n.a.createElement(vE.a,null)));return n.a.createElement(ta.a,wE({},this.props,{ref:this.ref,addonAfter:this.copyFeatureSupported&&e}))}}function _E(){return(_E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function EE(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class jE extends n.a.Component{constructor(e){super(e),EE(this,"formItemProps",{labelCol:{span:8},wrapperCol:{span:16},style:{marginBottom:7}}),EE(this,"enableAccess",()=>{var e=this.props.dashboard;this.setState({saving:!0}),B.post(this.apiUrl).then(t=>{e.publicAccessEnabled=!0,e.public_url=t.public_url}).catch(()=>{Hp.error(window.W_L.open_share_dashboard_failed)}).finally(()=>{this.setState({saving:!1})})}),EE(this,"disableAccess",()=>{var e=this.props.dashboard;this.setState({saving:!0}),B.delete(this.apiUrl).then(()=>{e.publicAccessEnabled=!1,delete e.public_url}).catch(()=>{Hp.error(window.W_L.close_share_dashboard_failed)}).finally(()=>{this.setState({saving:!1})})}),EE(this,"onChange",e=>{e?this.enableAccess():this.disableAccess()});var t=this.props.dashboard;this.state={saving:!1},this.apiUrl=Object(l.replace)("api/dashboards/{id}/share","{id}",t.id),this.enabled=this.props.hasOnlySafeQueries||t.publicAccessEnabled}static get headerContent(){return n.a.createElement(n.a.Fragment,null,window.W_L.share_dashboard,n.a.createElement("div",{className:"modal-header-desc"},window.W_L.share_dashboard_tip,n.a.createElement(Ge,{type:"SHARE_DASHBOARD"})))}render(){var e=this.props,t=e.dialog,a=e.dashboard;return n.a.createElement(R.a,_E({},t.props,{title:this.constructor.headerContent,footer:null}),n.a.createElement(Vb.a,{layout:"horizontal"},!this.props.hasOnlySafeQueries&&n.a.createElement(Vb.a.Item,null,n.a.createElement(u.a,{message:window.W_L.secret_address_tip,type:"error"})),n.a.createElement(Vb.a.Item,_E({label:window.W_L.allow_public},this.formItemProps),n.a.createElement(so.a,{checked:a.publicAccessEnabled,onChange:this.onChange,loading:this.state.saving,disabled:!this.enabled,"data-test":"PublicAccessEnabled"})),a.public_url&&n.a.createElement(Vb.a.Item,_E({label:window.W_L.secret_address},this.formItemProps),n.a.createElement(OE,{value:a.public_url,"data-test":"SecretAddress"}))))}}EE(jE,"propTypes",{dashboard:ae.a.object.isRequired,hasOnlySafeQueries:ae.a.bool.isRequired,dialog:ia.isRequired});var SE=la(jE);function CE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xE(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xE(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function PE(){var e=CE(Object(r.useState)(Object(l.has)(A.search,"fullscreen")),2),t=e[0],a=e[1];Object(r.useEffect)(()=>{document.body.classList.toggle("headless",t),A.setSearch({fullscreen:!!t||null},!0)},[t]);return[t,()=>a(!t)]}function LE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return kE(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kE(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function NE(e){var t=Z.getDashboardRefreshIntervals();return Object(l.max)([30,Object(l.min)(t),e])}function AE(e){var t=LE(Object(r.useState)(function(){var e=parseFloat(A.search.refresh);return Object(l.isNaN)(e)?null:NE(e)}()),2),a=t[0],n=t[1],o=Xv(e);return Object(r.useEffect)(()=>{if(A.setSearch({refresh:a||null},!0),a){var e=setInterval(o,1e3*a);return()=>clearInterval(e)}},[a,o]),Object(r.useMemo)(()=>[a,e=>n(NE(e)),()=>n(null)],[a])}function TE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return WE(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return WE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WE(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var IE="saved",qE="saving",DE="saving_failed";function RE(e,t){var a=TE(Object(r.useState)(e&&Object(l.has)(A.search,"edit")),2),n=a[0],o=a[1],i=TE(Object(r.useState)(IE),2),s=i[0],c=i[1],u=TE(Object(r.useState)([]),2),d=u[0],m=u[1],p=TE(Object(r.useState)(!1),2),f=p[0],g=p[1];Object(r.useEffect)(()=>{A.setSearch({edit:!!n||null},!0)},[n]),Object(r.useEffect)(()=>{f&&s===IE&&(g(!1),o(!1))},[f,s]);var b=Object(r.useCallback)(a=>{if(e){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(l.pickBy)(t,(t,a)=>{var r=Object(l.find)(e,{id:Number(a)}).options.position;return!Object(l.isMatch)(r,t)})}(t,a);c(qE),m(a);var n=Object(l.map)(r,(e,a)=>{var r=Object(l.find)(t,{id:Number(a)});return r?r.save("options",{position:e}):Promise.resolve()});return Promise.all(n).then(()=>c(IE)).catch(()=>{c(DE),Hp.error("Error saving changes.")})}c(IE)},[e,t]),h=Object(r.useCallback)((function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return c(qE),Object(l.debounce)(()=>b(...t),2e3)()}),[b]),y=Object(r.useCallback)(()=>b(d),[d,b]),v=Object(r.useCallback)(t=>{t||s===IE?o(e&&t):g(!0)},[s,e]);return{editingLayout:e&&n,setEditingLayout:v,saveDashboardLayout:n?h:b,retrySaveDashboardLayout:y,doneBtnClickedWhileSaving:f,dashboardStatus:s}}function ME(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function zE(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ME(Object(a),!0).forEach((function(t){FE(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ME(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function FE(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function VE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return UE(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return UE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function UE(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function BE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(l.isEmpty)(t)?e:e.filter(e=>Object.values(e.getParameterMappings()).filter(e=>"dashboard-level"===e.type).some(e=>{var a=e.mapTo;return Object(l.includes)(t.map(e=>e.name),a)}))}var HE=function(e){var t=VE(Object(r.useState)(e),2),a=t[0],n=t[1],o=VE(Object(r.useState)([]),2),i=o[0],s=o[1],c=VE(Object(r.useState)(!1),2),u=c[0],d=c[1],m=VE(Object(r.useState)(!1),2),p=m[0],f=m[1],g=Object(r.useMemo)(()=>a.getParametersDefs(),[a]),b=!a.is_archived&&Z.canEdit(a),h=Object(r.useMemo)(()=>!a.is_archived&&Object(l.has)(a,"user.id")&&(H.id===a.user.id||H.isAdmin),[a]),y=Object(r.useMemo)(()=>Object(l.every)(a.widgets,e=>!e.getQuery()||e.getQuery().is_safe),[a]),v=Object(r.useCallback)(()=>{var e="api/dashboards/".concat(a.id,"/acl");hE.showModal({aclUrl:e,context:"dashboard",author:a.user})},[a]),w=Object(r.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n(t=>Object(l.extend)({},t,e)),e=zE(zE({},e),{},{id:a.id}),t&&(e=zE(zE({},e),{},{version:a.version})),jp.save(e).then(t=>{n(a=>Object(l.extend)({},a,Object(l.pick)(t,Object(l.keys)(e)))),Object(l.has)(e,"name")&&A.setPath(Ze.parse(t.url).pathname,!0)}).catch(e=>{var t=Object(l.get)(e,"response.status");403===t?Hp.error("Dashboard update failed","Permission Denied."):409===t&&Hp.error(window.W_F.dashboard_has_changed,window.W_F.dashboard_has_changed_tip,{duration:null})})}),[a]),O=Object(r.useCallback)(()=>{da("toggle_published","dashboard",a.id),w({is_draft:!a.is_draft},!1)},[a,w]),_=Object(r.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.getParametersDefs(),n(e=>Object(l.extend)({},e)),e.load(t).catch(e=>{if(!(e instanceof tr))return Promise.reject(e)}).finally(()=>n(e=>Object(l.extend)({},e)))}),[]),E=Object(r.useCallback)(e=>_(e,!0),[_]),j=Object(r.useCallback)(e=>{n(t=>Object(l.extend)({},t,{widgets:t.widgets.filter(t=>void 0!==t.id&&t.id!==e)}))},[]),S=Object(r.useRef)();S.current=a;var C=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=BE(S.current.widgets,t),r=Object(l.compact)(a.map(t=>_(t,e).catch(e=>e)));return Promise.all(r).then(()=>{var e=Object(l.compact)(Object(l.map)(S.current.widgets,e=>e.getQueryResult())),t=Op(S.current,e,A.search);s(t)})}),[_]),x=Object(r.useCallback)(e=>{u||(d(!0),C(!0,e).finally(()=>d(!1)))},[u,C]),P=Object(r.useCallback)(()=>{da("archive","dashboard",a.id),jp.delete(a).then(e=>n(t=>Object(l.extend)({},t,Object(l.pick)(e,["is_archived"]))))},[a]),L=Object(r.useCallback)(()=>{var e=()=>n(e=>Object(l.extend)({},e));SE.showModal({dashboard:a,hasOnlySafeQueries:y}).onClose(e).onDismiss(e)},[a,y]),k=Object(r.useCallback)(()=>{C_.showModal({isNew:!0}).onClose(e=>a.addWidget(e).then(()=>n(e=>Object(l.extend)({},e))))},[a]),N=Object(r.useCallback)(()=>{tE.showModal({dashboard:a}).onClose(e=>{var t=e.visualization,r=e.parameterMappings;return a.addWidget(t,{parameterMappings:KO(r)}).then(e=>{var t=[e,...GO(e.options.parameterMappings,a.widgets)];return Promise.all(t.map(e=>e.save())).then(()=>n(e=>Object(l.extend)({},e)))})})},[a]),T=VE(AE(x),3),W=T[0],I=T[1],q=T[2],D=VE(PE(),2),R=D[0],M=D[1],z=RE(!p&&b,a.widgets);return Object(r.useEffect)(()=>{n(e),C()},[e]),Object(r.useEffect)(()=>{document.title=a.name},[a.name]),Object(r.useEffect)(()=>{C()},[a.dashboard_filters_enabled]),zE(zE({dashboard:a,globalParameters:g,refreshing:u,filters:i,setFilters:s,loadDashboard:C,refreshDashboard:x,updateDashboard:w,togglePublished:O,archiveDashboard:P,loadWidget:_,refreshWidget:E,removeWidget:j,canEditDashboard:b,isDashboardOwnerOrAdmin:h,refreshRate:W,setRefreshRate:I,disableRefreshRate:q},z),{},{gridDisabled:p,setGridDisabled:f,fullscreen:R,toggleFullscreen:M,showShareDashboardDialog:L,showAddTextboxDialog:k,showAddWidgetDialog:N,managePermissions:v})};function YE(){return(YE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function QE(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class KE extends n.a.Component{constructor(e){super(e),QE(this,"startEditing",()=>{this.props.isEditable&&this.setState({editing:!0})}),QE(this,"stopEditing",e=>{var t=Object(l.trim)(e);this.props.ignoreBlanks&&""===t||t===this.props.value||this.props.onDone(t),this.setState({editing:!1})}),QE(this,"handleKeyDown",e=>{13!==e.keyCode||e.shiftKey?27===e.keyCode&&this.setState({editing:!1}):(e.preventDefault(),this.stopEditing(e.target.value))}),QE(this,"renderNormal",()=>this.props.value?n.a.createElement("span",{role:"presentation",onFocus:this.startEditing,onClick:this.startEditing,className:this.props.isEditable?"editable":""},this.props.value):n.a.createElement("a",{className:"clickable",onClick:this.startEditing},this.props.placeholder)),QE(this,"renderEdit",()=>{var e=this.props,t=e.multiline,a=e.value,r=e.editorProps,o=t?ta.a.TextArea:ta.a;return n.a.createElement(o,YE({defaultValue:a,"aria-label":"Editing",onBlur:e=>this.stopEditing(e.target.value),onKeyDown:this.handleKeyDown,autoFocus:!0},r))}),this.state={editing:e.defaultEditing}}componentDidUpdate(e,t){!this.state.editing&&t.editing&&this.props.onStopEditing()}render(){return n.a.createElement("span",{className:me()("edit-in-place",{active:this.state.editing},this.props.className)},this.state.editing?this.renderEdit():this.renderNormal())}}function GE(e){return e.tags||[]}function $E(e){return B.get(e).then(GE)}QE(KE,"propTypes",{ignoreBlanks:ae.a.bool,isEditable:ae.a.bool,placeholder:ae.a.string,value:ae.a.string,onDone:ae.a.func.isRequired,onStopEditing:ae.a.func,multiline:ae.a.bool,editorProps:ae.a.object,defaultEditing:ae.a.bool}),QE(KE,"defaultProps",{ignoreBlanks:!1,isEditable:!0,placeholder:"",value:"",onStopEditing:()=>{},multiline:!1,editorProps:{},defaultEditing:!1});var JE=a(44),XE=a.n(JE),ZE=a(320),ej=a.n(ZE),tj=a(425),aj=a.n(tj),rj=a(426),nj=a.n(rj);a(1378);function oj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ij(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oj(Object(a),!0).forEach((function(t){lj(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function lj(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function sj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cj(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return cj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cj(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var uj=n.a.forwardRef((e,t)=>{var a=e.dashboardId,o=sj(Object(r.useState)(!1),2),i=o[0],l=o[1],s=sj(Object(r.useState)(1),2),c=s[0],u=s[1],d=[{id:1,title:window.W_L.example1,image:ej.a},{id:2,title:window.W_L.example2,image:aj.a},{id:3,title:window.W_L.example3,image:nj.a},{id:999,title:window.W_L.more,image:ej.a}],p=sj(Object(r.useState)(!1),2),f=p[0],g=p[1],b=sj(Object(r.useState)(!1),2),h=b[0],y=b[1],v=sj(Object(r.useState)(null),2),w=v[0],O=v[1],_=()=>{l(!0)};n.a.useImperativeHandle(t,()=>({openModal:_}));var E=e=>{if("TABLE"===e.visualization.type)return"table";var t=e.visualization.options.globalSeriesType;return!!["column","line","pie","area"].includes(t)&&("column"===t?"bar":t)},j=e=>{var t,a;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.map(e=>{var t,a;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(t=E(e))){r.next=6;break}return r.next=4,regeneratorRuntime.awrap(B.get("/api/queries/".concat(e.visualization.query.id,"/results/").concat(e.visualization.query.latest_query_data_id,".json")));case 4:return a=r.sent,r.abrupt("return",{id:e.visualization.query.id,latest_query_data_id:e.visualization.query.latest_query_data_id,chart_name:e.visualization.query.name,chart_type:t,data:a.query_result.data,columnMapping:e.visualization.options.columnMapping});case 6:case"end":return r.stop()}}),null,null,null,Promise)}),r.next=3,regeneratorRuntime.awrap(Promise.all(t));case 3:return a=r.sent,r.abrupt("return",a.filter(Boolean));case 5:case"end":return r.stop()}}),null,null,null,Promise)},S=e=>{var t,a;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=ij(ij({},e),{},{template_id:c}),r.next=3,regeneratorRuntime.awrap(B.post("/api/pretty_dashboard",t));case 3:return a=r.sent,r.abrupt("return",a);case 5:case"end":return r.stop()}}),null,null,null,Promise)},C=()=>{f||l(!1)};return n.a.createElement(n.a.Fragment,null,n.a.createElement(_e.a,{title:window.W_L.prettify_dashboard,visible:i,onClose:C,closable:!1,mask:!1,footer:n.a.createElement("div",{className:"drawer-footer"},n.a.createElement(m.a,{loading:f,className:"finish-button",type:"primary",onClick:()=>{var e,t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return g(!0),r.prev=1,r.next=4,regeneratorRuntime.awrap(B.get("/api/dashboards/".concat(a)).then(e=>{var t;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(e.widgets&&e.widgets.length>0)){a.next=7;break}return a.next=3,regeneratorRuntime.awrap(j(e.widgets));case 3:return t=a.sent,a.abrupt("return",{dashboard_name:e.name,dashboard_id:e.id,query_result:t});case 7:throw new Error(window.W_L.no_dashboard_data);case 8:case"end":return a.stop()}}),null,null,null,Promise)}).catch(e=>{throw console.error(e),e}));case 4:return e=r.sent,r.next=7,regeneratorRuntime.awrap(S(e));case 7:(t=r.sent)&&200===t.code?(XE.a.success(window.W_L.submit_success),regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(B.get("/api/pretty_dashboard"));case 2:case"end":return e.stop()}}),null,null,null,Promise)):XE.a.error(t.data||window.W_L.submit_fail),g(!1),r.next=17;break;case 12:r.prev=12,r.t0=r.catch(1),g(!1),console.error(r.t0),XE.a.error(window.W_L.submit_fail);case 17:case"end":return r.stop()}}),null,null,[[1,12]],Promise)}},window.W_L.apply),n.a.createElement(m.a,{className:"cancel-button",onClick:C},window.W_L.close))},n.a.createElement("div",{className:"template-container"},d.map(e=>n.a.createElement("div",{key:e.id,className:"template-item",onClick:()=>{return t=e.id,void u(t);var t}},n.a.createElement("p",null,e.title),n.a.createElement("div",{className:"template-div"},n.a.createElement("img",{alt:"example",src:e.image,className:"template-img ".concat(c===e.id?"template-item-selected":"")}),n.a.createElement("div",{className:"template-overlay ".concat(999===e.id?"always-show":"")},n.a.createElement("button",{className:"preview-button ".concat(999===e.id?"coming-soon-button":""),onClick:t=>{t.stopPropagation(),(e=>{999!==e.id&&(O(e.image),y(!0))})(e)}},999===e.id?window.W_L.coming_soon:window.W_L.preview))),999!==e.id&&n.a.createElement($r.a,{checked:c===e.id,className:"template-checkbox"}))))),n.a.createElement(R.a,{className:"preview-modal",visible:h,onCancel:()=>y(!1),footer:null,closable:!1,width:"80%"},n.a.createElement("img",{alt:"example",style:{width:"100%"},src:w})))});a(1379);function dj(){return $E("api/dashboards/tags").then(e=>Object(l.map)(e,e=>e.name))}function mj(e){return e?"primary":"default"}function pj(e){var t=e.dashboardConfiguration,a=t.dashboard,r=t.canEditDashboard,o=t.updateDashboard,i=t.editingLayout;return n.a.createElement("div",{className:"title-with-tags"},n.a.createElement("div",{className:"page-title"},n.a.createElement(Ef,{item:a}),n.a.createElement("h3",null,n.a.createElement(KE,{isEditable:i,onDone:e=>o({name:e}),value:a.name,ignoreBlanks:!0})),n.a.createElement(we,{title:a.user.name,placement:"bottom"},n.a.createElement("img",{src:a.user.profile_image_url,className:"profile-image",alt:a.user.name}))),n.a.createElement(Wg,{tags:a.tags,isDraft:a.is_draft,isArchived:a.is_archived,canEdit:r,getAvailableTags:dj,onEdit:e=>o({tags:e})}))}function fj(e){var t=e.dashboardConfiguration,a=t.refreshRate,r=t.setRefreshRate,o=t.disableRefreshRate,i=t.refreshing,s=t.refreshDashboard,c=Z.getDashboardRefreshIntervals(),u=Y.dashboardRefreshIntervals;return n.a.createElement(m.a.Group,null,n.a.createElement(we,{title:a?window.W_L.auto_flush_hz+" ".concat(Qf(a)):null},n.a.createElement(m.a,{type:mj(a),onClick:()=>s()},n.a.createElement("i",{className:me()("zmdi zmdi-refresh m-r-5",{"zmdi-hc-spin":i}),"aria-hidden":"true"}),a?Qf(a):window.W_L.flush)),n.a.createElement(Vt.a,{trigger:["click"],placement:"bottomRight",overlay:n.a.createElement(ue.a,{onClick:e=>{var t=e.key,a=parseFloat(t);a?(r(a),s()):o()},selectedKeys:["".concat(a)]},u.map(e=>n.a.createElement(ue.a.Item,{key:"".concat(e),disabled:!Object(l.includes)(c,e)},Qf(e))),a&&n.a.createElement(ue.a.Item,{key:null},window.W_L.stop_auto_flush))},n.a.createElement(m.a,{className:"icon-button hidden-xs",type:mj(a)},n.a.createElement("i",{className:"fa fa-angle-down","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Split button!"))))}function gj(e){var t=e.dashboardConfiguration,a=t.dashboard,r=t.setEditingLayout,o=t.togglePublished,i=t.archiveDashboard,l=t.managePermissions,s=t.gridDisabled,c=t.isDashboardOwnerOrAdmin;return n.a.createElement(Vt.a,{trigger:["click"],placement:"bottomRight",overlay:n.a.createElement(ue.a,{"data-test":"DashboardMoreButtonMenu"},n.a.createElement(ue.a.Item,{className:me()({hidden:s})},n.a.createElement(ge,{onClick:()=>r(!0)},window.W_L.edit)),Y.showPermissionsControl&&c&&n.a.createElement(ue.a.Item,null,n.a.createElement(ge,{onClick:l},window.W_L.mange_permissions)),!Y.disablePublish&&!a.is_draft&&n.a.createElement(ue.a.Item,null,n.a.createElement(ge,{onClick:o},window.W_L.draft)),n.a.createElement(ue.a.Item,null,n.a.createElement(ge,{onClick:()=>{R.a.confirm({title:window.W_L.dashboard_archived,content:window.W_L.are_you_sure+' "'.concat(a.name,'" ')+window.W_L.dashboard_archived,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:i,maskClosable:!0,autoFocusButton:null})}},window.W_L.archived)))},n.a.createElement(m.a,{className:"icon-button m-l-5","data-test":"DashboardMoreButton","aria-label":"More actions"},n.a.createElement(Db.a,{rotate:90,"aria-hidden":"true"})))}function bj(e){var t=e.dashboardConfiguration,a=e.headerExtra,r=t.dashboard,o=t.togglePublished,i=t.canEditDashboard,l=t.fullscreen,s=t.toggleFullscreen,c=t.showShareDashboardDialog,u=t.updateDashboard,d=r.is_draft,p=!r.is_draft,f=i&&!r.is_draft,g=!Y.disablePublicUrls&&(r.publicAccessEnabled||f),b=i,h=n.a.useRef();return n.a.createElement("div",{className:"dashboard-control"},n.a.createElement(uj,{ref:h,dashboardId:r.id}),r.can_edit&&r.is_archived&&n.a.createElement(m.a,{onClick:()=>{da("unarchive","dashboard",r.id),u({is_archived:!1},!1)}},"Unarchive"),!r.is_archived&&n.a.createElement("span",{className:"hidden-print"},n.a.createElement(m.a,{className:"m-r-5",onClick:()=>{h.current&&h.current.openModal()}},n.a.createElement("span",{className:"fa fa-magic m-r-5"})," ",window.W_L.prettify_dashboard),d&&n.a.createElement(m.a,{className:"m-r-5 hidden-xs",onClick:o},n.a.createElement("span",{className:"fa fa-paper-plane m-r-5"})," ",window.W_L.publish),n.a.createElement(fj,{dashboardConfiguration:t}),p&&n.a.createElement(we,{className:"hidden-xs",title:window.W_L.dis_en_able_fullscreen},n.a.createElement(m.a,{type:mj(l),className:"icon-button m-l-5",onClick:s,"aria-label":"Toggle fullscreen display"},n.a.createElement("i",{className:"zmdi zmdi-fullscreen","aria-hidden":"true"}))),a,g&&n.a.createElement(we,{title:window.W_L.share_dashboard_setting},n.a.createElement(m.a,{className:"icon-button m-l-5",type:mj(r.publicAccessEnabled),onClick:c,"data-test":"OpenShareForm","aria-label":"Share"},n.a.createElement("i",{className:"zmdi zmdi-share","aria-hidden":"true"}))),b&&n.a.createElement(gj,{dashboardConfiguration:t})))}function hj(e){var t,a=e.dashboardConfiguration,r=e.headerExtra,o=a.setEditingLayout,i=a.doneBtnClickedWhileSaving,l=a.dashboardStatus,s=a.retrySaveDashboardLayout;return t=l===IE?n.a.createElement("span",{className:"save-status"},window.W_L.saved):l===qE?n.a.createElement("span",{className:"save-status","data-saving":!0},window.W_L.saving):n.a.createElement("span",{className:"save-status","data-error":!0},window.W_L.save_failed),n.a.createElement("div",{className:"dashboard-control"},t,l===DE?n.a.createElement(m.a,{type:"primary",onClick:s},window.W_L.retry):n.a.createElement(m.a,{loading:i,type:"primary",onClick:()=>o(!1)},!i&&n.a.createElement("i",{className:"fa fa-check m-r-5","aria-hidden":"true"})," ",window.W_L.save),r)}function yj(e){var t=e.dashboardConfiguration,a=e.headerExtra,r=t.editingLayout?hj:bj;return n.a.createElement("div",{className:"dashboard-header"},n.a.createElement(pj,{dashboardConfiguration:t}),n.a.createElement(r,{dashboardConfiguration:t,headerExtra:a}))}pj.propTypes={dashboardConfiguration:ae.a.object.isRequired},fj.propTypes={dashboardConfiguration:ae.a.object.isRequired},gj.propTypes={dashboardConfiguration:ae.a.object.isRequired},bj.propTypes={dashboardConfiguration:ae.a.object.isRequired,headerExtra:ae.a.node},hj.propTypes={dashboardConfiguration:ae.a.object.isRequired,headerExtra:ae.a.node},yj.propTypes={dashboardConfiguration:ae.a.object.isRequired,headerExtra:ae.a.node};a(1380);function vj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wj(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return wj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wj(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Oj(){return(Oj=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _j(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Ej(e){var t=e.dashboardConfiguration,a=t.dashboard,r=t.updateDashboard;return n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled"},n.a.createElement($r.a,{checked:!!a.dashboard_filters_enabled,onChange:e=>{var t=e.target;return r({dashboard_filters_enabled:t.checked})},"data-test":"DashboardFiltersCheckbox"},window.W_L.dashboard_filter))}function jj(e){var t=e.dashboardConfiguration,a=e.className,r=_j(e,["dashboardConfiguration","className"]),o=t.showAddTextboxDialog,i=t.showAddWidgetDialog;return n.a.createElement("div",Oj({className:me()("add-widget-container",a)},r),n.a.createElement("h2",null,n.a.createElement("i",{className:"zmdi zmdi-widgets","aria-hidden":"true"}),n.a.createElement("span",{className:"hidden-xs hidden-sm"},window.W_L.dashboard_widget_info)),n.a.createElement("div",null,n.a.createElement(m.a,{className:"m-r-15",onClick:o,"data-test":"AddTextboxButton"},window.W_L.add_text),n.a.createElement(m.a,{type:"primary",onClick:i,"data-test":"AddWidgetButton"},window.W_L.add_widget)))}function Sj(e){var t=HE(e.dashboard),a=t.dashboard,o=t.filters,i=t.setFilters,s=t.loadDashboard,c=t.loadWidget,u=t.removeWidget,d=t.saveDashboardLayout,m=t.globalParameters,p=t.updateDashboard,f=t.refreshDashboard,g=t.refreshWidget,b=t.editingLayout,h=t.setGridDisabled,y=e.isShowReport,v=vj(Object(r.useState)(null),2),w=v[0],O=v[1],_=vj(Object(r.useState)({}),2),E=_[0],j=_[1];return Object(r.useEffect)(()=>{if(w)return Ar(w,()=>{if(b){var e=window.getComputedStyle(w,null),t=w.getBoundingClientRect(),a=parseFloat(e.paddingLeft)||0,r=parseFloat(e.paddingRight)||0;j({left:Math.round(t.left)+r,width:w.clientWidth-a-r})}window.dispatchEvent(new Event("resize"))})},[w,b]),n.a.createElement("div",{className:"container",ref:O,"data-test":"DashboardId".concat(a.id,"Container")},y&&n.a.createElement(yj,{dashboardConfiguration:t,headerExtra:n.a.createElement(se,{name:"Dashboard.HeaderExtra",dashboard:a,dashboardConfiguration:t})}),y&&!Object(l.isEmpty)(m)&&n.a.createElement("div",{className:"dashboard-parameters m-b-10 p-15 bg-white tiled","data-test":"DashboardParameters"},n.a.createElement(Tv,{parameters:m,onValuesChange:f,sortable:b,onParametersEdit:e=>{var t=Object(l.map)(e,"name");p({options:{globalParamOrder:t}})}})),y&&!Object(l.isEmpty)(o)&&n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled","data-test":"DashboardFilters"},n.a.createElement($v,{filters:o,onChange:i})),y&&b&&n.a.createElement(Ej,{dashboardConfiguration:t}),n.a.createElement("div",{id:"dashboard-container"},n.a.createElement(Y_,{isShowReport:y,dashboard:a,widgets:a.widgets,filters:o,isEditing:b,onLayoutChange:b?d:()=>{},onBreakpointChange:h,onLoadWidget:c,onRefreshWidget:g,onRemoveWidget:u,onParameterMappingsChange:s})),y&&b&&n.a.createElement(jj,{dashboardConfiguration:t,style:E}))}function Cj(e){var t=e.dashboardSlug,a=e.dashboardId,o=e.onError,i=e.isShowReport,l=vj(Object(r.useState)(null),2),s=l[0],c=l[1],u=Xv(o);return Object(r.useEffect)(()=>{jp.get({id:a,slug:t}).then(e=>{da("view","dashboard",e.id),c(e),a||A.setPath(Ze.parse(e.url).pathname,!0);var t=null;t&&clearTimeout(t),t=setTimeout(()=>{var e=document.querySelector(".dashbord_page");if(e){var t=e.scrollHeight,a=e.clientHeight;e.scrollTo({top:t-a,behavior:"smooth"})}},80)}).catch(u)},[a,t,u]),n.a.createElement("div",{className:"dashboard-page"},s&&n.a.createElement(Sj,{isShowReport:i,dashboard:s}))}Ej.propTypes={dashboardConfiguration:ae.a.object.isRequired},jj.propTypes={dashboardConfiguration:ae.a.object.isRequired,className:ae.a.string},Sj.propTypes={dashboard:ae.a.object.isRequired},Cj.propTypes={dashboardSlug:ae.a.string,dashboardId:ae.a.string,onError:ae.a.func,isShowReport:ae.a.bool},Cj.defaultProps={dashboardSlug:null,dashboardId:null,onError:ae.a.func,isShowReport:!0};var xj=Cj;rf.register("Dashboards.LegacyViewOrEdit",Zt({path:"/dashboard/:dashboardSlug",render:e=>n.a.createElement(Cj,e)})),rf.register("Dashboards.ViewOrEdit",Zt({path:"/dashboards/:dashboardId([^-]+)(-.*)?",render:e=>n.a.createElement(Cj,e)}));var Pj=a(245);new Pj.EventEmitter;window.location.protocol;function Lj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function kj(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Lj(Object(a),!0).forEach((function(t){Nj(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Lj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Nj(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Aj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Tj(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Tj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tj(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Wj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ij(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ij(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ij(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var qj=()=>{var e=e=>{sessionStorage.setItem("Chart_Dialogue",JSON.stringify(e))},t=()=>JSON.parse(sessionStorage.getItem("Chart_Dialogue")),a=e=>{sessionStorage.setItem("Chart_Dashboard",JSON.stringify(e))},r=()=>JSON.parse(sessionStorage.getItem("Chart_Dashboard")),n=e=>{var t=o();t.length>=10&&t.splice(0,1);var a=t.findIndex(t=>t.uuid===e[0].uuid);a>=0?t[a].messages=e[0].messages:t.push(e[0]),localStorage.setItem("Chart_All",JSON.stringify(t))},o=()=>JSON.parse(localStorage.getItem("Chart_All"))||[];return{getAutopilotStorage:()=>JSON.parse(sessionStorage.getItem("Chart_Dialogue_Autopilot")),addAutopilotStorage:e=>{sessionStorage.setItem("Chart_Dialogue_Autopilot",JSON.stringify(e))},addDashboard:a,getDashboard:r,addDialogueStorage:e,getDialogueStorage:t,addChatList:(o,i)=>{if(!(o.length<=0)){var l=[];(l="chat"===i?t():r())&&l.length>0&&(l[l.length-1].messages=o),"chat"===i?e(l):a(l),"chat"===i&&l&&l.length>0&&l[l.length-1].messages.length>=2&&n(l)}},getAllStorage:o,setDialogueStorageDashboardId:e=>{var t=r();t&&t.length>0&&(t[0].dashboardId=e),a(t)}}},Dj=(a(1381),e=>{var t=e.CharttableItem,a=e.chat_type,r=e.Charttable,o=e.loadingMask;return n.a.createElement(n.a.Fragment,null,r&&t&&t.label&&n.a.createElement("div",{className:"report"===a?"dialogue-top report-top":"dialogue-top"},n.a.createElement("div",{className:"dialogue-top-flex"},n.a.createElement("div",null,"chat"===a?window.W_L.data_analysis:"report"===a?window.W_L.query_builder:"autopilot"===a?window.W_L.auto_pilot:"")),n.a.createElement("div",{className:"dialogue-top-flex"},n.a.createElement("div",null,window.W_L.data_source,":"),n.a.createElement("span",null,t.label)),"viewConversation"!==a&&n.a.createElement(m.a,{disabled:o,type:"primary",size:"small",onClick:()=>{return t=()=>{e.closeDialogue()},void("autopilot"!==a?R.a.confirm({title:window.W_L.reset_dialogue,content:window.W_L.reset_dialogue_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:t,onCancel:null,maskClosable:!0,autoFocusButton:null}):t());var t},style:{borderRadius:"20px",fontSize:"13px",paddingLeft:"15px",paddingRight:"15px"},ghost:!0},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"autopilot"===a?window.W_L.auto_pilot:window.W_L.new_dialogue)))}),Rj=(a(1382),e=>{var t=e.loadingMask;return n.a.createElement("div",{className:"overlay"},n.a.createElement(m.a,{className:"overlay-btn",onClick:()=>{e.onUse()},loading:t},t?window.W_L.init_config:window.W_L.start_use))}),Mj=a(719),zj=a.n(Mj),Fj=a(427),Vj=a.n(Fj),Uj=a(720),Bj=a.n(Uj),Hj=a(174),Yj=a.n(Hj),Qj=a(243),Kj=a.n(Qj);a(603);function Gj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Jj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xj(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Xj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xj(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var Zj=Object(r.forwardRef)((e,t)=>{var a=e.SelectLoading,o=e.editData,i=e.closeEditData,l=e.submit,s=e.source_item,c=Jj(Object(r.useState)([]),2),u=c[0],d=c[1],m=Jj(Object(r.useState)({}),2),p=m[0],f=m[1],g=Jj(Object(r.useState)(!1),2),b=g[0],h=g[1],y=[{title:window.W_L.field_name,dataIndex:"name",key:"name",render:(e,t)=>n.a.createElement(we,{title:e},n.a.createElement("span",{style:{display:"inline-block",maxWidth:"100px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e))},{title:window.W_L.description,dataIndex:"comment",key:"comment",render:(e,t)=>n.a.createElement(ta.a,{type:"text",placeholder:window.W_L.field_description,value:e,style:{border:"none !important"},onChange:e=>v(e,t)})},{title:window.W_L.detection,dataIndex:"is_pass",key:"is_pass",render:(e,t)=>n.a.createElement("div",null,1===e?n.a.createElement("span",{style:{color:"#52c41a"}},window.W_L.pass):n.a.createElement("span",{style:{color:"#f5222d"}},window.W_L.fail))}];Object(r.useEffect)(()=>{h(a)},[a]),Object(r.useEffect)(()=>{o&&o.length>0&&(d(o),w(o[0]))},[o]);var v=(e,t)=>{var a=e.target.value,r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Gj(Object(a),!0).forEach((function(t){$j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Gj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},p).field_desc.map(e=>(e.name===t.name&&(e.comment=a),e)),n=u.map(e=>(e.table_name===p.table_name&&(e.field_desc=r),e));d(n)},w=e=>{var t=e;t.field_desc=e.field_desc.filter(e=>0===e.is_pass),f(t)},O=p.field_desc&&p.field_desc.length>0,_=u&&u.length>0;return n.a.createElement("div",null,n.a.createElement("p",{className:"edit-back",onClick:()=>{i()}},n.a.createElement(Py.a,{style:{fontSize:"18px"}})),n.a.createElement("div",{className:"select-content-item"},n.a.createElement("div",{style:{position:"absolute",bottom:"-30px",fontSize:"12px"}},n.a.createElement(we,{title:window.W_L.source_tooltip},n.a.createElement(Kj.a,{style:{marginRight:"5px"}})),window.W_L.source_second_tooltip),n.a.createElement("div",{style:{display:"flex",alignItems:"baseline"}},n.a.createElement("div",{className:"select-main",style:{margin:"0"}},n.a.createElement("ul",{className:_?"":"flex-center",style:{height:"288px"}},_&&u.map((e,t)=>n.a.createElement("li",{key:t},n.a.createElement("span",{onClick:()=>w(e),style:{color:e.table_name===p.table_name?"#2196F3":"#333",textAlign:"center",display:"block"}},"csv"===s.type?e.table_comment:e.table_name)))))),n.a.createElement("div",{className:"table-columns"},O&&n.a.createElement("div",{className:"table-columns-item"},n.a.createElement("span",null,"csv"===s.type?p.table_comment:p.table_name),n.a.createElement(ta.a,{placeholder:window.W_L.sheet_description,style:{padding:"2px",maxWidth:"60%"},type:"text",disabled:"csv"===s.type,value:"csv"===s.type?p.table_name:p.table_comment,onChange:e=>{var t=e.target.value,a=u.map(e=>(e.table_name===p.table_name&&(e.table_comment=t),e));d(a)}})),n.a.createElement("div",{className:O?"":"flex-center",style:{width:"400px",overflowY:"scroll",height:O?"235px":"276px"}},O&&n.a.createElement(Il.a,{dataSource:p.field_desc,columns:y,size:"small",rowKey:e=>e.name,pagination:!1}))),n.a.createElement("button",{onClick:()=>{l(u)},disabled:b,className:"submit-btn"},window.W_L.submit)))});function eS(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function tS(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?eS(Object(a),!0).forEach((function(t){aS(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eS(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function aS(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function rS(e){return Object(l.map)(e,e=>Object(l.isObject)(e)?e:{name:e})}var nS={query:()=>B.get("api/data_sources"),get:e=>{var t=e.id;return B.get("api/data_sources/".concat(t))},types:()=>B.get("api/data_sources/types"),create:e=>B.post("api/data_sources",e),save:e=>B.post("api/data_sources/".concat(e.id),e),test:e=>B.post("api/data_sources/".concat(e.id,"/test")),delete:e=>{var t=e.id;return B.delete("api/data_sources/".concat(t))},fetchSchema:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={};return t&&(a.refresh=!0),B.get("api/data_sources/".concat(e.id,"/schema"),{params:a}).then(e=>Object(l.has)(e,"job")?Ua(e.job.id).catch(t=>1===t.code?[]:Promise.reject(new Error(e.job.error))):Object(l.has)(e,"schema")?e.schema:Promise.reject()).then(e=>Object(l.map)(e,e=>tS(tS({},e),{},{columns:rS(e.columns)})))}};function oS(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function iS(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oS(Object(a),!0).forEach((function(t){lS(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oS(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function lS(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function sS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return cS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var uS=Object(r.forwardRef)((e,t)=>{var a=e.confirmLoading,o=e.Charttable,i=e.chat_type,l=e.onChange,s=e.onSuccess,c=e.percent,u=sS(Object(r.useState)([]),2),d=u[0],m=u[1],p=sS(Object(r.useState)({type:"mysql"}),2),f=p[0],g=p[1],b=sS(Object(r.useState)(),2),y=b[0],v=b[1],w=sS(Object(r.useState)([]),2),O=w[0],_=w[1],E=sS(Object(r.useState)([]),2),j=E[0],S=E[1],C=sS(Object(r.useState)({}),2),x=C[0],P=C[1],L=sS(Object(r.useState)([]),2),k=L[0],N=L[1],A=sS(Object(r.useState)([]),2),T=A[0],W=A[1],I=sS(Object(r.useState)([]),2),q=I[0],D=I[1],R=sS(Object(r.useState)(!1),2),M=R[0],z=R[1],F=sS(Object(r.useState)(!1),2),V=F[0],U=F[1],H=sS(Object(r.useState)(!1),2),Y=H[0],Q=H[1],K=sS(Object(r.useState)(!0),2),G=K[0],$=K[1],J=sS(Object(r.useState)([]),2),X=J[0],Z=J[1],ee=sS(Object(r.useState)(!1),2),te=ee[0],ae=ee[1],re=[{title:window.W_L.field_name,dataIndex:"name",key:"name",render:(e,t)=>n.a.createElement(we,{title:t.name},n.a.createElement("span",{className:"field-name"},t.name))},{title:window.W_L.description,dataIndex:"comment",key:"comment",render:(e,t)=>n.a.createElement(ta.a,{type:"text",value:e,style:{border:"none !important"},placeholder:window.W_L.field_description,onChange:e=>ce(e,t)})}];Object(r.useEffect)(()=>{var e,t;regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regeneratorRuntime.awrap(B.get("/api/data_sources"));case 3:e=a.sent,t=e.map(e=>iS(iS({},e),{},{value:e.id,label:e.name,type:e.type})),"report"!==i&&t.unshift({label:window.W_L.excel_upload,value:0,type:"csv",id:0}),m(t),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.error("error",a.t0);case 12:case"end":return a.stop()}}),null,null,[[0,9]],Promise)},[i]),Object(r.useEffect)(()=>{$(a),a||ae(!1)},[a]);var ne=e=>{Z(e)},oe=()=>{g({type:""}),v(""),_([]),S([]),P({}),N([]),W([]),D([]),U(!1),Q(!1)},ie=function(e){var t,a=arguments;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:50,$(!0),r.abrupt("return",new Promise((a,r)=>{var n,o,i,l;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,regeneratorRuntime.awrap(B.get("/api/data_sources/".concat(e,"/schema?refresh=true")));case 3:(n=s.sent).job&&3!==n.job.status?(o=0,i=n.job.id,l=setInterval(()=>{var e;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return++o>t&&(clearInterval(l),$(!1),r(new Error("Timeout waiting for job completion"))),n.prev=2,n.next=5,regeneratorRuntime.awrap(B.get("/api/jobs/".concat(i)));case 5:3===(e=n.sent).job.status&&(clearInterval(l),$(!1),a(e.job.result)),n.next=14;break;case 9:n.prev=9,n.t0=n.catch(2),clearInterval(l),$(!1),r(n.t0);case 14:case"end":return n.stop()}}),null,null,[[2,9]],Promise)},1e3)):($(!1),a(n.job?n.job.result:[])),s.next=11;break;case 7:s.prev=7,s.t0=s.catch(0),$(!1),r(s.t0);case 11:case"end":return s.stop()}}),null,null,[[0,7]],Promise)}));case 3:case"end":return r.stop()}}),null,null,null,Promise)},le=(e,t)=>{var a,r,n,o,i;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(l.prev=0,r=(e,t)=>e.map((e,a)=>iS(iS({},e),{},{label:"csv"===t?e.source_name:e.name,value:a,name:"csv"===t?e.file_name:e.name,checked:!1})),"csv"!==t){l.next=10;break}return l.next=5,regeneratorRuntime.awrap(B.get("api/upload"));case 5:n=l.sent,o=n.data,a=r(o,t),l.next=14;break;case 10:return l.next=12,regeneratorRuntime.awrap(ie(e));case 12:i=l.sent,a=r(i,t);case 14:_(a),l.next=20;break;case 17:l.prev=17,l.t0=l.catch(0),console.error("error",l.t0);case 20:case"end":return l.stop()}}),null,null,[[0,17]],Promise)},se=function(e){var t,a,r,n,o,i,l=arguments;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=l.length>1&&void 0!==l[1]?l[1]:null,z(!0),a={table_name:"",table_comment:"",field_desc:[]},s.next=5,regeneratorRuntime.awrap(B.get("/api/data_table/columns/".concat(y,"/").concat("csv"===f.type?e.file_name:e.name)));case 5:r=s.sent,0!==Object.keys(r).length?(a.table_name=r.table_name,a.table_comment=r.table_desc||"",a.field_desc=r.table_columns_info.field_desc):(a.table_name="csv"===f.type?e.file_name:e.name,a.table_comment="csv"===f.type?e.source_name:"","csv"!==f.type&&e.columns.forEach((t,r)=>{var n={name:"pg"===f.type?t.name:t,comment:e.comment[r]||"",in_use:1};a.field_desc.push(n)})),(n=j.find(e=>e.table_name===a.table_name))||S(e=>[...e,a]),t||P(n||a),(o=q.find(e=>e.table_name===a.table_name))?W(o.selectedRowKeys):(i=a.field_desc.map(e=>e.name),t||W(i),D(e=>[...e,{table_name:a.table_name,selectedRowKeys:i}])),z(!1);case 13:case"end":return s.stop()}}),null,null,null,Promise)},ce=(e,t)=>{var a=e.target.value,r=iS({},x);r.field_desc=r.field_desc.map(e=>(e.name===t.name&&(e.comment=a),e)),P(r);var n=j.map(e=>(e.table_name===r.table_name&&(e.field_desc=r.field_desc),e));S(n)},ue={selectedRowKeys:T,onChange:(e,t)=>{W(e);var a=iS({},x);a.field_desc=a.field_desc.map(t=>(t.in_use=e.includes(t.name)?1:0,t)),P(a);var r=j.map(e=>(e.table_name===a.table_name&&(e.field_desc=a.field_desc),e));S(r);var n=q.find(e=>e.table_name===a.table_name);D(n?q.map(t=>(t.table_name===a.table_name&&(t.selectedRowKeys=e),t)):t=>[...t,{table_name:a.table_name,selectedRowKeys:e}])}},de=function(){var e,t,a,r,n,o,i=arguments;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:[],ae(!0),t=[],a=[],r={},!(e.length>0)){l.next=14;break}return t=e.map(e=>({name:e.table_name})),n=t.map(t=>{var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,regeneratorRuntime.awrap(B.get("/api/data_table/columns/".concat(y,"/").concat(t.name)));case 2:(r=o.sent)&&(n={table_name:r.table_name,table_comment:r.table_desc||"",field_desc:r.table_columns_info.field_desc},e.forEach(e=>{e.table_name===r.table_name&&(n.table_comment=e.table_comment,n.field_desc.forEach((t,a)=>{e.field_desc.forEach(e=>{t.name===e.name&&(n.field_desc[a].comment=e.comment)})}))}),a.push(n));case 4:case"end":return o.stop()}}),null,null,null,Promise)}),l.next=10,regeneratorRuntime.awrap(Promise.all(n));case 10:s(200,a,f,r={tableName:t},""),l.next=19;break;case 14:o=k.filter(e=>e.checked),t=o.map(e=>({name:e.name})),r={tableName:t},a=j.filter(e=>o.some(t=>t.name===e.table_name)),s(200,a,f,r,"firstTableData");case 19:case"end":return l.stop()}}),null,null,null,Promise)},me=d.map(e=>{var t=e.type,a=e.value,r=e.label;return n.a.createElement(Yr.a.Option,{key:a,value:a},n.a.createElement(zj.a,null,n.a.createElement("div",{"aria-label":r,style:{display:"flex",alignItems:"center"}},n.a.createElement("span",{role:"img",style:{marginRight:"5px"}},n.a.createElement("img",{src:"".concat("static/images/db-logos","/").concat(t,".png"),alt:t,style:{width:"30px",height:"30px"}})),r)))}),pe=()=>n.a.createElement("div",{style:{textAlign:"center",display:"flex",flexDirection:"column",color:"#8f8f8f"}},n.a.createElement(Bj.a,{style:{fontSize:"30px"}}),window.W_L.no_data);Object(r.useImperativeHandle)(t,()=>({editTableData:ne}));var fe=O&&O.length>0,ge=x&&x.table_name&&x.field_desc.length>0;return!o&&n.a.createElement("div",{className:"flex-column"},n.a.createElement("div",{className:"dislogue-caption"},n.a.createElement("h1",null,"Hi !"),n.a.createElement("span",null,"chat"===i?window.W_L.chat_start:"autopilot"===i?window.W_L.AutoPilot_start:window.W_L.report_start,n.a.createElement(h,{href:"/data_sources"},window.W_L.add_datasource))),n.a.createElement("div",{className:"select-content"},n.a.createElement(vf.a,{spinning:G,className:te?"dislogue-spin":""},X&&X.length>0?n.a.createElement(Zj,{SelectLoading:G,editData:X,closeEditData:()=>{Z([])},submit:de,source_item:f}):n.a.createElement("div",{className:"select-content-item"},n.a.createElement("div",{style:{position:"absolute",bottom:"-30px",fontSize:"12px"}},n.a.createElement(we,{title:window.W_L.source_tooltip},n.a.createElement(Yj.a,{style:{marginRight:"3px"}})),window.W_L.source_first_tooltip),n.a.createElement("div",{style:{display:"flex",alignItems:"baseline"}},n.a.createElement("span",{className:"select-content-item-span"},window.W_L.data_source,n.a.createElement(we,{title:window.W_L.source_tooltip,placement:"bottom"},n.a.createElement(Lt.a,{style:{marginLeft:"5px"}}))),n.a.createElement("div",null,n.a.createElement(Yr.a,{style:{width:240},showSearch:!0,defaultValue:y,className:"dialogue-content-select",placeholder:window.W_L.select_data_source,optionFilterProp:"children",onChange:e=>{oe();var t=d.find(t=>t.value===e),a=t?t.type:null;l(a,e,t),g(t),v(e),le(e,a)},optionSelectedBg:"#eff0f4",disabled:G,filterOption:(e,t)=>{var a;return(null!==(a=null==t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())}},me),n.a.createElement("div",{className:"select-main"},n.a.createElement("ul",{className:fe?"":"flex-center"},fe&&n.a.createElement("div",{className:"flex-end"},n.a.createElement("span",null,window.W_L.select_all),n.a.createElement($r.a,{indeterminate:V,checked:Y,onChange:e=>function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){$(!0),U(!1),Q(e.target.checked);var a=[],r=[];O.forEach(t=>{a.push(iS(iS({},t),{},{checked:e.target.checked})),!t.checked&&e.target.checked&&r.push(se(t,"all"))}),_(a),N(e.target.checked?a:[]),e.target.checked?Promise.all(r).then(e=>{$(!1)}):(N([]),P({}),S([]),W([]),D([]),$(!1))}}(e,"all")})),fe?O.map((e,t)=>n.a.createElement("li",{key:t},n.a.createElement(we,{title:e.label},n.a.createElement("span",{onClick:()=>(e=>{if(!M){var t=j.find(t=>t.table_name===e.name);t?(P(t),W(t.field_desc.filter(e=>1===e.in_use).map(e=>e.name))):se(e)}})(e),style:{color:e.label===x.table_name?"#2196F3":"#333"}},e.label)),n.a.createElement($r.a,{checked:e.checked,onChange:t=>((e,t)=>{_([...O.map(a=>a.name===t.name?iS(iS({},a),{},{checked:e.target.checked}):a)]),e.target.checked?(N([...k,iS(iS({},t),{},{checked:!0})]),se(t)):(N(k.filter(e=>e.name!==t.name)),S(j.filter(e=>e.table_name!==t.name)),D(q.filter(e=>e.table_name!==t.name)),k.length<1&&P({})),N(e=>(e.length===O.length?(U(!1),Q(!0)):e.length>0?(U(!0),Q(!1)):(U(!1),Q(!1)),e))})(t,e)}))):n.a.createElement(pe,null))))),n.a.createElement("div",{className:"table-columns"},ge&&n.a.createElement("div",{className:"table-columns-item"},n.a.createElement("span",null,"csv"===f.type?x.table_comment:x.table_name),n.a.createElement(ta.a,{placeholder:window.W_L.sheet_description,style:{padding:"2px",maxWidth:"60%"},type:"text",disabled:"csv"===f.type,value:"csv"===f.type?x.table_name:x.table_comment,onChange:e=>{var t=e.target.value;P(e=>iS(iS({},e),{},{table_comment:t}));var a=iS({},x);a.table_comment=t;var r=j.map(e=>(e.table_name===a.table_name&&(e.table_comment=a.table_comment),e));S(r)}})),n.a.createElement("div",{className:ge?"":"flex-center",style:{width:"400px",overflowY:"scroll",height:ge?"235px":"276px"}},ge?n.a.createElement(Il.a,{rowSelection:iS({type:"checkbox"},ue),dataSource:x.field_desc,columns:re,size:"small",rowKey:e=>e.name,pagination:!1}):n.a.createElement(pe,null))),k&&k.length>0&&n.a.createElement("button",{onClick:de,disabled:G,className:"submit-btn"},window.W_L.submit," ",k.length))),G&&te&&n.a.createElement("div",{className:"dislogue-progress"},n.a.createElement(Vj.a,{width:80,type:"circle",percent:c}),n.a.createElement("p",null,window.W_L.ai_understanding_data))))}),dS=a(325);function mS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return pS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var fS=Object(r.memo)(e=>{var t=e.content,a=Object(r.useRef)(null),o=mS(Object(r.useState)({}),2),i=o[0],l=o[1];Object(r.useEffect)(()=>{var e=JSON.parse(t);l(e)},[t]),Object(r.useEffect)(()=>{try{var e=null;if(a.current){if(e=dS.b(a.current),"color"in i&&delete i.color,"series"in i)for(var t=0;t<i.series.length;++t)"lineStyle"in i.series[t]&&delete i.series[t].lineStyle;e.setOption(i)}return window.addEventListener("resize",s),()=>{e&&e.dispose(),window.removeEventListener("resize",s)}}catch(e){console.log("Error in EChartsChart: ",e)}},[i]);var s=()=>{if(a.current){var e=dS.a(a.current);e&&e.resize()}};return n.a.createElement("div",{ref:a,className:"w-full h-500"})}),gS=(a(1393),(e,t)=>n.a.createElement("div",{className:"content_loading"},n.a.createElement("div",{className:"point1"}),n.a.createElement("div",{className:"point2"}),n.a.createElement("div",{className:"point3"}))),bS=a(721),hS=a.n(bS);a(1394);function yS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return vS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var wS=e=>{var t=e.logData,a=e.Cardloading,r=yS(n.a.useState(!1),2),o=r[0],i=r[1],l=yS(n.a.useState([]),2),s=l[0],c=l[1],u=yS(n.a.useState("Show work"),2),d=u[0],p=u[1],f=n.a.useRef(null);n.a.useEffect(()=>{if(t&&t.length>0){var e=t.slice(s.length),a=f.current,r=/\n/g;if(e.some(e=>r.test(e))){var n=e.map(e=>e.replace(/\n\n/g,"<br />"));c(e=>[...e,...n])}else c(t=>[...t,...e]);setTimeout(()=>{a.scrollTop=a.scrollHeight},0)}},[t,s.length]);var g=()=>{try{var e=f.current,t=document.createRange();t.selectNode(e);var a=window.getSelection();a.rangeCount>0&&a.removeAllRanges(),a.addRange(t),document.execCommand("copy"),a.removeAllRanges(),XE.a.success(window.W_L.copy_success)}catch(e){XE.a.error(window.W_L.copy_failed)}};return n.a.createElement("div",{className:"log_terminal"},n.a.createElement("div",{className:"log_terminal_header"},a?n.a.createElement(gS,null):n.a.createElement("div",null),n.a.createElement("div",{className:"log_terminal_header_title",onClick:()=>{t&&0===t.length||("Show work"===d?(p("Hide work"),f.current.style.height="170px"):(p("Show work"),f.current.style.height="0px"))}},d)),n.a.createElement("div",{className:"log_terminal_content_div"},n.a.createElement(we,{title:window.W_L.copy},n.a.createElement(m.a,{icon:n.a.createElement(vE.a,null),style:{position:"absolute",color:"#9d9d9d",zIndex:1},type:"text",size:"small",className:"copy_btn",onClick:g})),n.a.createElement(we,{title:"全屏"},n.a.createElement(m.a,{icon:n.a.createElement(hS.a,null),style:{position:"absolute",color:"#9d9d9d",zIndex:1},type:"text",size:"small",className:"compress_btn",onClick:()=>{i(!0)}})),n.a.createElement(R.a,{visible:o,onCancel:()=>i(!1),footer:null,closable:!1,width:"80%",className:"log_terminal_modal"},n.a.createElement("div",{className:"log_terminal_content_div"},n.a.createElement(we,{title:window.W_L.copy},n.a.createElement(m.a,{icon:n.a.createElement(vE.a,null),style:{position:"absolute",color:"#9d9d9d",zIndex:1},type:"text",size:"small",className:"copy_btn",onClick:g})),n.a.createElement("div",{className:"log_terminal_content",style:{height:"auto",maxHeight:"75vh"}},s&&s.length>0&&s.map((e,t)=>n.a.createElement("div",{key:t,className:"log-item",dangerouslySetInnerHTML:{__html:e}}))))),n.a.createElement("div",{className:"log_terminal_content",ref:f},s&&s.length>0&&s.map((e,t)=>n.a.createElement("div",{key:t,className:"log-item",dangerouslySetInnerHTML:{__html:e}})))))},OS=(a(604),a(321)),_S=a.n(OS),ES=(a(1397),n.a.createContext()),jS=e=>{var t=Object(r.useContext)(ES),a=t.cancelRequest,o=(t.chat_type,e.source),i=e.message,l="bot"===i.sender&&i.Cardloading;return n.a.createElement("div",{className:"copy".concat(i.sender)},n.a.createElement("div",{className:"copy-item",onClick:l?()=>a(i):()=>{try{var e=document.createElement("input");e.setAttribute("readonly","readonly"),e.setAttribute("value",o),document.body.appendChild(e),e.select(),e.setSelectionRange(0,9999),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(e),XE.a.success(window.W_L.copy_success)}catch(e){XE.a.error(window.W_L.copy_failed)}}},l?n.a.createElement(n.a.Fragment,null,n.a.createElement(_S.a,{className:"gpt-btn-item-img"}),n.a.createElement("div",{className:"copy-text"},window.W_L.stop_generation)):n.a.createElement(n.a.Fragment,null,n.a.createElement(vE.a,{className:"gpt-btn-item-img"}),n.a.createElement("div",{className:"copy-text"},window.W_L.copy))))};a(1400);function SS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return CS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return CS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var xS=ta.a.TextArea,PS=e=>{var t=e.databases_type,a=SS(Object(r.useState)(!1),2),o=a[0],i=a[1],l=SS(Object(r.useState)(""),2),s=l[0],c=l[1],u=SS(Object(r.useState)(""),2),d=u[0],p=u[1],f=SS(Object(r.useState)(!0),2),g=f[0],b=f[1],h=()=>{if(s&&d){var e=y();if(e&&e.length>0&&e[0].table_name&&e[0].table_name.tableName&&e[0].table_name.tableName.length>0){i(!0);var a=[],r=e[0].table_name.tableName.map(t=>{var r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(B.get("/api/data_table/columns/".concat(e[0].Charttable_id,"/").concat(t.name)));case 2:r=n.sent,a.push({table_name:r.table_name,table_comment:r.table_desc,field_desc:r.table_columns_info.field_desc});case 4:case"end":return n.stop()}}),null,null,null,Promise)});Promise.all(r).then(()=>{var r,n,o;r=e[0].Charttable_id,n={databases_desc:"",table_desc:a},regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return o={databases_id:r,databases_type:t.current,report_name:s,report_desc:d,db_comment:n},e.next=3,regeneratorRuntime.awrap(B.post("/api/auto_pilot",o).then(e=>{i(!1),200===e.code?(b(!1),XE.a.success(window.W_L.submit_success+" "+window.W_L.submit_success_tip),rf.navigate("Dialogue.List.autopilot_list")):XE.a.error(e.data)}).catch(e=>{i(!1),XE.a.error(window.W_L.submit_fail)}));case 3:case"end":return e.stop()}}),null,null,null,Promise)}).catch(e=>{console.log(e,"first_error"),i(!1)})}}},y=qj().getAutopilotStorage;return n.a.createElement("div",{style:{width:"100%"}},n.a.createElement(Yc.a,{size:"small",column:1,bordered:!0,className:"my-custom-label"},n.a.createElement(Yc.a.Item,{label:window.W_L.report_name},n.a.createElement(ta.a,{bordered:!1,placeholder:window.W_L.report_name_tip,value:s,onChange:e=>c(e.target.value)})),n.a.createElement(Yc.a.Item,{label:window.W_L.report_desc},n.a.createElement(xS,{style:{resize:"none"},rows:10,placeholder:window.W_L.report_desc_tip,bordered:!1,value:d,onChange:e=>p(e.target.value)}))),n.a.createElement("div",{className:"gpt-descriptions-btn"},n.a.createElement("div",{style:{fontSize:"14px"}},n.a.createElement(he.a,{title:window.W_L.report_name_and_report_desc_tip},n.a.createElement(Yj.a,{style:{marginRight:"3px"}})),window.W_L.please_complete_report_name_and_report_desc),g&&n.a.createElement(m.a,{style:{width:"100px"},block:!0,type:"primary",disabled:o,onClick:()=>h()},n.a.createElement("i",{className:"fa fa-check m-r-5","aria-hidden":"true"}),window.W_L.submit)))};a(605);function LS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return kS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var NS=e=>{var t=e.databases_type,a=e.chat_type,o=e.index,i=e.message,l=e.source,s=(e.ChangeScrollTop,Object(r.useRef)()),c=LS(Object(r.useState)(""),2),u=c[0],d=c[1],m=LS(Object(r.useState)(!1),2),p=m[0],f=m[1];Object(r.useEffect)(()=>{if(/\n/g.test(l)){var e=l.replace(/\n/g,"<br />");d(e)}else d(l);setTimeout(()=>{},0)},[l]);var g=Object(r.useMemo)(()=>0===o?null:n.a.createElement(wS,{Cardloading:i.Cardloading,logData:i.logData}),[o,i]),b=Object(r.useMemo)(()=>i.chart?n.a.createElement(fS,{content:i.chart}):null,[i]),h=Object(r.useMemo)(()=>n.a.createElement("div",{style:{wordBreak:"break-all"},ref:s,dangerouslySetInnerHTML:{__html:u}}),[u]),y=Object(r.useMemo)(()=>"autopilot"===a?n.a.createElement(PS,{databases_type:t}):n.a.createElement("div",{className:"Chat ".concat(i.sender)},l),[a,i,l]);return n.a.createElement("div",{className:"message ".concat(a),onMouseLeave:()=>f(!1)},n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"info".concat(i.sender,"-time")},"autopilot"===a?"":i.time),n.a.createElement("div",{className:"chat".concat(i.sender),onMouseEnter:()=>f(!0)},"autopilot"!==a&&n.a.createElement("img",{src:"user"===i.sender?H.profile_image_url:vt.a,alt:""}),"user"===i.sender?y:n.a.createElement("div",{className:"Chat ".concat(i.sender)},g,b,h)),p&&!i.Cardloading&&"autopilot"!==a&&n.a.createElement(jS,{index:o,source:l,message:i}),i.Cardloading&&"chat"===a&&n.a.createElement(jS,{index:o,source:l,message:i})))};NS.propTypes={title:te.PropTypes.string,source:te.PropTypes.string},NS.defaultProps={title:"",source:""};var AS=NS,TS=a(722),WS=a.n(TS),IS=ta.a.TextArea,qS=Object(r.forwardRef)((e,t)=>{var a=e.Charttable,o=e.confirmLoading,i=e.onChange,l=e.sendTableDate,s=e.loadingMask,c=e.onUse,u=e.messages,d=e.ChangeScrollTop,m=e.loadingState,p=e.stopSend,f=e.inputMessage,g=e.setInputMessage,b=e.handleSendMessage,h=e.chat_type,y=e.onOpenKeyClick,v=e.onSuccess,w=e.percent,O=e.databases_type,_=Object(r.useRef)(null),E=e=>{_.current.editTableData(e)};return Object(r.useImperativeHandle)(t,()=>({sourceEdit:E})),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dialogue-content-all"},n.a.createElement("div",{className:"dialogue-content-message"},n.a.createElement("div",{className:"dialogue-content-message-auto"},n.a.createElement(uS,{ref:_,onSuccess:v,chat_type:h,Charttable:a,confirmLoading:o,onChange:i,percent:w}),1!==l&&u.length<=0&&a?n.a.createElement(Rj,{loadingMask:s,Charttable:a,onUse:c}):null,u.map((e,t)=>n.a.createElement("div",{key:t,className:"chat-content",style:{margin:"report"===h?"0 30px":"",marginTop:0===t?"30px":""}},n.a.createElement(AS,{databases_type:O,chat_type:h,source:e.content,message:e,index:t,ChangeScrollTop:d})))))),"viewConversation"!==h&&n.a.createElement("div",{className:"main-all",style:{width:"report"===h?"90%":"80%"}},m&&u.length>0&&"report"===h&&n.a.createElement("div",{className:"gpt-section-btn-list"},n.a.createElement("button",{className:"gpt-btn-item",onClick:p},n.a.createElement(_S.a,{className:"gpt-btn-item-img"}),n.a.createElement("div",{className:"gpt-btn-item-txt"},window.W_L.stop_generation))),"autopilot"===h?"":n.a.createElement("div",{className:"dialogue-content-bottom"},n.a.createElement("div",{className:"open-key",style:{display:"none"},onClick:y}),n.a.createElement(IS,{bordered:!1,style:{resize:"none",maxHeight:"100px !important",fontSize:"15px",border:"none !important"},value:f,className:"gpt-input",onChange:e=>{if(e&&e.target){var t=e.target.value;g(t)}},placeholder:window.W_L.send_me_instructions,autoSize:{minRows:1,maxRows:4},onPressEnter:e=>{e.preventDefault(),b()}}),n.a.createElement("div",{className:"gpt-input-middle"},n.a.createElement(WS.a,{onClick:b,style:{color:f?"":"#ccc",fontSize:"20px",marginRight:"15px"}})))))}),DS=(a(1403),e=>n.a.createElement("div",{className:"menumask"})),RS=(a(1404),window.location.protocol+"//"+window.location.hostname+":8341"),MS="".concat(RS,"/api/chat");function zS(e,t,a,r){var n="ws";"https:"===window.location.protocol&&(n="wss");var o="".concat(n,"://").concat("192.168.5.165:8339/").concat(H.id,"_").concat(H.name),i=e=>{console.error("WebSocket error",e),XE.a.error(window.W_L.ERROR_MESSAGE)},l=e=>{e.addEventListener("message",e=>{var t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=JSON.parse(e.data),a(t);case 2:case"end":return r.stop()}}),null,null,null,Promise)}),e.addEventListener("close",e=>{console.log("Connection closed",e.code,e.reason),r()}),e.addEventListener("error",i)};if(e.current&&(e.current.removeEventListener("message",a),e.current.removeEventListener("close",r),e.current.removeEventListener("error",i),1===e.current.readyState))return console.log("old ws connection is open"),e.current.send(JSON.stringify(t)),void l(e.current);console.log("new ws connection");var s=new WebSocket(o);e.current=s,s.addEventListener("open",()=>{console.log("new params",t),s.send(JSON.stringify(t)),l(s)})}function FS(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function VS(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?FS(Object(a),!0).forEach((function(t){US(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):FS(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function US(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function BS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return HS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return HS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var YS=e=>{var t=e.chat_type,a=e.sendUrl,o=e.uuid,i=Object(r.useRef)(),l=Object(r.useRef)(),s=Object(r.useRef)([]),c=Object(r.useRef)(),u=Object(r.useRef)(null),d=Object(r.useRef)({}),m=Object(r.useRef)(null),p=Object(r.useRef)(null),f=BS(Object(r.useState)(null),2),g=f[0],b=f[1],h=BS(Object(r.useState)(null),2),y=h[0],v=h[1],w=BS(Object(r.useState)(!1),2),O=w[0],_=w[1],E=BS(Object(r.useState)(!1),2),j=E[0],S=E[1],C=BS(Object(r.useState)(0),2),x=C[0],P=C[1],L=BS(Object(r.useState)(!1),2),k=L[0],N=L[1],A=BS(Object(r.useState)([]),2),T=A[0],W=A[1],I=BS(Object(r.useState)({}),2),q=I[0],D=I[1],R=Object(r.useRef)(),M=Object(r.useRef)(),z=BS(Object(r.useState)(!1),2),F=z[0],V=z[1],U=Object(r.useRef)("mysql"),Y=BS(Object(r.useState)(0),2),Q=Y[0],K=Y[1],G=BS(Object(r.useState)(null),2),$=G[0],J=G[1],X="chat"===t?5:1,Z=Object(r.useRef)([]),ee=null,te=BS(Object(r.useState)(""),2),ae=te[0],re=te[1],ne=Object(r.useRef)(null),oe=BS(Object(r.useState)({messages:[],lockReconnect:!1,data_type:null,logData:[]}),2),ie=oe[0],le=oe[1];Object(r.useEffect)(()=>{ie.logData&&(s.current=ie.logData)},[ie.logData]),Object(r.useEffect)(()=>{se()},[]),Object(r.useEffect)(()=>{o&&se()},[o]),Object(r.useEffect)(()=>{R.current=q},[q]),Object(r.useEffect)(()=>{M.current=T},[T]),Object(r.useEffect)(()=>{p.current=y},[y]);var se=function(){if("chat"===t||"report"===t||"autopilot"===t){var e=[];switch(t){case"chat":e=Ke();break;case"report":e=Ye()}e&&e.length>0?(v(e[0].table_name),p.current=e[0].table_name,ye("",e[0].Charttable_id),U.current=e[0].type,d.current={label:e[0].label,id:e[0].id,type:e[0].type},e[0].dashboardId?(a(e[0].dashboardId),ye("dashboard_id",e[0].dashboardId)):("report"===t&&a("new_report"),ye("dashboard_id",null)),e[0].messages&&e[0].messages.length>0?(le(t=>VS(VS({},t),{},{messages:e[0].messages})),N(!1),S(!0),Le("edit"),P(0)):Ee()):("report"===t&&a(""),v(null),ye(null,null),le(e=>VS(VS({},e),{},{messages:[]})),N(!1),P(0),S(!1),d.current={})}else if("viewConversation"===t){var r=$e();if(r&&r.length>0&&o){var n=r.filter(e=>e.uuid===o);v(n[0].table_name),ye("",n[0].Charttable_id),d.current={label:n[0].label,id:n[0].id,type:n[0].type},n[0].messages&&n[0].messages.length>0&&(le(e=>VS(VS({},e),{},{messages:n[0].messages})),N(!1),P(1),S(!0))}}xe()},ce=()=>{var e,a;v(M.current),e=[],(a=VS({table_name:M.current,Charttable_id:u.current},d.current)).title=window.W_L.new_dialogue+String($e().length+1),a.uuid=Date.now(),a.messages=[],e.push(a),"report"===t?He(e):"chat"===t?Qe(e):"autopilot"===t&&Je(e)},ue=Object(r.useCallback)((e,t,a,r,n)=>{var o,i,l;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return u.current=a.id,d.current={label:a.label,id:a.id,type:a.type},U.current=a.type,V(!0),le(e=>VS(VS({},e),{},{data_type:"mysql_comment"})),n&&W(r),D({table_desc:t}),o=t.map(e=>{var t=e.field_desc.filter(e=>1===e.in_use);return{table_name:e.table_name,table_comment:e.table_comment,field_desc:t}}),i={databases_desc:"",table_desc:o},l=new window.AbortController,Z.current.push(l),s.next=13,regeneratorRuntime.awrap(Ie(e,"bi","mysql_comment",i,0,"",1,l.signal));case 13:Z.current=Z.current.filter(e=>e!==l);case 14:case"end":return s.stop()}}),null,null,null,Promise)},[le,Ie]),de=(e,t)=>{var a=JSON.parse(JSON.stringify(e));return t.table_desc.forEach((e,t)=>{var r=a.table_desc.findIndex((t,a)=>e.table_name===t.table_name);-1!==r?(a.table_desc[r].table_comment=e.table_comment,e.field_desc.forEach((e,t)=>{var n=a.table_desc[r].field_desc.findIndex((t,a)=>e.name===t.name);-1!==n?(a.table_desc[r].field_desc[n].comment=e.comment,a.table_desc[r].field_desc[n].in_use=e.in_use,a.table_desc[r].field_desc[n].is_pass=e.is_pass):a.table_desc[r].field_desc.push(e)})):a.table_desc.push(e)}),a},me=function(e,t){var a,r,n,o=arguments;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:a=o.length>2&&void 0!==o[2]?o[2]:null;try{r=de(R.current,t),n=r.table_desc.map(t=>{var a;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a={table_name:t.table_name,table_inuse:!0,table_desc:t.table_comment,table_columns_info:{field_desc:t.field_desc}},r.next=3,regeneratorRuntime.awrap(B.post("/api/data_table/columns/".concat(e,"/").concat(t.table_name),a));case 3:case"end":return r.stop()}}),null,null,null,Promise)}),Promise.all(n).then(()=>{a&&Ee()})}catch(e){V(!1)}case 2:case"end":return i.stop()}}),null,null,null,Promise)},pe=e=>{var t;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t=e,a.next=4,regeneratorRuntime.awrap(fe(t));case 4:a.next=11;break;case 6:a.prev=6,a.t0=a.catch(0),console.log(a.t0,"socket_error"),N(!1),_(!1);case 11:case"end":return a.stop()}}),null,null,[[0,6]],Promise)},fe=e=>{var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if("user"===e.receiver&&(le(a=>VS(VS({},a),{},{messages:a.messages.map((r,n)=>"chat"===t&&"bot"===r.sender&&r.chat_id===e.chat_id||"chat"!==t&&n===a.messages.length-1&&"bot"===r.sender?VS(VS({},r),{},{content:e.data.content,Cardloading:!1,time:Ea()().format("YYYY-MM-DD HH:mm")}):r)})),_(!1),xe(!0),ke()),500!==e.state){o.next=9;break}return ke(),"bi"===e.receiver&&"mysql_comment_first"===e.data.data_type&&(P(0),N(!1)),V(!1),"log"===e.receiver&&XE.a.error(e.data.content),le(t=>({messages:t.messages.map((t,a)=>t.chat_id===e.chat_id&&t.Cardloading?VS(VS({},t),{},{Cardloading:!1}):t)})),_(!1),o.abrupt("return");case 9:if("bi"!==e.receiver){o.next=68;break}if("mysql_code"!==e.data.data_type){o.next=15;break}je("mysql_code"),Re(e.data.content,e.data.name,e.id),o.next=66;break;case 15:if("ask_data"!==e.data.data_type){o.next=20;break}je("ask_data"),Fe("","ask_data",e.id),o.next=66;break;case 20:if("chart_code"!==e.data.data_type){o.next=32;break}je("chart_code"),o.prev=22,m.current?ze(JSON.parse(e.data.content),"edit",e.id):ze(JSON.parse(e.data.content),null,e.id),o.next=30;break;case 26:return o.prev=26,o.t0=o.catch(22),o.next=30,regeneratorRuntime.awrap(Ie(500,"bi","chart_code",o.t0,e.id));case 30:o.next=66;break;case 32:if("mysql_comment"!==e.data.data_type){o.next=47;break}return je("mysql_comment"),o.prev=34,r=JSON.parse(JSON.stringify(e.data.content.table_desc)),o.next=38,regeneratorRuntime.awrap(Ce(r));case 38:(n=o.sent).length>0?(XE()(window.W_L.please_fill_in_the_description),V(!1),l.current.sourceEdit(n),me(u.current,e.data.content)):(ce(),V(!1),"report"===t&&a("new_report"),me(u.current,e.data.content,"success")),K(0),o.next=45;break;case 43:o.prev=43,o.t1=o.catch(34);case 45:o.next=66;break;case 47:if("mysql_comment_first"!==e.data.data_type){o.next=56;break}le("autopilot"===t?{messages:[{content:e.data.content,sender:"bot",Cardloading:!1,time:Ea()().format("YYYY-MM-DD HH:mm")},{content:"",sender:"user",time:Ea()().format("YYYY-MM-DD HH:mm")}]}:{messages:[{content:e.data.content,sender:"bot",Cardloading:!1,chat_id:e.chat_id,time:Ea()().format("YYYY-MM-DD HH:mm")}],data_type:"mysql_comment_first"}),N(!1),P(1),S(!0),_(!1),XE.a.success(window.W_L.configuration_completed+" "+t=="autopilot"?"":window.W_L.start_the_dialogue,{icon:"👏"}),o.next=66;break;case 56:if("mysql_comment_second"!==e.data.data_type){o.next=65;break}return le(e=>VS(VS({},e),{},{loadingMask:!1,sendTableDate:1})),N(!1),_(!1),P(1),o.next=63,regeneratorRuntime.awrap(Ie(200,"user","question",ae));case 63:o.next=66;break;case 65:"delete_chart"===e.data.data_type?(je("delete_chart"),Fe(e.data.content,"delete",e.id)):"table_code"===e.data.data_type&&(console.log("table_code=====",e.id),je("table_code"),m.current?(console.log("22222table_code=====",e.id),Ve("edit",e.id)):(console.log("111111table_code=====",e.id),Ve(null,e.id)));case 66:o.next=78;break;case 68:if("log"!==e.receiver){o.next=77;break}if(e.data.content){o.next=71;break}return o.abrupt("return");case 71:if("data_check"!==e.data.data_type){o.next=74;break}return K(e.data.content),o.abrupt("return");case 74:le(a=>({messages:a.messages.map((r,n)=>"chat"===t&&"bot"===r.sender&&r.chat_id===e.chat_id||"chat"!==t&&n===a.messages.length-1&&"bot"===r.sender?VS(VS({},r),{},{logData:[...r.logData||[],e.data.content]}):r)})),o.next=78;break;case 77:"python"===e.receiver&&"echart_code"===e.data.data_type&&le(a=>({messages:a.messages.map((r,n)=>"chat"===t&&"bot"===r.sender&&r.chat_id===e.chat_id||"chat"!==t&&n===a.messages.length-1&&"bot"===r.sender?VS(VS({},r),{},{chart:e.data.content}):r)}));case 78:case"end":return o.stop()}}),null,null,[[22,26],[34,43]],Promise)},ge=()=>{if("chat"===t||"report"===t){var e=c.current,a=c.current[c.current.length-1];a&&"bot"===a.sender&&a.Cardloading&&!a.content&&!a.chart&&e.pop(),Ge(e,t)}_(!1),be()},be=()=>{if(ke(),0!==Z.current.length)try{Z.current.forEach(e=>{e.abort()}),le(e=>VS(VS({},e),{},{messages:e.messages.map(e=>"bot"===e.sender&&e.Cardloading?VS(VS({},e),{},{Cardloading:!1}):e)}))}catch(e){console.log(e,"cancelRequestAll_error")}};Object(r.useEffect)(()=>{c.current=ie.messages},[ie.messages]),Object(r.useEffect)(()=>{var e=()=>{ge()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e),ge()}},[]);var he=Object(r.useCallback)((function(e){}),[le,pe]),ye=Object(r.useCallback)((e,t)=>{if("dashboard_id"===e)return m.current=t,void b(t);u.current=t},[]),ve=Object(r.useCallback)(e=>{var t,a,r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(t={},"mysql_comment_first"===e&&(le(t=>VS(VS({},t),{},{data_type:e})),N(!0),_(!0)),!$){n.next=6;break}t={databases_desc:"",table_desc:$},n.next=22;break;case 6:if(!(p.current&&p.current.tableName.length>0&&0===x)){n.next=22;break}return le(t=>VS(VS({},t),{},{data_type:e})),a=p.current.tableName.map(e=>{var t;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(B.get("/api/data_table/columns/".concat(u.current,"/").concat(e.name)));case 2:return t=a.sent,a.abrupt("return",{table_name:t.table_name,table_comment:t.table_desc,field_desc:(r=t.table_columns_info,r.field_desc.filter(e=>1===e.in_use))});case 4:case"end":return a.stop()}var r}),null,null,null,Promise)}),n.prev=9,n.next=12,regeneratorRuntime.awrap(Promise.all(a));case 12:r=n.sent,t={databases_desc:"",table_desc:r},J(r),n.next=22;break;case 17:n.prev=17,n.t0=n.catch(9),console.log(n.t0,"first_error"),N(!1),_(!1);case 22:return n.abrupt("return",t);case 23:case"end":return n.stop()}}),null,null,[[9,17]],Promise)},[ie,le,pe,Ie]),we=Object(r.useCallback)(()=>{var e,t,a,r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=ie.messages,""!==ae.trim()){n.next=3;break}return n.abrupt("return");case 3:if(!(e.filter(e=>"bot"===e.sender&&e.Cardloading).length>=X)){n.next=7;break}return XE.a.error("为防止过大的Token消耗，每次对话最多只能提问"+X+"个问题"),n.abrupt("return");case 7:return t=Ea()().valueOf(),a=new window.AbortController,Z.current.push(a),le(r=>VS(VS({},r),{},{messages:[...e,{content:ae,sender:"user",chat_id:t,time:Ea()().format("YYYY-MM-DD HH:mm")},{content:"",sender:"bot",Cardloading:!0,chat_id:t,abortController:a}],data_type:"question"})),re(""),_(!0),xe(),n.next=16,regeneratorRuntime.awrap(ve("mysql_comment_second"));case 16:return r=n.sent,n.next=19,regeneratorRuntime.awrap(Ie(200,"user","question",ae,0,r,t,a.signal));case 19:Z.current=Z.current.filter(e=>e!==a);case 20:case"end":return n.stop()}}),null,null,null,Promise)},[ie,le,ae,re,xe,Ie,ve]),Oe=Object(r.useCallback)(()=>{j&&p.current&&p.current.tableName.length>0&&we()},[ie,le,we]),_e=Object(r.useCallback)(()=>{XE.a.error(window.W_L.connection_failed),_(!1)},[le]),Ee=Object(r.useCallback)(()=>{var e,t,a;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e="mysql_comment_first",r.next=3,regeneratorRuntime.awrap(ve(e));case 3:return t=r.sent,a=new window.AbortController,Z.current.push(a),r.next=8,regeneratorRuntime.awrap(Ie(200,"bi",e,t,0,"",1,a.signal));case 8:Z.current=Z.current.filter(e=>e!==a);case 9:case"end":return r.stop()}}),null,null,null,Promise)},[ve]),je=Object(r.useCallback)(e=>{le(t=>VS(VS({},t),{},{data_type:e}))},[le]),Se=Object(r.useCallback)(()=>{XE.a.success(window.W_L.report_generation_completed)},[]);var Ce=Object(r.useCallback)(e=>e.filter(e=>e.field_desc.some(e=>1!==e.is_pass)),[]),xe=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"viewConversation"===t||e||(ee&&clearTimeout(ee),ee=setTimeout(()=>{var e=document.querySelector(".dialogue-content-all");if(e){var t=e.scrollHeight,a=e.clientHeight;e.scrollTo({top:t-a,behavior:"smooth"})}},50))}),[]),Pe=Object(r.useCallback)(()=>{setTimeout(()=>{xe()},100)},[]),Le=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;P("edit"===e?1:0),_(!1),ke()}),[le]),ke=()=>{ne.current&&"report"===t&&(ne.current.close(),le(e=>VS(VS({},e),{},{messages:e.messages.map((t,a)=>a===e.messages.length-1&&"bot"===t.sender?VS(VS({},t),{},{Cardloading:!1}):t)})))},Ne=Object(r.useCallback)(e=>{if("report"!==t){if(e&&e.abortController)try{e.abortController.abort(),Z.current=Z.current.filter(t=>t!==e.abortController),le(t=>VS(VS({},t),{},{messages:t.messages.map((t,a)=>t.chat_id===e.chat_id?VS(VS({},t),{},{Cardloading:!1}):t)}))}catch(e){console.error(e,"cancelRequest_error")}}else ke()},[]),Ae=Object(r.useCallback)(e=>{a(e),Be(e)},[]),Te=Object(r.useCallback)(e=>{},[le,Ie]),We=Object(r.useCallback)(()=>{},[le,i]),Ie=Object(r.useCallback)((function(e,a,r,n){var o,i,l,s,c,d,m,p,f,g,b,h=arguments;return regeneratorRuntime.async((function(y){for(;;)switch(y.prev=y.next){case 0:if(o=h.length>4&&void 0!==h[4]?h[4]:0,i=h.length>5&&void 0!==h[5]?h[5]:null,l=h.length>6&&void 0!==h[6]?h[6]:0,s=h.length>7&&void 0!==h[7]?h[7]:null,"report"!==t||"mysql_comment_first"===r||"mysql_comment"===r){y.next=11;break}if(c={state:e,database:U.current,sender:a,chat_type:t,base_message:i,data:{data_type:r,databases_id:u.current||0,language_mode:window.W_L.language_mode,content:n},id:o},!ne.current||1!==ne.current.readyState){y.next=9;break}return ne.current.send(JSON.stringify(c)),y.abrupt("return");case 9:return zS(ne,c,e=>{console.log("res===",e),pe(e)},()=>{le(e=>VS(VS({},e),{},{messages:e.messages.map((t,a)=>a===e.messages.length-1&&"bot"===t.sender&&t.Cardloading?VS(VS({},t),{},{content:window.W_L.connection_seems_lost,Cardloading:!1}):t)})),N(!1),P(0),V(!1)}),y.abrupt("return");case 11:return d={user_id:H.id,user_name:H.name,chat_id:l,message:{state:e,database:U.current,sender:a,chat_type:t,base_message:i,data:{data_type:r,databases_id:u.current||0,language_mode:window.W_L.language_mode,content:n},id:o}},y.prev=12,y.next=15,regeneratorRuntime.awrap(fetch(MS,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify(d),signal:s}));case 15:(m=y.sent).body&&m.body.getReader?(p=m.body.getReader(),f=new TextDecoder,g="",b=e=>{var t,a,r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.done,a=e.value,!t){n.next=3;break}return n.abrupt("return");case 3:g+=f.decode(a,{stream:!0}),r=g.split("---ENDOFMESSAGE---"),console.log("Received buffer:",g),g=r.pop(),r.forEach(e=>{try{var t=JSON.parse(e);console.log("Parsed JSON:",t),pe(t)}catch(e){console.error("Error parsing JSON:",e)}}),p.read().then(b);case 9:case"end":return n.stop()}}),null,null,null,Promise)},p.read().then(b)):console.log("Streaming not supported"),y.next=27;break;case 19:y.prev=19,y.t0=y.catch(12),console.error("Fetch error:",y.t0),N(!1),_(!1),V(!1),le(e=>({messages:e.messages.map((e,t)=>e.chat_id===l&&e.Cardloading?VS(VS({},e),{},{Cardloading:!1}):e)})),"AbortError"!==y.t0.name&&XE.a.error(window.W_L.ERROR_MESSAGE);case 27:case"end":return y.stop()}}),null,null,[[12,19]],Promise)}),[ie,ve]),qe=((e,t,a)=>{var n=Aj(Object(r.useState)({SelectValue:null,sqlId:null}),2),o=n[0],i=n[1],l=Object(r.useRef)(null),s=Object(r.useRef)(null);Object(r.useEffect)(()=>{o.sqlId&&(l.current=o.sqlId)},[o.sqlId]),Object(r.useEffect)(()=>{e&&(s.current=e)},[e]);var c=Object(r.useCallback)((e,a,r,n)=>{var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,regeneratorRuntime.awrap(B.get("/api/query_results/".concat(e.job.query_result_id)));case 3:if(0!==(o=i.sent).query_result.data.rows.length){i.next=8;break}return i.next=7,regeneratorRuntime.awrap(t(500,"bi","mysql_code","sql没有查询到数据",n));case 7:return i.abrupt("return");case 8:if("test"!==a){i.next=13;break}return i.next=11,regeneratorRuntime.awrap(m(o.query_result.query,r,n));case 11:i.next=15;break;case 13:return i.next=15,regeneratorRuntime.awrap(t(200,"bi","mysql_code",o.query_result.data,n));case 15:i.next=19;break;case 17:i.prev=17,i.t0=i.catch(0);case 19:case"end":return i.stop()}}),null,null,[[0,17]],Promise)},[t,m]),u=Object(r.useCallback)((function(e,r,n,o){var i,l,s,u,d=arguments;return regeneratorRuntime.async((function(m){for(;;)switch(m.prev=m.next){case 0:i=d.length>4&&void 0!==d[4]?d[4]:50,l=0,s=!1,u=setInterval(()=>{var d;return regeneratorRuntime.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(!(++l>i)){m.next=5;break}return clearInterval(u),a(),m.abrupt("return");case 5:return m.prev=5,m.next=8,regeneratorRuntime.awrap(B.get("/api/jobs/".concat(e.job.id)));case 8:if(!(d=m.sent).job.query_result_id||s){m.next=16;break}return s=!0,clearInterval(u),m.next=14,regeneratorRuntime.awrap(c(d,r,n,o));case 14:m.next=21;break;case 16:if(!d.job.error){m.next=21;break}return clearInterval(u),m.next=20,regeneratorRuntime.awrap(t(500,"bi","mysql_code",d.job.error,o));case 20:return m.abrupt("return");case 21:m.next=25;break;case 23:m.prev=23,m.t0=m.catch(5);case 25:case"end":return m.stop()}}),null,null,[[5,23]],Promise)},200);case 4:case"end":return m.stop()}}),null,null,null,Promise)}),[a,t,c]),d=Object(r.useCallback)((e,a)=>{var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r={id:e.id,parameters:{},apply_auto_limit:!0,max_age:0},o.prev=1,o.next=4,regeneratorRuntime.awrap(B.post("/api/queries/".concat(e.id,"/results"),r));case 4:return n=o.sent,o.next=7,regeneratorRuntime.awrap(u(n,"execute",null,a));case 7:o.next=13;break;case 9:return o.prev=9,o.t0=o.catch(1),o.next=13,regeneratorRuntime.awrap(t(500,"bi","mysql_code","",a));case 13:case"end":return o.stop()}}),null,null,[[1,9]],Promise)},[u,t]),m=Object(r.useCallback)((e,t,a)=>{var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r={data_source_id:s.current,latest_query_data_id:null,name:t,options:{apply_auto_limit:!0,parameters:[]},query:e,schedule:null,tags:[]},o.prev=1,o.next=4,regeneratorRuntime.awrap(B.post("/api/queries",r));case 4:return n=o.sent,i(e=>kj(kj({},e),{},{sqlId:n.id})),o.next=8,regeneratorRuntime.awrap(d(n,a));case 8:o.next=12;break;case 10:o.prev=10,o.t0=o.catch(1);case 12:case"end":return o.stop()}}),null,null,[[1,10]],Promise)},[d]),p=Object(r.useCallback)((e,t,a)=>{var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r={apply_auto_limit:!0,data_source_id:s.current,max_age:0,parameters:{},query:e},o.prev=1,o.next=4,regeneratorRuntime.awrap(B.post("/api/query_results",r));case 4:return n=o.sent,o.next=7,regeneratorRuntime.awrap(u(n,"test",t,a));case 7:o.next=11;break;case 9:o.prev=9,o.t0=o.catch(1);case 11:case"end":return o.stop()}}),null,null,[[1,9]],Promise)},[u]);return{state:o,saveSql:m,executeSql:d,testAndVerifySql:p,findJob:u,findQueryResult:c,new_sql:l}})(u.current,Ie,_e),De=qe.new_sql,Re=qe.testAndVerifySql,Me=((e,t,a,n,o,i,l,s)=>{var c=Wj(Object(r.useState)({dashboard_id:null}),2),u=c[0],d=c[1],m=Object(r.useRef)(null);Object(r.useEffect)(()=>{l&&(m.current=l)},[l]);var p=Object(r.useCallback)((function(t){var a,r,n,o,l,s=arguments;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:null,r=s.length>2?s[2]:void 0,n=i.current,o={description:"",name:window.W_L.CHART,query_id:n,type:"CHART",options:{alignYAxesAtZero:!1,globalSeriesType:t[0].globalSeriesType,coefficient:1,columnMapping:t[0].columnMapping,dateTimeFormat:"DD/MM/YY HH:mm",direction:{type:"counterclockwise"},error_y:{type:"data",visible:!0},legend:{enabled:!0,placement:"auto",traceorder:"normal"},missingValuesAsZero:!0,numberFormat:"0,0[.]00000",percentFormat:"0[.]00%",series:{stacking:null,error_y:{type:"data",visible:!0}},seriesOptions:{},showDataLabels:!0,sizemode:"diameter",sortX:!1,textFormat:"",valuesOptions:{},xAxis:{type:"category",labels:{enabled:!0}},yAxis:[{type:"linear"},{type:"linear",opposite:!0}]}},c.prev=4,c.next=7,regeneratorRuntime.awrap(B.post("/api/visualizations",o));case 7:if(l=c.sent,"edit"!==a){c.next=13;break}return c.next=11,regeneratorRuntime.awrap(h(l,a,r));case 11:c.next=15;break;case 13:return c.next=15,regeneratorRuntime.awrap(f(null,r));case 15:c.next=21;break;case 17:return c.prev=17,c.t0=c.catch(4),c.next=21,regeneratorRuntime.awrap(e(500,"bi","chart_code",c.t0,r));case 21:case"end":return c.stop()}}),null,null,[[4,17]],Promise)}),[u,h,f]),f=Object(r.useCallback)((function(){var t,a,r,n,o,l,s=arguments;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:null,a=s.length>1?s[1]:void 0,console.log(a,"publishQuery"),console.log("new_sql.current===",i.current),r=i.current,n=n,o={id:r,is_draft:!0,version:1},c.prev=7,c.next=10,regeneratorRuntime.awrap(B.post("/api/queries/".concat(r),o));case 10:if(l=c.sent,console.log(l,"publishQuery_success"),!n||!n.dashboard_id){c.next=17;break}return c.next=15,regeneratorRuntime.awrap(h(l,t,a));case 15:c.next=19;break;case 17:return c.next=19,regeneratorRuntime.awrap(b(t,a));case 19:c.next=26;break;case 21:return c.prev=21,c.t0=c.catch(7),console.log(c.t0,"publishQuery_error"),c.next=26,regeneratorRuntime.awrap(e(500,"bi","chart_code",c.t0,a));case 26:case"end":return c.stop()}}),null,null,[[7,21]],Promise)}),[u,o,h,b,e]),g=e=>{var t;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(B.get("/api/dashboards?order&page=1&page_size=20&q=".concat(e)));case 2:(t=a.sent).results.length>0&&t.results.forEach((t,a)=>regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.name!==e){a.next=4;break}return a.next=3,regeneratorRuntime.awrap(B.delete("/api/dashboards/".concat(t.id)));case 3:a.sent;case 4:case"end":return a.stop()}}),null,null,null,Promise));case 4:case"end":return a.stop()}}),null,null,null,Promise)},b=Object(r.useCallback)((function(){var e,a,r,n,o=arguments;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:null,a=o.length>1?o[1]:void 0,r={name:window.W_L.temporary_dashboard},i.prev=3,i.next=6,regeneratorRuntime.awrap(g(window.W_L.temporary_dashboard));case 6:return i.next=8,regeneratorRuntime.awrap(B.post("/api/dashboards",r));case 8:return n=i.sent,t("dashboard_id",n.id),i.next=12,regeneratorRuntime.awrap(h(n,e,a));case 12:i.next=16;break;case 14:i.prev=14,i.t0=i.catch(3);case 16:case"end":return i.stop()}}),null,null,[[3,14]],Promise)}),[d,t,h]),h=Object(r.useCallback)((function(t){var a,r,o,i,l=arguments;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:null,r=l.length>2?l[2]:void 0,o=m.current?m.current:t.id,c.prev=3,c.next=6,regeneratorRuntime.awrap(B.get("/api/dashboards/".concat(o)));case 6:if(i=c.sent,"delete"!==a){c.next=10;break}return _(t,i,r),c.abrupt("return");case 10:if("ask_data"!==a){c.next=13;break}return O(i,a,r),c.abrupt("return");case 13:if("getPath"!==a&&"delGetPath"!==a){c.next=19;break}return c.next=16,regeneratorRuntime.awrap(e(200,"bi","getPath"===a?"chart_code":"delete_chart",i,r));case 16:return s(o),n(),c.abrupt("return");case 19:return c.next=21,regeneratorRuntime.awrap(y(i,a,r));case 21:c.next=25;break;case 23:c.prev=23,c.t0=c.catch(3);case 25:case"end":return c.stop()}}),null,null,[[3,23]],Promise)}),[u,d,e,_,O,a,n,y,t,s,m]),y=Object(r.useCallback)((e,t,a)=>{var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r=i.current,o.prev=1,o.next=4,regeneratorRuntime.awrap(B.get("/api/queries/".concat(r)));case 4:return n=o.sent,o.next=7,regeneratorRuntime.awrap(v(n,e,t,a));case 7:o.next=11;break;case 9:o.prev=9,o.t0=o.catch(1);case 11:case"end":return o.stop()}}),null,null,[[1,9]],Promise)},[u,v]),v=Object(r.useCallback)((e,t,a,r)=>{var n,o,i;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=m.current,o={created_at:new Date,dashboard_id:n,options:{isHidden:!1,parameterMappings:{},position:{autoHeight:!1,col:0,maxSizeX:6,maxSizeY:1e3,minSizeX:1,minSizeY:5,row:0,sizeX:6,sizeY:12}},text:"",visualization_id:e.visualizations[e.visualizations.length-1].id,width:1},l.prev=2,l.next=5,regeneratorRuntime.awrap(B.post("/api/widgets",o));case 5:return i=l.sent,l.next=8,regeneratorRuntime.awrap(w(i,t,a,r));case 8:l.next=12;break;case 10:l.prev=10,l.t0=l.catch(2);case 12:case"end":return l.stop()}}),null,null,[[2,10]],Promise)},[u,w]),w=Object(r.useCallback)((e,t,a,r)=>{var n,o,i;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:return(n=e.options).position.row=12*t.widgets.length,o={dashboard_id:e.dashboard_id,id:e.id,options:n,text:"",visualization_id:e.visualization.id,width:1},l.prev=3,l.next=6,regeneratorRuntime.awrap(B.post("/api/widgets/".concat(e.id),o));case 6:return i=l.sent,l.next=9,regeneratorRuntime.awrap(O(i,a,r));case 9:l.next=14;break;case 11:l.prev=11,l.t0=l.catch(3),console.log(l.t0,"saveReport_error");case 14:case"end":return l.stop()}}),null,null,[[3,11]],Promise)},[O]),O=Object(r.useCallback)((t,a,r)=>{var o,l,c,u,d;return regeneratorRuntime.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(o=m.current,l=i.current,p.prev=2,"ask_data"!==a){p.next=8;break}return c=[],u=t.widgets.map((e,t)=>{var a;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(B.get("/api/queries/".concat(e.visualization.query.id,"/results/").concat(e.visualization.query.latest_query_data_id,".json")));case 2:a=t.sent,c.push({data:a.query_result.data,table_name:e.visualization.query.name});case 4:case"end":return t.stop()}}),null,null,null,Promise)}),Promise.all(u).then(t=>regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(e(200,"bi","ask_data",c,r));case 2:case"end":return t.stop()}}),null,null,null,Promise)),p.abrupt("return");case 8:return p.next=10,regeneratorRuntime.awrap(B.get("/api/queries/".concat(l,"/results/").concat(t.visualization.query.latest_query_data_id,".json")));case 10:if(d=p.sent,"edit"===a){p.next=18;break}return s(o),p.next=15,regeneratorRuntime.awrap(e(200,"bi","chart_code",d,r));case 15:n(),p.next=19;break;case 18:h(d,"getPath",r);case 19:p.next=23;break;case 21:p.prev=21,p.t0=p.catch(2);case 23:case"end":return p.stop()}}),null,null,[[2,21]],Promise)},[u,e,i,h]),_=Object(r.useCallback)((e,t,a)=>{var r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:try{r=t.widgets.map((t,a)=>regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.includes(t.visualization.query.name)){a.next=3;break}return a.next=3,regeneratorRuntime.awrap(B.delete("/api/widgets/".concat(t.id)));case 3:case"end":return a.stop()}}),null,null,null,Promise)),Promise.all(r).then(e=>{h(e,"delGetPath",a)})}catch(e){}case 1:case"end":return n.stop()}}),null,null,null,Promise)},[h]);return{DashId:m,saveChart:p,dashboardsId:h,publishQuery:f}})(Ie,ye,e,Se,p.current,De,g,Ae),ze=Me.saveChart,Fe=Me.dashboardsId,Ve=Me.publishQuery,Ue=qj(),Be=Ue.setDialogueStorageDashboardId,He=Ue.addDashboard,Ye=Ue.getDashboard,Qe=Ue.addDialogueStorage,Ke=Ue.getDialogueStorage,Ge=Ue.addChatList,$e=Ue.getAllStorage,Je=Ue.addAutopilotStorage,Xe=ie.messages;return n.a.createElement(ES.Provider,{value:{cancelRequest:Ne}},n.a.createElement("div",{className:"dialogue-content"},n.a.createElement(Dj,{loadingMask:k,Charttable:y,CharttableItem:d.current,closeDialogue:()=>{ge(),"report"===t?He([]):"chat"===t?Qe([]):"autopilot"===t&&Je([]),l.current.sourceEdit([]),se("report")},chat_type:t}),O&&n.a.createElement(DS,null),n.a.createElement(qS,{databases_type:U,ref:l,Charttable:y,onUse:Ee,sendTableDate:x,onChange:he,confirmLoading:F,loadingMask:k,messages:Xe,ChangeScrollTop:Pe,loadingState:O,stopSend:Le,inputMessage:ae,setInputMessage:re,handleSendMessage:Oe,chat_type:t,retry:Te,onOpenKeyClick:We,onSuccess:ue,percent:Q,sourceTypeRef:U})))},QS=(a(1405),a(723)),KS=a.n(QS);function GS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $S(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $S(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var JS=e=>{var t=GS(Object(r.useState)([]),2),a=t[0],o=t[1],i=GS(Object(r.useState)(""),2),l=i[0],s=i[1];Object(r.useEffect)(()=>{o(JSON.parse(localStorage.getItem("Chart_All"))||[])},[]);var c=t=>()=>{s(t.uuid),e.switchMode(t)};return n.a.createElement(n.a.Fragment,null,a&&a.length>0&&n.a.createElement("div",{className:"dia-main"},n.a.createElement(()=>n.a.createElement("div",{className:"dia-top"},n.a.createElement("img",{src:vt.a,alt:""}),n.a.createElement("span",null,"DeepBI")),null),n.a.createElement(()=>n.a.createElement("div",{className:"dia-content"},a.map((e,t)=>n.a.createElement("div",{className:"flex-d dia-info",key:t},n.a.createElement("div",{className:"dia-chats"},n.a.createElement("div",{className:"dia-chat",onClick:c(e)},n.a.createElement(KS.a,{style:{color:l===e.uuid?"#4974d1":"#fff",fontSize:"21px"}}),n.a.createElement("div",{className:"dia-chat-name"},e.messages[1].content||e.title)))))),null)))};var XS=function(e){var t=e.chatType;return n.a.createElement("div",{style:{flex:"1 1 0%",overflow:"auto",display:"flex",flexDirection:"column",justifyContent:"center"}},n.a.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNDEiIHZpZXdCb3g9IjAgMCA2NCA0MSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAxKSIgZmlsbD0ibm9uZSIgZmlsbFJ1bGU9ImV2ZW5vZGQiPg0KICAgIDxlbGxpcHNlIGZpbGw9IiNkZGQiIGN4PSIzMiIgY3k9IjMzIiByeD0iMzIiIHJ5PSI3IiAvPg0KICAgIDxnIGZpbGxSdWxlPSJub256ZXJvIiBzdHJva2U9IiM5OTkiPg0KICAgICAgPHBhdGgNCiAgICAgICAgZD0iTTU1IDEyLjc2TDQ0Ljg1NCAxLjI1OEM0NC4zNjcuNDc0IDQzLjY1NiAwIDQyLjkwNyAwSDIxLjA5M2MtLjc0OSAwLTEuNDYuNDc0LTEuOTQ3IDEuMjU3TDkgMTIuNzYxVjIyaDQ2di05LjI0eiIgLz4NCiAgICAgIDxwYXRoDQogICAgICAgIGQ9Ik00MS42MTMgMTUuOTMxYzAtMS42MDUuOTk0LTIuOTMgMi4yMjctMi45MzFINTV2MTguMTM3QzU1IDMzLjI2IDUzLjY4IDM1IDUyLjA1IDM1aC00MC4xQzEwLjMyIDM1IDkgMzMuMjU5IDkgMzEuMTM3VjEzaDExLjE2YzEuMjMzIDAgMi4yMjcgMS4zMjMgMi4yMjcgMi45Mjh2LjAyMmMwIDEuNjA1IDEuMDA1IDIuOTAxIDIuMjM3IDIuOTAxaDE0Ljc1MmMxLjIzMiAwIDIuMjM3LTEuMzA4IDIuMjM3LTIuOTEzdi0uMDA3eiINCiAgICAgICAgZmlsbD0iI2UxZTFlMSIgLz4NCiAgICA8L2c+DQogIDwvZz4NCjwvc3ZnPg==",alt:"noData",style:{width:"120px",height:"120px",margin:"0 auto"}}),n.a.createElement("p",{style:{textAlign:"center",marginTop:"20px",fontSize:"14px",fontWeight:"bold"}},"report"===t?window.W_L.start_your_dialogue:window.W_L.no_dialogue))};a(398);function ZS(){return(ZS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function eC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return tC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function aC(e){var t=e.chatType,a=eC(n.a.useState(""),2),r=a[0],o=a[1],i=eC(n.a.useState(0),2),l=i[0],s=i[1],c=eC(n.a.useState(""),2),u=c[0],d=c[1],m=eC(n.a.useState(!1),2),p=m[0],f=m[1];return n.a.createElement("div",{className:"page-alerts-list"},"viewConversation"===t&&n.a.createElement(JS,{chat_type:t,switchMode:e=>{d(e.uuid)}}),n.a.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1,position:"relative",background:"rgb(250, 250, 250)",overflow:"auto"}},"viewConversation"!==t||u?n.a.createElement(YS,{chat_type:t,sendUrl:e=>{if("new_report"===e)return f(!0),o(""),void s(e=>e+1);f(!1),o(e),s(e=>e+1)},key:t,uuid:u}):n.a.createElement(XS,{chatType:t})),"report"===t&&r?n.a.createElement("div",{style:{flex:"1",overflow:"auto"},className:"dashbord_page"},n.a.createElement(xj,{key:l,isShowReport:!1,dashboardId:r,dashboardSlug:"-",onError:()=>{}})):null,"report"===t&&p&&n.a.createElement(XS,{chatType:t}))}function rC(){return(rC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function nC(e){return n.a.createElement("div",{className:"text-center"},n.a.createElement(xe,rC({icon:"fa-search",message:window.W_L.find_nothing},e)))}rf.register("Dialogue.List.autopilot",Zt({path:"/autopilot",title:"autopilot",render:e=>n.a.createElement(aC,ZS({},e,{chatType:"autopilot"}))})),rf.register("Dialogue.List.Dialogue",Zt({path:"/dialogue-list",title:"Dialogue",render:e=>n.a.createElement(aC,ZS({},e,{chatType:"viewConversation"}))})),rf.register("Dialogue.List.Report",Zt({path:"/report-route",title:"Report",render:e=>n.a.createElement(aC,ZS({},e,{chatType:"report"}))})),rf.register("Dialogue.List",Zt({path:"/",title:window.W_L.dialogue,render:e=>n.a.createElement(aC,ZS({},e,{currentPage:"testdialogue",chatType:"chat"}))}));a(1408);function oC(){return(oC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function iC(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var lC={className:ae.a.string,children:ae.a.node},sC={className:null,children:null};function cC(e){var t=e.className,a=e.children,r=iC(e,["className","children"]);return n.a.createElement("div",oC({className:me()("layout-sidebar",t)},r),n.a.createElement("div",null,a))}function uC(e){var t=e.className,a=e.children,r=iC(e,["className","children"]);return n.a.createElement("div",oC({className:me()("layout-content",t)},r),n.a.createElement("div",null,a))}function dC(e){var t=e.children,a=e.className,r=void 0===a?void 0:a,o=iC(e,["children","className"]);return n.a.createElement("div",oC({className:me()("layout-with-sidebar",r)},o),t)}cC.propTypes=lC,cC.defaultProps=sC,uC.propTypes=lC,uC.defaultProps=sC,dC.propTypes=lC,dC.defaultProps=sC,dC.Sidebar=cC,dC.Content=uC;var mC=a(248),pC=a.n(mC);function fC(){return(fC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function gC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function hC(){var e=gC(Object(r.useState)([]),2),t=e[0],a=e[1],o=gC(Object(r.useState)(!0),2),i=o[0],l=o[1],s=[{title:window.W_L.name,dataIndex:"report_name",width:null,align:"center",render:(e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(h,{className:"table-main-title",href:"autopilot/"+t.id},t.report_name))},{title:window.W_L.create_time,dataIndex:"created_at",align:"center"},{title:window.W_L.task_status,dataIndex:"is_generate",align:"center",render:(e,t)=>n.a.createElement(n.a.Fragment,null,0===t.is_generate&&n.a.createElement(DO.a,{color:"gold"},window.W_L.waiting),1===t.is_generate&&n.a.createElement(DO.a,{color:"blue"},window.W_L.generating),2===t.is_generate&&n.a.createElement(DO.a,{color:"green"},window.W_L.success),-1===t.is_generate&&n.a.createElement(DO.a,{color:"red"},window.W_L.fail))},{title:"",dataIndex:"actions",width:50,align:"center",render:(e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(pC.a,{style:{color:"#f08282",fontSize:"15px"},onClick:()=>c(t.id)}))}],c=e=>regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:R.a.confirm({title:window.W_L.confirm_delete,content:window.W_L.confirm_delete_tip,onOk:()=>regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,regeneratorRuntime.awrap(B.delete("/api/auto_pilot/delete/".concat(e)));case 3:200===t.sent.code?(XE.a.success(window.W_L.delete_success),u()):XE.a.error(window.W_L.delete_fail),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),null,null,[[0,7]],Promise),onCancel(){}});case 1:case"end":return t.stop()}}),null,null,null,Promise),u=()=>{var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),t.next=3,regeneratorRuntime.awrap(B.get("/api/auto_pilot"));case 3:200===(e=t.sent).code&&(e.data.sort((function(e,t){return Date.parse(t.created_at)-Date.parse(e.created_at)})),a(e.data)),l(!1);case 6:case"end":return t.stop()}}),null,null,null,Promise)};return Object(r.useEffect)(()=>{u()},[]),n.a.createElement("div",{className:"page-queries-list"},n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:window.W_L.all_autopilot,actions:n.a.createElement(h.Button,{block:!0,type:"primary",href:"autopilot"},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.auto_pilot)}),n.a.createElement(dC,null,n.a.createElement(dC.Content,null,n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(Il.a,{className:"table-data",rowKey:"id",size:"middle",columns:s,dataSource:t,pagination:!1,loading:i,locale:{emptyText:n.a.createElement(nC,{className:""})}})))))))}rf.register("Dialogue.List.autopilot_list",Zt({path:"/autopilot_list",title:"autopilot_list",render:e=>n.a.createElement(hC,fC({},e,{chatType:"autopilot"}))}));a(1411);var yC=a(307),vC=a.n(yC),wC=a(428);function OC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _C(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _C(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}a(1412);var EC=Object(r.memo)(e=>{var t=e.title,a=e.content,o=Object(r.useRef)(null);Object(r.useEffect)(()=>{if(a){var e=a,t=document.createElement("div");t.innerHTML=e,o.current.append(t);try{t.querySelectorAll("script").forEach(e=>{window.eval(e.innerText)})}catch(e){}}},[a]);var i=(()=>{var e=OC(Object(r.useState)(!1),2),t=e[0],a=e[1];return{loading:t,exportPDF:(e,t)=>{var r,n,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:t&&(a(!0),r=t.offsetWidth/4,n=t.offsetHeight/4,14400,n>14400&&(o=14400/n,n=14400,r*=o),vC()(t,{scale:2,useCORS:!0,allowTaint:!1,ignoreElements:e=>"ignoreBtnElement"===e.id}).then(t=>{var o,i=t.getContext("2d");i&&(i.mozImageSmoothingEnabled=!1,i.webkitImageSmoothingEnabled=!1,i.msImageSmoothingEnabled=!1,i.imageSmoothingEnabled=!1);var l=t.toDataURL("image/webp",.7),s=new Image;s.src=l,s.onload=function(){var t;s.width/=2,s.height/=2,s.style.transform="scale(0.5)",o=r>n?"l":"p",(t=new wC.default(o,"mm",[r,n])).addImage(l,"jpeg",0,0,r,n),t.save("".concat(e,".pdf")),a(!1)}}));case 1:case"end":return i.stop()}}),null,null,null,Promise)}}})(),l=i.loading,s=i.exportPDF;return n.a.createElement("div",{className:"auto_pilot"},n.a.createElement("div",{className:"auto_pilot_icon",onClick:()=>{s(t,o.current)}},n.a.createElement("svg",{t:"1701955188289",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3387",width:"2rem",height:"2rem"},n.a.createElement("path",{d:"M704 0H192c-35.328 0-64 28.672-64 64v320h576c35.328 0 64 28.672 64 64v415.744c0 35.328-28.672 64-64 64H128v31.744c0 35.328 28.672 64 64 64h768c35.328 0 64-28.672 64-64v-640L704 0z",fill:"#EAEAEA","p-id":"3388"}),n.a.createElement("path",{d:"M704 0v256c0 35.328 28.672 64 64 64h256L704 0z",fill:"#434854","p-id":"3389"}),n.a.createElement("path",{d:"M768 320l256 256V320z",opacity:".1","p-id":"3390"}),n.a.createElement("path",{d:"M704 832c0 17.92-14.336 31.744-31.744 31.744H31.744C13.824 863.744 0 849.408 0 832V480.256c0-17.92 14.336-31.744 31.744-31.744h640c17.92 0 31.744 14.336 31.744 31.744V832z",fill:"#CD4050","p-id":"3391"}),n.a.createElement("path",{d:"M192 544.256h-48.128c-8.704 0-15.872 7.168-15.872 15.872v192c0 8.704 7.168 15.872 15.872 15.872s15.872-7.168 15.872-15.872v-79.872h31.744c35.328 0 64-28.672 64-64s-28.16-64-63.488-64z m158.72 0c34.816 0 62.976 27.648 64 62.464v97.792c0 34.816-27.648 62.976-62.464 64h-49.664c-8.704 0-15.36-6.656-15.872-14.848V560.64c0-8.704 6.656-15.36 14.848-15.872h49.152z m227.328 0c8.704 0 15.872 7.168 15.872 15.872S586.752 576 578.048 576h-80.384v64h48.128c8.704 0 15.872 7.168 15.872 15.872s-7.168 15.872-15.872 15.872h-48.128v79.872c0 8.704-7.168 15.872-15.872 15.872s-15.872-7.168-15.872-15.872v-192c0-8.704 7.168-15.872 15.872-15.872h96.256zM350.72 576h-31.744v159.744h31.744c17.408 0 31.232-13.824 31.744-30.72v-97.28C382.976 590.336 368.64 576 350.72 576zM192 576c17.92 0 31.744 14.336 31.744 31.744S209.92 640 192 640h-31.744v-64H192z",fill:"#FFFFFF","p-id":"3392"})),n.a.createElement("p",null,window.W_L.download),l&&n.a.createElement(of.a,null)),n.a.createElement("div",{ref:o}))});function jC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return SC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return SC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function CC(e){var t=jC(Object(r.useState)({}),2),a=t[0],o=t[1],i=jC(Object(r.useState)(!0),2),l=i[0],s=i[1];return Object(r.useEffect)(()=>{var t,a;t=e.autopilotId,regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(B.get("/api/auto_pilot/".concat(t)));case 2:200===(a=e.sent).code?o(a.data):o({}),s(!1);case 5:case"end":return e.stop()}}),null,null,null,Promise)},[]),n.a.createElement("div",{className:"auto-pilot-list"},n.a.createElement(Of.a,{loading:l,active:!0,paragraph:{rows:10}},n.a.createElement("div",{className:"message"},n.a.createElement("div",{className:"auto-pilot"},n.a.createElement("div",{className:"chat user autopilot-item"},n.a.createElement("p",null,window.W_L.report_name,":",a.report_name),n.a.createElement("p",null,window.W_L.report_desc,":",a.report_desc),n.a.createElement(wS,{Cardloading:!1,logData:a.chat_log}),a.html_code?n.a.createElement(EC,{title:a.report_name,content:a.html_code}):n.a.createElement("div",{style:{textAlign:"center",marginTop:"50px"}},n.a.createElement("svg",{t:"1701954689007",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1988",width:"200",height:"200"},n.a.createElement("path",{d:"M777 806.7c0 38.7-31.1 70.3-69.7 70.3H225.9c-38.7 0-69.9-31.6-69.9-70.3V174.4c0-38.7 31.2-70.4 69.9-70.4h481.4c38.7 0 69.7 31.7 69.7 70.4v632.3z",fill:"#FFFFFF","p-id":"1989"}),n.a.createElement("path",{d:"M707.3 886H225.9c-43.5 0-78.9-35.8-78.9-79.3V174.4c0-43.5 35.4-79.4 78.9-79.4h481.4c43.5 0 79.7 35.9 79.7 79.4v632.3c0 43.5-36.2 79.3-79.7 79.3zM225.9 113c-33.7 0-59.9 27.7-59.9 61.4v632.3c0 33.7 26.2 61.3 59.9 61.3h481.4c33.7 0 60.7-27.6 60.7-61.3V174.4c0-33.7-27-61.4-60.7-61.4H225.9z",fill:"#282828","p-id":"1990"}),n.a.createElement("path",{d:"M732 763.1c0 33.3-26.1 60.9-59.4 60.9H251.7c-33.3 0-59.7-27.6-59.7-60.9V226.9c0-33.3 26.4-60.9 59.7-60.9h420.9c33.3 0 59.4 27.5 59.4 60.9v536.2z",fill:"#50BCFF","p-id":"1991"}),n.a.createElement("path",{d:"M361.8 251.9H208.6c-4.9 0-8.9-4-8.9-8.9s4-8.9 8.9-8.9h153.1c4.9 0 8.9 4 8.9 8.9s-3.9 8.9-8.8 8.9zM549.2 313H208.6c-4.9 0-8.9-4-8.9-8.9s4-8.9 8.9-8.9h340.5c4.9 0 8.9 4 8.9 8.9s-3.9 8.9-8.8 8.9zM652 448.4H208.6c-4.9 0-8.9-4-8.9-8.9s4-8.9 8.9-8.9H652c4.9 0 8.9 4 8.9 8.9s-4 8.9-8.9 8.9zM588.4 515.8H208.6c-4.9 0-8.9-4-8.9-8.9s4-8.9 8.9-8.9h379.7c4.9 0 8.9 4 8.9 8.9 0.1 4.9-3.9 8.9-8.8 8.9z",fill:"#282828","p-id":"1992"}),n.a.createElement("path",{d:"M673.3 113.3c0 19.6-15.9 35.5-35.5 35.5h-346c-19.6 0-35.5-15.9-35.5-35.5v-6.7c0-19.6 15.9-35.5 35.5-35.5h346c19.6 0 35.5 15.9 35.5 35.5v6.7z",fill:"#1A6DFF","p-id":"1993"}),n.a.createElement("path",{d:"M637.8 157.6h-346c-24.5 0-44.4-19.9-44.4-44.4v-6.7c0-24.5 19.9-44.4 44.4-44.4h346c24.5 0 44.4 19.9 44.4 44.4v6.7c0 24.5-19.9 44.4-44.4 44.4zM291.9 80c-14.7 0-26.6 11.9-26.6 26.6v6.7c0 14.7 11.9 26.6 26.6 26.6h346c14.7 0 26.6-11.9 26.6-26.6v-6.7c0-14.7-11.9-26.6-26.6-26.6h-346z",fill:"#282828","p-id":"1994"}),n.a.createElement("path",{d:"M849.7 758.4c0 106.3-86.2 192.4-192.4 192.4-106.3 0-192.4-86.2-192.4-192.4C464.8 652.1 551 566 657.3 566c106.2 0 192.4 86.1 192.4 192.4z",fill:"#FFFFFF","p-id":"1995"}),n.a.createElement("path",{d:"M657.3 959.7c-111 0-201.3-90.3-201.3-201.3s90.3-201.3 201.3-201.3 201.3 90.3 201.3 201.3-90.3 201.3-201.3 201.3z m0-384.8c-101.2 0-183.5 82.3-183.5 183.5S556.1 942 657.3 942s183.6-82.3 183.6-183.6c-0.1-101.2-82.4-183.5-183.6-183.5z",fill:"#282828","p-id":"1996"}),n.a.createElement("path",{d:"M657.3 553.6v204.9h203.6c-0.2-112.7-91.2-204-203.6-204.9z",fill:"#1A6DFF","p-id":"1997"}),n.a.createElement("path",{d:"M860.9 767.3H657.3c-4.9 0-8.9-4-8.9-8.9V553.6c0-2.4 0.9-4.6 2.6-6.3 1.7-1.7 3.6-2.4 6.3-2.6 116.9 0.9 212.2 96.8 212.4 213.7 0 2.4-0.9 4.6-2.6 6.3-1.6 1.7-3.9 2.6-6.2 2.6z m-194.8-17.8h185.6C847 649.3 766.2 568 666.1 562.7v186.8z",fill:"#282828","p-id":"1998"}),n.a.createElement("path",{d:"M794.1 903.7c-2.3 0-4.6-0.9-6.3-2.6L652.1 764.7c-3.5-3.5-3.4-9.1 0-12.6 3.5-3.5 9.1-3.4 12.6 0l135.7 136.5c3.5 3.5 3.4 9.1 0 12.6-1.8 1.7-4 2.5-6.3 2.5z",fill:"#282828","p-id":"1999"})),n.a.createElement("p",{style:{marginTop:"20px"}},window.W_L.task_processing)))))))}function xC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return PC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return PC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function LC(){var e=Object(r.useRef)(),t=xC(Object(r.useState)([]),2),a=t[0],o=t[1],i=xC(Object(r.useState)(!0),2),l=i[0],s=i[1],c=[{title:window.W_L.name,dataIndex:"report_name",width:null,align:"center",render:(e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"table-main-title",style:{color:"#2196f3",cursor:"pointer"},onClick:()=>u(t)},t.report_name))},{title:window.W_L.create_time,dataIndex:"created_at",align:"center"},{title:window.W_L.task_status,dataIndex:"is_generate",align:"center",render:(e,t)=>n.a.createElement(n.a.Fragment,null,0===t.is_generate&&n.a.createElement(DO.a,{color:"gold"},window.W_L.waiting),1===t.is_generate&&n.a.createElement(DO.a,{color:"blue"},window.W_L.generating),2===t.is_generate&&n.a.createElement(DO.a,{color:"green"},window.W_L.success),-1===t.is_generate&&n.a.createElement(DO.a,{color:"red"},window.W_L.fail))},{title:"",dataIndex:"actions",width:50,align:"center",render:(e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(pC.a,{style:{color:"#f08282",fontSize:"15px"},onClick:()=>d(t.id)}))}],u=e=>{var t,a;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(2!==e.is_generate||!e.html_name){r.next=6;break}t=e.html_name.split(".")[0],a=window.location.protocol+"//"+window.location.host+"/pretty_dashboard/"+t,window.open(a),r.next=16;break;case 6:r.t0=e.is_generate,r.next=0===r.t0?9:1===r.t0?11:-1===r.t0?13:15;break;case 9:return XE.a.error(window.W_L.waiting),r.abrupt("break",16);case 11:return XE.a.error(window.W_L.generating),r.abrupt("break",16);case 13:return XE.a.error(window.W_L.fail),r.abrupt("break",16);case 15:return r.abrupt("break",16);case 16:case"end":return r.stop()}}),null,null,null,Promise)},d=e=>regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:R.a.confirm({title:window.W_L.confirm_delete,content:window.W_L.confirm_delete_tip,onOk:()=>regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,regeneratorRuntime.awrap(B.delete("/api/pretty_dashboard/delete/".concat(e)));case 3:200===t.sent.code?(XE.a.success(window.W_L.delete_success),m()):XE.a.error(window.W_L.delete_fail),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),null,null,[[0,7]],Promise),onCancel(){}});case 1:case"end":return t.stop()}}),null,null,null,Promise),m=()=>{var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return s(!0),t.next=3,regeneratorRuntime.awrap(B.get("/api/pretty_dashboard"));case 3:200===(e=t.sent).code&&(e.data.sort((function(e,t){return Date.parse(t.created_at)-Date.parse(e.created_at)})),o(e.data)),s(!1);case 6:case"end":return t.stop()}}),null,null,null,Promise)};Object(r.useEffect)(()=>{m()},[]);return n.a.createElement("div",{className:"page-queries-list"},n.a.createElement(uj,{ref:e}),n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:window.W_L.dashboards_prettify_all}),n.a.createElement(dC,null,n.a.createElement(dC.Content,null,n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(Il.a,{className:"table-data",rowKey:"id",size:"middle",columns:c,dataSource:a,pagination:!1,loading:l,locale:{emptyText:n.a.createElement(nC,{className:""})}})))))))}rf.register("Dialogue.List.autopilot_view",Zt({path:"/autopilot/:autopilotId",render:e=>n.a.createElement(CC,e)})),rf.register("Dialogue.List.dashboards_prettify",Zt({path:"/dashboards_prettify",title:"dashboards_prettify",render:e=>n.a.createElement(LC,e)}));a(1413);function kC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return NC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return NC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var AC=function(e){var t=e.tagsUrl,a=e.showUnselectAll,o=void 0!==a&&a,i=e.onUpdate,s=kC(Object(r.useState)([]),2),c=s[0],u=s[1],d=kC(Object(r.useState)([]),2),m=d[0],p=d[1];Object(r.useEffect)(()=>{var e=!1;return $E(t).then(t=>{e||u(t)}),()=>{e=!0}},[t]);var f=Object(r.useCallback)((e,t)=>{var a;a=e.shiftKey?Object(l.includes)(m,t)?Object(l.difference)(m,[t]):[...m,t]:Object(l.includes)(m,t)&&1===m.length?[]:[t],p(a),i&&i([...a])},[m,i]),g=Object(r.useCallback)(()=>{p([]),i&&i([])},[i]);return 0===c.length?null:n.a.createElement("div",{className:"tags-list"},n.a.createElement("div",{className:"tags-list-title"},n.a.createElement("span",{className:"tags-list-label"},window.W_L.tag),o&&m.length>0&&n.a.createElement(ge,{type:"link",onClick:g},n.a.createElement(je.a,null),"clear selection")),n.a.createElement("div",{className:"tiled"},n.a.createElement(ue.a,{className:"invert-stripe-position",mode:"inline",selectedKeys:m},Object(l.map)(c,e=>n.a.createElement(ue.a.Item,{key:e.name,className:"m-0"},n.a.createElement(ge,{className:"d-flex align-items-center justify-content-between",onClick:t=>f(t,e.name)},n.a.createElement("span",{className:"max-character col-xs-11"},e.name),n.a.createElement(hf.a,{count:e.count})))))))};function TC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return WC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return WC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function IC(e){var t=e.placeholder,a=e.value,o=e.showIcon,i=e.onChange,l=e.label,s=TC(Object(r.useState)(a),2),c=s[0],u=s[1];Object(r.useEffect)(()=>{u(a)},[a]);var d=Object(r.useCallback)(e=>{var t=e.target.value;u(t),i(t)},[i]),m=o?ta.a.Search:ta.a;return n.a.createElement("div",{className:"m-b-10"},n.a.createElement(m,{className:"form-control",placeholder:t,value:c,"aria-label":l,onChange:d}))}function qC(e){var t=e.items,a=e.selected;return 0===(t=Object(l.filter)(t,e=>!Object(l.isFunction)(e.isAvailable)||e.isAvailable())).length?null:n.a.createElement("div",{className:"m-b-10 tags-list tiled"},n.a.createElement(ue.a,{className:"invert-stripe-position",mode:"inline",selectable:!1,selectedKeys:[a]},Object(l.map)(t,e=>n.a.createElement(ue.a.Item,{key:e.key,className:"m-0"},n.a.createElement(h,{href:e.href},Object(l.isString)(e.icon)&&""!==e.icon&&n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:e.icon,"aria-hidden":"true"})),Object(l.isFunction)(e.icon)&&(e.icon(e)||null),e.title)))))}function DC(e){var t=e.icon;return n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:t,"aria-hidden":"true"}))}function RC(e){var t=e.user;return Object(l.isString)(t.profile_image_url)&&""!==t.profile_image_url?n.a.createElement("img",{src:t.profile_image_url,className:"profile__image--sidebar m-r-5",width:"13",alt:t.name}):null}function MC(e){var t=e.url,a=e.onChange,r=e.showUnselectAll;return""===t?null:n.a.createElement("div",{className:"m-b-10"},n.a.createElement(AC,{tagsUrl:t,onUpdate:a,showUnselectAll:r}))}function zC(){return(zC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function FC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return VC(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return VC(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VC(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function UC(e,t,a){var o=FC(Object(r.useState)({isAvailable:!1}),2),i=o[0],s=o[1],c=FC(Object(r.useState)([]),2),u=c[0],d=c[1];Object(r.useEffect)(()=>{d([])},[e.pageItems,i.isAvailable]);var m=Object(r.useMemo)(()=>{var t=e.pageItems;return 0!==t.length&&0!==u.length&&Object(l.intersection)(u,t).length===t.length},[u,e.pageItems]),p=Object(r.useCallback)(()=>{d(m?[]:e.pageItems)},[m,e.pageItems]),f=Object(r.useCallback)(e=>{Object(l.includes)(u,e)?d(Object(l.filter)(u,t=>t!==e)):d([...u,e])},[u]),g=Object(r.useMemo)(()=>ng.custom((e,t)=>n.a.createElement($r.a,{checked:Object(l.includes)(u,t),onChange:()=>f(t)}),{title:()=>n.a.createElement($r.a,{checked:m,onChange:p}),field:"id",width:"1%"}),[u,m,p,f]),b=Object(r.useCallback)((function(e){return a?n.a.createElement(a,zC({onStateChange:s},e)):null}),[a]);return Object(r.useMemo)(()=>({areExtraActionsAvailable:i.isAvailable,listColumns:i.isAvailable?[g,...t]:t,Component:b,selectedItems:u,setSelectedItems:d}),[i,t,g,u,b])}function BC(e){var t=e.objectType,a=e.tags;return n.a.createElement(xe,{icon:"fa-tags"},"No ",t," found tagged with ",n.a.createElement(Ng,{className:"inline-tags-control",tags:Array.from(a),tagSeparator:"+"}),".")}function HC(e){var t=e.page,a=e.searchTerm,n=e.selectedTags;if(""!==a)return r.createElement(xe,{message:window.W_L.find_nothing,icon:"fa-search"});if(n.length>0)return r.createElement(BC,{objectType:"dashboards",tags:n});switch(t){case"favorites":return r.createElement(xe,{message:window.W_L.show_my_favorite_dashboard,icon:"fa-star"});case"my":var o=H.hasPermission("create_dashboard")?r.createElement("span",null,r.createElement(m.a,{type:"primary",size:"small",onClick:()=>Tp.showModal()},window.W_L.create_first_dashboard)," ",r.createElement(Ge,{className:"f-14",type:"DASHBOARDS",showTooltip:!1},window.W_L.need_help,"?")):r.createElement("span",null,window.W_L.no_data);return r.createElement(xe,{icon:"fa-search"},o);default:return r.createElement(se,{name:"DashboardList.EmptyState"},r.createElement(Rp,{icon:"zmdi zmdi-view-quilt",description:window.W_L.see_big_picture,illustration:"dashboard",helpMessage:r.createElement(qp,{helpTriggerType:"DASHBOARDS"}),showDashboardStep:!0}))}}IC.propTypes={value:ae.a.string.isRequired,placeholder:ae.a.string,showIcon:ae.a.bool,onChange:ae.a.func.isRequired,label:ae.a.string},IC.defaultProps={placeholder:window.W_L.search,showIcon:!1,label:"Search"},qC.propTypes={items:ae.a.arrayOf(ae.a.shape({key:ae.a.string.isRequired,href:ae.a.string.isRequired,title:ae.a.string.isRequired,icon:ae.a.func,isAvailable:ae.a.func})),selected:ae.a.string},qC.defaultProps={items:[],selected:null},DC.propTypes={icon:ae.a.string.isRequired},RC.propTypes={user:ae.a.shape({profile_image_url:ae.a.string,name:ae.a.string}).isRequired},MC.propTypes={url:ae.a.string.isRequired,onChange:ae.a.func.isRequired,showUnselectAll:ae.a.bool,unselectAllButtonTitle:ae.a.string},BC.propTypes={objectType:ae.a.string.isRequired,tags:ae.a.oneOfType([ae.a.array,ae.a.objectOf(Set)]).isRequired},HC.propTypes={page:te.string.isRequired,searchTerm:te.string.isRequired,selectedTags:te.array.isRequired};a(1414);function YC(){return(YC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var QC=[{key:"all",href:"dashboards",title:window.W_L.all_dashboard,icon:()=>n.a.createElement(DC,{icon:"zmdi zmdi-view-quilt"})},{key:"my",href:"dashboards/my",title:window.W_L.my_dashboard,icon:()=>n.a.createElement(RC,{user:H})},{key:"favorites",href:"dashboards/favorites",title:window.W_L.my_favorite_dashboard,icon:()=>n.a.createElement(DC,{icon:"fa fa-star"})}],KC=[ng.favorites({className:"p-r-0"}),ng.custom.sortable((e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(h,{className:"table-main-title",href:t.url,"data-test":"DashboardId".concat(t.id)},t.name),n.a.createElement(Wg,{className:"d-block",tags:t.tags,isDraft:t.is_draft,isArchived:t.is_archived})),{title:window.W_L.name,field:"name",width:null}),ng.custom((e,t)=>t.user.name,{title:window.W_L.create_user,width:"1%"}),ng.dateTime.sortable({title:window.W_L.create_time,field:"created_at",width:"1%"})];function GC(e){return n.a.createElement(se,YC({name:"DashboardList.Actions"},e))}function $C(e){var t=e.controller,a=UC(t,KC,GC),r=a.areExtraActionsAvailable,o=a.listColumns,i=a.Component,l=a.selectedItems,s=t.pageItems&&t.pageItems.length>0?t.pageItems.filter(e=>e.name!==window.W_L.temporary_dashboard):[];return n.a.createElement("div",{className:"page-dashboard-list"},n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:t.params.pageTitle,actions:H.hasPermission("create_dashboard")?n.a.createElement(m.a,{block:!0,type:"primary",onClick:()=>Tp.showModal()},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.create):null}),n.a.createElement(dC,null,n.a.createElement(dC.Sidebar,{className:"m-b-0"},n.a.createElement(IC,{placeholder:window.W_L.search_dashboard,label:window.W_L.search_dashboard,value:t.searchTerm,onChange:t.updateSearch}),n.a.createElement(qC,{items:QC,selected:t.params.currentPage}),n.a.createElement(MC,{url:"api/dashboards/tags",onChange:t.updateSelectedTags,showUnselectAll:!0})),n.a.createElement(dC.Content,null,n.a.createElement("div",{"data-test":"DashboardLayoutContent"},t.isLoaded&&t.isEmpty?n.a.createElement(HC,{page:t.params.currentPage,searchTerm:t.searchTerm,selectedTags:t.selectedTags}):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:me()({"m-b-10":r})},n.a.createElement(i,{selectedItems:l})),n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(og,{items:s,loading:!t.isLoaded,columns:o,orderByField:t.orderByField,orderByReverse:t.orderByReverse,toggleSorting:t.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:t.totalItemsCount,pageSize:t.itemsPerPage,onPageSizeChange:e=>t.updatePagination({itemsPerPage:e}),page:t.page,onChange:e=>t.updatePagination({page:e})}))))))))}$C.propTypes={controller:Bg.isRequired};var JC=Hg($C,()=>new ib({getResource(e){var t=e.params.currentPage;return{all:jp.query.bind(jp),my:jp.myDashboards.bind(jp),favorites:jp.favorites.bind(jp)}[t]},getItemProcessor:()=>e=>new jp(e)}),()=>new ub({orderByField:"created_at",orderByReverse:!0}));function XC(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function ZC(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ex(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ZC(Object(a),!0).forEach((function(t){tx(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ZC(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function tx(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ax(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return rx(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rx(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function nx(e){var t=e.apiKey,a=e.currentRoute,o=e.renderChildren,i=ax(Object(r.useState)(!1),2),l=i[0],s=i[1],c=Object(r.useContext)(_).handleError;return Object(r.useEffect)(()=>{var e=!1;return X.setApiKey(t),X.loadConfig().then(()=>{e||s(!0)}).catch(()=>{e||s(!1)}),()=>{e=!0}},[t]),!l||Y.disablePublicUrls?null:n.a.createElement(n.a.Fragment,{key:a.key},o(ex(ex({},a.routeParams),{},{pageTitle:a.title,onError:c,apiKey:t})))}function ox(e){var t=e.render,a=e.getApiKey;return ex(ex({},XC(e,["render","getApiKey"])),{},{render:e=>n.a.createElement(nx,{apiKey:a(e),currentRoute:e,renderChildren:t})})}rf.register("Dashboards.List",Zt({path:"/dashboards",title:window.W_L.dashboards,render:e=>n.a.createElement(JC,YC({},e,{currentPage:"all"}))})),rf.register("Dashboards.Favorites",Zt({path:"/dashboards/favorites",title:window.W_L.my_favorite_dashboard,render:e=>n.a.createElement(JC,YC({},e,{currentPage:"favorites"}))})),rf.register("Dashboards.My",Zt({path:"/dashboards/my",title:window.W_L.my_dashboard,render:e=>n.a.createElement(JC,YC({},e,{currentPage:"my"}))})),nx.propTypes={apiKey:ae.a.string.isRequired,renderChildren:ae.a.func},nx.defaultProps={renderChildren:()=>null};a(1415);function ix(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function lx(e){var t=e.dashboard,a=HE(t),r=a.globalParameters,o=a.filters,i=a.setFilters,s=a.refreshDashboard,c=a.loadWidget,u=a.refreshWidget;return n.a.createElement("div",{className:"container p-t-10 p-b-20"},n.a.createElement(ff,{title:t.name}),!Object(l.isEmpty)(r)&&n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled"},n.a.createElement(Tv,{parameters:r,onValuesChange:s})),!Object(l.isEmpty)(o)&&n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled"},n.a.createElement($v,{filters:o,onChange:i})),n.a.createElement("div",{id:"dashboard-container"},n.a.createElement(Y_,{dashboard:t,widgets:t.widgets,filters:o,isEditing:!1,isPublic:!0,onLoadWidget:c,onRefreshWidget:u})))}lx.propTypes={dashboard:ae.a.object.isRequired};class sx extends n.a.Component{constructor(){super(...arguments),ix(this,"state",{loading:!0,dashboard:null})}componentDidMount(){jp.getByToken({token:this.props.token}).then(e=>this.setState({dashboard:e,loading:!1})).catch(e=>this.props.onError(e))}render(){var e=this.state,t=e.loading,a=e.dashboard;return n.a.createElement("div",{className:"public-dashboard-page"},t?n.a.createElement("div",{className:"container loading-message"},n.a.createElement(xe,{className:"",icon:"fa-spinner fa-2x fa-pulse",message:"Loading..."})):n.a.createElement(lx,{dashboard:a}))}}ix(sx,"propTypes",{token:ae.a.string.isRequired,onError:ae.a.func}),ix(sx,"defaultProps",{onError:()=>{}}),rf.register("Dashboards.ViewShared",ox({path:"/public/dashboards/:token",render:e=>n.a.createElement(sx,e),getApiKey:e=>e.routeParams.token}));a(1416);function cx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ux(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ux(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ux(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function dx(){return(dx=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function mx(e){var t=e.item,a=e.keySuffix,r={key:"card".concat(a),className:"visual-card",onClick:t.onClick,children:n.a.createElement(n.a.Fragment,null,n.a.createElement("img",{alt:t.title,src:t.imgSrc}),n.a.createElement("h3",null,t.title))};return t.href?n.a.createElement(h,dx({href:t.href},r)):n.a.createElement(ge,dx({type:"link"},r))}function px(e){var t=e.items,a=void 0===t?[]:t,o=e.showSearch,i=void 0!==o&&o,s=cx(Object(r.useState)(""),2),c=s[0],u=s[1],d=a.filter(e=>Object(l.isEmpty)(c)||Object(l.includes)(e.title.toLowerCase(),c.toLowerCase()));return n.a.createElement("div",{"data-test":"CardsList"},i&&n.a.createElement("div",{className:"row p-10"},n.a.createElement("div",{className:"col-md-4 col-md-offset-4"},n.a.createElement(ta.a.Search,{placeholder:"{window.W_L.search}","aria-label":"{window.W_L.search}",onChange:e=>u(e.target.value),autoFocus:!0}))),Object(l.isEmpty)(d)?n.a.createElement(nC,{className:""}):n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-lg-12 d-inline-flex flex-wrap visual-card-list"},d.map((e,t)=>n.a.createElement(mx,{key:t,item:e,keySuffix:t.toString()})))))}px.propTypes={items:ae.a.arrayOf(ae.a.shape({title:ae.a.string.isRequired,imgSrc:ae.a.string.isRequired,onClick:ae.a.func,href:ae.a.string})),showSearch:ae.a.bool};var fx=a(436),gx=a.n(fx);function bx(){return(bx=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function hx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function yx(e){var t=e.collapsed,a=e.children,r=e.className,o=hx(e,["collapsed","children","className"]);return n.a.createElement(Om.a,bx({},o,{activeKey:t?null:"content",className:me()(r,"ant-collapse-headerless")}),n.a.createElement(Om.a.Panel,{key:"content",header:""},a))}function vx(e){var t=e.title,a=e.name;return t||Kf(a)}yx.propTypes={collapsed:ae.a.bool,children:ae.a.node,className:ae.a.string},yx.defaultProps={collapsed:!0,children:null,className:""};var wx=a(308),Ox=a.n(wx);a(1422);function _x(){return(_x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var Ex=Object(r.forwardRef)((function(e,t){return n.a.createElement("div",{className:"ace-editor-input","data-test":e["data-test"]},n.a.createElement(Ox.a,_x({ref:t,mode:"sql",theme:"textmate",height:"100px",editorProps:{$blockScrolling:1/0},showPrintMargin:!1},e)))}));function jx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Sx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Cx=a(322),xx=a.n(Cx),Px=a(323),Lx=a.n(Px);function kx(){return(kx=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Nx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Ax(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Tx(e){e.form,e.field;var t=Ax(e,["form","field"]);return n.a.createElement(ta.a,t)}function Wx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Ix(){return(Ix=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function qx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Dx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Rx(){return(Rx=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Mx(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function zx(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Mx(Object(a),!0).forEach((function(t){Fx(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Mx(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Fx(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Vx(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Ux=ae.a.shape({name:ae.a.string.isRequired,title:ae.a.string,type:ae.a.oneOf(["ace","text","textarea","email","password","number","checkbox","file","select","content"]).isRequired,initialValue:ae.a.oneOfType([ae.a.string,ae.a.number,ae.a.bool,ae.a.arrayOf(ae.a.string),ae.a.arrayOf(ae.a.number)]),content:ae.a.node,mode:ae.a.string,required:ae.a.bool,extra:ae.a.bool,readOnly:ae.a.bool,autoFocus:ae.a.bool,minLength:ae.a.number,placeholder:ae.a.string,contentAfter:ae.a.oneOfType([ae.a.node,ae.a.func]),loading:ae.a.bool,props:ae.a.object}),Bx={checkbox:function(e){e.form;var t=e.field,a=Sx(e,["form","field"]),r=vx(t);return n.a.createElement($r.a,a,r)},file:function(e){var t=e.form,a=e.field,r=Nx(e,["form","field"]),o=a.name,i=a.initialValue,l=t.getFieldValue,s=void 0!==l(o)&&l(o)!==i;return n.a.createElement(xx.a,kx({},r,{beforeUpload:()=>!1}),n.a.createElement(m.a,{disabled:s},n.a.createElement(Lx.a,null)," ",window.W_L.upload))},select:function(e){e.form;var t=e.field,a=qx(e,["form","field"]),r=t.readOnly;return n.a.createElement(Yr.a,Ix({},a,{optionFilterProp:"children",loading:t.loading||!1,mode:t.mode,getPopupContainer:e=>e.parentNode}),t.options&&t.options.map(e=>n.a.createElement(Yr.a.Option,{key:"".concat(e.value),value:e.value,disabled:r},e.name||e.value)))},number:function(e){e.form,e.field;var t=Wx(e,["form","field"]);return n.a.createElement(Kr.a,t)},textarea:function(e){e.form,e.field;var t=Dx(e,["form","field"]);return n.a.createElement(ta.a.TextArea,t)},ace:function(e){e.form,e.field;var t=jx(e,["form","field"]);return n.a.createElement(Ex,t)},content:function(e){return e.field.content}};function Hx(e){var t=e.form,a=e.field,r=Vx(e,["form","field"]),o=a.name,i=a.type,s=a.readOnly,c=a.autoFocus,u=vx(a),d=zx(zx({},a.props),{},{className:"w-100",name:o,type:i,readOnly:s,autoFocus:c,placeholder:a.placeholder,"data-test":u},r),m=Object(l.get)(Bx,i,Tx);return n.a.createElement(m,Rx({},d,{form:t,field:a}))}function Yx(e,t,a){var r=new Array(t.length);return Object.keys(e).forEach(n=>{var o=t.indexOf(n),i={name:n,title:e[n].title,type:e[n].type,placeholder:Object(l.isNil)(e[n].default)?null:e[n].default.toString(),required:e[n].required,extra:e[n].extra,initialValue:a[n]};"select"===i.type&&(i.placeholder="Select an option",i.options=e[n].options),o>-1?r[o]=i:r.push(i)}),r}function Qx(e){Object(l.each)(e.properties,(t,a)=>{"password"!==a&&"passwd"!==a||(t.type="password"),a.endsWith("File")&&(t.type="file"),"boolean"===t.type&&(t.type="checkbox"),"string"===t.type&&(t.type="text"),Object(l.isEmpty)(t.enum)||(t.type="select",t.options=Object(l.map)(t.enum,e=>({value:e,name:e}))),Object(l.isEmpty)(t.extendedEnum)||(t.type="select",t.options=t.extendedEnum),t.required=Object(l.includes)(e.required,a),t.extra=Object(l.includes)(e.extra_options,a)}),e.order=e.order||[]}function Kx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.properties;Object.keys(a).forEach(e=>{var r=a[e];if(Object(l.isUndefined)(r.default)||"checkbox"!==r.type||(t[e]=r.default),"select"===r.type){var n=Object(l.map)(r.options,e=>e.value);t[e]=Object(l.includes)(n,r.default)?r.default:n[0]}})}Hx.propTypes={field:Ux.isRequired};var Gx={getFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{options:{}},a=e.configuration_schema;Qx(a);var r=Object.keys(t.options).length>0;r||Kx(a,t.options);var o=!t.id,i=[{name:"name",title:window.W_L.name,type:"text",required:!0,initialValue:t.name,contentAfter:n.a.createElement("hr"),placeholder:"My ".concat(e.name),autoFocus:o},...Yx(a.properties,a.order,t.options)];return i},updateTargetWithValues:function(e,t){e.name=t.name,Object.keys(t).forEach(a=>{"name"!==a&&(e.options[a]=t[a])})},getBase64:function(e){return new Promise((t,a)=>{var r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result.substr(r.result.indexOf(",")+1)),r.onerror=e=>a(e)})},hasFilledExtraField:function(e,t){var a=Object(l.get)(e,"configuration_schema.extra_options",[]);return Object(l.some)(a,a=>{var r=Object(l.get)(e,["configuration_schema","properties",a,"default"]),n=Object(l.get)(t,["options",a]);return!Object(l.isNil)(n)&&n!==r})}};a(1439);function $x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Jx(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Jx(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jx(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var Xx=ae.a.shape({name:ae.a.string.isRequired,callback:ae.a.func.isRequired,type:ae.a.string,pullRight:ae.a.bool,disabledWhenDirty:ae.a.bool}),Zx=ae.a.shape({validateFieldsAndScroll:ae.a.func}),eP=e=>{var t=e.type,a=e.required,r=e.minLength,n=a,o=r&&Object(l.includes)(["text","email","password"],t),i="email"===t;return[n&&{required:a,message:window.W_L.required},o&&{min:r,message:window.W_L.short},i&&{type:"email",message:window.W_L.email_error}].filter(e=>e)};function tP(e){var t=e.fields,a=e.feedbackIcons,r=e.form;return t.map(e=>{var t=e.name,o=e.type,i=e.initialValue,s=e.contentAfter,c=vx(e),u={name:t,className:"m-b-10",hasFeedback:"checkbox"!==o&&"file"!==o&&a,label:"checkbox"===o?"":c,rules:eP(e),valuePropName:"checkbox"===o?"checked":"value",initialValue:i};return"file"===o&&(u.valuePropName="data-value",u.getValueFromEvent=e=>{e&&e.fileList[0]&&Gx.getBase64(e.file).then(e=>{r.setFieldsValue({[t]:e})})}),n.a.createElement(n.a.Fragment,{key:t},n.a.createElement(Vb.a.Item,u,n.a.createElement(Hx,{field:e,form:r})),Object(l.isFunction)(s)?s(r.getFieldValue(t)):s)})}tP.propTypes={fields:ae.a.arrayOf(Ux),feedbackIcons:ae.a.bool,form:Zx.isRequired},tP.defaultProps={fields:[],feedbackIcons:!1};var aP=(e,t)=>(t.inProgress?e.add(t.actionName):e.delete(t.actionName),new Set(e));function rP(e){var t=e.actions,a=e.isFormDirty,o=$x(Object(r.useReducer)(aP,new Set),2),i=o[0],s=o[1],c=Object(r.useCallback)(e=>{var t=e.name;Object(l.isFunction)(e.callback)&&(s({actionName:t,inProgress:!0}),e.callback(()=>{s({actionName:t,inProgress:!1})}))},[]);return t.map(e=>n.a.createElement(m.a,{key:e.name,htmlType:"button",className:me()("m-t-10",{"pull-right":e.pullRight}),type:e.type,disabled:a&&e.disableWhenDirty,loading:i.has(e.name),onClick:()=>c(e)},e.name))}function nP(e){var t=e.id,a=e.fields,o=e.actions,i=e.feedbackIcons,s=e.hideSubmitButton,c=e.defaultShowExtraFields,u=e.saveText,d=e.onSubmit,p=$x(Object(r.useState)(!1),2),f=p[0],g=p[1],b=$x(Object(r.useState)(!1),2),h=b[0],y=b[1],v=$x(Object(r.useState)(c),2),w=v[0],O=v[1],_=$x(Vb.a.useForm(),1)[0],E=Object(l.filter)(a,{extra:!0}),j=Object(l.difference)(a,E),S=Object(r.useCallback)(e=>{g(!0),e=function(e,t){return Object(l.mapValues)(t,(t,a)=>{var r=(Object(l.find)(e,{name:a})||{}).initialValue;return null!=r&&""!==r||""!==t?t:null})}(a,e),d(e,e=>{g(!1),y(!1),Hp.success(e)},e=>{g(!1),Hp.error(e)})},[a,d]),C=Object(r.useCallback)(e=>{var t=e.errorFields;_.scrollToField(t[0].name)},[_]);return n.a.createElement(Vb.a,{form:_,onFieldsChange:()=>{y(!0)},id:t,className:"dynamic-form",layout:"vertical",onFinish:S,onFinishFailed:C},n.a.createElement(tP,{fields:j,feedbackIcons:i,form:_}),!Object(l.isEmpty)(E)&&n.a.createElement("div",{className:"extra-options"},n.a.createElement(m.a,{type:"dashed",block:!0,className:"extra-options-button",onClick:()=>O(e=>!e)},window.W_L.add_params,n.a.createElement("i",{className:me()("fa m-l-5",{"fa-caret-up":w,"fa-caret-down":!w}),"aria-hidden":"true"})),n.a.createElement(yx,{collapsed:!w,className:"extra-options-content"},n.a.createElement(tP,{fields:E,feedbackIcons:i,form:_}))),!s&&n.a.createElement(m.a,{className:"w-100 m-t-20",type:"primary",htmlType:"submit",disabled:f},u),n.a.createElement(rP,{actions:o,isFormDirty:h}))}function oP(){return(oP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function iP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rP.propTypes={actions:ae.a.arrayOf(Xx),isFormDirty:ae.a.bool},rP.defaultProps={actions:[],isFormDirty:!1},nP.propTypes={id:ae.a.string,fields:ae.a.arrayOf(Ux),actions:ae.a.arrayOf(Xx),feedbackIcons:ae.a.bool,hideSubmitButton:ae.a.bool,defaultShowExtraFields:ae.a.bool,saveText:ae.a.string,onSubmit:ae.a.func},nP.defaultProps={id:null,fields:[],actions:[],feedbackIcons:!1,hideSubmitButton:!1,defaultShowExtraFields:!1,saveText:window.W_L.save,onSubmit:()=>{}};var lP=gx.a.Step,sP=ta.a.Search,cP=0,uP=1,dP=2;class mP extends n.a.Component{constructor(){super(...arguments),iP(this,"state",{searchText:"",selectedType:null,savingSource:!1,currentStep:cP}),iP(this,"formId",Object(l.uniqueId)("sourceForm")),iP(this,"selectType",e=>{this.setState({selectedType:e,currentStep:uP})}),iP(this,"resetType",()=>{this.state.currentStep===uP&&this.setState({searchText:"",selectedType:null,currentStep:cP})}),iP(this,"createSource",(e,t,a)=>{var r=this.state,n=r.selectedType;r.savingSource||(this.setState({savingSource:!0,currentStep:dP}),this.props.onCreate(n,e).then(e=>{t(window.W_L.save_success),this.props.dialog.close({success:!0,data:e})}).catch(e=>{this.setState({savingSource:!1,currentStep:uP}),a(Object(l.get)(e,"response.data.message",window.W_L.save_failed))}))})}renderTypeSelector(){var e=this.props.types,t=this.state.searchText,a=e.filter(e=>Object(l.isEmpty)(t)||Object(l.includes)(e.name.toLowerCase(),t.toLowerCase()));return n.a.createElement("div",{className:"m-t-10"},n.a.createElement(sP,{placeholder:window.W_L.search,"aria-label":window.W_L.search,onChange:e=>this.setState({searchText:e.target.value}),autoFocus:!0,"data-test":"SearchSource"}),n.a.createElement("div",{className:"scrollbox p-5 m-t-10",style:{minHeight:"30vh",maxHeight:"40vh"}},Object(l.isEmpty)(a)?n.a.createElement(nC,{className:""}):n.a.createElement(yb.a,{size:"small",dataSource:a,renderItem:e=>this.renderItem(e)})))}renderForm(){var e=this.props,t=e.imageFolder,a=e.helpTriggerPrefix,r=this.state.selectedType,o=Gx.getFields(r),i="".concat(a).concat(Object(l.toUpper)(r.type));return n.a.createElement("div",null,n.a.createElement("div",{className:"d-flex justify-content-center align-items-center"},n.a.createElement("img",{className:"p-5",src:"".concat(t,"/").concat(r.type,".png"),alt:r.name,width:"48"}),n.a.createElement("h4",{className:"m-0"},r.name)),n.a.createElement("div",{className:"text-right"},Ye[i]&&n.a.createElement(Ge,{className:"f-13",type:i},window.W_L.setting_info," ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(",window.W_L.help,")"))),n.a.createElement(nP,{id:this.formId,fields:o,onSubmit:this.createSource,feedbackIcons:!0,hideSubmitButton:!0}),"databricks"===r.type&&n.a.createElement("small",null,window.W_L.jdbc_info," ",n.a.createElement(h,{href:"https://databricks.com/spark/odbc-driver-download",target:"_blank",rel:"noopener noreferrer"},window.W_L.jdbc_download_name),"."))}renderItem(e){var t=this.props.imageFolder;return n.a.createElement(yb.a.Item,{className:"p-l-10 p-r-10 clickable",onClick:()=>this.selectType(e)},n.a.createElement(nE,{title:e.name,imageUrl:"".concat(t,"/").concat(e.type,".png"),roundedImage:!1,"data-test":"PreviewItem","data-test-type":e.type},n.a.createElement("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})))}render(){var e=this.state,t=e.currentStep,a=e.savingSource,r=this.props,o=r.dialog,i=r.sourceType;return n.a.createElement(R.a,oP({},o.props,{title:window.W_L.create+" ".concat(i),footer:t===cP?[n.a.createElement(m.a,{key:"cancel",onClick:()=>o.dismiss(),"data-test":"CreateSourceCancelButton"},window.W_L.cancel),n.a.createElement(m.a,{key:"submit",type:"primary",disabled:!0},window.W_L.create)]:[n.a.createElement(m.a,{key:"previous",onClick:this.resetType},window.W_L.previous),n.a.createElement(m.a,{key:"submit",htmlType:"submit",form:this.formId,type:"primary",loading:a,"data-test":"CreateSourceSaveButton"},window.W_L.create)]}),n.a.createElement("div",{"data-test":"CreateSourceDialog"},n.a.createElement(gx.a,{className:"hidden-xs m-b-10",size:"small",current:t,progressDot:!0},t===uP?n.a.createElement(lP,{title:window.W_L.type_select,className:"clickable",onClick:this.resetType}):n.a.createElement(lP,{title:window.W_L.type}),n.a.createElement(lP,{title:window.W_L.setting}),n.a.createElement(lP,{title:window.W_L.done})),t===cP&&this.renderTypeSelector(),t!==cP&&this.renderForm()))}}iP(mP,"propTypes",{dialog:ia.isRequired,types:ae.a.arrayOf(ae.a.object),sourceType:ae.a.string.isRequired,imageFolder:ae.a.string.isRequired,helpTriggerPrefix:ae.a.string,onCreate:ae.a.func.isRequired}),iP(mP,"defaultProps",{types:[],helpTriggerPrefix:null});var pP=la(mP);var fP=function(e,t,a){return ht.add(e,t),function(e){var t=ht.getActiveItem(A.path);return n.a.createElement("div",{className:"settings-screen"},n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:window.W_L.setting}),n.a.createElement("div",{className:"bg-white tiled"},n.a.createElement(ue.a,{selectedKeys:[t&&t.title],selectable:!1,mode:"horizontal"},ht.getAvailableItems().map(e=>n.a.createElement(ue.a.Item,{key:e.title},n.a.createElement(h,{href:e.path,"data-test":"SettingsScreenItem"},e.title)))),n.a.createElement("div",{className:"p-15"},n.a.createElement("div",null,n.a.createElement(a,e))))))}};function gP(){return(gP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function bP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}le("DataSourcesListComponent",(function(e){var t=e.dataSources,a=e.onClickCreate,r=t.map(e=>({title:e.name,imgSrc:"".concat("static/images/db-logos","/").concat(e.type,".png"),href:"data_sources/".concat(e.id)}));return Object(l.isEmpty)(t)?n.a.createElement("div",{className:"text-center"},window.W_L.no_datasource,Z.isCreateDataSourceEnabled()&&n.a.createElement("div",{className:"m-t-5"},n.a.createElement(ge,{type:"link",onClick:a,"data-test":"CreateDataSourceLink"},window.W_L.connect_new_datasource)," ")):n.a.createElement(px,{items:r})}));class hP extends n.a.Component{constructor(){var e;super(...arguments),e=this,bP(this,"state",{dataSourceTypes:[],dataSources:[],loading:!0}),bP(this,"newDataSourceDialog",null),bP(this,"createDataSource",(e,t)=>{var a={options:{},type:e.type};return Gx.updateTargetWithValues(a,t),nS.create(a).then(e=>(this.setState({loading:!0}),nS.query().then(e=>this.setState({dataSources:e,loading:!1})),e))}),bP(this,"showCreateSourceDialog",()=>{da("view","page","data_sources/new"),this.newDataSourceDialog=pP.showModal({types:Object(l.reject)(this.state.dataSourceTypes,"deprecated"),sourceType:window.W_L.data_source,imageFolder:"static/images/db-logos",helpTriggerPrefix:"DS_",onCreate:this.createDataSource}),this.newDataSourceDialog.onClose((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.newDataSourceDialog=null,t.success&&sa("data_sources/".concat(t.data.id))})).onDismiss(()=>{this.newDataSourceDialog=null,sa("data_sources",!0)})})}componentDidMount(){Promise.all([nS.query(),nS.types()]).then(e=>this.setState({dataSources:e[0],dataSourceTypes:e[1],loading:!1},()=>{this.props.isNewDataSourcePage&&(Z.canCreateDataSource()?this.showCreateSourceDialog():sa("data_sources",!0))})).catch(e=>this.props.onError(e))}componentWillUnmount(){this.newDataSourceDialog&&this.newDataSourceDialog.dismiss()}render(){var e={type:"primary",onClick:Z.isCreateDataSourceEnabled()?this.showCreateSourceDialog:null,disabled:!Z.isCreateDataSourceEnabled(),"data-test":"CreateDataSourceButton"};return n.a.createElement("div",null,n.a.createElement("div",{className:"m-b-15"},n.a.createElement(m.a,e,n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.new_data_source),n.a.createElement(se,{name:"DataSourcesListExtra"})),this.state.loading?n.a.createElement(mb,{className:""}):n.a.createElement(se,{name:"DataSourcesListComponent",dataSources:this.state.dataSources,onClickCreate:this.showCreateSourceDialog}))}}bP(hP,"propTypes",{isNewDataSourcePage:ae.a.bool,onError:ae.a.func}),bP(hP,"defaultProps",{isNewDataSourcePage:!1,onError:()=>{}});var yP=fP("DataSources.List",{permission:"admin",title:window.W_L.data_source,path:"data_sources",order:1},hP);function vP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rf.register("DataSources.List",Zt({path:"/data_sources",title:window.W_L.data_source,render:e=>n.a.createElement(yP,e)})),rf.register("DataSources.New",Zt({path:"/data_sources/new",title:window.W_L.data_source,render:e=>n.a.createElement(yP,gP({},e,{isNewDataSourcePage:!0}))}));class wP extends n.a.Component{constructor(){super(...arguments),vP(this,"state",{dataSource:null,type:null,loading:!0}),vP(this,"saveDataSource",(e,t,a)=>{var r=this.state.dataSource;Gx.updateTargetWithValues(r,e),nS.save(r).then(()=>t(window.W_L.save_success)).catch(e=>{var t=Object(l.get)(e,"response.data.message",window.W_L.save_failed);a(t)})}),vP(this,"deleteDataSource",e=>{var t=this.state.dataSource;R.a.confirm({title:window.W_L.delete_datasource,content:window.W_L.delete_datasource_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:()=>{nS.delete(t).then(()=>{Hp.success(window.W_L.datasource_delete_success),sa("data_sources")}).catch(()=>{e()})},onCancel:e,maskClosable:!0,autoFocusButton:null})}),vP(this,"testConnection",e=>{var t=this.state.dataSource;nS.test({id:t.id}).then(t=>{t.ok?Hp.success(window.W_L.connect_success):Hp.error(window.W_L.connect_failed,t.message,{duration:10}),e()}).catch(()=>{Hp.error(window.W_L.connect_failed,window.W_L.connect_failed_tip,{duration:10}),e()})})}componentDidMount(){nS.get({id:this.props.dataSourceId}).then(e=>{var t=e.type;this.setState({dataSource:e}),nS.types().then(e=>this.setState({type:Object(l.find)(e,{type:t}),loading:!1}))}).catch(e=>this.props.onError(e))}renderForm(){var e=this.state,t=e.dataSource,a=e.type,r=Gx.getFields(a,t),o="DS_".concat(Object(l.toUpper)(a.type)),i={fields:r,type:a,actions:[{name:window.W_L.delete,type:"danger",callback:this.deleteDataSource},{name:window.W_L.connect_test,pullRight:!0,callback:this.testConnection,disableWhenDirty:!0}],onSubmit:this.saveDataSource,feedbackIcons:!0,defaultShowExtraFields:Gx.hasFilledExtraField(a,t)};return n.a.createElement("div",{className:"row","data-test":"DataSource"},n.a.createElement("div",{className:"text-right m-r-10"},Ye[o]&&n.a.createElement(Ge,{className:"f-13",type:o},"Setup Instructions ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(help)"))),n.a.createElement("div",{className:"text-center m-b-10"},n.a.createElement("img",{className:"p-5",src:"".concat("static/images/db-logos","/").concat(a.type,".png"),alt:a.name,width:"64"}),n.a.createElement("h3",{className:"m-0"},a.name)),n.a.createElement("div",{className:"col-md-4 col-md-offset-4 m-b-10"},n.a.createElement(nP,i)))}render(){return this.state.loading?n.a.createElement(mb,{className:""}):this.renderForm()}}vP(wP,"propTypes",{dataSourceId:ae.a.string.isRequired,onError:ae.a.func}),vP(wP,"defaultProps",{onError:()=>{}});var OP=fP("DataSources.Edit",null,wP);function _P(){return(_P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function EP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rf.register("DataSources.Edit",Zt({path:"/data_sources/:dataSourceId",title:window.W_L.data_source,render:e=>n.a.createElement(OP,e)}));class jP extends n.a.Component{constructor(){super(...arguments),EP(this,"state",{destinationTypes:[],destinations:[],loading:!0}),EP(this,"createDestination",(e,t)=>{var a={options:{},type:e.type};return Gx.updateTargetWithValues(a,t),jh.create(a).then(e=>(this.setState({loading:!0}),jh.query().then(e=>this.setState({destinations:e,loading:!1})),e))}),EP(this,"showCreateSourceDialog",()=>{pP.showModal({types:Object(l.reject)(this.state.destinationTypes,"deprecated"),sourceType:window.W_L.alert_setting,imageFolder:Eh,onCreate:this.createDestination}).onClose((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.success&&sa("destinations/".concat(e.data.id))})).onDismiss(()=>{sa("destinations",!0)})})}componentDidMount(){Promise.all([jh.query(),jh.types()]).then(e=>this.setState({destinations:e[0],destinationTypes:e[1],loading:!1},()=>{this.props.isNewDestinationPage&&(Z.canCreateDestination()?this.showCreateSourceDialog():sa("destinations",!0))})).catch(e=>this.props.onError(e))}renderDestinations(){var e=this.state.destinations,t=e.map(e=>({title:e.name,imgSrc:"".concat(Eh,"/").concat(e.type,".png"),href:"destinations/".concat(e.id)}));return Object(l.isEmpty)(e)?n.a.createElement("div",{className:"text-center"},window.W_L.no_alert_setting,Z.isCreateDestinationEnabled()&&n.a.createElement("div",{className:"m-t-5"},n.a.createElement(ge,{type:"link",onClick:this.showCreateSourceDialog},window.W_L.add_alert_setting)," ")):n.a.createElement(px,{items:t})}render(){var e={type:"primary",onClick:Z.isCreateDestinationEnabled()?this.showCreateSourceDialog:null,disabled:!Z.isCreateDestinationEnabled()};return n.a.createElement("div",null,n.a.createElement("div",{className:"m-b-15"},n.a.createElement(m.a,e,n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.add_alert_setting)),this.state.loading?n.a.createElement(mb,{className:""}):this.renderDestinations())}}EP(jP,"propTypes",{isNewDestinationPage:ae.a.bool,onError:ae.a.func}),EP(jP,"defaultProps",{isNewDestinationPage:!1,onError:()=>{}});var SP=fP("AlertDestinations.List",{permission:"admin",title:window.W_L.alert_setting,path:"destinations",order:4},jP);function CP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rf.register("AlertDestinations.List",Zt({path:"/destinations",title:window.W_L.alert_setting,render:e=>n.a.createElement(SP,e)})),rf.register("AlertDestinations.New",Zt({path:"/destinations/new",title:window.W_L.alert_setting,render:e=>n.a.createElement(SP,_P({},e,{isNewDestinationPage:!0}))}));class xP extends n.a.Component{constructor(){super(...arguments),CP(this,"state",{destination:null,type:null,loading:!0}),CP(this,"saveDestination",(e,t,a)=>{var r=this.state.destination;Gx.updateTargetWithValues(r,e),jh.save(r).then(()=>t(window.W_L.save_success)).catch(e=>{var t=Object(l.get)(e,"response.data.message",window.W_L.save_failed);a(t)})}),CP(this,"deleteDestination",e=>{var t=this.state.destination;R.a.confirm({title:window.W_L.delete_alert,content:window.W_L.delete_alert_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:()=>{jh.delete(t).then(()=>{Hp.success(window.W_L.alert_delete_success),sa("destinations")}).catch(()=>{e()})},onCancel:e,maskClosable:!0,autoFocusButton:null})})}componentDidMount(){jh.get({id:this.props.destinationId}).then(e=>{var t=e.type;this.setState({destination:e}),jh.types().then(e=>this.setState({type:Object(l.find)(e,{type:t}),loading:!1}))}).catch(e=>this.props.onError(e))}renderForm(){var e=this.state,t=e.destination,a=e.type,r={fields:Gx.getFields(a,t),type:a,actions:[{name:window.W_L.delete,type:"danger",callback:this.deleteDestination}],onSubmit:this.saveDestination,defaultShowExtraFields:Gx.hasFilledExtraField(a,t),feedbackIcons:!0};return n.a.createElement("div",{className:"row","data-test":"Destination"},n.a.createElement("div",{className:"text-center m-b-10"},n.a.createElement("img",{className:"p-5",src:"".concat(Eh,"/").concat(a.type,".png"),alt:a.name,width:"64"}),n.a.createElement("h3",{className:"m-0"},a.name)),n.a.createElement("div",{className:"col-md-4 col-md-offset-4 m-b-10"},n.a.createElement(nP,r)))}render(){return this.state.loading?n.a.createElement(mb,{className:""}):this.renderForm()}}CP(xP,"propTypes",{destinationId:ae.a.string.isRequired,onError:ae.a.func}),CP(xP,"defaultProps",{onError:()=>{}});var PP=fP("AlertDestinations.Edit",null,xP);function LP(){return(LP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function kP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rf.register("AlertDestinations.Edit",Zt({path:"/destinations/:destinationId",title:window.W_L.alert_setting,render:e=>n.a.createElement(PP,e)}));class NP extends n.a.Component{constructor(){super(...arguments),kP(this,"state",{name:""}),kP(this,"save",()=>{this.props.dialog.close({name:this.state.name})})}render(){var e=this.props.dialog;return n.a.createElement(R.a,LP({},e.props,{title:window.W_L.create_role,okText:window.W_L.create,cancelText:window.W_L.cancel,onOk:()=>this.save()}),n.a.createElement(ta.a,{className:"form-control",defaultValue:this.state.name,onChange:e=>this.setState({name:e.target.value}),onPressEnter:()=>this.save(),placeholder:window.W_L.role_name,"aria-label":window.W_L.role_name,autoFocus:!0}))}}kP(NP,"propTypes",{dialog:ia.isRequired});var AP=la(NP),TP={query:()=>B.get("api/groups"),get:e=>{var t=e.id;return B.get("api/groups/".concat(t))},create:e=>B.post("api/groups",e),save:e=>B.post("api/groups/".concat(e.id),e),delete:e=>B.delete("api/groups/".concat(e.id)),members:e=>{var t=e.id;return B.get("api/groups/".concat(t,"/members"))},addMember:(e,t)=>{var a=e.id;return B.post("api/groups/".concat(a,"/members"),t)},removeMember:e=>{var t=e.id,a=e.userId;return B.delete("api/groups/".concat(t,"/members/").concat(a))},dataSources:e=>{var t=e.id;return B.get("api/groups/".concat(t,"/data_sources"))},addDataSource:(e,t)=>{var a=e.id;return B.post("api/groups/".concat(a,"/data_sources"),t)},removeDataSource:e=>{var t=e.id,a=e.dataSourceId;return B.delete("api/groups/".concat(t,"/data_sources/").concat(a))},updateDataSource:(e,t)=>{var a=e.id,r=e.dataSourceId;return B.post("api/groups/".concat(a,"/data_sources/").concat(r),t)}};function WP(){return(WP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function IP(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function qP(e){var t=e.group,a=e.title,r=e.onClick,o=e.children,i=IP(e,["group","title","onClick","children"]);if(!t)return null;var s=n.a.createElement(m.a,WP({},i,{type:"danger",onClick:e=>function(e,t,a){R.a.confirm({title:window.W_L.del_role,content:window.W_L.del_role_confirm,okText:window.W_L.ok_text,okType:"danger",cancelText:window.W_L.cancel,onOk:()=>{TP.delete(t).then(()=>{Hp.success(window.W_L.del_role_success),a()})}})}(0,t,r)}),o);return Object(l.isString)(a)&&""!==a?n.a.createElement(we,{placement:"top",title:a,mouseLeaveDelay:0},s):s}function DP(){return(DP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function RP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}qP.propTypes={group:ae.a.object,title:ae.a.string,onClick:ae.a.func,children:ae.a.node},qP.defaultProps={group:null,title:null,onClick:()=>{},children:null};class MP extends n.a.Component{constructor(){super(...arguments),RP(this,"listColumns",[ng.custom((e,t)=>n.a.createElement("div",null,n.a.createElement(h,{href:"groups/"+t.id},t.name),"builtin"===t.type&&n.a.createElement("span",{className:"label label-default m-l-10"},window.W_L.built_in)),{field:"name",width:null}),ng.custom((e,t)=>n.a.createElement(m.a.Group,null,n.a.createElement(h.Button,{href:"groups/".concat(t.id)},window.W_L.members),H.isAdmin&&n.a.createElement(h.Button,{href:"groups/".concat(t.id,"/data_sources")},window.W_L.data_source)),{width:"1%",className:"text-nowrap"}),ng.custom((e,t)=>{var a="builtin"!==t.type;return n.a.createElement(qP,{className:"w-100",disabled:!a,group:t,title:a?null:window.W_L.built_in_role_delete_tip,onClick:()=>this.onGroupDeleted()},window.W_L.delete)},{width:"1%",className:"text-nowrap p-l-0",isAvailable:()=>H.isAdmin})]),RP(this,"createGroup",()=>{AP.showModal().onClose(e=>TP.create(e).then(e=>sa("groups/".concat(e.id))))}),RP(this,"onGroupDeleted",()=>{this.props.controller.updatePagination({page:1}),this.props.controller.update()})}render(){var e=this.props.controller;return n.a.createElement("div",{"data-test":"GroupList"},H.isAdmin&&n.a.createElement("div",{className:"m-b-15"},n.a.createElement(m.a,{type:"primary",onClick:this.createGroup},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.create_role)),!e.isLoaded&&n.a.createElement(mb,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement(nC,{className:""}),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive"},n.a.createElement(og,{items:e.pageItems,columns:this.listColumns,showHeader:!1,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))}}RP(MP,"propTypes",{controller:Bg.isRequired});var zP=fP("Groups.List",{permission:"list_users",title:window.W_L.role,path:"groups",order:3},Hg(MP,()=>new ib({isPlainList:!0,getRequest:()=>({}),getResource:()=>TP.query.bind(TP)}),()=>new cb({orderByField:"name",itemsPerPage:10})));rf.register("Groups.List",Zt({path:"/groups",title:window.W_L.role,render:e=>n.a.createElement(zP,DP({},e,{currentPage:"groups"}))}));var FP=a(244),VP=a.n(FP);function UP(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function BP(e){var t=e.group,a=e.onChange,r=UP(e,["group","onChange"]);if(!t)return null;var o=H.isAdmin&&"builtin"!==t.type;return n.a.createElement("h3",r,n.a.createElement(KE,{className:"edit-in-place",isEditable:o,ignoreBlanks:!0,onDone:e=>function(e,t,a){e.name=t,TP.save(e),a()}(t,e,a),value:t.name}))}function HP(e){var t=e.controller,a=e.group,r=e.items,o=e.canAddMembers,i=e.onAddMembersClick,l=e.canAddDataSources,s=e.onAddDataSourcesClick,c=e.onGroupDeleted,u=a&&H.isAdmin&&"builtin"!==a.type;return n.a.createElement(n.a.Fragment,null,n.a.createElement(qC,{items:r,selected:t.params.currentPage}),o&&n.a.createElement(m.a,{className:"w-100 m-t-5",type:"primary",onClick:i},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.add_user),l&&n.a.createElement(m.a,{className:"w-100 m-t-5",type:"primary",onClick:s},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.add_datasource),u&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Qb.a,{dashed:!0,className:"m-t-10 m-b-10"}),n.a.createElement(qP,{className:"w-100",group:a,onClick:c},window.W_L.del_role)))}function YP(){return(YP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function QP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}BP.propTypes={group:ae.a.shape({name:ae.a.string.isRequired}),onChange:ae.a.func},BP.defaultProps={group:null,onChange:()=>{}},HP.propTypes={controller:Bg.isRequired,group:ae.a.object,items:ae.a.array.isRequired,canAddMembers:ae.a.bool,onAddMembersClick:ae.a.func,canAddDataSources:ae.a.bool,onAddDataSourcesClick:ae.a.func,onGroupDeleted:ae.a.func},HP.defaultProps={group:null,canAddMembers:!1,onAddMembersClick:null,canAddDataSources:!1,onAddDataSourcesClick:null,onGroupDeleted:null};class KP extends n.a.Component{constructor(){super(...arguments),QP(this,"groupId",parseInt(this.props.controller.params.groupId,10)),QP(this,"group",null),QP(this,"sidebarMenu",[{key:"users",href:"groups/".concat(this.groupId),title:window.W_L.members},{key:"datasources",href:"groups/".concat(this.groupId,"/data_sources"),title:window.W_L.data_source,isAvailable:()=>H.isAdmin}]),QP(this,"listColumns",[ng.custom((e,t)=>n.a.createElement(iE,{dataSource:t,withLink:!0}),{title:window.W_L.name,field:"name",width:null}),ng.custom((e,t)=>{var a=n.a.createElement(ue.a,{selectedKeys:[t.view_only?"viewonly":"full"],onClick:e=>this.setDataSourcePermissions(t,e.key)},n.a.createElement(ue.a.Item,{key:"full"},window.W_L.full_access),n.a.createElement(ue.a.Item,{key:"viewonly"},window.W_L.view_only));return n.a.createElement(Vt.a,{trigger:["click"],overlay:a},n.a.createElement(m.a,{className:"w-100","aria-label":"Permissions"},t.view_only?window.W_L.view_only:window.W_L.full_access,n.a.createElement(VP.a,{"aria-hidden":"true"})))},{width:"1%",className:"p-r-0",isAvailable:()=>H.isAdmin}),ng.custom((e,t)=>n.a.createElement(m.a,{className:"w-100",type:"danger",onClick:()=>this.removeGroupDataSource(t)},"Remove"),{width:"1%",isAvailable:()=>H.isAdmin})]),QP(this,"removeGroupDataSource",e=>{TP.removeDataSource({id:this.groupId,dataSourceId:e.id}).then(()=>{this.props.controller.updatePagination({page:1}),this.props.controller.update()}).catch(()=>{Hp.error(window.W_L.datasource_delete_failed)})}),QP(this,"setDataSourcePermissions",(e,t)=>{var a="full"!==t;TP.updateDataSource({id:this.groupId,dataSourceId:e.id},{view_only:a}).then(()=>{e.view_only=a,this.forceUpdate()}).catch(()=>{Hp.error(window.W_L.change_datasource_permission_failed)})}),QP(this,"addDataSources",()=>{var e=nS.query(),t=Object(l.map)(this.props.controller.allItems,e=>e.id);_h.showModal({dialogTitle:window.W_L.new_data_source,inputPlaceholder:window.W_L.search_database,selectedItemsTitle:window.W_L.new_data_source,searchItems:t=>(t=Object(l.toLower)(t),e.then(e=>Object(l.filter)(e,e=>Object(l.includes)(Object(l.toLower)(e.name),t)))),renderItem:(e,a)=>{var r=a.isSelected,o=Object(l.includes)(t,e.id);return{content:n.a.createElement(iE,{dataSource:e},n.a.createElement(Ch,{isSelected:r,alreadyInGroup:o})),isDisabled:o,className:r||o?"selected":""}},renderStagedItem:(e,t)=>{var a=t.isSelected;return{content:n.a.createElement(iE,{dataSource:e},n.a.createElement(Ch,{isSelected:a,isStaged:!0}))}}}).onClose(e=>{var t=Object(l.map)(e,e=>TP.addDataSource({id:this.groupId},{data_source_id:e.id}));return Promise.all(t).then(()=>this.props.controller.update())})})}componentDidMount(){TP.get({id:this.groupId}).then(e=>{this.group=e,this.forceUpdate()}).catch(e=>{this.props.controller.handleError(e)})}render(){var e=this.props.controller;return n.a.createElement("div",{"data-test":"Group"},n.a.createElement(BP,{className:"d-block m-t-0 m-b-15",group:this.group,onChange:()=>this.forceUpdate()}),n.a.createElement(dC,null,n.a.createElement(dC.Sidebar,null,n.a.createElement(HP,{controller:e,group:this.group,items:this.sidebarMenu,canAddDataSources:H.isAdmin,onAddDataSourcesClick:this.addDataSources,onGroupDeleted:()=>sa("groups")})),n.a.createElement(dC.Content,null,!e.isLoaded&&n.a.createElement(mb,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center"},n.a.createElement("p",null,window.W_L.group_no_datasource),H.isAdmin&&n.a.createElement(m.a,{type:"primary",onClick:this.addDataSources},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.new_data_source)),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive"},n.a.createElement(og,{items:e.pageItems,columns:this.listColumns,showHeader:!1,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}QP(KP,"propTypes",{controller:Bg.isRequired});var GP=fP("Groups.DataSources",null,Hg(KP,()=>new ib({isPlainList:!0,getRequest:(e,t)=>({id:t.params.groupId}),getResource:()=>TP.dataSources.bind(TP)}),()=>new cb({orderByField:"name"})));function $P(){return($P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function JP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rf.register("Groups.DataSources",Zt({path:"/groups/:groupId/data_sources",title:window.W_L.group_datasource,render:e=>n.a.createElement(GP,YP({},e,{currentPage:"datasources"}))}));class XP extends n.a.Component{constructor(){super(...arguments),JP(this,"groupId",parseInt(this.props.controller.params.groupId,10)),JP(this,"group",null),JP(this,"sidebarMenu",[{key:"users",href:"groups/".concat(this.groupId),title:window.W_L.members},{key:"datasources",href:"groups/".concat(this.groupId,"/data_sources"),title:window.W_L.data_source,isAvailable:()=>H.isAdmin}]),JP(this,"listColumns",[ng.custom((e,t)=>n.a.createElement(oE,{user:t,withLink:!0}),{title:window.W_L.name,field:"name",width:null}),ng.custom((e,t)=>this.group?"builtin"===this.group.type&&H.id===t.id?null:n.a.createElement(m.a,{className:"w-100",type:"danger",onClick:e=>this.removeGroupMember(e,t)},window.W_L.remove):null,{width:"1%",isAvailable:()=>H.isAdmin})]),JP(this,"removeGroupMember",(e,t)=>TP.removeMember({id:this.groupId,userId:t.id}).then(()=>{this.props.controller.updatePagination({page:1}),this.props.controller.update()}).catch(()=>{Hp.error(window.W_L.remove_member_failed)})),JP(this,"addMembers",()=>{var e=Object(l.map)(this.props.controller.allItems,e=>e.id);_h.showModal({dialogTitle:window.W_L.add_member,inputPlaceholder:window.W_L.search_member,selectedItemsTitle:window.W_L.add_member,searchItems:e=>cE.query({q:e}).then(e=>e.results),renderItem:(t,a)=>{var r=a.isSelected,o=Object(l.includes)(e,t.id);return{content:n.a.createElement(oE,{user:t},n.a.createElement(Ch,{isSelected:r,alreadyInGroup:o})),isDisabled:o,className:r||o?"selected":""}},renderStagedItem:(e,t)=>{var a=t.isSelected;return{content:n.a.createElement(oE,{user:e},n.a.createElement(Ch,{isSelected:a,isStaged:!0}))}}}).onClose(e=>{var t=Object(l.map)(e,e=>TP.addMember({id:this.groupId},{user_id:e.id}));return Promise.all(t).then(()=>this.props.controller.update())})})}componentDidMount(){TP.get({id:this.groupId}).then(e=>{this.group=e,this.forceUpdate()}).catch(e=>{this.props.controller.handleError(e)})}render(){var e=this.props.controller;return n.a.createElement("div",{"data-test":"Group"},n.a.createElement(BP,{className:"d-block m-t-0 m-b-15",group:this.group,onChange:()=>this.forceUpdate()}),n.a.createElement(dC,null,n.a.createElement(dC.Sidebar,null,n.a.createElement(HP,{controller:e,group:this.group,items:this.sidebarMenu,canAddMembers:H.isAdmin,onAddMembersClick:this.addMembers,onGroupDeleted:()=>sa("groups")})),n.a.createElement(dC.Content,null,!e.isLoaded&&n.a.createElement(mb,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center"},n.a.createElement("p",null,window.W_L.role_no_member),H.isAdmin&&n.a.createElement(m.a,{type:"primary",onClick:this.addMembers},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.add_member)),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive"},n.a.createElement(og,{items:e.pageItems,columns:this.listColumns,showHeader:!1,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}JP(XP,"propTypes",{controller:Bg.isRequired});var ZP=fP("Groups.Members",null,Hg(XP,()=>new ib({isPlainList:!0,getRequest:(e,t)=>({id:t.params.groupId}),getResource:()=>TP.members.bind(TP)}),()=>new cb({orderByField:"name"})));function eL(e){var t=e.page,a=e.searchTerm,r=e.selectedTags;if(""!==a)return n.a.createElement(xe,{message:window.W_L.find_nothing,icon:"fa-search"});if(r.length>0)return n.a.createElement(BC,{objectType:"queries",tags:r});switch(t){case"favorites":return n.a.createElement(xe,{message:window.W_L.my_favorite_query,icon:"fa-star"});case"archive":return n.a.createElement(xe,{message:window.W_L.archived_query,icon:"fa-archive"});case"my":var o=H.hasPermission("create_query")?n.a.createElement("span",null,n.a.createElement(h.Button,{href:"queries/new",type:"primary",size:"small"},window.W_L.create_query)," ",n.a.createElement(Ge,{className:"f-13",type:"QUERIES",showTooltip:!1},window.W_L.need_help,"?")):n.a.createElement("span",null,window.W_L.find_nothing);return n.a.createElement(xe,{icon:"fa-search"},o);default:return n.a.createElement(se,{name:"QueriesList.EmptyState"},n.a.createElement(Rp,{icon:"fa fa-code",illustration:"query",description:window.W_L.get_data_from_datasource,helpMessage:n.a.createElement(qp,{helpTriggerType:"QUERIES"})}))}}rf.register("Groups.Members",Zt({path:"/groups/:groupId",title:window.W_L.members,render:e=>n.a.createElement(ZP,$P({},e,{currentPage:"users"}))})),eL.propTypes={page:ae.a.string.isRequired,searchTerm:ae.a.string.isRequired,selectedTags:ae.a.array.isRequired};a(1440);function tL(){return(tL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var aL=[{key:"all",href:"queries",title:window.W_L.all_queries,icon:()=>n.a.createElement(DC,{icon:"fa fa-code"})},{key:"my",href:"queries/my",title:window.W_L.my_queries,icon:()=>n.a.createElement(RC,{user:H})},{key:"favorites",href:"queries/favorites",title:window.W_L.my_favorite_query,icon:()=>n.a.createElement(DC,{icon:"fa fa-star"})},{key:"archive",href:"queries/archive",title:window.W_L.archived_query,icon:()=>n.a.createElement(DC,{icon:"fa fa-archive"})}],rL=[ng.favorites({className:"p-r-0"}),ng.custom.sortable((e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(h,{className:"table-main-title",href:"queries/"+t.id},t.name),n.a.createElement(Tg,{className:"d-block",tags:t.tags,isDraft:t.is_draft,isArchived:t.is_archived})),{title:window.W_L.name,field:"name",width:null}),ng.custom((e,t)=>t.user.name,{title:window.W_L.create_user,width:"1%"}),ng.dateTime.sortable({title:window.W_L.create_time,field:"created_at",width:"1%"}),ng.dateTime.sortable({title:window.W_L.last_exec_datetime,field:"retrieved_at",orderByField:"executed_at",width:"1%"}),ng.custom.sortable((e,t)=>n.a.createElement(Rg,{schedule:t.schedule,isNew:t.isNew()}),{title:window.W_L.auto_flush,field:"schedule",width:"1%"})];function nL(e){return n.a.createElement(se,tL({name:"QueriesList.Actions"},e))}function oL(e){var t=e.controller,a=Object(r.useRef)();a.current=t,Object(r.useEffect)(()=>{var e=A.listen((e,t)=>{var r=A.search.q||"";"PUSH"===t&&r!==a.current.searchTerm&&a.current.updateSearch(r)});return()=>{e()}},[]);var o=UC(t,rL,nL),i=o.areExtraActionsAvailable,l=o.listColumns,s=o.Component,c=o.selectedItems;return n.a.createElement("div",{className:"page-queries-list"},n.a.createElement("div",{className:"container"},n.a.createElement(ff,{title:t.params.pageTitle,actions:H.hasPermission("create_query")?n.a.createElement(h.Button,{block:!0,type:"primary",href:"queries/new"},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.new_query):null}),n.a.createElement(dC,null,n.a.createElement(dC.Sidebar,{className:"m-b-0"},n.a.createElement(IC,{placeholder:window.W_L.search_query,label:window.W_L.search_query,value:t.searchTerm,onChange:t.updateSearch}),n.a.createElement(qC,{items:aL,selected:t.params.currentPage}),n.a.createElement(MC,{url:"api/queries/tags",onChange:t.updateSelectedTags,showUnselectAll:!0})),n.a.createElement(dC.Content,null,t.isLoaded&&t.isEmpty?n.a.createElement(eL,{page:t.params.currentPage,searchTerm:t.searchTerm,selectedTags:t.selectedTags}):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:me()({"m-b-10":i})},n.a.createElement(s,{selectedItems:c})),n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(og,{items:t.pageItems,loading:!t.isLoaded,columns:l,orderByField:t.orderByField,orderByReverse:t.orderByReverse,toggleSorting:t.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:t.totalItemsCount,pageSize:t.itemsPerPage,onPageSizeChange:e=>t.updatePagination({itemsPerPage:e}),page:t.page,onChange:e=>t.updatePagination({page:e})})))))))}oL.propTypes={controller:Bg.isRequired};var iL=Hg(oL,()=>new ib({getResource(e){var t=e.params.currentPage;return{all:Za.query.bind(Za),my:Za.myQueries.bind(Za),favorites:Za.favorites.bind(Za),archive:Za.archive.bind(Za)}[t]},getItemProcessor:()=>e=>new Za(e)}),()=>new ub({orderByField:"created_at",orderByReverse:!0}));rf.register("Queries.List",Zt({path:"/queries",title:window.W_L.all_queries,render:e=>n.a.createElement(iL,tL({},e,{currentPage:"all"}))})),rf.register("Queries.Favorites",Zt({path:"/queries/favorites",title:window.W_L.my_favorite_query,render:e=>n.a.createElement(iL,tL({},e,{currentPage:"favorites"}))})),rf.register("Queries.Archived",Zt({path:"/queries/archive",title:window.W_L.archived_query,render:e=>n.a.createElement(iL,tL({},e,{currentPage:"archive"}))})),rf.register("Queries.My",Zt({path:"/queries/my",title:window.W_L.my_queries,render:e=>n.a.createElement(iL,tL({},e,{currentPage:"my"}))}));var lL=a(424);a(1441);function sL(){return(sL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function cL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function uL(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cL(Object(a),!0).forEach((function(t){dL(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cL(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function dL(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function mL(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return pL(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pL(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function fL(e){var t=e.toggleShortcut,a=e.direction,o=e.sizeAttribute,i=e.children,l=mL(Object(r.useState)(0),2),s=l[0],c=l[1],u=Object(r.useRef)(),d=Object(r.useRef)(!1),m=Object(r.useRef)(!1),p="horizontal"===a?"width":"height";o=o||p;var f=Object(r.useCallback)(()=>u.current?Math.floor(u.current.getBoundingClientRect()[p]):0,[p]),g=Object(r.useRef)(null),b=Object(r.useCallback)(()=>{if(u.current){var e,t=Lr.a.select(u.current);null===g.current?(e="0px",g.current="".concat(f(),"px")):(e=g.current,g.current=null),t.style(o,g.current||"0px").transition().duration(200).ease("swing").style(o,e),c(parseInt(e)||0)}},[f,o]),h=Object(r.useMemo)(()=>n.a.createElement("span",{className:"react-resizable-handle react-resizable-handle-".concat(a),role:"separator",onClick:()=>{!d.current&&m.current||b(),d.current=!1,m.current=!1}}),[a,b]);Object(r.useEffect)(()=>{if(t){var e={[t]:b};return uy.bind(e),()=>{uy.unbind(e)}}},[t,b]);var y=Object(r.useMemo)(()=>({onResizeStart:()=>{c(f())},onResize:(e,t)=>{Lr.a.select(u.current).style(o,"".concat(t.size[p],"px")),c(t.size[p]),m.current=!0},onResizeStop:()=>{m.current&&(g.current=null)}}),[p,f,o]),v=Object(r.useMemo)(()=>({onMouseDown:e=>{"touchstart"===e.type&&(d.current=!0),c(f())}}),[f]);return i?(i=n.a.createElement(i.type,uL(uL({},i.props),{},{ref:u})),n.a.createElement(lL.Resizable,sL({className:"resizable-component",axis:"horizontal"===a?"x":"y",resizeHandles:["horizontal"===a?"e":"s"],handle:h,width:"horizontal"===a?s:0,height:"vertical"===a?s:0,minConstraints:[0,0]},y,{draggableOpts:v}),i)):null}fL.propTypes={direction:ae.a.oneOf(["horizontal","vertical"]),sizeAttribute:ae.a.string,toggleShortcut:ae.a.string,children:ae.a.element},fL.defaultProps={direction:"horizontal",sizeAttribute:null,toggleShortcut:null,children:null};var gL=a(724),bL=a.n(gL),hL={sql:e=>bL.a.format(Object(l.trim)(e)),json:e=>JSON.stringify(JSON.parse(e),null,4)};function yL(e){return e in hL}function vL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=t||{view_only:!0},Object(r.useMemo)(()=>({isNew:Object(l.isNil)(e.id),isDraft:e.is_draft,isArchived:e.is_archived,canCreate:H.hasPermission("create_query"),canView:H.hasPermission("view_query"),canEdit:H.hasPermission("edit_query")&&Z.canEdit(e),canViewSource:H.hasPermission("view_source"),canExecute:!Object(l.isEmpty)(e.query)&&Z.canRun(e)&&(e.is_safe||H.hasPermission("execute_query")&&!t.view_only),canFork:H.hasPermission("edit_query")&&!t.view_only,canSchedule:H.hasPermission("schedule_query")}),[e,t.view_only])}function wL(e,t){var a=Xv(t);return Object(r.useCallback)(()=>{new Promise((e,t)=>{R.a.confirm({title:window.W_L.archived_search,content:n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"m-b-5"},window.W_L.archived_confirm),n.a.createElement("div",null,window.W_L.archived_tip)),okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:()=>{e()},onCancel:()=>{t()},maskClosable:!0,autoFocusButton:null})}).then(()=>function(e){return Za.delete({id:e.id}).then(()=>Object(l.extend)(e.clone(),{is_archived:!0,schedule:null})).catch(e=>(Hp.error(window.W_L.archived_failed),Promise.reject(e)))}(e)).then(a)},[e,a])}function OL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?OL(Object(a),!0).forEach((function(t){EL(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):OL(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function EL(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class jL extends(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error)){constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e),this.detailedMessage=t}}class SL extends jL{constructor(){super(window.W_L.change_not_save,n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"m-b-5"},window.W_L.query_has_change),n.a.createElement("div",null,window.W_L.self_copy_save_and_reload)))}}function CL(){return new Promise((e,t)=>{R.a.confirm({title:window.W_L.overwrite_query,content:n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"m-b-5"},window.W_L.query_has_change),n.a.createElement("div",null,window.W_L.overwrite_query_confirm)),okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:()=>{e()},onCancel:()=>{t()},maskClosable:!0,autoFocusButton:null})})}function xL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.canOverwrite,r=void 0!==a&&a;return Object(l.isObject)(e.options)&&e.options.parameters&&(e.options=_L(_L({},e.options),{},{parameters:Object(l.map)(e.options.parameters,e=>e.toSaveableObject())})),Za.save(e).catch(t=>409===Object(l.get)(t,"response.status")?r?CL().then(()=>Za.save(Object(l.omit)(e,["version"]))).catch(()=>Promise.reject(new SL)):Promise.reject(new SL):Promise.reject(new jL(window.W_L.save_failed)))}function PL(e,t){var a=Xv(t);return Object(r.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.successMessage,o=void 0===n?window.W_L.save_success:n;if(Object(l.isObject)(t)){if(e.isNew())return void a(Object(l.extend)(e.clone(),t));t=_L(_L({},t),{},{id:e.id,version:e.version})}else t=Object(l.pick)(e,["id","version","schedule","query","description","name","data_source_id","options","latest_query_data_id","is_draft","tags"]);return xL(t,{canOverwrite:Z.canEdit(e)}).then(r=>{Object(l.isNil)(o)||Hp.success(o),a(Object(l.extend)(e.clone(),r.id!==e.id?r:Object(l.pick)(r,Object(l.uniq)(["id","version",...Object(l.keys)(t)]))))}).catch(e=>{var t={};e instanceof SL&&(t.duration=null),Hp.error(e.message,e.detailedMessage,t)})}),[e,a])}var LL=a(437),kL=a.n(LL);function NL(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return AL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return AL(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AL(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function TL(e){var t=NL(Object(r.useState)(!1),2),a=t[0],n=t[1],o=Object(r.useCallback)(()=>{var t="duplicatedQueryTab/".concat(Math.random().toString()),a=window.open("",t);n(!0),Za.fork({id:e.id}).then(e=>{a.location=function(e){var t=C.a.parse(window.location.search);e=kL.a.parse(e);var a=C.a.parse(e.search);return kL.a.format(Object(l.extend)(Object(l.pick)(e,["protocol","auth","host","pathname","hash"]),{search:C.a.stringify(Object(l.extend)(t,a))}))}(e.getUrl(!0))}).finally(()=>{n(!1)})},[e.id]);return[a,a?l.noop:o]}a(1500);function WL(){return(WL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function IL(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function qL(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class DL extends n.a.Component{constructor(e){super(e),qL(this,"state",{copied:null}),qL(this,"copy",()=>{window.getSelection().selectAllChildren(this.ref.current);try{if(!document.execCommand("copy"))throw new Error;this.setState({copied:window.W_L.copy_success})}catch(e){this.setState({copied:window.W_L.copy_failed})}window.getSelection().removeAllRanges(),this.resetCopyState=setTimeout(()=>this.setState({copied:null}),2e3)}),this.ref=n.a.createRef(),this.copyFeatureEnabled=e.copyable&&document.queryCommandSupported("copy"),this.resetCopyState=null}componentWillUnmount(){this.resetCopyState&&clearTimeout(this.resetCopyState)}render(){var e=this.props,t=(e.copyable,e.children),a=IL(e,["copyable","children"]),r=n.a.createElement(we,{title:this.state.copied||window.W_L.copy},n.a.createElement(m.a,{icon:n.a.createElement(vE.a,null),type:"dashed",size:"small",onClick:this.copy}));return n.a.createElement("div",{className:"code-block"},n.a.createElement("code",WL({},a,{ref:this.ref}),t),this.copyFeatureEnabled&&r)}}qL(DL,"propTypes",{copyable:ae.a.bool,children:ae.a.node}),qL(DL,"defaultProps",{copyable:!1,children:null});a(1501);function RL(){return(RL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ML(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zL(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zL(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function FL(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function VL(e){var t=e.dialog,a=FL(e,["dialog"]),o=ML(Object(r.useState)(a.query),2),i=o[0],s=o[1],c=ML(Object(r.useState)(!1),2),u=c[0],d=c[1],p=Object(r.useCallback)(()=>{d(!0),B.post("api/queries/".concat(i.id,"/regenerate_api_key")).then(e=>{d(!1),s(Object(l.extend)(i.clone(),{api_key:e.api_key}))}).catch(()=>{d(!1),Hp.error(window.W_L.fail_update_api_key)})},[i]),f=Object(r.useMemo)(()=>({csvUrl:"".concat(Y.basePath,"api/queries/").concat(i.id,"/results.csv?api_key=").concat(i.api_key),jsonUrl:"".concat(Y.basePath,"api/queries/").concat(i.id,"/results.json?api_key=").concat(i.api_key)}),[i.id,i.api_key]),g=f.csvUrl,b=f.jsonUrl,h=Se("csv-results-label"),y=Se("json-results-label");return n.a.createElement(R.a,RL({},t.props,{width:600,footer:n.a.createElement(m.a,{onClick:()=>t.close(i)},window.W_L.close)}),n.a.createElement("div",{className:"query-api-key-dialog-wrapper"},n.a.createElement("h5",null,"API Key"),n.a.createElement("div",{className:"m-b-20"},n.a.createElement(ta.a.Group,{compact:!0},n.a.createElement(ta.a,{readOnly:!0,value:i.api_key,"aria-label":"Query API Key"}),Z.canEdit(i)&&n.a.createElement(m.a,{disabled:u,loading:u,onClick:p},window.W_L.re_generate))),n.a.createElement("h5",null,window.W_L.api_example,"："),n.a.createElement("div",{className:"m-b-10"},n.a.createElement("span",{id:h},window.W_L.result_as_csv,"："),n.a.createElement(DL,{"aria-labelledby":h,copyable:!0},g)),n.a.createElement("div",null,n.a.createElement("span",{id:y},window.W_L.result_as_json,"："),n.a.createElement(DL,{"aria-labelledby":y,copyable:!0},b))))}VL.propTypes={dialog:ia.isRequired,query:ae.a.shape({id:ae.a.number.isRequired,api_key:ae.a.string,can_edit:ae.a.bool}).isRequired};var UL=la(VL);a(1502);function BL(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return HL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return HL(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HL(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function YL(){return $E("api/queries/tags").then(e=>Object(l.map)(e,e=>e.name))}function QL(e){var t=e.query,a=e.dataSource,o=e.sourceMode,i=e.selectedVisualization,s=e.headerExtra,c=e.tagsExtra,u=e.onChange,d=Do()({minWidth:768}),p=vL(t,a),f=function(e,t){var a=PL(e,t);return Object(r.useCallback)(t=>{da("edit_name","query",e.id);var r={name:t},n={};e.is_draft&&Y.autoPublishNamedQueries&&t!==window.W_L.new_query&&(r.is_draft=!1,n.successMessage=window.W_L.query_save_publish_success),a(r,n)},[e.id,e.is_draft,a])}(t,u),g=function(e,t){var a=PL(e,t);return Object(r.useCallback)(t=>{da("edit_tags","query",e.id),a({tags:t})},[e.id,a])}(t,u),b=wL(t,u),y=function(e,t){var a=PL(e,t);return Object(r.useCallback)(()=>{da("toggle_published","query",e.id),a({is_draft:!1})},[e.id,a])}(t,u),v=function(e,t){var a=PL(e,t);return Object(r.useCallback)(()=>{da("toggle_published","query",e.id),a({is_draft:!0})},[e.id,a])}(t,u),w=BL(TL(t),2),O=w[0],_=w[1],E=function(e,t){var a=Xv(t);return Object(r.useCallback)(()=>{UL.showModal({query:e}).onClose(a)},[e,a])}(t,u),j=function(e){return Object(r.useCallback)(()=>{hE.showModal({aclUrl:"api/queries/".concat(e.id,"/acl"),context:"query",author:e.user})},[e.id,e.user])}(t),S=Object(r.useMemo)(()=>{return e=[{fork:{isEnabled:!p.isNew&&p.canFork&&!O,title:n.a.createElement(n.a.Fragment,null,window.W_L.copy," ",n.a.createElement("i",{className:"fa fa-external-link m-l-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)")),onClick:_}},{archive:{isAvailable:!p.isNew&&p.canEdit&&!p.isArchived,title:window.W_L.archived,onClick:b},managePermissions:{isAvailable:!p.isNew&&p.canEdit&&!p.isArchived&&Y.showPermissionsControl,title:window.W_L.mange_permissions,onClick:j},publish:{isAvailable:!d&&p.isDraft&&!p.isArchived&&!p.isNew&&p.canEdit,title:window.W_L.publish,onClick:y},unpublish:{isAvailable:!Y.disablePublish&&!p.isNew&&p.canEdit&&!p.isDraft,title:window.W_L.draft,onClick:v}},{showAPIKey:{isAvailable:!Y.disablePublicUrls&&!p.isNew,title:window.W_L.show+" API Key",onClick:E}}],t={},a=Object(l.map)(e,e=>Object(l.filter)(Object(l.map)(e,(e,a)=>(e=Object(l.extend)({isAvailable:!0,isEnabled:!0,onClick:()=>{}},e)).isAvailable?(t[a]=e.onClick,n.a.createElement(ue.a.Item,{key:a,disabled:!e.isEnabled},e.title)):null))),n.a.createElement(ue.a,{onClick:e=>{var a=e.key;return t[a]()}},Object(l.reduce)(Object(l.filter)(a,e=>e.length>0),(e,t,a)=>{var r=e.length>0?n.a.createElement(ue.a.Divider,{key:"divider".concat(a)}):null;return[...e,r,...t]},[]));var e,t,a},[p.isNew,p.canFork,p.canEdit,p.isArchived,p.isDraft,O,_,b,j,d,y,v,E]);return n.a.createElement("div",{className:"query-page-header"},n.a.createElement("div",{className:"title-with-tags"},n.a.createElement("div",{className:"page-title"},n.a.createElement("div",{className:"d-flex align-items-center"},!p.isNew&&n.a.createElement(Ef,{item:t}),n.a.createElement("h3",null,n.a.createElement(KE,{isEditable:p.canEdit,onDone:f,ignoreBlanks:!0,value:t.name})))),n.a.createElement("div",{className:"query-tags"},n.a.createElement(Tg,{tags:t.tags,isDraft:p.isDraft,isArchived:p.isArchived,canEdit:p.canEdit,getAvailableTags:YL,onEdit:g,tagsExtra:c}))),n.a.createElement("div",{className:"header-actions"},s,d&&p.isDraft&&!p.isArchived&&!p.isNew&&p.canEdit&&n.a.createElement(m.a,{className:"m-r-5",onClick:y},n.a.createElement("i",{className:"fa fa-paper-plane m-r-5","aria-hidden":"true"})," ",window.W_L.publish),!p.isNew&&p.canViewSource&&n.a.createElement("span",null,!o&&n.a.createElement(h.Button,{className:"m-r-5",href:t.getUrl(!0,i)},n.a.createElement("i",{className:"fa fa-pencil-square-o","aria-hidden":"true"}),n.a.createElement("span",{className:"m-l-5"},window.W_L.edit_source)),o&&n.a.createElement(h.Button,{className:"m-r-5",href:t.getUrl(!1,i),"data-test":"QueryPageShowResultOnly"},n.a.createElement("i",{className:"fa fa-table","aria-hidden":"true"}),n.a.createElement("span",{className:"m-l-5"},window.W_L.show_result_only))),!p.isNew&&n.a.createElement(Vt.a,{overlay:S,trigger:["click"]},n.a.createElement(m.a,{"data-test":"QueryPageHeaderMoreButton","aria-label":"More actions"},n.a.createElement(Db.a,{rotate:90,"aria-hidden":"true"})))))}QL.propTypes={query:ae.a.shape({id:ae.a.oneOfType([ae.a.number,ae.a.string]),name:ae.a.string,tags:ae.a.arrayOf(ae.a.string)}).isRequired,dataSource:ae.a.object,sourceMode:ae.a.bool,selectedVisualization:ae.a.number,headerExtra:ae.a.node,tagsExtra:ae.a.node,onChange:ae.a.func},QL.defaultProps={dataSource:null,sourceMode:!1,selectedVisualization:null,headerExtra:null,tagsExtra:null,onChange:()=>{}};a(1503);function KL(e){var t=e.query,a=e.dataSource,r=e.layout,o=e.onEditSchedule;return n.a.createElement("div",{className:"query-metadata query-metadata-".concat(r)},n.a.createElement("div",{className:"query-metadata-item"},n.a.createElement("img",{className:"profile__image_thumb",src:t.user.profile_image_url,alt:"Avatar"}),n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("strong",{className:me()("query-metadata-label",{"text-muted":t.user.is_disabled})},t.user.name),n.a.createElement("span",{className:"query-metadata-value"},window.W_L.create_time," ",n.a.createElement("strong",null,n.a.createElement(qf,{date:t.created_at}))))),n.a.createElement("div",{className:"query-metadata-item"},n.a.createElement("img",{className:"profile__image_thumb",src:t.last_modified_by.profile_image_url,alt:"Avatar"}),n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("strong",{className:me()("query-metadata-label",{"text-muted":t.last_modified_by.is_disabled})},t.last_modified_by.name),n.a.createElement("span",{className:"query-metadata-value"},window.W_L.update_time," ",n.a.createElement("strong",null,n.a.createElement(qf,{date:t.updated_at}))))),n.a.createElement("div",{className:"query-metadata-space"}),Object(l.has)(a,"name")&&Object(l.has)(a,"type")&&n.a.createElement("div",{className:"query-metadata-item"},window.W_L.data_source,"：",n.a.createElement("img",{src:"".concat("static/images/db-logos","/").concat(a.type,".png"),width:"20",alt:a.type}),n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("div",{className:"query-metadata-label"},a.name))),n.a.createElement("div",{className:"query-metadata-item"},n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("span",{className:"query-metadata-label"},n.a.createElement("span",{className:"zmdi zmdi-refresh m-r-5"}),window.W_L.auto_flush),n.a.createElement("span",{className:"query-metadata-value"},n.a.createElement(Rg,{isLink:Object(l.isFunction)(o),isNew:t.isNew(),schedule:t.schedule,onClick:o})))))}KL.propTypes={layout:ae.a.oneOf(["table","horizontal"]),query:ae.a.shape({created_at:ae.a.oneOfType([ae.a.string,Tf]).isRequired,updated_at:ae.a.oneOfType([ae.a.string,Tf]).isRequired,user:ae.a.shape({name:ae.a.string.isRequired,profile_image_url:ae.a.string.isRequired,is_disabled:ae.a.bool}).isRequired,last_modified_by:ae.a.shape({name:ae.a.string.isRequired,profile_image_url:ae.a.string.isRequired,is_disabled:ae.a.bool}).isRequired,schedule:ae.a.object}).isRequired,dataSource:ae.a.shape({type:ae.a.string,name:ae.a.string}),onEditSchedule:ae.a.func},KL.defaultProps={layout:"table",dataSource:null,onEditSchedule:null};a(1504);function GL(){return(GL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function $L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return JL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return JL(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JL(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function XL(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var ZL=Jn.a.TabPane;function ek(e){var t=e.title,a=e.message,r=e.refreshButton;return n.a.createElement("div",{className:"query-results-empty-state"},n.a.createElement("div",{className:"empty-state-content"},n.a.createElement("div",null,n.a.createElement("img",{src:"static/images/illustrations/no-query-results.svg",alt:window.W_L.find_nothing})),n.a.createElement("h3",null,t),n.a.createElement("div",{className:"m-b-20"},a),r))}function tk(e){var t=e.visualizationName,a=e.canDelete,o=e.onDelete,i=XL(e,["visualizationName","canDelete","onDelete"]),l=Object(r.useCallback)(e=>{e.stopPropagation(),R.a.confirm({title:window.W_L.delete_view,content:window.W_L.delete_view_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okType:"danger",onOk:o,maskClosable:!0,autoFocusButton:null})},[o]);return n.a.createElement("span",i,t,a&&n.a.createElement(ge,{className:"delete-visualization-button",onClick:l,"aria-label":"Close",title:"Close"},n.a.createElement("i",{className:"zmdi zmdi-close","aria-hidden":"true"})))}ek.propTypes={title:ae.a.string.isRequired,message:ae.a.string.isRequired,refreshButton:ae.a.node},ek.defaultProps={refreshButton:null},tk.propTypes={visualizationName:ae.a.string.isRequired,canDelete:ae.a.bool,onDelete:ae.a.func},tk.defaultProps={canDelete:!1,onDelete:()=>{}};var ak=[{type:"TABLE",name:window.W_L.table,id:null,options:{}}];function rk(e){var t=e.queryResult,a=e.selectedTab,o=e.showNewVisualizationButton,i=e.canDeleteVisualizations,s=e.onChangeTab,c=e.onAddVisualization,u=e.onDeleteVisualization,d=e.refreshButton,p=e.canRefresh,f=XL(e,["queryResult","selectedTab","showNewVisualizationButton","canDeleteVisualizations","onChangeTab","onAddVisualization","onDeleteVisualization","refreshButton","canRefresh"]),g=Object(r.useMemo)(()=>f.visualizations.length>0?f.visualizations:ak,[f.visualizations]),b={};Object(l.find)(g,{id:a})&&(b.activeKey="".concat(a)),o&&(b.tabBarExtraContent=n.a.createElement(m.a,{className:"add-visualization-button","data-test":"NewVisualization",type:"link",onClick:()=>c()},n.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}),n.a.createElement("span",{className:"m-l-5 hidden-xs"},window.W_L.add_view)));var h=Object(r.useMemo)(()=>Object(l.orderBy)(g,["id"]),[g]),y=Object(r.useCallback)(e=>e===h[0].id,[h]),v=Do()({maxWidth:768}),w=$L(Object(r.useState)([]),2),O=w[0],_=w[1];return n.a.createElement(Jn.a,GL({},b,{type:"card",className:me()("query-visualization-tabs card-style"),"data-test":"QueryPageVisualizationTabs",animated:!1,tabBarGutter:0,onChange:e=>s(+e),destroyInactiveTabPane:!0}),h.map(e=>n.a.createElement(ZL,{key:"".concat(e.id),tab:n.a.createElement(tk,{"data-test":"QueryPageVisualizationTab".concat(e.id),canDelete:!v&&i&&!y(e.id),visualizationName:e.name,onDelete:()=>u(e.id)})},t?n.a.createElement(AO,{visualization:e,queryResult:t,context:"query",filters:O,onFiltersChange:_}):n.a.createElement(ek,{title:window.W_L.find_nothing,message:p?window.W_L.please_exec_flush:window.W_L.no_permission_exec,refreshButton:d}))))}function nk(e){var t=e.status,a=e.updatedAt,r=e.error,o=e.isCancelling,i=e.onCancel,s="failed"===t?"error":"info",c="failed"!==t&&a,d=Object(l.includes)(["waiting","processing"],t),p=o?n.a.createElement(n.a.Fragment,null,"Cancelling…"):null;switch(t){case"waiting":o||(p=n.a.createElement(n.a.Fragment,null,window.W_L.query_queue,"…"));break;case"processing":o||(p=n.a.createElement(n.a.Fragment,null,window.W_L.exec_query,"…"));break;case"loading-result":p=n.a.createElement(n.a.Fragment,null,window.W_L.loading_query_result,"…");break;case"failed":p=n.a.createElement(n.a.Fragment,null,window.W_L.query_run_error,"：",n.a.createElement("strong",null,r))}return n.a.createElement(u.a,{"data-test":"QueryExecutionStatus",type:s,message:n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement("div",{className:"flex-fill p-t-5 p-b-5"},p," ",c&&n.a.createElement(qv,{from:a})),n.a.createElement("div",null,d&&n.a.createElement(m.a,{className:"m-l-10",type:"primary",size:"small",disabled:o,onClick:i},window.W_L.cancel)))})}rk.propTypes={queryResult:ae.a.object,visualizations:ae.a.arrayOf(ae.a.object),selectedTab:ae.a.number,showNewVisualizationButton:ae.a.bool,canDeleteVisualizations:ae.a.bool,onChangeTab:ae.a.func,onAddVisualization:ae.a.func,onDeleteVisualization:ae.a.func,refreshButton:ae.a.node,canRefresh:ae.a.bool},rk.defaultProps={queryResult:null,visualizations:[],selectedTab:null,showNewVisualizationButton:!1,canDeleteVisualizations:!1,onChangeTab:()=>{},onAddVisualization:()=>{},onDeleteVisualization:()=>{},refreshButton:null,canRefresh:!0},nk.propTypes={status:ae.a.string,updatedAt:ae.a.any,error:ae.a.string,isCancelling:ae.a.bool,onCancel:ae.a.func},nk.defaultProps={status:"waiting",updatedAt:null,error:null,isCancelling:!0,onCancel:()=>{}};a(1505);function ok(e){var t=e.query,a=e.dataSourcesAvailable,r=vL(t),o=null;return r.isNew&&!r.canCreate?o=n.a.createElement(n.a.Fragment,null,n.a.createElement(un.a.Title,{level:4},window.W_L.no_datasource_cant_create_query),n.a.createElement("p",null,n.a.createElement(un.a.Text,{type:"secondary"},window.W_L.apply_permission))):a||(o=H.isAdmin?n.a.createElement(n.a.Fragment,null,n.a.createElement(un.a.Title,{level:4},window.W_L.no_datasource_or_permission),n.a.createElement("p",null,n.a.createElement(un.a.Text,{type:"secondary"},window.W_L.first_create_datasource)),n.a.createElement("div",{className:"query-source-alerts-actions"},n.a.createElement(h.Button,{type:"primary",href:"data_sources/new"},window.W_L.add_datasource),n.a.createElement(h.Button,{type:"default",href:"groups"},window.W_L.mange_permissions))):n.a.createElement(n.a.Fragment,null,n.a.createElement(un.a.Title,{level:4},window.W_L.no_datasource_or_permission),n.a.createElement("p",null,n.a.createElement(un.a.Text,{type:"secondary"},window.W_L.first_create_datasource)))),o?n.a.createElement("div",{className:"query-source-alerts"},n.a.createElement(en.a,null,n.a.createElement(se,{name:"QuerySource.Alerts",query:t,dataSourcesAvailable:a},n.a.createElement("div",{className:"query-source-alerts-icon"},n.a.createElement(Hb.a,null)),o))):null}function ik(){return(ik=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function lk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sk(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sk(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sk(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ck(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function uk(e){function t(t){var a=t.queryId,o=t.onError,i=ck(t,["queryId","onError"]),l=lk(Object(r.useState)(null),2),s=l[0],c=l[1],u=Xv(o);return Object(r.useEffect)(()=>{var e=!1;return(a?Za.get({id:a}):Promise.resolve(Za.newQuery())).then(t=>{e||c(t)}).catch(u),()=>{e=!0}},[a,u]),s?n.a.createElement(e,ik({query:s,onError:o},i)):n.a.createElement(mb,{className:"flex-fill"})}return t.propTypes={queryId:ae.a.oneOfType([ae.a.number,ae.a.string])},t.defaultProps={queryId:null},t}ok.propTypes={query:ae.a.object.isRequired,dataSourcesAvailable:ae.a.bool},ok.defaultProps={dataSourcesAvailable:!1};var dk=a(728),mk=a.n(dk);a(1506);function pk(){return(pk=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return gk(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return gk(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gk(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function bk(e){var t=e.dialog,a=e.visualization,o=fk(Object(r.useState)(""),2),i=o[0],s=o[1],c=fk(sh(e=>Object(l.isString)(e)&&""!==e?jp.query({q:e}).then(e=>e.results).catch(()=>[]):Promise.resolve([]),{initialResults:[]}),3),u=c[0],d=c[1],m=c[2],p=fk(Object(r.useState)(null),2),f=p[0],g=p[1],b=fk(Object(r.useState)(!1),2),y=b[0],v=b[1];Object(r.useEffect)(()=>{u(i)},[u,i]);var w=f?[f]:d;return n.a.createElement(R.a,pk({},t.props,{title:window.W_L.widget_add_dashboard,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,okButtonProps:{disabled:!f||y,loading:y},cancelButtonProps:{disabled:y},onOk:function(){jp.get(f).then(e=>(e.addWidget(a),e)).then(e=>{t.close();var a="notification-".concat(Math.random().toString(36).substr(2,10));Hp.success(window.W_L.widget_add_dashboard,n.a.createElement(n.a.Fragment,null,n.a.createElement(h,{href:"".concat(e.url),onClick:()=>Hp.close(a)},e.name),n.a.createElement(Tg,{isDraft:e.is_draft,tags:e.tags})),{key:a})}).catch(()=>{Hp.error(window.W_L.widget_add_failed)}).finally(()=>{v(!1)})}}),n.a.createElement("label",{htmlFor:"add-to-dashboard-dialog-dashboard"},window.W_L.select_query_to_dashboard,"："),!f&&n.a.createElement(ta.a,{id:"add-to-dashboard-dialog-dashboard",className:"w-100",autoComplete:"off",autoFocus:!0,placeholder:window.W_L.filter_by_name,value:i,onChange:e=>s(e.target.value),suffix:n.a.createElement(ge,{className:""===i?"hidden":null,onClick:()=>s("")},n.a.createElement(je.a,null))}),(w.length>0||m)&&n.a.createElement(yb.a,{className:f?"add-to-dashboard-dialog-selection":"add-to-dashboard-dialog-search-results",bordered:!0,itemLayout:"horizontal",loading:m,dataSource:w,renderItem:e=>n.a.createElement(yb.a.Item,{key:"dashboard-".concat(e.id),actions:f?[n.a.createElement(ge,{onClick:()=>g(null)},n.a.createElement(je.a,null))]:[],onClick:f?null:()=>g(e)},n.a.createElement("div",{className:"add-to-dashboard-dialog-item-content"},e.name,n.a.createElement(Tg,{isDraft:e.is_draft,tags:e.tags})))}))}bk.propTypes={dialog:ia.isRequired,visualization:ae.a.object.isRequired};var hk=la(bk);a(1507);function yk(){return(yk=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function vk(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class wk extends n.a.Component{constructor(e){super(e),vk(this,"state",{enableChangeIframeSize:!1,iframeWidth:720,iframeHeight:391}),vk(this,"urlEmbedLabelId",Object(l.uniqueId)("url-embed-label")),vk(this,"iframeEmbedLabelId",Object(l.uniqueId)("iframe-embed-label"));var t=e.query,a=e.visualization;this.embedUrl="".concat(Y.basePath,"embed/query/").concat(t.id,"/visualization/").concat(a.id,"?api_key=").concat(t.api_key,"&").concat(t.getParameters().toUrlParams()),window.snapshotUrlBuilder&&(this.snapshotUrl=window.snapshotUrlBuilder(t,a))}render(){var e=this.props,t=e.query,a=e.dialog,r=this.state,o=r.enableChangeIframeSize,i=r.iframeWidth,l=r.iframeHeight;return n.a.createElement(R.a,yk({},a.props,{className:"embed-query-dialog",title:window.W_L.embed_query,footer:n.a.createElement(m.a,{onClick:a.dismiss},window.W_L.close)}),t.is_safe?n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",{id:this.urlEmbedLabelId,className:"m-t-0"},window.W_L.public_url),n.a.createElement("div",{className:"m-b-30"},n.a.createElement(DL,{"aria-labelledby":this.urlEmbedLabelId,"data-test":"EmbedIframe",copyable:!0},this.embedUrl)),n.a.createElement("h5",{id:this.iframeEmbedLabelId,className:"m-t-0"},window.W_L.iframe_embed),n.a.createElement("div",null,n.a.createElement(DL,{"aria-labelledby":this.iframeEmbedLabelId,copyable:!0},'<iframe src="'.concat(this.embedUrl,'" width="').concat(i,'" height="').concat(l,'"></iframe>')),n.a.createElement(Vb.a,{className:"m-t-10",layout:"inline"},n.a.createElement(Vb.a.Item,null,n.a.createElement($r.a,{checked:o,onChange:e=>this.setState({enableChangeIframeSize:e.target.checked})})),n.a.createElement(Vb.a.Item,{label:"Width"},n.a.createElement(Kr.a,{className:"size-input",value:i,onChange:e=>this.setState({iframeWidth:e}),size:"small",disabled:!o})),n.a.createElement(Vb.a.Item,{label:"Height"},n.a.createElement(Kr.a,{className:"size-input",value:l,onChange:e=>this.setState({iframeHeight:e}),size:"small",disabled:!o})))),this.snapshotUrl&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",null,window.W_L.image_embed),n.a.createElement(DL,{copyable:!0},this.snapshotUrl))):n.a.createElement(u.a,{message:window.W_L.query_embed_sql_error,type:"error","data-test":"EmbedErrorAlert"}))}}vk(wk,"propTypes",{dialog:ia.isRequired,query:ae.a.object.isRequired,visualization:ae.a.object.isRequired});var Ok=la(wk);var _k=a(725),Ek=a.n(_k),jk=a(726),Sk=a.n(jk),Ck=a(211),xk=a.n(Ck),Pk=a(324),Lk=a.n(Pk);function kk(e){var t="",a=e.query,r=e.queryResult,o=e.fileType,i=r.getId&&r.getId(),l=r.getData&&r.getData();return i&&l&&a.name&&(t=a.id?"api/queries/".concat(a.id,"/results/").concat(i,".").concat(o).concat(e.embed?"?api_key=".concat(e.apiKey):""):"api/query_results/".concat(i,".").concat(o)),n.a.createElement(h,{target:"_blank",rel:"noopener noreferrer",disabled:e.disabled,href:t,download:!0},e.children)}function Nk(e){var t=n.a.createElement(ue.a,null,!e.query.isNew()&&(!e.query.is_draft||!e.query.is_archived)&&n.a.createElement(ue.a.Item,null,n.a.createElement(ge,{onClick:()=>e.openAddToDashboardForm(e.selectedTab)},n.a.createElement(Ek.a,null)," ",window.W_L.add_to_dashboard)),!Y.disablePublicUrls&&!e.query.isNew()&&n.a.createElement(ue.a.Item,null,n.a.createElement(ge,{onClick:()=>e.showEmbedDialog(e.query,e.selectedTab),"data-test":"ShowEmbedDialogButton"},n.a.createElement(Sk.a,null)," ",window.W_L.embed_other)),n.a.createElement(ue.a.Item,null,n.a.createElement(kk,{fileType:"csv",disabled:e.queryExecuting||!e.queryResult.getData||!e.queryResult.getData(),query:e.query,queryResult:e.queryResult,embed:e.embed,apiKey:e.apiKey},n.a.createElement(xk.a,null)," ",window.W_L.save_as_csv)),n.a.createElement(ue.a.Item,null,n.a.createElement(kk,{fileType:"tsv",disabled:e.queryExecuting||!e.queryResult.getData||!e.queryResult.getData(),query:e.query,queryResult:e.queryResult,embed:e.embed,apiKey:e.apiKey},n.a.createElement(xk.a,null)," ",window.W_L.save_as_tsv)),n.a.createElement(ue.a.Item,null,n.a.createElement(kk,{fileType:"xlsx",disabled:e.queryExecuting||!e.queryResult.getData||!e.queryResult.getData(),query:e.query,queryResult:e.queryResult,embed:e.embed,apiKey:e.apiKey},n.a.createElement(Lk.a,null)," ",window.W_L.save_as_excel)));return n.a.createElement(Vt.a,{trigger:["click"],overlay:t,overlayClassName:"query-control-dropdown-overlay"},n.a.createElement(m.a,{"data-test":"QueryControlDropdownButton"},n.a.createElement(Db.a,{rotate:90})))}kk.propTypes={query:ae.a.object.isRequired,queryResult:ae.a.object,fileType:ae.a.string,disabled:ae.a.bool.isRequired,embed:ae.a.bool,apiKey:ae.a.string,children:ae.a.oneOfType([ae.a.arrayOf(ae.a.node),ae.a.node]).isRequired},kk.defaultProps={queryResult:{},fileType:"csv",embed:!1,apiKey:""},Nk.propTypes={query:ae.a.object.isRequired,queryResult:ae.a.object,queryExecuting:ae.a.bool.isRequired,showEmbedDialog:ae.a.func.isRequired,embed:ae.a.bool,apiKey:ae.a.string,selectedTab:ae.a.oneOfType([ae.a.string,ae.a.number]),openAddToDashboardForm:ae.a.func.isRequired},Nk.defaultProps={queryResult:{},embed:!1,apiKey:"",selectedTab:""};var Ak=a(727),Tk=a.n(Ak);function Wk(e){return n.a.createElement(m.a,{"data-test":"EditVisualization",className:"edit-visualization",onClick:()=>e.openVisualizationEditor(e.selectedTab)},n.a.createElement(Tk.a,null),n.a.createElement("span",{className:"hidden-xs hidden-s hidden-m"},window.W_L.edit_view))}Wk.propTypes={openVisualizationEditor:ae.a.func.isRequired,selectedTab:ae.a.oneOfType([ae.a.string,ae.a.number])},Wk.defaultProps={selectedTab:""};a(1518);function Ik(e){var t=e.query,a=e.queryResult,o=e.isQueryExecuting,i=e.selectedVisualization,s=e.showEditVisualizationButton,c=e.onEditVisualization,u=e.extraActions,d=Jv(a),m=function(e){return Object(r.useCallback)(t=>{var a=Object(l.find)(e.visualizations,{id:t});hk.showModal({visualization:a})},[e.visualizations])}(t),p=function(e){return Object(r.useCallback)((t,a)=>{var r=Object(l.find)(e.visualizations,{id:a});Ok.showModal({query:e,visualization:r})},[e])}(t);return n.a.createElement("div",{className:"query-execution-metadata"},n.a.createElement("span",{className:"m-r-5"},n.a.createElement(Nk,{query:t,queryResult:a,queryExecuting:o,showEmbedDialog:p,embed:!1,apiKey:t.api_key,selectedTab:i,openAddToDashboardForm:m})),u,s&&n.a.createElement(Wk,{openVisualizationEditor:c,selectedTab:i}),n.a.createElement("span",{className:"m-l-5 m-r-10"},n.a.createElement("span",null,!0===d.truncated&&n.a.createElement("span",{className:"m-r-5"},n.a.createElement(we,{title:"Result truncated to "+d.rows.length+window.W_L.redash_cut_data_tip},n.a.createElement(mk.a,{twoToneColor:"#FF9800"}))),n.a.createElement("strong",null,d.rows.length)," ",Yf("row",d.rows.length)),n.a.createElement("span",{className:"m-l-5"},!o&&n.a.createElement(n.a.Fragment,null,n.a.createElement("strong",null,Qf(d.runtime)),n.a.createElement("span",{className:"hidden-xs"}," ",window.W_L.run_time)),o&&n.a.createElement("span",null,window.W_L.runing,"…")),d.metadata.data_scanned&&n.a.createElement("span",{className:"m-l-5"},"Data Scanned",n.a.createElement("strong",null,Jf(d.metadata.data_scanned)))),n.a.createElement("div",null,n.a.createElement("span",{className:"m-r-10"},n.a.createElement("span",{className:"hidden-xs"},window.W_L.flush_time,"："),n.a.createElement("strong",null,n.a.createElement(qf,{date:d.retrievedAt,placeholder:"-"})))))}Ik.propTypes={query:ae.a.object.isRequired,queryResult:ae.a.object.isRequired,isQueryExecuting:ae.a.bool,selectedVisualization:ae.a.number,showEditVisualizationButton:ae.a.bool,onEditVisualization:ae.a.func,extraActions:ae.a.node},Ik.defaultProps={isQueryExecuting:!1,selectedVisualization:null,showEditVisualizationButton:!1,onEditVisualization:()=>{},extraActions:null};var qk=a(729),Dk=a.n(qk),Rk=a(730),Mk=a.n(Rk);function zk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fk(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Fk(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fk(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Vk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e?nS.fetchSchema(e,t).catch(()=>(Hp.error(window.W_L.flush_error,window.W_L.wait_retry),Promise.resolve([]))):Promise.resolve([])}function Uk(){return(Uk=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Bk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Hk(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Bk(Object(a),!0).forEach((function(t){Yk(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bk(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Yk(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Kk(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Kk(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kk(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Gk(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var $k=ae.a.shape({name:ae.a.string.isRequired,type:ae.a.string}),Jk=ae.a.shape({name:ae.a.string.isRequired,size:ae.a.number,loading:ae.a.bool,columns:ae.a.arrayOf($k).isRequired});function Xk(e){var t=e.item,a=e.expanded,o=e.onToggle,i=e.onSelect,s=Gk(e,["item","expanded","onToggle","onSelect"]),c=Object(r.useCallback)((function(e){e.preventDefault(),e.stopPropagation();for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];i(...a)}),[i]);if(!t)return null;var u=t.displayName||t.name;return n.a.createElement("div",s,n.a.createElement("div",{className:"schema-list-item"},n.a.createElement(ge,{className:"table-name",onClick:o},n.a.createElement("i",{className:"fa fa-table m-r-5","aria-hidden":"true"}),n.a.createElement("strong",null,n.a.createElement("span",{title:t.name},u),!Object(l.isNil)(t.size)&&n.a.createElement("span",null," (",t.size,")"))),n.a.createElement(we,{title:"Insert table name into query text",mouseEnterDelay:0,mouseLeaveDelay:0,placement:"topRight",arrowPointAtCenter:!0},n.a.createElement(ge,{className:"copy-to-editor",onClick:e=>c(e,t.name)},n.a.createElement("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})))),a&&n.a.createElement("div",{className:"table-open"},t.loading?n.a.createElement("div",{className:"table-open"},"Loading..."):Object(l.map)(t.columns,e=>{var t=Object(l.get)(e,"name"),a=Object(l.get)(e,"type");return n.a.createElement(we,{title:"Insert column name into query text",mouseEnterDelay:0,mouseLeaveDelay:0,placement:"rightTop"},n.a.createElement(ge,{key:t,className:"table-open-item",onClick:e=>c(e,t)},n.a.createElement("div",null,t," ",a&&n.a.createElement("span",{className:"column-type"},a)),n.a.createElement("div",{className:"copy-to-editor"},n.a.createElement("i",{className:"fa fa-angle-double-right","aria-hidden":"true"}))))})))}function Zk(){return n.a.createElement("div",{className:"schema-loading-state"},n.a.createElement(mb,{className:""}))}function eN(e){var t=e.loading,a=e.schema,o=e.expandedFlags,i=e.onTableExpand,l=e.onItemSelect,s=Qk(Object(r.useState)(null),2),c=s[0],u=s[1];return Object(r.useEffect)(()=>{c&&c.recomputeRowHeights()},[c,a,o]),n.a.createElement("div",{className:"schema-browser"},t&&n.a.createElement(Zk,null),!t&&n.a.createElement(Dk.a,null,e=>{var t=e.width,r=e.height;return n.a.createElement(Mk.a,{ref:u,width:t,height:r,rowCount:a.length,rowHeight:e=>{var t=e.index,r=a[t],n=r.loading?1:r.columns.length;return 22+18*(o[r.name]?n:0)},rowRenderer:e=>{var t=e.key,r=e.index,s=e.style,c=a[r];return n.a.createElement(Xk,{key:t,style:s,item:c,expanded:o[c.name],onToggle:()=>i(c.name),onSelect:l})}})}))}function tN(e,t){var a=Object(l.filter)(t.toLowerCase().split(/\s+/),e=>e.length>0);if(0===a.length)return e;if(1===a.length){var r=a[0],n=a[0];return Object(l.filter)(e,e=>Object(l.includes)(e.name.toLowerCase(),r)||Object(l.some)(e.columns,e=>Object(l.includes)(Object(l.get)(e,"name").toLowerCase(),n)))}var o=a[0],i=a[1];return Object(l.filter)(Object(l.map)(e,e=>{if(Object(l.includes)(e.name.toLowerCase(),o))return(e=Hk(Hk({},e),{},{columns:Object(l.filter)(e.columns,e=>Object(l.includes)(Object(l.get)(e,"name").toLowerCase(),i))})).columns.length>0?e:null}))}function aN(e){var t=e.dataSource,a=e.onSchemaUpdate,o=e.onItemSelect,i=(e.options,e.onOptionsUpdate,Gk(e,["dataSource","onSchemaUpdate","onItemSelect","options","onOptionsUpdate"])),l=Qk(function(e){var t=zk(Object(r.useState)([]),2),a=t[0],n=t[1],o=zk(Object(r.useState)(!0),2),i=o[0],l=o[1],s=Object(r.useRef)(null),c=Object(r.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;l(!0);var a=Math.random().toString(36).substr(2);s.current=a,Vk(e,t).then(e=>{s.current===a&&n(e)}).finally(()=>{s.current===a&&l(!1)})}),[e]);return Object(r.useEffect)(()=>{c()},[c]),Object(r.useEffect)(()=>()=>{s.current=null},[]),Object(r.useMemo)(()=>[a,i,c],[a,i,c])}(t),3),s=l[0],c=l[1],u=l[2],d=Qk(Object(r.useState)(""),2),p=d[0],f=d[1],g=Object(r.useMemo)(()=>tN(s,p),[s,p]),b=Qk(Object(Sl.a)(f,500),1)[0],h=Qk(Object(r.useState)({}),2),y=h[0],v=h[1],w=Xv(a);if(Object(r.useEffect)(()=>{v({}),w(s)},[s,w]),0===s.length&&!c)return null;return n.a.createElement("div",Uk({className:"schema-container"},i),n.a.createElement("div",{className:"schema-control"},n.a.createElement(ta.a,{className:"m-r-5",placeholder:window.W_L.search_schema,"aria-label":window.W_L.search_schema,disabled:0===s.length,onChange:e=>b(e.target.value)}),n.a.createElement(we,{title:window.W_L.flush_schema},n.a.createElement(m.a,{onClick:()=>u(!0)},n.a.createElement("i",{className:me()("zmdi zmdi-refresh",{"zmdi-hc-spin":c}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},c?"Loading, please wait.":"Press to refresh.")))),n.a.createElement(eN,{loading:c&&0===s.length,schema:g,expandedFlags:y,onTableExpand:function(e){v(Hk(Hk({},y),{},{[e]:!y[e]}))},onItemSelect:o}))}Xk.propTypes={item:Jk,expanded:ae.a.bool,onToggle:ae.a.func,onSelect:ae.a.func},Xk.defaultProps={item:null,expanded:!1,onToggle:()=>{},onSelect:()=>{}},aN.propTypes={dataSource:ae.a.object,onSchemaUpdate:ae.a.func,onItemSelect:ae.a.func},aN.defaultProps={dataSource:null,onSchemaUpdate:()=>{},onItemSelect:()=>{}};var rN=a(175),nN=a.n(rN),oN=(a(1592),a(1593),a(1594),a(1595),a(1596),a(1597),a(1598),nN.a.acequire("ace/ext/language_tools")),iN=nN.a.acequire("ace/snippets");function lN(e){nN.a.define("ace/snippets/".concat(e),["require","exports","module"],(t,a)=>{a.snippetText="",a.scope=e})}function sN(e){var t=[],a={},r={};return e.forEach(e=>{t.push({name:e.name,value:e.name,score:100,meta:"Table"}),r[e.name]=function(e){var t=[];return e.columns.forEach(a=>{var r=Object(l.get)(a,"name");t.push({name:"".concat(e.name,".").concat(r),value:"".concat(e.name,".").concat(r),score:100,meta:Object(l.capitalize)(Object(l.get)(a,"type","Column"))})}),t}(e),e.columns.forEach(e=>{var t=Object(l.get)(e,"name",e);a[t]=Object(l.capitalize)(Object(l.get)(e,"type","Column"))})}),{table:t,column:Object(l.map)(a,(e,t)=>({name:t,value:t,score:50,meta:e})),tableColumn:r}}lN("python"),lN("sql"),lN("json"),lN("yaml");var cN={};function uN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;cN[e]=Object(l.isNil)(t)?null:sN(t)}oN.setCompleters([oN.snippetCompleter,oN.keyWordCompleter,oN.textCompleter,{identifierRegexps:[/[a-zA-Z_0-9.\-\u00A2-\uFFFF]/],getCompletions:(e,t,a,r,n)=>{var o=cN[e.id]||{table:[],column:[],tableColumn:[]},i=o.table,l=o.column,s=o.tableColumn;if(0!==r.length&&0!==i.length)if("."!==r[r.length-1])n(null,i.concat(l));else{var c=r.substring(0,r.length-1);n(null,i.concat(s[c]))}else n(null,[])}}]);class dN{constructor(e){Object(l.extend)(this,e)}getSnippet(){var e=this.trigger;return""!==this.description&&(e="".concat(this.trigger,": ").concat(this.description)),{name:e,content:this.snippet,tabTrigger:this.trigger}}}var mN=e=>new dN(e),pN={get:e=>B.get("api/query_snippets/".concat(e.id)).then(mN),query:()=>B.get("api/query_snippets").then(e=>Object(l.map)(e,mN)),create:e=>B.post("api/query_snippets",e).then(mN),save:e=>B.post("api/query_snippets/".concat(e.id),e).then(mN),delete:e=>B.delete("api/query_snippets/".concat(e.id))};a(1599);function fN(e){var t=e.available,a=e.enabled,o=e.onToggle,i=window.W_L.auto_enable,l="icon-flash";a||(i=window.W_L.auto_disable,l="icon-flash-off"),t||(i=window.W_L.auto_info,l="icon-flash-off");var s=Object(r.useCallback)(()=>{da("toggle_autocomplete","screen","query_editor",{state:!a}),o(!a)},[a,o]);return n.a.createElement(we,{placement:"top",title:i},n.a.createElement(m.a,{className:"query-editor-controls-button m-r-5",disabled:!t,onClick:s,"aria-label":a?"Disable live autocomplete":"Enable live autocomplete"},n.a.createElement("i",{className:"icon "+l,"aria-hidden":"true"})))}fN.propTypes={available:ae.a.bool.isRequired,enabled:ae.a.bool.isRequired,onToggle:ae.a.func.isRequired};a(1600);function gN(e){var t=e.available,a=e.checked,o=e.onChange,i=Object(r.useCallback)(()=>{da("checkbox_auto_limit","screen","query_editor",{state:!a}),o(!a)},[a,o]),l=null;return l=t?window.W_L.limit_1000:window.W_L.not_limit,n.a.createElement(we,{placement:"top",title:l},n.a.createElement($r.a,{className:"query-editor-controls-checkbox",disabled:!t,onClick:i,checked:t&&a},window.W_L.return_1000))}function bN(){return(bN=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function hN(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function yN(e){var t=e.title,a=e.shortcut,r=hN(e,["title","shortcut"]);return a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a={mod:Object(l.upperFirst)(iy),alt:Object(l.upperFirst)(ly)};return e=Object(l.toLower)(Object(l.toString)(e)),e=Object(l.filter)(Object(l.map)(e.split(","),l.trim),e=>""!==e).slice(0,t),""!==(e=Object(l.map)(e,e=>(e=Object(l.filter)(Object(l.map)(e.split("+")),e=>""!==e),Object(l.map)(e,e=>a[e]||Object(l.upperFirst)(e)).join(" + "))).join(", "))?e:null}(a,1),t=t&&a?n.a.createElement(n.a.Fragment,null,t," (",n.a.createElement("i",null,a),")"):t||a,n.a.createElement(we,bN({placement:"top",title:t},r))}function vN(e){var t=e.addParameterButtonProps,a=e.formatButtonProps,o=e.saveButtonProps,i=e.executeButtonProps,s=e.autocompleteToggleProps,c=e.autoLimitCheckboxProps,u=e.dataSourceSelectorProps;return Object(r.useEffect)(()=>{var e=Object(l.filter)([t,a,o,i],e=>e.shortcut&&Object(l.isFunction)(e.onClick));if(e.length>0){var r=Object(l.fromPairs)(Object(l.map)(e,e=>[e.shortcut,e.disabled?l.noop:e.onClick]));return uy.bind(r),()=>{uy.unbind(r)}}},[t,a,o,i]),n.a.createElement("div",{className:"query-editor-controls"},!1!==t&&n.a.createElement(yN,{title:t.title,shortcut:t.shortcut},n.a.createElement(m.a,{className:"query-editor-controls-button m-r-5",disabled:t.disabled,onClick:t.onClick},"{{"," ","}}")),!1!==a&&n.a.createElement(yN,{title:a.title,shortcut:a.shortcut},n.a.createElement(m.a,{className:"query-editor-controls-button m-r-5",disabled:a.disabled,onClick:a.onClick},n.a.createElement("span",{className:"zmdi zmdi-format-indent-increase"}),a.text)),!1!==s&&n.a.createElement(fN,{available:s.available,enabled:s.enabled,onToggle:s.onToggle}),!1!==c&&n.a.createElement(gN,c),!1===u&&n.a.createElement("span",{className:"query-editor-controls-spacer"}),!1!==u&&n.a.createElement(Yr.a,{className:"w-100 flex-fill datasource-small",disabled:u.disabled,value:u.value,onChange:u.onChange},Object(l.map)(u.options,e=>n.a.createElement(Yr.a.Option,{key:"option-".concat(e.value),value:e.value},e.label))),!1!==o&&n.a.createElement(yN,{title:o.title,shortcut:o.shortcut},n.a.createElement(m.a,{className:"query-editor-controls-button m-l-5",disabled:o.disabled,loading:o.loading,onClick:o.onClick,"data-test":"SaveButton"},!o.loading&&n.a.createElement("span",{className:"fa fa-floppy-o"}),o.text)),!1!==i&&n.a.createElement(yN,{title:i.title,shortcut:i.shortcut},n.a.createElement(m.a,{className:"query-editor-controls-button m-l-5",type:"primary",disabled:i.disabled,onClick:i.onClick,"data-test":"ExecuteButton"},n.a.createElement("span",{className:"zmdi zmdi-play"}),i.text)))}gN.propTypes={available:ae.a.bool,checked:ae.a.bool.isRequired,onChange:ae.a.func.isRequired},yN.propTypes={title:ae.a.node,shortcut:ae.a.string},yN.defaultProps={title:null,shortcut:null};var wN=ae.a.oneOfType([ae.a.bool,ae.a.shape({title:ae.a.node,disabled:ae.a.bool,loading:ae.a.bool,onClick:ae.a.func,text:ae.a.node,shortcut:ae.a.string})]);vN.propTypes={addParameterButtonProps:wN,formatButtonProps:wN,saveButtonProps:wN,executeButtonProps:wN,autocompleteToggleProps:ae.a.oneOfType([ae.a.bool,ae.a.shape({available:ae.a.bool,enabled:ae.a.bool,onToggle:ae.a.func})]),autoLimitCheckboxProps:ae.a.oneOfType([ae.a.bool,ae.a.shape(gN.propTypes)]),dataSourceSelectorProps:ae.a.oneOfType([ae.a.bool,ae.a.shape({disabled:ae.a.bool,value:ae.a.oneOfType([ae.a.string,ae.a.number]),options:ae.a.arrayOf(ae.a.shape({value:ae.a.oneOfType([ae.a.string,ae.a.number]),label:ae.a.node})),onChange:ae.a.func})])},vN.defaultProps={addParameterButtonProps:!1,formatButtonProps:!1,saveButtonProps:!1,executeButtonProps:!1,autocompleteToggleProps:!1,autoLimitCheckboxProps:!1,dataSourceSelectorProps:!1};a(1601);function ON(){return(ON=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return EN(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return EN(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EN(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function jN(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var SN={$blockScrolling:1/0},CN=n.a.forwardRef((function(e,t){var a=e.className,o=e.syntax,i=e.value,l=e.autocompleteEnabled,s=e.schema,c=e.onChange,u=e.onSelectionChange,d=jN(e,["className","syntax","value","autocompleteEnabled","schema","onChange","onSelectionChange"]),m=_N(Object(r.useState)(null),2),p=m[0],f=m[1],g=_N(Object(r.useState)(null),2),b=g[0],h=g[1],y=_N(Object(r.useState)(i),2),v=y[0],w=y[1];Object(r.useEffect)(()=>{w(i)},[i]);var O=Object(r.useCallback)(e=>{w(e),c(e)},[c]),_=Object(r.useMemo)(()=>({behavioursEnabled:!0,enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:l,autoScrollEditorIntoView:!0}),[l]);Object(r.useEffect)(()=>{if(b){var e=b.editor.id;return uN(e,s),()=>{uN(e,null)}}},[s,b]),Object(r.useEffect)(()=>{function e(){b&&b.editor.resize()}if(p)return e(),Ar(p,e)},[p,b]);var E=Object(r.useCallback)(e=>{var t=b.editor.session.doc.getTextRange(e.getRange()),a=t.length>1?t:null;u(a)},[b,u]),j=Object(r.useCallback)(e=>{e.commands.bindKey({win:"Ctrl+L",mac:"Cmd+L"},null),e.commands.bindKey({win:"Ctrl+Shift+F",mac:"Cmd+Shift+F"},null),e.commands.bindKey({win:"Ctrl+P",mac:null},null),e.commands.bindKey({win:null,mac:"Ctrl+P"},"golineup"),e.commands.bindKey({win:"Esc",mac:"Esc"},()=>{e.blur()});var t=null;e.on("focus",()=>{t=function(e){var t=e.text,a=e.expiry,r=void 0===a?1e3:a,n=e.container,o=void 0===n?document.body:n,i=e.politeness,l=void 0===i?"polite":i,s=document.createElement("div"),c="speak-".concat(Date.now());s.id=c,s.className="sr-only",s.textContent=t,s.setAttribute("role","alert"),s.setAttribute("aria-live",l),o.appendChild(s);var u=null,d=!1,m=()=>{if(!d){d=!0;try{o.removeChild(s)}catch(e){console.error(e)}u&&window.clearTimeout(u)}};return u=window.setTimeout(m,r),m}({text:"You've entered the SQL editor. To exit press the ESC key.",politeness:"assertive"})}),e.on("blur",()=>{t&&t()}),e.commands.on("afterExec",t=>{"insertstring"===t.command.name&&"."===t.args&&e.completer&&e.completer.showPopup(e)}),pN.query().then(e=>{var t=iN.snippetManager,a={snippetText:""};a.snippets=t.parseSnippetFile(a.snippetText),e.forEach(e=>{a.snippets.push(e.getSnippet())}),t.register(a.snippets||[],a.scope)}),e.focus()},[]);return Object(r.useImperativeHandle)(t,()=>({paste:e=>{if(b){var t=b.editor;t.session.doc.replace(t.selection.getRange(),e);var a=t.selection.getRange();c(t.session.getValue()),t.selection.setRange(a)}},focus:()=>{b&&b.editor.focus()}}),[b,c]),n.a.createElement("div",ON({className:me()("query-editor-container",a)},d,{ref:f}),n.a.createElement(Ox.a,{ref:h,theme:"textmate",mode:o||"sql",value:v,editorProps:SN,width:"100%",height:"100%",setOptions:_,showPrintMargin:!1,wrapEnabled:!1,onLoad:j,onChange:O,onSelectionChange:E}))}));CN.propTypes={className:ae.a.string,syntax:ae.a.string,value:ae.a.string,autocompleteEnabled:ae.a.bool,schema:ae.a.arrayOf(Jk),onChange:ae.a.func,onSelectionChange:ae.a.func},CN.defaultProps={className:null,syntax:null,value:null,autocompleteEnabled:!0,schema:[],onChange:()=>{},onSelectionChange:()=>{}},CN.Controls=vN;var xN=CN,PN=a(731),LN=a.n(PN);function kN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function NN(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?kN(Object(a),!0).forEach((function(t){AN(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kN(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function AN(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function TN(e){return Object(l.has)(e,"job.id")?Ua(e.job.id,1e3):e}function WN(e){return Object(l.has)(e,"error")?Promise.reject(new Error(e.error.message)):e}var IN=NN(NN({},nS),{},{getDatabases:function(e){var t=e.id,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={};return a&&(r.refresh=!0),B.get("api/databricks/databases/".concat(t),{params:r}).then(TN).then(WN)},getDatabaseTables:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={};return a&&(r.refresh=!0),B.get("api/databricks/databases/".concat(e.id,"/").concat(t,"/tables"),{params:r}).then(TN).then(WN)},getTableColumns:(e,t,a)=>B.get("api/databricks/databases/".concat(e.id,"/").concat(t,"/columns/").concat(a)).then(TN).then(WN)});function qN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return DN(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return DN(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DN(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function RN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function MN(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?RN(Object(a),!0).forEach((function(t){zN(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):RN(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function zN(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function FN(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?IN.getDatabases(e,t).catch(()=>(Hp.error("Failed to load Database list.","Please try again later."),Promise.reject())):Promise.resolve([])}function VN(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e&&t?IN.getDatabaseTables(e,t,a).catch(()=>(Hp.error("Failed to load tables for ".concat(t,"."),"Please try again later."),Promise.reject())):Promise.resolve([])}function UN(e,t){return t?Object(l.map)(e,e=>{var a=t+".",r=e.name;return Object(l.startsWith)(e.name,a)&&(r=e.name.slice(a.length)),MN(MN({},e),{},{displayName:r})}):e}a(1602);function BN(){return(BN=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function HN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function YN(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?HN(Object(a),!0).forEach((function(t){QN(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):HN(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function QN(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function KN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return GN(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return GN(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GN(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function $N(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function JN(e){var t=e.dataSource,a=e.options,o=e.onOptionsUpdate,i=e.onSchemaUpdate,s=e.onItemSelect,c=$N(e,["dataSource","options","onOptionsUpdate","onSchemaUpdate","onItemSelect"]),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=Object(r.useState)([]),o=qN(n,2),i=o[0],s=o[1],c=Object(r.useState)(!0),u=qN(c,2),d=u[0],m=u[1],p=Object(r.useState)(),f=qN(p,2),g=f[0],b=f[1],h=Object(r.useState)({}),y=qN(h,2),v=y[0],w=y[1],O=Object(r.useState)(!1),_=qN(O,2),E=_[0],j=_[1],S=Object(r.useState)(!1),C=qN(S,2),x=C[0],P=C[1],L=Object(r.useCallback)(e=>w(t=>MN(MN({},t),{},{[g]:e})),[g]),k=Object(r.useRef)();k.current=g;var N=Object(r.useCallback)(t=>{IN.getTableColumns(e,g,t.substring(g.length+1)).then(e=>{k.current===g&&w(a=>{var r=Object(l.get)(a,g,[]),n=Object(l.map)(r,a=>a.name===t?MN(MN({},a),{},{columns:e,loading:!1}):a);return MN(MN({},a),{},{[g]:n})})})},[e,g]),A=Object(r.useMemo)(()=>UN(Object(l.get)(v,g,[]),g),[v,g]),T=Object(r.useCallback)(()=>{if(!x){P(!0);var t=FN(e,!0).then(s),a=VN(e,g,!0).then(e=>{var t=e.schema;return L(t)});Promise.all([a.catch(()=>{}),t.catch(()=>{})]).then(()=>P(!1))}},[e,g,L,x]),W=Object(r.useRef)();W.current=v,Object(r.useEffect)(()=>{var t=!1;return g&&!Object(l.has)(W.current,g)&&(j(!0),VN(e,g).catch(()=>Promise.resolve({schema:[],has_columns:!0})).then(a=>{var r=a.schema,n=a.has_columns;t||(n||Object(l.isEmpty)(r)||(r=Object(l.map)(r,e=>MN(MN({},e),{},{loading:!0})),VN(e,g,!0).then(e=>{var a=e.schema;t||L(a)})),L(r))}).finally(()=>{t||j(!1)})),()=>{t=!0}},[e,g,L]);var I=Object(r.useRef)();I.current=Object(l.get)(t,"selectedDatabase",null),Object(r.useEffect)(()=>{var t=!1;return m(!0),b(void 0),w({}),FN(e).catch(()=>Promise.resolve([])).then(a=>{if(!t){s(a);var r=I.current||localStorage.getItem("lastSelectedDatabricksDatabase_".concat(e.id));r||(r=Object(l.includes)(a,"default")?"default":Object(l.first)(a)||null),b(r)}}).finally(()=>{t||m(!1)}),()=>{t=!0}},[e]);var q=Object(r.useCallback)(r=>{if(r)try{localStorage.setItem("lastSelectedDatabricksDatabase_".concat(e.id),r)}catch(e){}b(r),Object(l.isFunction)(a)&&r!==I.current&&a(MN(MN({},t),{},{selectedDatabase:r}))},[e.id,t,a]);return{databases:i,loadingDatabases:d,schema:A,loadingSchema:E,currentDatabaseName:g,setCurrentDatabase:q,loadTableColumns:N,refreshAll:T,refreshing:x}}(t,a,o),d=u.databases,p=u.loadingDatabases,f=u.schema,g=u.loadingSchema,b=u.loadTableColumns,h=u.currentDatabaseName,y=u.setCurrentDatabase,v=u.refreshAll,w=u.refreshing,O=KN(Object(r.useState)(""),2),_=O[0],E=O[1],j=KN(Object(r.useState)(""),2),S=j[0],C=j[1],x=Object(r.useMemo)(()=>tN(f,_),[f,_]),P=KN(Object(r.useState)(!1),2),L=P[0],k=P[1],N=KN(Object(r.useState)({}),2),A=N[0],T=N[1],W=KN(Object(Sl.a)(E,500),1)[0],I=KN(Object(Sl.a)(C,500),2),q=I[0],D=I[1],R=Object(r.useCallback)(e=>{y(e),D(),C("")},[D,y]),M=Object(r.useMemo)(()=>Object(l.filter)(d,e=>Object(l.includes)(e.toLowerCase(),S.toLowerCase())),[d,S]),z=Xv(i);return Object(r.useEffect)(()=>{z(f)},[f,z]),Object(r.useEffect)(()=>{T({})},[h]),n.a.createElement("div",BN({className:"databricks-schema-browser schema-container"},c),n.a.createElement("div",{className:"schema-control"},n.a.createElement(ta.a,{className:L?"database-select-open":"",placeholder:window.W_L.filter_table_columns,"aria-label":"{window.W_L.search_schema}",disabled:p||g,onChange:e=>W(e.target.value),addonBefore:n.a.createElement(Yr.a,{dropdownClassName:"databricks-schema-browser-db-dropdown",loading:p,disabled:p,onChange:R,value:h,showSearch:!0,onSearch:q,onDropdownVisibleChange:k,placeholder:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-database m-r-5","aria-hidden":"true"})," Database")},M.map(e=>n.a.createElement(Yr.a.Option,{key:e},n.a.createElement("i",{className:"fa fa-database m-r-5","aria-hidden":"true"}),e)))})),n.a.createElement("div",{className:"schema-list-wrapper"},n.a.createElement(eN,{loading:p||g,schema:x,expandedFlags:A,onTableExpand:function(e){var t=Object(l.find)(f,{name:e});!A[e]&&Object(l.get)(t,"loading",!1)&&b(e),T(YN(YN({},A),{},{[e]:!A[e]}))},onItemSelect:s}),!(g||p)&&n.a.createElement("div",{className:"load-button"},n.a.createElement(we,{title:w?null:"Refresh Databases and Current Schema"},n.a.createElement(m.a,{type:"link",onClick:v,disabled:w},n.a.createElement(LN.a,{spin:w}))))))}function XN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ZN(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?XN(Object(a),!0).forEach((function(t){eA(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):XN(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function eA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}JN.propTypes={dataSource:ae.a.object,options:ae.a.object,onOptionsUpdate:ae.a.func,onSchemaUpdate:ae.a.func,onItemSelect:ae.a.func},JN.defaultProps={dataSource:null,options:null,onOptionsUpdate:()=>{},onSchemaUpdate:()=>{},onItemSelect:()=>{}};var tA=new Map,aA="SchemaBrowser",rA="QueryEditor";function nA(e,t,a){Object(l.isNil)(a)&&(a=[null]),Object(l.isArray)(a)||(a=[a]),Object(l.each)(a,a=>{tA.set(a,ZN(ZN({},tA.get(a)),{},{[e]:t}))})}function oA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return iA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return iA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function lA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function cA(e){var t=Object(r.useMemo)(()=>Object(l.first)(Object(l.orderBy)(e,["id"]))||{},[e]),a=lA(Object(r.useState)(+A.hash||t.id),2),n=a[0],o=a[1];return Object(r.useEffect)(()=>{var e=n!==t.id?"".concat(n):null;return A.hash!==e&&A.setHash(e),A.listen(()=>{A.hash!==e&&o(+A.hash||t.id)})},[t.id,n]),Object(r.useEffect)(()=>{Object(l.find)(e,{id:n})||o(t.id)},[t.id,n,e]),Object(r.useMemo)(()=>[n,o],[n])}function uA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return dA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function mA(e){var t=Object(r.useMemo)(()=>function(e){return Object(l.reduce)(e,(e,t)=>e+t.columns.length,0)}(e)<=5e3,[e]),a=uA(Object(r.useState)(Qa.get("liveAutocomplete",!0)),2),n=a[0],o=a[1],i=Object(r.useCallback)(e=>{o(e),Qa.set("liveAutocomplete",e)},[]);return Object(r.useMemo)(()=>[t,n,i],[t,n,i])}function pA(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function fA(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pA(Object(a),!0).forEach((function(t){gA(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pA(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function gA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function bA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return hA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return hA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function yA(e,t,a){var n=function(e){return Object(l.get)(e,"supports_auto_limit",!1)}(e),o=bA(Object(r.useState)(t.options.apply_auto_limit),2),i=o[0],s=o[1];return t.options.apply_auto_limit=i,[n,i,Object(r.useCallback)(e=>{s(e),Qa.set("applyAutoLimit",e),a(Object(l.extend)(t.clone(),{options:fA(fA({},t.options),{},{apply_auto_limit:e})}))},[t,a])]}nA(aA,aN),nA(rA,xN),nA(aA,JN,["databricks","databricks_internal"]);var vA=v()("redash:notifications"),wA=window.Notification||null;wA||vA("HTML5 notifications are not supported.");var OA=Object(l.find)(["hidden","webkitHidden","mozHidden","msHidden"],e=>e in document);var _A={getPermissions:function(){wA&&"default"===wA.permission&&wA.requestPermission()},showNotification:function(e,t){wA&&document[OA]&&"granted"===wA.permission&&(new wA(e,{tag:e+t,body:t,icon:vt.a}).onclick=function(){window.focus(),this.close(),da("click","notification")})}};function EA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return jA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function SA(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function CA(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?SA(Object(a),!0).forEach((function(t){xA(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):SA(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function xA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var PA=(e,t)=>CA(CA({},e),t);function LA(e){var t=EA(Object(r.useReducer)(PA,{queryResult:null,isExecuting:!1,loadedInitialResults:!1,executionStatus:null,isCancelling:!1,cancelCallback:null,error:null}),2),a=t[0],n=t[1],o=Object(r.useRef)(null);Object(r.useEffect)(()=>()=>{o.current=null},[]);var i=Xv((function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;t=i?i():e.getQueryResult(r),da("execute","query",e.id),_A.getPermissions(),o.current=t,n({updatedAt:t.getUpdatedAt(),executionStatus:t.getStatus(),isExecuting:!0,cancelCallback:()=>{da("cancel_execute","query",e.id),n({isCancelling:!0}),t.cancelExecution()}});var l=e=>{o.current===t&&n({updatedAt:t.getUpdatedAt(),executionStatus:e})};t.toPromise(l).then(r=>{o.current===t&&(r&&r.query_result.query===e.query&&(e.latest_query_data_id=r.getId(),e.queryResult=r),a.loadedInitialResults&&_A.showNotification("DeepBI","".concat(e.name," updated.")),n({queryResult:r,loadedInitialResults:!0,error:null,isExecuting:!1,isCancelling:!1,executionStatus:null}))}).catch(r=>{o.current===t&&(a.loadedInitialResults&&_A.showNotification("DeepBI","".concat(e.name," failed to run: ").concat(r.getError())),n({queryResult:r,loadedInitialResults:!0,error:r.getError(),isExecuting:!1,isCancelling:!1,executionStatus:Ra}))})})),l=Object(r.useRef)(e);return l.current=e,Object(r.useEffect)(()=>{var e;l.current.hasResult()||l.current.paramsRequired()?i(void 0!==(e=A.search.maxAge)?e:-1):n({loadedInitialResults:!0})},[i]),CA(CA({},a),{executeQuery:i})}function kA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return NA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return NA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function AA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return TA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return TA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function WA(e){var t=Object(r.useMemo)(()=>e.getParametersDefs(),[e]),a=AA(Object(r.useState)(e.getParameters().hasPendingValues()),2),n=a[0],o=a[1],i=Object(r.useCallback)(t=>{t=Object(l.isUndefined)(t)?e.getParameters().hasPendingValues():t,o(t)},[e]);return Object(r.useEffect)(()=>{var t=e.getParameters().hasPendingValues();t!==n&&o(t)},[e,t,n]),Object(r.useMemo)(()=>[t,n,i],[t,n,i])}var IA=a(732),qA=a.n(IA);function DA(){return(DA=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function RA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function MA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var FA=Ea.a.weekdaysShort(),VA=Ea.a.weekdays(),UA=Yr.a.Option,BA=Yr.a.OptGroup;function HA(e){var t=MA(Object(r.useState)(e.defaultValue),2),a=t[0],o=t[1],i=a&&!a.isUTC();return n.a.createElement(n.a.Fragment,null,n.a.createElement(qA.a,{allowClear:!1,value:a,format:"HH:mm",minuteStep:5,onChange:function(t){o(t),e.onChange(t)}}),i&&n.a.createElement("span",{className:"utc","data-testid":"utc"},"(",Ea.a.utc(a).format("HH:mm")," UTC)"))}HA.propTypes={defaultValue:Tf,onChange:ae.a.func.isRequired},HA.defaultProps={defaultValue:null};class YA extends n.a.Component{constructor(){super(...arguments),RA(this,"state",this.getState()),RA(this,"setTime",e=>{this.newSchedule={time:Ea()(e).utc().format("HH:mm")}}),RA(this,"setInterval",e=>{var t=this.state.newSchedule,a=Hf(e).interval;a===Mf.NEVER&&(t.until=null),-1!==[Mf.NEVER,Mf.MINUTES,Mf.HOURS].indexOf(a)&&(t.time=null),a!==Mf.WEEKS&&(t.day_of_week=null),a!==Mf.DAYS&&a!==Mf.WEEKS||this.state.minute&&this.state.hour||(t.time=Ea()().hour("00").minute("15").utc().format("HH:mm")),a!==Mf.WEEKS||this.state.dayOfWeek||(t.day_of_week=VA[0]),t.interval=e;var r=MA(t.time?Bf(t.time).split(":"):[null,null],2),n=r[0],o=r[1];this.setState({interval:a,seconds:e,hour:n,minute:o,dayOfWeek:t.day_of_week?FA[VA.indexOf(t.day_of_week)]:null}),this.newSchedule=t}),RA(this,"setScheduleUntil",(e,t)=>{this.newSchedule={until:t}}),RA(this,"setWeekday",e=>{var t=e.target.value;this.setState({dayOfWeek:t}),this.newSchedule={day_of_week:t?VA[FA.indexOf(t)]:null}}),RA(this,"setUntilToggle",e=>{var t=e.target.value?Ea()().format("YYYY-MM-DD"):null;this.setScheduleUntil(null,t)})}getState(){var e=Object(l.clone)(this.props.schedule||YA.defaultProps.schedule),t=e.time,a=e.interval,r=e.day_of_week,n=Hf(a).interval,o=MA(t?Bf(t).split(":"):[null,null],2);return{hour:o[0],minute:o[1],seconds:a,interval:n,dayOfWeek:r?FA[VA.indexOf(r)]:null,newSchedule:e}}get intervals(){var e={[Mf.NEVER]:[]};return this.props.refreshOptions.forEach(t=>{var a=Hf(t),r=a.count,n=a.interval;n in e||(e[n]=[]),e[n].push([r,t])}),Object.defineProperty(this,"intervals",{value:e}),e}set newSchedule(e){this.setState(t=>({newSchedule:DA(t.newSchedule,e)}))}save(){var e=this.state.newSchedule;(()=>{var t=Object(l.omitBy)(e,l.isNil),a=Object(l.omitBy)(this.props.schedule,l.isNil);return!Object(l.isEqual)(t,a)})()&&(e.interval?this.props.dialog.close(Object(l.clone)(e)):this.props.dialog.close(null)),this.props.dialog.dismiss()}render(){var e=this.props.dialog,t=this.state,a=t.interval,r=t.minute,o=t.hour,i=t.seconds,s=t.newSchedule.until;return n.a.createElement(R.a,DA({},e.props,{title:window.W_L.auto_flush,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,className:"schedule",onOk:()=>this.save()}),n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,window.W_L.flush_hz),n.a.createElement("div",{"data-testid":"interval"},n.a.createElement(Yr.a,{className:"input",value:i,onChange:this.setInterval,dropdownMatchSelectWidth:!1},n.a.createElement(UA,{value:null,key:"never"},window.W_L.flush_never),Object.keys(this.intervals).filter(e=>!Object(l.isEmpty)(this.intervals[e])).map(e=>n.a.createElement(BA,{label:Object(l.capitalize)(Yf(e)),key:e},this.intervals[e].map(t=>{var a=MA(t,2),r=a[0],o=a[1];return n.a.createElement(UA,{value:o,key:"".concat(e,"-").concat(r)},Qf(o))})))))),-1!==[Mf.DAYS,Mf.WEEKS].indexOf(a)?n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,window.W_L.on_time),n.a.createElement("div",{"data-testid":"time"},n.a.createElement(HA,{defaultValue:o?Ea()().hour(o).minute(r):null,onChange:this.setTime}))):null,Mf.WEEKS===a?n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,window.W_L.on_day),n.a.createElement("div",{"data-testid":"weekday"},n.a.createElement(kn.a.Group,{size:"medium",defaultValue:this.state.dayOfWeek,onChange:this.setWeekday},FA.map(e=>n.a.createElement(kn.a.Button,{value:e,key:e,className:"input"},e[0]))))):null,a!==Mf.NEVER?n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,window.W_L.ends),n.a.createElement("div",{className:"ends","data-testid":"ends"},n.a.createElement(kn.a.Group,{size:"medium",value:!!s,onChange:this.setUntilToggle},n.a.createElement(kn.a,{value:!1},window.W_L.never),n.a.createElement(kn.a,{value:!0},window.W_L.on)),s?n.a.createElement(yy.a,{size:"small",className:"datepicker",value:Ea()(s),allowClear:!1,format:"YYYY-MM-DD",onChange:this.setScheduleUntil}):null)):null)}}RA(YA,"propTypes",{schedule:Sf,refreshOptions:ae.a.arrayOf(ae.a.number).isRequired,dialog:ia.isRequired}),RA(YA,"defaultProps",{schedule:Cf});var QA=la(YA);function KA(e,t){var a=vL(e),n=PL(e,t);return Object(r.useCallback)(()=>{if(a.canEdit&&a.canSchedule){var t=Y.queryRefreshIntervals,r=Z.getQueryRefreshIntervals(),o=Object(l.isArray)(r)?Object(l.intersection)(t,r):t;QA.showModal({schedule:e.schedule,refreshOptions:o}).onClose(t=>{da("edit_schedule","query",e.id),n({schedule:t})})}},[e.id,e.schedule,a.canEdit,a.canSchedule,n])}var GA={save:e=>B.post((e=>e.id?"api/visualizations/".concat(e.id):"api/visualizations")(e),e),delete:e=>B.delete("api/visualizations/".concat(e.id))};a(1605);function $A(){return($A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function JA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return XA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return XA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function XA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ZA(e){var t=e.dialog,a=e.visualization,o=e.query,i=e.queryResult,s=Object(r.useRef)(),c=!a,u=Jv(i),d=JA(Object(r.useState)(u.filters),2),m=d[0],p=d[1],f=Object(r.useMemo)(()=>({columns:u.columns,rows:Kv(u.rows,m)}),[u,m]),g=Object(r.useMemo)(()=>{var e=a?rp[a.type]:np(),t=e.getOptions(c?{}:a.options,u);return{type:e.type,name:c?e.name:a.name,options:t,originalOptions:t}},[u,c,a]),b=JA(Object(r.useState)(g.type),2),h=b[0],y=b[1],v=JA(Object(r.useState)(g.name),2),w=v[0],O=v[1],_=JA(Object(r.useState)(!1),2),E=_[0],j=_[1],S=JA(Object(r.useState)(g.options),2),C=S[0],x=S[1],P=JA(Object(r.useState)(!1),2),L=P[0],k=P[1];function N(e){var t=rp[h];x(t.getOptions(e,u))}Object(r.useEffect)(()=>{s.current&&s.current.reset()},[u,C]);var A=c?Object(l.filter)(rp,e=>!e.isDeprecated):Object(l.pick)(rp,[h]),T=Se("visualization-type"),W=Se("visualization-name");return n.a.createElement(R.a,$A({},t.props,{wrapClassName:"ant-modal-fullscreen",title:window.W_L.edit_view,okText:window.W_L.save,cancelText:window.W_L.cancel,okButtonProps:{loading:L,disabled:L},onOk:function(){k(!0);var e=C;"TABLE"===h&&(e=Object(l.omit)(e,["paginationSize"])),function(e){return e.id?da("update","visualization",e.id,{type:e.type}):da("create","visualization",null,{type:e.type}),GA.save(e).then(e=>(Hp.success(window.W_L.view_save_success),e)).catch(e=>(Hp.error(window.W_L.view_save_failed),Promise.reject(e)))}(Object(l.extend)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e?ap[e]:np();return{type:a.type,name:a.name,description:"",options:t}}(h),a,{name:w,options:e,query_id:o.id})).then(e=>{!function(e,t){var a=Object(l.findIndex)(e.visualizations,e=>e.id===t.id);a>-1?e.visualizations[a]=t:e.visualizations.push(t),e.visualizations=[...e.visualizations]}(o,e),t.close(e)})},onCancel:function(){var e,a=!Object(l.isEqual)(C,g.originalOptions);(e=E||a,new Promise((t,a)=>{e?R.a.confirm({title:window.W_L.edit_view,content:window.W_L.quit_with_not_save,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,onOk:()=>t(),onCancel:()=>a()}):t()})).then(t.dismiss)},wrapProps:{"data-test":"EditVisualizationDialog"}}),n.a.createElement("div",{className:"edit-visualization-dialog"},n.a.createElement("div",{className:"visualization-settings"},n.a.createElement("div",{className:"m-b-15"},n.a.createElement("label",{htmlFor:T},window.W_L.view_type),n.a.createElement(Yr.a,{"data-test":"VisualizationType",id:T,className:"w-100",disabled:!c,value:h,onChange:function(e){y(e);var t=rp[e];E||O(t.name),x(t.getOptions(c?{}:a.options,u))}},Object(l.map)(A,e=>n.a.createElement(Yr.a.Option,{key:e.type,"data-test":"VisualizationType."+e.type},e.name)))),n.a.createElement("div",{className:"m-b-15"},n.a.createElement("label",{htmlFor:W},window.W_L.view_name),n.a.createElement(ta.a,{"data-test":"VisualizationName",id:W,className:"w-100",value:w,onChange:e=>{return t=e.target.value,O(t),void j(t!==w);var t}})),n.a.createElement("div",{"data-test":"VisualizationEditor"},n.a.createElement(SO,{type:h,data:u,options:C,visualizationName:w,onOptionsChange:N}))),n.a.createElement("div",{className:"visualization-preview"},n.a.createElement("label",{htmlFor:"visualization-preview",className:"invisible hidden-xs"},window.W_L.preview),n.a.createElement($v,{filters:m,onChange:p}),n.a.createElement("div",{className:"scrollbox","data-test":"VisualizationPreview"},n.a.createElement(jO,{type:h,data:f,options:C,visualizationName:w,onOptionsChange:N})))))}ZA.propTypes={dialog:ia.isRequired,query:ae.a.object.isRequired,visualization:Ir,queryResult:ae.a.object.isRequired},ZA.defaultProps={visualization:null};var eT=la(ZA);function tT(e,t,a){var n=Xv(a);return Object(r.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=Object(l.find)(e.visualizations,{id:a})||null;eT.showModal({query:e,visualization:r,queryResult:t}).onClose(t=>{var a=Object(l.filter)(e.visualizations,e=>e.id!==t.id);n(Object(l.extend)(e.clone(),{visualizations:[...a,t]}),t)})}),[e,t,n])}function aT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rT(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return rT(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rT(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function nT(e,t){var a=Xv(t);return Object(r.useCallback)(t=>GA.delete({id:t}).then(()=>{var r=Object(l.filter)(e.visualizations,e=>e.id!==t);a(Object(l.extend)(e.clone(),{visualizations:r}))}).catch(()=>{Hp.error("Error deleting visualization.","Maybe it's used in a dashboard?")}),[e,a])}function oT(e,t){var a=PL(e,t);return Object(r.useCallback)(t=>{da("edit_description","query",e.id),a({description:t})},[e.id,a])}function iT(e){return n.a.createElement("img",{src:"".concat("","/static/images/db-logos/").concat(e.type,".png"),width:"20",alt:e.alt})}function lT(e){var t=e.dataSource,a=e.children;return n.a.createElement(n.a.Fragment,null,n.a.createElement(iT,{type:t.type,"aria-label":t.name,title:t.name}),a||n.a.createElement("span",null,t.name))}function sT(e){return n.a.createElement(Yr.a,{className:"w-100","data-test":"SelectDataSource",placeholder:"Choose data source...",value:e.value,disabled:e.disabled,loading:e.loading,optionFilterProp:"data-name",showSearch:!0,onChange:e.onChange},Object(l.map)(e.dataSources,e=>n.a.createElement(Yr.a.Option,{key:"ds-".concat(e.id),value:e.id,"data-name":e.name,"data-test":"SelectDataSource".concat(e.id)},n.a.createElement(se,{name:"QuerySourceDropdownItem",dataSource:e}))))}iT.propTypes={type:ae.a.string,alt:ae.a.string},lT.propTypes={dataSource:ae.a.shape({name:ae.a.string,id:ae.a.oneOfType([ae.a.string,ae.a.number]),type:ae.a.string}).isRequired,children:ae.a.element},le("QuerySourceDropdownItem",lT),sT.propTypes={dataSources:ae.a.any,value:ae.a.oneOfType([ae.a.string,ae.a.number]),disabled:ae.a.bool,loading:ae.a.bool,onChange:ae.a.func},le("QuerySourceDropdown",sT);a(1606);function cT(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function uT(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cT(Object(a),!0).forEach((function(t){dT(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cT(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function dT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function mT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pT(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return pT(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pT(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function fT(e){var t,a=function(e){var t=oA(Object(r.useState)(e),2),a=t[0],n=t[1],o=oA(Object(r.useState)(e.query),2),i=o[0],s=o[1],c=oA(Object(r.useState)(a.options.apply_auto_limit),2),u=c[0],d=c[1],m=PL(a,e=>{e.id!==a.id&&sa(e.getUrl(!0),!0),n(e),s(e.query),d(e.options.apply_auto_limit)});return Object(r.useMemo)(()=>({query:a,setQuery:n,isDirty:a.query!==i||!Object(l.isEmpty)(a.query)&&a.options.apply_auto_limit!==u,saveQuery:()=>m()}),[a,i,m,u])}(e.query),o=a.query,i=a.setQuery,s=a.isDirty,c=a.saveQuery,u=function(e){var t=kA(Object(r.useState)([]),2),a=t[0],n=t[1],o=kA(Object(r.useState)(!1),2),i=o[0],s=o[1],c=Object(r.useMemo)(()=>Object(l.filter)(a,t=>!t.view_only||t.id===e.data_source_id),[a,e.data_source_id]),u=Object(r.useMemo)(()=>Object(l.find)(c,t=>Object(l.toString)(t.id)===Object(l.toString)(e.data_source_id))||null,[e.data_source_id,c]);return Object(r.useEffect)(()=>{var e=!1;return nS.query().then(t=>{e||(s(!0),n(t))}),()=>{e=!0}},[]),Object(r.useMemo)(()=>({dataSourcesLoaded:i,dataSources:c,dataSource:u}),[i,c,u])}(o),d=u.dataSourcesLoaded,p=u.dataSources,f=u.dataSource,g=mT(Object(r.useState)([]),2),b=g[0],h=g[1],y=vL(o,f),v=mT(WA(o),3),w=v[0],O=v[1],_=v[2],E=mT(cA(o.visualizations),2),j=E[0],S=E[1],C=(t=f&&f.type,ZN(ZN({},tA.get(null)),tA.get(t))),x=C.QueryEditor,P=C.SchemaBrowser,L=!Do()({minWidth:768});!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(r.useRef)();t.current=e,Object(r.useEffect)(()=>{var e=window.W_L.leave_lost_warning,a="".concat(e,"\n")+window.W_L.leave_lost_confirm,r=window.onbeforeunload;window.onbeforeunload=function(){return t.current?e:void 0};var n=A.confirmChange((e,r)=>{if(t.current&&e.path!==r.path)return a});return()=>{window.onbeforeunload=r,n()}},[])}(s);var k=LA(o),N=k.queryResult,T=k.isExecuting,W=k.executionStatus,I=k.executeQuery,q=k.error,D=k.cancelCallback,R=k.isCancelling,M=k.updatedAt,z=k.loadedInitialResults,F=Jv(N),V=Object(r.useRef)(null),U=mT(mA(b),3),B=U[0],H=U[1],Y=U[2],Q=mT(yA(f,o,i),3),K=Q[0],G=Q[1],$=Q[2],J=mT(Object(Sl.a)(e=>{i(Object(l.extend)(o.clone(),{query:e}))},100),1)[0];Object(r.useEffect)(()=>{da("view_source","query",o.id)},[o.id]),Object(r.useEffect)(()=>{document.title=o.name},[o.name]);var X=PL(o,i),Z=oT(o,i),ee=f?f.syntax||"sql":null,te=yL(ee),ae=Object(r.useCallback)(e=>{if(e)try{localStorage.setItem("lastSelectedDataSourceId",e)}catch(e){}if(o.data_source_id!==e){da("update_data_source","query",o.id,{dataSourceId:e});var t={data_source_id:e,latest_query_data_id:null,latest_query_data:null};i(Object(l.extend)(o.clone(),t)),X(t,{successMessage:null})}},[o,i,X]);Object(r.useEffect)(()=>{if(d&&y.isNew){var e=p.length>0?p[0].id:null;ae((t=[o.data_source_id,localStorage.getItem("lastSelectedDataSourceId"),e],a=p,a=Object(l.map)(a,e=>e.id),Object(l.find)(t,e=>Object(l.includes)(a,e))||null))}var t,a},[o.data_source_id,y.isNew,d,p,ae]);var re=KA(o,i),ne=function(e,t){var a=Xv(t);return Object(r.useCallback)(()=>{kv.showModal({parameter:{title:null,name:"",type:"text",value:null},existingParams:Object(l.map)(e.getParameters().get(),e=>e.name)}).onClose(t=>{var r=e.clone();t=r.getParameters().add(t),a(r,t)})},[e,a])}(o,(e,t)=>{V.current&&(V.current.paste(t.toQueryTextFragment()),V.current.focus()),i(e)}),oe=Object(r.useCallback)(e=>{V.current&&V.current.paste(e)},[]),ie=mT(Object(r.useState)(null),2),le=ie[0],ce=ie[1],ue=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y.canExecute&&(e||!O&&!T)&&(s||!Object(l.isEmpty)(le)?I(null,()=>o.getQueryResultByText(0,le)):I())}),[o,y.canExecute,O,T,s,le,I]),de=mT(Object(r.useState)(!1),2),pe=de[0],fe=de[1],ge=Object(r.useCallback)(()=>{pe||(fe(!0),c().finally(()=>fe(!1)))},[pe,c]),be=function(e,t,a,n){var o=vL(e),i=tT(e,t,n),l=aT(Object(r.useState)(!1),2),s=l[0],c=l[1];return Object(r.useEffect)(()=>{!o.isNew&&s&&(c(!1),i())},[o.isNew,s,i]),Object(r.useCallback)(()=>{o.isNew?(c(!0),a()):i()},[o.isNew,a,i])}(o,N,ge,(e,t)=>{i(e),S(t.id)}),he=tT(o,N,e=>i(e)),ye=nT(o,i);return n.a.createElement("div",{className:me()("query-page-wrapper",{"query-fixed-layout":!L})},n.a.createElement(ok,{query:o,dataSourcesAvailable:!d||p.length>0}),n.a.createElement("div",{className:"container w-100 p-b-10"},n.a.createElement(QL,{query:o,dataSource:f,sourceMode:!0,selectedVisualization:j,headerExtra:n.a.createElement(se,{name:"QuerySource.HeaderExtra",query:o}),onChange:i})),n.a.createElement("main",{className:"query-fullscreen"},n.a.createElement(fL,{direction:"horizontal",sizeAttribute:"flex-basis",toggleShortcut:"Alt+Shift+D, Alt+D"},n.a.createElement("nav",null,d&&n.a.createElement("div",{className:"editor__left__data-source"},n.a.createElement(se,{name:"QuerySourceDropdown",dataSources:p,value:f?f.id:void 0,disabled:!y.canEdit||!d||0===p.length,loading:!d,onChange:ae})),n.a.createElement("div",{className:"editor__left__schema"},n.a.createElement(P,{dataSource:f,options:o.options.schemaOptions,onOptionsUpdate:e=>i(Object(l.extend)(o.clone(),{options:uT(uT({},o.options),{},{schemaOptions:e})})),onSchemaUpdate:h,onItemSelect:oe})),!o.isNew()&&n.a.createElement("div",{className:"query-page-query-description"},n.a.createElement(KE,{isEditable:y.canEdit,markdown:!0,ignoreBlanks:!1,placeholder:window.W_L.new_desc,value:o.description,onDone:Z,multiline:!0})),!o.isNew()&&n.a.createElement(KL,{layout:"table",query:o,onEditSchedule:re}))),n.a.createElement("div",{className:"content"},n.a.createElement("div",{className:"flex-fill p-relative"},n.a.createElement("div",{className:"p-absolute d-flex flex-column p-l-15 p-r-15",style:{left:0,top:0,right:0,bottom:0,overflow:"auto"}},n.a.createElement(fL,{direction:"vertical",sizeAttribute:"flex-basis"},n.a.createElement("div",{className:"row editor"},n.a.createElement("section",{className:"query-editor-wrapper","data-test":"QueryEditor"},n.a.createElement(x,{ref:V,"data-executing":T?"true":null,syntax:f?f.syntax:null,value:o.query,schema:b,autocompleteEnabled:B&&H,onChange:J,onSelectionChange:ce}),n.a.createElement(x.Controls,{addParameterButtonProps:{title:window.W_L.new_params,shortcut:"mod+p",onClick:ne},formatButtonProps:{title:te?window.W_L.query_format:window.W_L.query_format_not_support,disabled:!f||!te,shortcut:te?"mod+shift+f":null,onClick:()=>{try{var e=(t=o.query,yL(a=ee)?(0,hL[a])(t):t);i(Object(l.extend)(o.clone(),{query:e}))}catch(e){Hp.error(String(e))}var t,a}},saveButtonProps:y.canEdit&&{text:n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"hidden-xs"},window.W_L.save),s&&!pe?"*":null),shortcut:"mod+s",onClick:ge,loading:pe},executeButtonProps:{disabled:!y.canExecute||T||O,shortcut:"mod+enter, alt+enter, ctrl+enter, shift+enter",onClick:ue,text:n.a.createElement("span",{className:"hidden-xs"},null===le?window.W_L.exec_query:window.W_L.exec_select_query)},autocompleteToggleProps:{available:B,enabled:H,onToggle:Y},autoLimitCheckboxProps:{available:K,checked:G,onChange:$},dataSourceSelectorProps:!!f&&{disabled:!y.canEdit,value:f.id,onChange:ae,options:Object(l.map)(p,e=>({value:e.id,label:e.name}))}})))),!y.isNew&&n.a.createElement(KL,{layout:"horizontal",query:o,onEditSchedule:re}),n.a.createElement("section",{className:"query-results-wrapper"},o.hasParameters()&&n.a.createElement("div",{className:"query-parameters-wrapper"},n.a.createElement(Tv,{editable:y.canEdit,sortable:y.canEdit,disableUrlUpdate:y.isNew,parameters:w,onPendingValuesChange:()=>_(),onValuesChange:()=>{_(!1),ue(!0)},onParametersEdit:()=>{s||c()}})),(q||T)&&n.a.createElement("div",{className:"query-alerts"},n.a.createElement(nk,{status:W,updatedAt:M,error:q,isCancelling:R,onCancel:D})),n.a.createElement(n.a.Fragment,null,F.log.length>0&&n.a.createElement("div",{className:"query-results-log"},n.a.createElement("p",null,"Log Information:"),Object(l.map)(F.log,(e,t)=>n.a.createElement("p",{key:"log-line-".concat(t),className:"query-log-line"},e))),z&&!(y.isNew&&!N)&&n.a.createElement(rk,{queryResult:N,visualizations:o.visualizations,showNewVisualizationButton:y.canEdit&&F.status===Da,canDeleteVisualizations:y.canEdit,selectedTab:j,onChangeTab:S,onAddVisualization:be,onDeleteVisualization:ye,refreshButton:n.a.createElement(m.a,{type:"primary",disabled:!y.canExecute||O,loading:T,onClick:ue},!T&&n.a.createElement("i",{className:"zmdi zmdi-refresh m-r-5","aria-hidden":"true"}),window.W_L.flush)}))))),N&&!N.getError()&&n.a.createElement("div",{className:"bottom-controller-container"},n.a.createElement(Ik,{query:o,queryResult:N,selectedVisualization:j,isQueryExecuting:T,showEditVisualizationButton:!y.isNew&&y.canEdit,onEditVisualization:he})))))}fT.propTypes={query:ae.a.object.isRequired};var gT=uk(fT);rf.register("Queries.New",Zt({path:"/queries/new",render:e=>n.a.createElement(gT,e),bodyClass:"fixed-layout"})),rf.register("Queries.Edit",Zt({path:"/queries/:queryId/source",render:e=>n.a.createElement(gT,e),bodyClass:"fixed-layout"}));var bT=a(734),hT=a.n(bT),yT=a(733),vT=a.n(yT);function wT(){return(wT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function OT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _T(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _T(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ET(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function jT(e){var t=e.title,a=e.shortcut,o=e.disabled,i=e.children,l=e.onClick,s=ET(e,["title","shortcut","disabled","children","onClick"]),c=OT(Object(r.useState)(!1),2),u=c[0],d=c[1],p=Object(r.useMemo)(()=>({onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)}),[]);return Object(r.useEffect)(()=>{o&&d(!1)},[o]),Object(r.useEffect)(()=>{if(a){var e={[a]:l};return uy.bind(e),()=>{uy.unbind(e)}}},[a,l]),n.a.createElement(yN,{title:t,shortcut:a,visible:u},n.a.createElement("span",p,n.a.createElement(m.a,wT({"data-test":"ExecuteButton",disabled:o,onClick:l,style:o?{pointerEvents:"none"}:{}},s),i)))}jT.propTypes={className:ae.a.string,shortcut:ae.a.string,disabled:ae.a.bool,children:ae.a.node,onClick:ae.a.func},jT.defaultProps={className:null,shortcut:null,disabled:!1,children:null,onClick:()=>{}};a(1607);function ST(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return CT(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return CT(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CT(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function xT(e){var t=ST(Object(r.useState)(e.query),2),a=t[0],o=t[1],i=ST(Object(r.useState)(),2),l=i[0],s=i[1],c=vL(a,l),u=ST(WA(a),3),d=u[0],p=u[1],f=u[2],g=ST(cA(a.visualizations),2),b=g[0],h=g[1],y=Do()({minWidth:768}),v=Do()({minHeight:500})&&y,w=ST(PE(),2),O=w[0],_=w[1],E=ST(Object(r.useState)(!1),2),j=E[0],S=E[1],C=LA(a),x=C.queryResult,P=C.loadedInitialResults,L=C.isExecuting,k=C.executionStatus,N=C.executeQuery,A=C.error,T=C.cancelCallback,W=C.isCancelling,I=C.updatedAt,q=Jv(x),D=oT(a,o),R=KA(a,o),M=tT(a,x,(e,t)=>{o(e),h(t.id)}),z=tT(a,x,e=>o(e)),F=nT(a,o),V=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c.canExecute&&(e||!p&&!L)&&N()}),[p,N,L,c.canExecute]);return Object(r.useEffect)(()=>{document.title=a.name},[a.name]),Object(r.useEffect)(()=>{nS.get({id:a.data_source_id}).then(s)},[a.data_source_id]),n.a.createElement("div",{className:me()("query-page-wrapper",{"query-view-fullscreen":O,"query-fixed-layout":v})},n.a.createElement("div",{className:"container w-100"},n.a.createElement(QL,{query:a,dataSource:l,onChange:o,selectedVisualization:b,headerExtra:n.a.createElement(se,{name:"QueryView.HeaderExtra",query:a},Z.canRun(a)&&n.a.createElement(jT,{className:"m-r-5",type:"primary",shortcut:"mod+enter, alt+enter, ctrl+enter",disabled:!c.canExecute||L||p,onClick:V},window.W_L.flush)),tagsExtra:!a.description&&c.canEdit&&!j&&!O&&n.a.createElement(ge,{className:"label label-tag hidden-xs",role:"none",onClick:()=>S(!0)},n.a.createElement("i",{className:"zmdi zmdi-plus m-r-5","aria-hidden":"true"}),window.W_L.new_desc)}),(a.description||j)&&n.a.createElement("div",{className:me()("m-t-5",{hidden:O})},n.a.createElement(KE,{className:"w-100",value:a.description,isEditable:c.canEdit,onDone:D,onStopEditing:()=>S(!1),placeholder:"Add description",ignoreBlanks:!1,editorProps:{autoSize:{minRows:2,maxRows:4}},defaultEditing:j,multiline:!0}))),n.a.createElement("div",{className:"query-view-content"},a.hasParameters()&&n.a.createElement("div",{className:me()("bg-white tiled p-15 m-t-15 m-l-15 m-r-15",{hidden:O})},n.a.createElement(Tv,{parameters:d,onValuesChange:()=>{f(!1),V(!0)},onPendingValuesChange:()=>f()})),n.a.createElement("div",{className:"query-results m-t-15"},P&&n.a.createElement(rk,{queryResult:x,visualizations:a.visualizations,showNewVisualizationButton:c.canEdit&&q.status===Da,canDeleteVisualizations:c.canEdit,selectedTab:b,onChangeTab:h,onAddVisualization:M,onDeleteVisualization:F,refreshButton:Z.canRun(a)&&n.a.createElement(m.a,{type:"primary",disabled:!c.canExecute||p,loading:L,onClick:V},!L&&n.a.createElement("i",{className:"zmdi zmdi-refresh m-r-5","aria-hidden":"true"}),window.W_L.flush_now),canRefresh:Z.canRun(a)}),n.a.createElement("div",{className:"query-results-footer"},x&&!x.getError()&&n.a.createElement(Ik,{query:a,queryResult:x,selectedVisualization:b,isQueryExecuting:L,showEditVisualizationButton:c.canEdit,onEditVisualization:z,extraActions:n.a.createElement(jT,{className:"icon-button m-r-5 hidden-xs",title:window.W_L.toggle_screen,type:"default",shortcut:"alt+f",onClick:_},O?n.a.createElement(vT.a,null):n.a.createElement(hT.a,null))}),(A||L)&&n.a.createElement("div",{className:"query-execution-status"},n.a.createElement(nk,{status:k,error:A,isCancelling:W,onCancel:T,updatedAt:I})))),n.a.createElement("div",{className:me()("p-t-15 p-r-15 p-l-15",{hidden:O})},n.a.createElement(KL,{layout:"horizontal",query:a,dataSource:l,onEditSchedule:R}))))}xT.propTypes={query:ae.a.object.isRequired};var PT=uk(xT);function LT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return kT(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kT(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kT(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function NT(e){var t=e.queryName,a=e.queryDescription,r=e.visualization;return n.a.createElement("div",{className:"embed-heading p-b-10 p-r-15 p-l-15"},n.a.createElement("h3",null,n.a.createElement("img",{src:vt.a,alt:"DeepBI Logo",style:{height:"24px",verticalAlign:"text-bottom"}}),n.a.createElement(Rv,{visualization:r})," ",t,a&&n.a.createElement("small",null,n.a.createElement(We,{className:"markdown text-muted"},Ie.markdown.toHTML(a||"")))))}function AT(e){var t=e.query,a=e.queryResults,r=e.updatedAt,o=e.refreshStartedAt,i=e.queryUrl,l=e.hideTimestamp,s=e.apiKey,c=n.a.createElement(ue.a,null,n.a.createElement(ue.a.Item,null,n.a.createElement(kk,{fileType:"csv",query:t,queryResult:a,apiKey:s,disabled:!a||!a.getData||!a.getData(),embed:!0},n.a.createElement(xk.a,null)," ",window.W_L.save_as_csv)),n.a.createElement(ue.a.Item,null,n.a.createElement(kk,{fileType:"tsv",query:t,queryResult:a,apiKey:s,disabled:!a||!a.getData||!a.getData(),embed:!0},n.a.createElement(xk.a,null)," ",window.W_L.save_as_tsv)),n.a.createElement(ue.a.Item,null,n.a.createElement(kk,{fileType:"xlsx",query:t,queryResult:a,apiKey:s,disabled:!a||!a.getData||!a.getData(),embed:!0},n.a.createElement(Lk.a,null),window.W_L.save_as_excel)));return n.a.createElement("div",{className:"tile__bottom-control"},!l&&n.a.createElement("span",null,n.a.createElement("span",{className:"small hidden-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",o?n.a.createElement(qv,{from:o}):n.a.createElement(qf,{date:r})),n.a.createElement("span",{className:"small visible-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",Vf(r))),i&&n.a.createElement("span",{className:"hidden-print"},n.a.createElement(we,{title:window.W_L.open_in_redash},n.a.createElement(h.Button,{className:"icon-button",href:i,target:"_blank"},n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Open in Tap"))),!t.hasParameters()&&n.a.createElement(Vt.a,{overlay:c,disabled:!a,trigger:["click"],placement:"topLeft"},n.a.createElement(m.a,{loading:!a&&!!o,className:"m-l-5"},window.W_L.save_as,n.a.createElement("i",{className:"fa fa-caret-up m-l-5","aria-hidden":"true"})))))}function TT(e){var t=e.queryId,a=e.visualizationId,o=e.apiKey,i=e.onError,s=LT(Object(r.useState)(null),2),c=s[0],u=s[1],d=LT(Object(r.useState)(null),2),m=d[0],p=d[1],f=LT(Object(r.useState)(null),2),g=f[0],b=f[1],h=LT(Object(r.useState)(null),2),y=h[0],v=h[1],w=Xv(i);Object(r.useEffect)(()=>{var e=!1;return Za.get({id:t}).then(t=>{e||u(t)}).catch(w),()=>{e=!0}},[t,w]);var O=Object(r.useCallback)(()=>{c&&(p(null),b(Ea()()),c.getQueryResultPromise().then(e=>{v(e)}).catch(e=>{p(e.getError())}).finally(()=>b(null)))},[c]);if(Object(r.useEffect)(()=>{document.querySelector("body").classList.add("headless"),O()},[O]),!c)return null;var _=Object(l.has)(A.search,"hide_header"),E=Object(l.has)(A.search,"hide_parameters"),j=Object(l.has)(A.search,"hide_link"),S=Object(l.has)(A.search,"hide_timestamp"),C=Object(l.has)(A.search,"showDescription");a=parseInt(a,10);var x=Object(l.find)(c.visualizations,e=>e.id===a);return x?n.a.createElement("div",{className:"tile m-t-10 m-l-10 m-r-10 p-t-10 embed__vis","data-test":"VisualizationEmbed"},!_&&n.a.createElement(NT,{queryName:c.name,queryDescription:C?c.description:null,visualization:x}),n.a.createElement("div",{className:"col-md-12 query__vis"},!E&&c.hasParameters()&&n.a.createElement("div",{className:"p-t-15 p-b-10"},n.a.createElement(Tv,{parameters:c.getParametersDefs(),onValuesChange:O})),m&&n.a.createElement("div",{className:"alert alert-danger","data-test":"ErrorMessage"},"Error: ".concat(m)),!m&&y&&n.a.createElement(AO,{visualization:x,queryResult:y,context:"widget"}),!y&&g&&n.a.createElement("div",{className:"d-flex justify-content-center"},n.a.createElement("div",{className:"spinner"},n.a.createElement("i",{className:"zmdi zmdi-refresh zmdi-hc-spin zmdi-hc-5x","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Refreshing...")))),n.a.createElement(AT,{query:c,queryResults:y,updatedAt:y?y.getUpdatedAt():void 0,refreshStartedAt:g,queryUrl:j?null:c.getUrl(),hideTimestamp:S,apiKey:o})):(setTimeout(()=>{i(new Error(window.W_L.view_not_exist))},10),null)}function WT(){return(WT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function IT(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function qT(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?IT(Object(a),!0).forEach((function(t){DT(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):IT(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function DT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function RT(e){var t=e.querySnippet,a=e.dialog,o=e.readOnly,i=Object(r.useCallback)((e,r,n)=>{var o=Object(l.get)(t,"id");Object(l.isNil)(e.description)&&(e.description=""),a.close(o?qT({id:o},e):e).then(()=>r(window.W_L.save_success)).catch(()=>n(window.W_L.save_failed))},[a,t]),s=!!Object(l.get)(t,"id"),c=[{name:"trigger",title:window.W_L.code,type:"text",required:!0,autoFocus:!s},{name:"description",title:window.W_L.desc,type:"text"},{name:"snippet",title:window.W_L.query_code,type:"ace",required:!0}].map(e=>qT(qT({},e),{},{readOnly:o,initialValue:Object(l.get)(t,e.name,"")})),u=Se("querySnippetForm");return n.a.createElement(R.a,WT({},a.props,{title:s?t.trigger:window.W_L.create_query,footer:[n.a.createElement(m.a,WT({key:"cancel"},a.props.cancelButtonProps,{onClick:a.dismiss}),o?window.W_L.close:window.W_L.cancel),!o&&n.a.createElement(m.a,WT({key:"submit"},a.props.okButtonProps,{disabled:o||a.props.okButtonProps.disabled,htmlType:"submit",type:"primary",form:u,"data-test":"SaveQuerySnippetButton"}),s?window.W_L.save:window.W_L.create)],wrapProps:{"data-test":"QuerySnippetDialog"}}),n.a.createElement(nP,{id:u,fields:c,onSubmit:i,hideSubmitButton:!0,feedbackIcons:!0}))}rf.register("Queries.View",Zt({path:"/queries/:queryId",render:e=>n.a.createElement(PT,e)})),NT.propTypes={queryName:ae.a.string.isRequired,queryDescription:ae.a.string,visualization:Ir.isRequired},NT.defaultProps={queryDescription:""},AT.propTypes={query:ae.a.object.isRequired,queryResults:ae.a.object,updatedAt:ae.a.string,refreshStartedAt:Tf,queryUrl:ae.a.string,hideTimestamp:ae.a.bool,apiKey:ae.a.string},AT.defaultProps={queryResults:null,updatedAt:null,refreshStartedAt:null,queryUrl:null,hideTimestamp:!1,apiKey:null},TT.propTypes={queryId:ae.a.string.isRequired,visualizationId:ae.a.string,apiKey:ae.a.string.isRequired,onError:ae.a.func},TT.defaultProps={onError:()=>{}},rf.register("Visualizations.ViewShared",ox({path:"/embed/query/:queryId/visualization/:visualizationId",render:e=>n.a.createElement(TT,e),getApiKey:()=>A.search.api_key})),RT.propTypes={dialog:ia.isRequired,querySnippet:ae.a.object,readOnly:ae.a.bool},RT.defaultProps={querySnippet:null,readOnly:!1};var MT=la(RT);a(1612);function zT(){return(zT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function FT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var VT=e=>H.isAdmin||H.id===Object(l.get)(e,"user.id");class UT extends n.a.Component{constructor(){var e;super(...arguments),e=this,FT(this,"listColumns",[ng.custom.sortable((e,t)=>n.a.createElement(ge,{type:"link",className:"table-main-title",onClick:()=>this.showSnippetDialog(t)},t.trigger),{title:window.W_L.snippet_script,field:"trigger",className:"text-nowrap"}),ng.custom.sortable(e=>e,{title:window.W_L.desc,field:"description",className:"text-nowrap"}),ng.custom(e=>n.a.createElement("code",{className:"snippet-content"},e),{title:window.W_L.script,field:"snippet"}),ng.avatar({field:"user",className:"p-l-0 p-r-0"},e=>window.W_L.create_user+" ".concat(e)),ng.date.sortable({title:window.W_L.create_time,field:"created_at",className:"text-nowrap",width:"1%"}),ng.custom((e,t)=>VT(t)&&n.a.createElement(m.a,{type:"danger",className:"w-100",onClick:e=>this.deleteQuerySnippet(e,t)},window.W_L.delete),{width:"1%"})]),FT(this,"saveQuerySnippet",e=>(e.id?pN.save:pN.create)(e)),FT(this,"deleteQuerySnippet",(e,t)=>{R.a.confirm({title:window.W_L.delete_snippet_script,content:window.W_L.delete_snippet_script_confirm,okText:window.W_L.ok_text,okType:"danger",cancelText:window.W_L.cancel,onOk:()=>{pN.delete(t).then(()=>{Hp.success(window.W_L.delete_snippet_script_success),this.props.controller.update()}).catch(()=>{Hp.error(window.W_L.delete_snippet_script_failed)})}})}),FT(this,"showSnippetDialog",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=!t||VT(t);sa("query_snippets/"+Object(l.get)(t,"id","new"),!0);var r=()=>sa("query_snippets",!0);MT.showModal({querySnippet:t,readOnly:!a}).onClose(t=>e.saveQuerySnippet(t).then(()=>{e.props.controller.update(),r()})).onDismiss(r)}))}componentDidMount(){var e=this.props.controller.params,t=e.isNewOrEditPage,a=e.querySnippetId;t&&("new"===a?Z.isCreateQuerySnippetEnabled()?this.showSnippetDialog():sa("query_snippets",!0):pN.get({id:a}).then(this.showSnippetDialog).catch(e=>{this.props.controller.handleError(e)}))}render(){var e=this.props.controller;return n.a.createElement("div",null,n.a.createElement("div",{className:"m-b-15"},n.a.createElement(m.a,{type:"primary",onClick:()=>this.showSnippetDialog(),disabled:!Z.isCreateQuerySnippetEnabled()},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.new_snippet_script)),!e.isLoaded&&n.a.createElement(mb,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center"},window.W_L.no_snippet_script,Z.isCreateQuerySnippetEnabled()&&n.a.createElement("div",{className:"m-t-5"},n.a.createElement(ge,{type:"link",onClick:()=>this.showSnippetDialog()},window.W_L.new_snippet_script)," ")),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive query-snippets-table"},n.a.createElement(og,{items:e.pageItems,columns:this.listColumns,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))}}FT(UT,"propTypes",{controller:Bg.isRequired});var BT=fP("QuerySnippets.List",{permission:"create_query",title:window.W_L.snippet_script,path:"query_snippets",order:5},Hg(UT,()=>new ib({isPlainList:!0,getRequest:()=>({}),getResource:()=>pN.query.bind(pN)}),()=>new cb({orderByField:"trigger",itemsPerPage:10})));rf.register("QuerySnippets.List",Zt({path:"/query_snippets",title:window.W_L.snippet_script,render:e=>n.a.createElement(BT,zT({},e,{currentPage:"query_snippets"}))})),rf.register("QuerySnippets.NewOrEdit",Zt({path:"/query_snippets/:querySnippetId",title:window.W_L.snippet_script,render:e=>n.a.createElement(BT,zT({},e,{currentPage:"query_snippets",isNewOrEditPage:!0}))}));a(1613);function HT(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function YT(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?HT(Object(a),!0).forEach((function(t){QT(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):HT(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function QT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function KT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return GT(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return GT(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GT(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function $T(e){var t=e.onError,a=KT(Object(r.useState)({}),2),n=a[0],o=a[1],i=KT(Object(r.useState)({}),2),s=i[0],c=i[1],u=KT(Object(r.useState)(!0),2),d=u[0],m=u[1],p=KT(Object(r.useState)(!1),2),f=p[0],g=p[1],b=Xv(t);Object(r.useEffect)(()=>{da("view","page","org_settings");var e=!1;return Yp().then(t=>{if(!e){var a=Object(l.get)(t,"settings");o(a),c(YT({},a)),m(!1)}}).catch(t=>{e||b(t)}),()=>{e=!0}},[b]);var h=Object(r.useCallback)(e=>{c(t=>YT(YT({},t),e))},[]),y=Object(r.useCallback)(()=>{f||(g(!0),Qp(s).then(e=>{var t,a=Object(l.get)(e,"settings");o(a),c(YT({},a)),t={dateFormat:s.date_format,timeFormat:s.time_format,dateTimeFormat:"".concat(s.date_format," ").concat(s.time_format)},Object(l.extend)(Y,t)}).catch(b).finally(()=>g(!1)))},[f,s,b]);return{settings:n,currentValues:s,isLoading:d,isSaving:f,handleSubmit:y,handleChange:h}}var JT={settings:ae.a.object,values:ae.a.object,onChange:ae.a.func,loading:ae.a.bool},XT={settings:{},values:{},onChange:()=>{},loading:!1};function ZT(){return(ZT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function eW(e){var t=e.values,a=e.onChange,r=e.loading;return n.a.createElement(se,ZT({name:"OrganizationSettings.FormatSettings"},e),n.a.createElement(Vb.a.Item,{label:window.W_L.date_format},r?n.a.createElement(Of.a.Input,{style:{width:300},active:!0}):n.a.createElement(Yr.a,{value:t.date_format,onChange:e=>a({date_format:e}),"data-test":"DateFormatSelect"},Y.dateFormatList.map(e=>n.a.createElement(Yr.a.Option,{key:e,"data-test":"DateFormatSelect:".concat(e)},e)))),n.a.createElement(Vb.a.Item,{label:window.W_L.time_format},r?n.a.createElement(Of.a.Input,{style:{width:300},active:!0}):n.a.createElement(Yr.a,{value:t.time_format,onChange:e=>a({time_format:e}),"data-test":"TimeFormatSelect"},Y.timeFormatList.map(e=>n.a.createElement(Yr.a.Option,{key:e},e)))))}function tW(){return(tW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function aW(e){var t=e.values,a=e.onChange,r=e.loading;return n.a.createElement(se,tW({name:"OrganizationSettings.PlotlySettings"},e),n.a.createElement(Vb.a.Item,{label:window.W_L.hidden_tool_bar+"(Chart)"},r?n.a.createElement(Of.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement($r.a,{name:"hide_plotly_mode_bar",checked:t.hide_plotly_mode_bar,onChange:e=>a({hide_plotly_mode_bar:e.target.checked})},window.W_L.hidden_tool_bar)))}eW.propTypes=JT,eW.defaultProps=XT,aW.propTypes=JT,aW.defaultProps=XT;var rW=a(209),nW=a.n(rW);function oW(){return(oW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function iW(e){var t=e.values,a=e.onChange,r=e.loading;return n.a.createElement(se,oW({name:"OrganizationSettings.FeatureFlagsSettings"},e),n.a.createElement(Vb.a.Item,{label:window.W_L.feature_flags},r?n.a.createElement(n.a.Fragment,null,n.a.createElement(nW.a,null,n.a.createElement(Of.a,{title:!1,paragraph:{width:[300,300,300],rows:3},active:!0}))):n.a.createElement(n.a.Fragment,null,n.a.createElement(se,oW({name:"OrganizationSettings.FeatureFlagsSettings.PermissionsControl"},e),n.a.createElement(nW.a,null,n.a.createElement($r.a,{name:"feature_show_permissions_control",checked:t.feature_show_permissions_control,onChange:e=>a({feature_show_permissions_control:e.target.checked})},window.W_L.enable_multiple_owners_tip))),n.a.createElement(nW.a,null,n.a.createElement($r.a,{name:"send_email_on_failed_scheduled_queries",checked:t.send_email_on_failed_scheduled_queries,onChange:e=>a({send_email_on_failed_scheduled_queries:e.target.checked})},window.W_L.when_query_error_info_by_email)),n.a.createElement(nW.a,null,n.a.createElement($r.a,{name:"multi_byte_search_enabled",checked:t.multi_byte_search_enabled,onChange:e=>a({multi_byte_search_enabled:e.target.checked})},window.W_L.dashboard_language_tip)))))}function lW(){return(lW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function sW(e){var t=e.values,a=e.onChange,r=e.loading;return n.a.createElement(se,lW({name:"OrganizationSettings.BeaconConsentSettings"},e),n.a.createElement(Vb.a.Item,{label:n.a.createElement("span",null,window.W_L.help_share_anonymous_data,n.a.createElement(Ge,{className:"m-l-5 m-r-5",type:"USAGE_DATA_SHARING"}))},r?n.a.createElement(Of.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement($r.a,{name:"beacon_consent",checked:t.beacon_consent,onChange:e=>a({beacon_consent:e.target.checked})},window.W_L.help_redash_improve_tip)))}function cW(){return(cW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function uW(e){return n.a.createElement(se,cW({name:"OrganizationSettings.GeneralSettings"},e),n.a.createElement("h3",{className:"m-t-0"},window.W_L.params),n.a.createElement("hr",null),n.a.createElement(eW,e),n.a.createElement(aW,e),n.a.createElement(iW,e),n.a.createElement(sW,e))}function dW(){return(dW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function mW(e){var t=e.settings,a=e.values,r=e.onChange,o=e.loading,i=!Y.googleLoginEnabled&&!Y.ldapLoginEnabled&&!a.auth_saml_enabled;return n.a.createElement(se,dW({name:"OrganizationSettings.PasswordLoginSettings"},e),!o&&!t.auth_password_login_enabled&&n.a.createElement(u.a,{message:window.W_L.disable_password_tip,type:"warning",className:"m-t-15 m-b-15"}),n.a.createElement(Vb.a.Item,{label:window.W_L.password_login},o?n.a.createElement(Of.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement($r.a,{checked:a.auth_password_login_enabled,disabled:i,onChange:e=>r({auth_password_login_enabled:e.target.checked})},n.a.createElement(we,{title:i?window.W_L.enable_password_login_tip:null,placement:"right"},window.W_L.enable_password))))}function pW(){return(pW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fW(e){var t=e.values,a=e.onChange;return Y.googleLoginEnabled?n.a.createElement(se,pW({name:"OrganizationSettings.GoogleLoginSettings"},e),n.a.createElement("h4",null,window.W_L.google_login),n.a.createElement(Vb.a.Item,{label:"{window.W_L.allow} Google Apps Domains"},n.a.createElement(Yr.a,{mode:"tags",value:t.auth_google_apps_domains,onChange:e=>a({auth_google_apps_domains:e})}),!Object(l.isEmpty)(t.auth_google_apps_domains)&&n.a.createElement(u.a,{message:n.a.createElement("p",null,window.W_L.google_login_tip,n.a.createElement("strong",null,Object(l.join)(t.auth_google_apps_domains,", ")),window.W_L.google_login_auto_reg),className:"m-t-15"}))):null}function gW(){return(gW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function bW(e){var t=e.values,a=e.onChange,r=e.loading;return n.a.createElement(se,gW({name:"OrganizationSettings.SAMLSettings"},e),n.a.createElement("h4",null,"SAML"),n.a.createElement(Vb.a.Item,{label:window.W_L.enable_saml},r?n.a.createElement(Of.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement(kn.a.Group,{onChange:e=>{var t={auth_saml_enabled:!!e.target.value};e.target.value&&(t.auth_saml_type=e.target.value),a(t)},value:t.auth_saml_enabled&&(t.auth_saml_type||"dynamic")},n.a.createElement(kn.a,{value:!1},window.W_L.disable),n.a.createElement(kn.a,{value:"static"},window.W_L.enable,"(",window.W_L.static,")"),n.a.createElement(kn.a,{value:"dynamic"},window.W_L.enable,"(",window.W_L.dynamic,")"))),t.auth_saml_enabled&&n.a.createElement(n.a.Fragment,null,"static"===t.auth_saml_type&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Vb.a.Item,{label:"SAML Single Sign-on URL"},n.a.createElement(ta.a,{value:t.auth_saml_sso_url,onChange:e=>a({auth_saml_sso_url:e.target.value})})),n.a.createElement(Vb.a.Item,{label:"SAML Entity ID"},n.a.createElement(ta.a,{value:t.auth_saml_entity_id,onChange:e=>a({auth_saml_entity_id:e.target.value})})),n.a.createElement(Vb.a.Item,{label:"SAML x509 cert"},n.a.createElement(ta.a,{value:t.auth_saml_x509_cert,onChange:e=>a({auth_saml_x509_cert:e.target.value})}))),"dynamic"===t.auth_saml_type&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Vb.a.Item,{label:"SAML Metadata URL"},n.a.createElement(ta.a,{value:t.auth_saml_metadata_url,onChange:e=>a({auth_saml_metadata_url:e.target.value})})),n.a.createElement(Vb.a.Item,{label:"SAML Entity ID"},n.a.createElement(ta.a,{value:t.auth_saml_entity_id,onChange:e=>a({auth_saml_entity_id:e.target.value})})),n.a.createElement(Vb.a.Item,{label:"SAML NameID Format"},n.a.createElement(ta.a,{value:t.auth_saml_nameid_format,onChange:e=>a({auth_saml_nameid_format:e.target.value})})))))}function hW(){return(hW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function yW(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function vW(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yW(Object(a),!0).forEach((function(t){wW(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yW(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function wW(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function OW(e){var t=e.values,a=e.onChange,o=Object(r.useCallback)(e=>{var r=vW(vW({},t),e);!Y.googleLoginEnabled&&!Y.ldapLoginEnabled&&!r.auth_saml_enabled&&(e=vW(vW({},e),{},{auth_password_login_enabled:!0})),a(e)},[t,a]);return n.a.createElement(se,hW({name:"OrganizationSettings.AuthSettings"},e),n.a.createElement("h3",{className:"m-t-0"},window.W_L.authentication," ",n.a.createElement(Ge,{type:"AUTHENTICATION_OPTIONS"})),n.a.createElement("hr",null),n.a.createElement(mW,hW({},e,{onChange:o})),n.a.createElement(fW,hW({},e,{onChange:o})),n.a.createElement(bW,hW({},e,{onChange:o})))}function _W(){return(_W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function EW(e){var t=$T(e.onError),a=t.settings,r=t.currentValues,o=t.isLoading,i=t.isSaving,l=t.handleSubmit,s=t.handleChange;return n.a.createElement("div",{className:"row","data-test":"OrganizationSettings"},n.a.createElement("div",{className:"m-r-20 m-l-20"},n.a.createElement(Vb.a,_W({},{labelCol:{xs:{span:24},sm:{span:6},lg:{span:4}},wrapperCol:{xs:{span:24},sm:{span:12},lg:{span:10}},layout:"horizontal",className:"ant-form-horizontal--labels-left"},{onFinish:l}),n.a.createElement(uW,{loading:o,settings:a,values:r,onChange:s}),n.a.createElement(OW,{loading:o,settings:a,values:r,onChange:s}),n.a.createElement(Vb.a.Item,{wrapperCol:{xs:{span:24},sm:{span:12,offset:6},lg:{span:12,offset:4}}},o?n.a.createElement(Of.a.Button,{active:!0}):n.a.createElement(m.a,{type:"primary",htmlType:"submit",loading:i,"data-test":"OrganizationSettingsSaveButton"},window.W_L.save)))))}iW.propTypes=JT,iW.defaultProps=XT,sW.propTypes=JT,sW.defaultProps=XT,mW.propTypes=JT,mW.defaultProps=XT,fW.propTypes=JT,fW.defaultProps=XT,bW.propTypes=JT,bW.defaultProps=XT,OW.propTypes=JT,OW.defaultProps=XT,EW.propTypes={onError:ae.a.func},EW.defaultProps={onError:()=>{}};var jW=fP("Settings.Organization",{permission:"admin",title:window.W_L.sys_setting,path:"settings/general",order:6},EW);function SW(e){var t=new URL(e,window.location);return t.protocol=window.location.protocol,t.host=window.location.host,t.toString()}function CW(){return(CW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function xW(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return PW(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return PW(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PW(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}rf.register("Settings.Organization",Zt({path:"/settings/general",title:window.W_L.sys_setting,render:e=>n.a.createElement(jW,e)}));var LW=[{required:!0,name:"name",title:window.W_L.user_name,type:"text",autoFocus:!0},{required:!0,name:"email",title:"Email",type:"email"}];function kW(e){var t=e.dialog,a=xW(Object(r.useState)(null),2),o=a[0],i=a[1];Object(r.useEffect)(()=>{da("view","page","users/new")},[]);var l=Object(r.useCallback)(e=>t.close(e).catch(i),[t]),s=Se("userForm");return n.a.createElement(R.a,CW({},t.props,{title:window.W_L.create_user,footer:[n.a.createElement(m.a,CW({key:"cancel"},t.props.cancelButtonProps,{onClick:t.dismiss}),window.W_L.cancel),n.a.createElement(m.a,CW({key:"submit"},t.props.okButtonProps,{htmlType:"submit",type:"primary",form:s,"data-test":"SaveUserButton"}),window.W_L.create)],wrapProps:{"data-test":"CreateUserDialog"}}),n.a.createElement(nP,{id:s,fields:LW,onSubmit:l,hideSubmitButton:!0}),o&&n.a.createElement(u.a,{message:o.message,type:"error",showIcon:!0,"data-test":"CreateUserErrorAlert"}))}kW.propTypes={dialog:ia.isRequired};var NW=la(kW);function AW(){return(AW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function TW(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function WW(e){var t=e.user,a=e.enableUser,r=e.disableUser,o=e.deleteUser;return t.id===H.id?null:t.is_invitation_pending?n.a.createElement(m.a,{type:"danger",className:"w-100",onClick:e=>o(e,t)},window.W_L.delete):t.is_disabled?n.a.createElement(m.a,{type:"primary",className:"w-100",onClick:e=>a(e,t)},window.W_L.enable):n.a.createElement(m.a,{className:"w-100",onClick:e=>r(e,t)},window.W_L.disable)}WW.propTypes={user:ae.a.shape({id:ae.a.number,is_invitation_pending:ae.a.bool,is_disabled:ae.a.bool}).isRequired,enableUser:ae.a.func.isRequired,disableUser:ae.a.func.isRequired,deleteUser:ae.a.func.isRequired};class IW extends n.a.Component{constructor(){super(...arguments),TW(this,"sidebarMenu",[{key:"active",href:"users",title:window.W_L.enable_user},{key:"pending",href:"users/pending",title:window.W_L.invite_user},{key:"disabled",href:"users/disabled",title:window.W_L.disable_user,isAvailable:()=>Z.canCreateUser()}]),TW(this,"listColumns",[ng.custom.sortable((e,t)=>n.a.createElement(oE,{user:t,withLink:!0}),{title:window.W_L.account,field:"name",width:null}),ng.custom.sortable((e,t)=>Object(l.map)(t.groups,e=>n.a.createElement(h,{key:"group"+e.id,className:"label label-tag",href:"groups/"+e.id},e.name)),{title:window.W_L.role,field:"groups"}),ng.timeAgo.sortable({title:window.W_L.create_time,field:"created_at",className:"text-nowrap",width:"1%"}),ng.timeAgo.sortable({title:window.W_L.active_time,field:"active_at",className:"text-nowrap",width:"1%"}),ng.custom((e,t)=>n.a.createElement(WW,{user:t,enableUser:this.enableUser,disableUser:this.disableUser,deleteUser:this.deleteUser}),{width:"1%",isAvailable:()=>Z.canCreateUser()})]),TW(this,"createUser",e=>cE.create(e).then(e=>{Hp.success(window.W_L.save_seccess),e.invite_link&&R.a.warning({title:window.W_L.email_send_error,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,content:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,window.W_L.email_not_setting,n.a.createElement("b",null,e.name),":"),n.a.createElement(OE,{value:SW(e.invite_link),"aria-label":"Invite link",readOnly:!0}))})}).catch(e=>{var t=Object(l.find)([Object(l.get)(e,"response.data.message"),Object(l.get)(e,"message"),window.W_L.save_failed],l.isString);return Promise.reject(new Error(t))})),TW(this,"showCreateUserDialog",()=>{if(Z.isCreateUserEnabled()){var e=()=>{this.props.controller.params.isNewUserPage&&sa("users")};NW.showModal().onClose(t=>this.createUser(t).then(()=>{this.props.controller.update(),e()})).onDismiss(e)}}),TW(this,"enableUser",(e,t)=>cE.enableUser(t).then(()=>this.props.controller.update())),TW(this,"disableUser",(e,t)=>cE.disableUser(t).then(()=>this.props.controller.update())),TW(this,"deleteUser",(e,t)=>cE.deleteUser(t).then(()=>this.props.controller.update()))}componentDidMount(){this.props.controller.params.isNewUserPage&&this.showCreateUserDialog()}renderPageHeader(){return Z.canCreateUser()?n.a.createElement("div",{className:"m-b-15"},n.a.createElement(m.a,{type:"primary",disabled:!Z.isCreateUserEnabled(),onClick:this.showCreateUserDialog},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),window.W_L.create_user),n.a.createElement(se,{name:"UsersListExtra"})):null}render(){var e=this.props.controller;return n.a.createElement(n.a.Fragment,null,this.renderPageHeader(),n.a.createElement(dC,null,n.a.createElement(dC.Sidebar,{className:"m-b-0"},n.a.createElement(IC,{value:e.searchTerm,onChange:e.updateSearch,label:"Search users"}),n.a.createElement(qC,{items:this.sidebarMenu,selected:e.params.currentPage})),n.a.createElement(dC.Content,null,!e.isLoaded&&n.a.createElement(mb,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement(nC,{className:""}),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive","data-test":"UserList"},n.a.createElement(og,{items:e.pageItems,columns:this.listColumns,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement(Eg,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}TW(IW,"propTypes",{controller:Bg.isRequired});var qW=fP("Users.List",{permission:"list_users",title:window.W_L.account,path:"users",isActive:e=>e.startsWith("/users")&&"/users/me"!==e,order:2},Hg(IW,()=>new ib({getRequest(e,t){switch(t.params.currentPage){case"active":e.pending=!1;break;case"pending":e.pending=!0;break;case"disabled":e.disabled=!0}return e},getResource:()=>cE.query.bind(cE)}),()=>new ub({orderByField:"created_at",orderByReverse:!0})));rf.register("Users.New",Zt({path:"/users/new",title:window.W_L.account,render:e=>n.a.createElement(qW,AW({},e,{currentPage:"active",isNewUserPage:!0}))})),rf.register("Users.List",Zt({path:"/users",title:window.W_L.enable_user,render:e=>n.a.createElement(qW,AW({},e,{currentPage:"active"}))})),rf.register("Users.Pending",Zt({path:"/users/pending",title:window.W_L.invite_user,render:e=>n.a.createElement(qW,AW({},e,{currentPage:"pending"}))})),rf.register("Users.Disabled",Zt({path:"/users/disabled",title:window.W_L.disable_user,render:e=>n.a.createElement(qW,AW({},e,{currentPage:"disabled"}))}));a(1614);function DW(){return(DW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function RW(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function MW(e){var t=e.groups,a=e.linkGroups,r=RW(e,["groups","linkGroups"]);return n.a.createElement("div",DW({className:"user-groups"},r),Object(l.map)(t,e=>n.a.createElement(DO.a,{key:e.id},a?n.a.createElement(h,{href:"groups/".concat(e.id)},e.name):e.name)))}function zW(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return FW(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return FW(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FW(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function VW(e){var t=zW(Object(r.useState)([]),2),a=t[0],n=t[1],o=zW(Object(r.useState)(!0),2),i=o[0],s=o[1],c=Object(r.useMemo)(()=>Object(l.filter)(a,t=>Object(l.includes)(e.groupIds,t.id)),[a,e]);return Object(r.useEffect)(()=>{TP.query().then(e=>{n(Object(l.isArray)(e)?e:[]),s(!1)})},[]),Object(r.useMemo)(()=>({groups:c,allGroups:a,isLoading:i}),[c,a,i])}function UW(){return(UW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function BW(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function HW(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?BW(Object(a),!0).forEach((function(t){YW(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):BW(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function YW(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function QW(e){var t=e.user,a=e.onChange,o=VW(t),i=o.groups,s=o.allGroups,c=o.isLoading,u=Xv(a),d=Object(r.useCallback)((e,a,r)=>{var n=HW(HW({},e),{},{id:t.id});cE.save(n).then(e=>{a(window.W_L.save_success),u(cE.convertUserInfo(e))}).catch(e=>{r(Object(l.get)(e,"response.data.message","Failed saving."))})},[t,u]),m=Object(r.useMemo)(()=>Object(l.map)([{name:"name",title:window.W_L.name,type:"text",initialValue:t.name},{name:"email",title:window.W_L.email,type:"email",initialValue:t.email},t.isDisabled||H.id===t.id?{name:"group_ids",title:window.W_L.role,type:"content",required:!1,content:c?window.W_L.loading:n.a.createElement(MW,{"data-test":"Groups",groups:i})}:{name:"group_ids",title:window.W_L.role,type:"select",mode:"multiple",options:Object(l.map)(s,e=>({name:e.name,value:e.id})),initialValue:t.groupIds,loading:c,placeholder:c?window.W_L.loading:""}],e=>HW({readOnly:t.isDisabled,required:!0},e)),[t,i,s,c]);return n.a.createElement(se,UW({name:"UserProfile.UserInfoForm"},e),n.a.createElement(nP,{fields:m,onSubmit:d,hideSubmitButton:t.isDisabled}))}function KW(){return(KW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function GW(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?GW(Object(a),!0).forEach((function(t){JW(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):GW(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function JW(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function XW(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ZW(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ZW(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZW(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function eI(e){var t=e.user,a=e.onChange,o=XW(Object(r.useState)(!1),2),i=o[0],l=o[1],s=Xv(a),c=Se("apiKey"),u=Object(r.useCallback)(()=>{R.a.confirm({title:window.W_L.re_generate_api_key,content:window.W_L.re_generate_api_key_confirm,okText:window.W_L.ok_text,cancelText:window.W_L.cancel,onOk:()=>{l(!0),cE.regenerateApiKey(t).then(e=>{e&&s($W($W({},t),{},{apiKey:e}))}).finally(()=>{l(!1)})},maskClosable:!0,autoFocusButton:null})},[t,s]);return n.a.createElement(se,KW({name:"UserProfile.ApiKeyForm"},e),n.a.createElement(Vb.a,{layout:"vertical"},n.a.createElement("hr",null),n.a.createElement(Vb.a.Item,{label:"API Key",className:"m-b-10"},n.a.createElement(OE,{id:c,className:"hide-in-percy",value:t.apiKey,"data-test":"ApiKey",readOnly:!0})),n.a.createElement(m.a,{className:"w-100",onClick:u,loading:i,"data-test":"RegenerateApiKey"},window.W_L.re_generate_api_key)))}function tI(){return(tI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function aI(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function rI(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?aI(Object(a),!0).forEach((function(t){nI(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):aI(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function nI(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}MW.propTypes={groups:ae.a.arrayOf(ae.a.shape({id:ae.a.oneOfType([ae.a.number,ae.a.string]).isRequired,name:ae.a.string})),linkGroups:ae.a.bool},MW.defaultProps={groups:[],linkGroups:!0},QW.propTypes={user:xf.isRequired,onChange:ae.a.func},QW.defaultProps={onChange:()=>{}},eI.propTypes={user:xf.isRequired,onChange:ae.a.func},eI.defaultProps={onChange:()=>{}};class oI extends n.a.Component{constructor(e){super(e),nI(this,"fieldError",(e,t)=>0===t.length?window.W_L.required:"currentPassword"!==e&&t.length<6?window.W_L.too_short:"repeatPassword"===e&&t!==this.state.newPassword.value?window.W_L.do_not_match:null),nI(this,"validateFields",e=>{var t=this.state,a=t.currentPassword,r=t.newPassword,n=t.repeatPassword,o={currentPassword:this.fieldError("currentPassword",a.value),newPassword:this.fieldError("newPassword",r.value),repeatPassword:this.fieldError("repeatPassword",n.value)};this.setState({currentPassword:rI(rI({},a),{},{error:o.currentPassword}),newPassword:rI(rI({},r),{},{error:o.newPassword}),repeatPassword:rI(rI({},n),{},{error:o.repeatPassword})}),Object(l.isFunction)(e)&&e(o.currentPassword||o.newPassword||o.repeatPassword?o:null)}),nI(this,"updatePassword",()=>{var e=this.state,t=e.currentPassword,a=e.newPassword;e.updatingPassword||this.validateFields(e=>{if(e)this.setState(e=>({currentPassword:rI(rI({},e.currentPassword),{},{touched:!0}),newPassword:rI(rI({},e.newPassword),{},{touched:!0}),repeatPassword:rI(rI({},e.repeatPassword),{},{touched:!0})}));else{var r={id:this.props.user.id,old_password:t.value,password:a.value};this.setState({updatingPassword:!0}),cE.save(r).then(()=>{Hp.success(window.W_L.save_success),this.props.dialog.close({success:!0})}).catch(e=>{Hp.error(Object(l.get)(e,"response.data.message",window.W_L.save_failed)),this.setState({updatingPassword:!1})})}})}),nI(this,"handleChange",e=>{var t=e.target,a=t.name,r=t.value,n=this.state[a].error;this.setState({[a]:{value:r,error:n,touched:!0}},()=>{this.validateFields()})}),this.state={currentPassword:{value:"",error:null,touched:!1},newPassword:{value:"",error:null,touched:!1},repeatPassword:{value:"",error:null,touched:!1},updatingPassword:!1}}render(){var e=this.props.dialog,t=this.state,a=t.currentPassword,r=t.newPassword,o=t.repeatPassword,i=t.updatingPassword,l={className:"m-b-10",required:!0},s={onChange:this.handleChange,onPressEnter:this.updatePassword};return n.a.createElement(R.a,tI({},e.props,{okButtonProps:{loading:i},onOk:this.updatePassword,title:window.W_L.change_password,okText:window.W_L.ok_text,cancelText:window.W_L.cancel}),n.a.createElement(Vb.a,{layout:"vertical"},n.a.createElement(Vb.a.Item,tI({},l,{validateStatus:a.touched&&a.error?"error":null,help:a.touched?a.error:null,label:window.W_L.current_password}),n.a.createElement(ta.a.Password,tI({},s,{name:"currentPassword","data-test":"CurrentPassword",autoFocus:!0}))),n.a.createElement(Vb.a.Item,tI({},l,{validateStatus:r.touched&&r.error?"error":null,help:r.touched?r.error:null,label:window.W_L.new_password}),n.a.createElement(ta.a.Password,tI({},s,{name:"newPassword","data-test":"NewPassword"}))),n.a.createElement(Vb.a.Item,tI({},l,{validateStatus:o.touched&&o.error?"error":null,help:o.touched?o.error:null,label:window.W_L.repeat_password}),n.a.createElement(ta.a.Password,tI({},s,{name:"repeatPassword","data-test":"RepeatPassword"})))))}}nI(oI,"propTypes",{user:xf.isRequired,dialog:ia.isRequired});var iI=la(oI);function lI(){return(lI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function sI(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function cI(e){var t=e.user,a=e.passwordLink,r=sI(e,["user","passwordLink"]);return Object(l.isString)(a)?n.a.createElement(se,lI({name:"UserProfile.PasswordLinkAlert"},e),n.a.createElement(u.a,lI({message:window.W_L.email_send_error,description:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,window.W_L.email_not_setting,n.a.createElement("b",null,t.name),":"),n.a.createElement(OE,{value:SW(a),"aria-label":"Password link",readOnly:!0})),type:"warning",className:"m-t-20",closable:!0},r))):null}function uI(){return(uI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function dI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return mI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mI(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function pI(e){var t=e.user,a=dI(Object(r.useState)(!1),2),o=a[0],i=a[1],l=dI(Object(r.useState)(null),2),s=l[0],c=l[1],u=Object(r.useCallback)(()=>{i(!0),cE.sendPasswordReset(t).then(e=>{c(e)}).finally(()=>{i(!1)})},[t]);return n.a.createElement(se,uI({name:"UserProfile.PasswordResetForm"},e),n.a.createElement(m.a,{className:"w-100 m-t-10",onClick:u,loading:o},window.W_L.email_reset_password_send),n.a.createElement(cI,{user:t,passwordLink:s,afterClose:()=>c(null)}))}function fI(){return(fI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function gI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bI(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function hI(e){var t=e.user,a=gI(Object(r.useState)(!1),2),o=a[0],i=a[1],l=gI(Object(r.useState)(null),2),s=l[0],c=l[1],u=Object(r.useCallback)(()=>{i(!0),cE.resendInvitation(t).then(e=>{c(e)}).finally(()=>{i(!1)})},[t]);return n.a.createElement(se,fI({name:"UserProfile.ResendInvitationForm"},e),n.a.createElement(m.a,{className:"w-100 m-t-10",onClick:u,loading:o},window.W_L.email_re_send_invite),n.a.createElement(cI,{user:t,passwordLink:s,afterClose:()=>c(null)}))}function yI(){return(yI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function vI(e){var t=e.user,a=Object(r.useCallback)(()=>{iI.showModal({user:t})},[t]);return n.a.createElement(se,yI({name:"UserProfile.PasswordForm"},e),n.a.createElement("h5",null,window.W_L.password),t.id===H.id&&n.a.createElement(m.a,{className:"w-100 m-t-10",onClick:a,"data-test":"ChangePassword"},window.W_L.change_password),t.id!==H.id&&H.isAdmin&&n.a.createElement(n.a.Fragment,null,t.isInvitationPending?n.a.createElement(hI,{user:t}):n.a.createElement(pI,{user:t})))}function wI(){return(wI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function OI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _I(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function EI(e){var t=e.user,a=e.onChange,o=OI(Object(r.useState)(!1),2),i=o[0],l=o[1],s=Xv(a),c=Object(r.useCallback)(()=>{var e=t.isDisabled?cE.enableUser:cE.disableUser;l(!0),e(t).then(e=>{e&&s(cE.convertUserInfo(e))}).finally(()=>{l(!1)})},[t,s]);if(!H.isAdmin||t.id===H.id)return null;var u={type:t.isDisabled?"primary":"danger",children:t.isDisabled?window.W_L.enable_user:window.W_L.disable_user};return n.a.createElement(se,{name:"UserProfile.ToggleUserForm"},n.a.createElement(m.a,wI({className:"w-100 m-t-10",onClick:c,loading:i},u)))}function jI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return SI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return SI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SI(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function CI(e){var t=jI(Object(r.useState)(e.user),2),a=t[0],o=t[1];return Object(r.useEffect)(()=>{o(e.user)},[e.user]),n.a.createElement("div",{className:"col-md-4 col-md-offset-4"},n.a.createElement("img",{alt:"Profile",src:a.profileImageUrl,className:"profile__image",width:"40"}),n.a.createElement("h3",{className:"profile__h3"},a.name),n.a.createElement("hr",null),n.a.createElement(QW,{user:a,onChange:o}),!a.isDisabled&&n.a.createElement(n.a.Fragment,null,n.a.createElement(eI,{user:a,onChange:o}),n.a.createElement("hr",null),n.a.createElement(vI,{user:a})),n.a.createElement("hr",null),n.a.createElement(EI,{user:a,onChange:o}))}function xI(e){var t=e.user,a=VW(t),r=a.groups,o=a.isLoading;return n.a.createElement("div",{className:"col-md-4 col-md-offset-4 profile__container"},n.a.createElement("img",{alt:"profile",src:t.profileImageUrl,className:"profile__image",width:"40"}),n.a.createElement("h3",{className:"profile__h3"},t.name),n.a.createElement("hr",null),n.a.createElement("dl",{className:"profile__dl"},n.a.createElement("dt",null,window.W_L.name,"："),n.a.createElement("dd",null,t.name),n.a.createElement("dt",null,window.W_L.email,"："),n.a.createElement("dd",null,t.email),n.a.createElement("dt",{className:"m-b-5"},window.W_L.role,"："),n.a.createElement("dd",null,o?window.W_L.loading:n.a.createElement(MW,{groups:r}))))}cI.propTypes={user:xf.isRequired,passwordLink:ae.a.string},cI.defaultProps={passwordLink:null},pI.propTypes={user:xf.isRequired},hI.propTypes={user:xf.isRequired},vI.propTypes={user:xf.isRequired},EI.propTypes={user:xf.isRequired,onChange:ae.a.func},EI.defaultProps={onChange:()=>{}},CI.propTypes={user:xf.isRequired},xI.propTypes={user:xf.isRequired};a(1615);function PI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return LI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return LI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LI(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function kI(e){var t=e.userId,a=e.onError,o=PI(Object(r.useState)(null),2),i=o[0],l=o[1],s=Xv(a);Object(r.useEffect)(()=>{var e=!1;return cE.get({id:t||H.id}).then(t=>{e||l(cE.convertUserInfo(t))}).catch(t=>{e||s(t)}),()=>{e=!0}},[t,s]);var c=i&&(H.isAdmin||H.id===i.id);return n.a.createElement(n.a.Fragment,null,n.a.createElement(xh,{featureName:window.W_L.invite_email,className:"m-b-20",adminOnly:!0}),n.a.createElement("div",{className:"row"},!i&&n.a.createElement(mb,{className:""}),i&&n.a.createElement(se,{name:"UserProfile",user:i},!c&&n.a.createElement(xI,{user:i}),c&&n.a.createElement(CI,{user:i}))))}kI.propTypes={userId:ae.a.string,onError:ae.a.func},kI.defaultProps={userId:null,onError:()=>{}};var NI=fP("Users.Account",{title:window.W_L.personal_setting,path:"users/me",order:7},kI);rf.register("Users.Account",Zt({path:"/users/me",title:window.W_L.personal_setting,render:e=>n.a.createElement(NI,e)})),rf.register("Users.ViewOrEdit",Zt({path:"/users/:userId",title:window.W_L.account,render:e=>n.a.createElement(NI,e)}));var AI=a(429),TI=a.n(AI),WI=a(242),II=a.n(WI);function qI(){return(qI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var DI=e=>{var t=e.excelList,a=e.delList;function r(e){var t=e.item,r=e.keySuffix,o={key:"card".concat(r),className:"visual-card",children:n.a.createElement("div",{style:{display:"flex",alignItems:"center",position:"relative",height:"100%",width:"100%"}},n.a.createElement("div",{style:{position:"absolute",right:"0",top:"-10px",fontSize:"16px",color:"#999898"},onClick:()=>(e=>{a(e)})(t)}," ",n.a.createElement(II.a,null)),n.a.createElement("img",{alt:t.source_name,src:TI.a}),n.a.createElement("h3",null,t.source_name))};return n.a.createElement(ge,qI({type:"link"},o))}return n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-lg-12 d-inline-flex flex-wrap visual-card-list"},t.map((e,t)=>n.a.createElement(r,{key:t,item:e,keySuffix:t.toString()}))))};a(1616);function RI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return MI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return MI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MI(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var zI=()=>{var e=RI(Object(r.useState)([]),2),t=e[0],a=e[1],o=RI(Object(r.useState)(!1),2),i=o[0],l=o[1],s=()=>{var e,t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(B.get("api/upload"));case 2:e=r.sent,t=e.data,a(t);case 5:case"end":return r.stop()}}),null,null,null,Promise)};Object(r.useEffect)(()=>{s()},[]);var c={name:"file",accept:".csv,.xlsx,.xls",customRequest:e=>{l(!0);var t=new FormData;t.append("file",e.file),B.post("/api/upload",t).then(t=>{e.onSuccess(),l(!1),s()}).catch(t=>{e.onError(),l(!1)})},onChange(e){}};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"row1"},!t&&n.a.createElement(mb,{className:""}),t&&n.a.createElement(n.a.Fragment,null,n.a.createElement(xx.a,c,n.a.createElement(m.a,{type:"primary",disabled:i}," ",n.a.createElement(Lx.a,null),window.W_L.upload)),n.a.createElement(DI,{excelList:t,delList:e=>regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(B.delete("api/upload/".concat(e.id)));case 2:s();case 3:case"end":return t.stop()}}),null,null,null,Promise)}))))},FI=fP("Upload.ExcelUpload",{title:window.W_L.excel_upload,path:"upload/excel",order:8},zI);function VI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return UI(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return UI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function UI(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}rf.register("Upload.ExcelUpload",Zt({path:"/upload/excel",title:window.W_L.excel_upload,render:e=>n.a.createElement(FI,e)}));var BI,HI,YI=()=>{var e=VI(Vb.a.useForm(),1)[0],t=VI(Object(r.useState)(!1),2),a=t[0],o=t[1],i=VI(Object(r.useState)("DeepInsight"),2),l=i[0],s=i[1],c=Object(r.useCallback)(()=>{var t,a,r,n,i,l,c,u;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:return o(!0),d.next=3,regeneratorRuntime.awrap(B.get("/api/ai_token"));case 3:t=d.sent,(a=t.data).in_use?(s(a.in_use),r=a.OpenAI,n=void 0===r?{}:r,i=a.DeepInsight,l=void 0===i?{}:i,c=a.Azure,u=void 0===c?{}:c,e.setFieldsValue({ApiKey:l.ApiKey||"",OpenaiApiKey:n.OpenaiApiKey||"",HttpProxyHost:n.HttpProxyHost||"",HttpProxyPort:n.HttpProxyPort||"",ApiHost:n.ApiHost||"",AzureApiKey:u.AzureApiKey||"",AzureHost:u.AzureHost||""})):e.setFieldsValue(a),o(!1);case 7:case"end":return d.stop()}}),null,null,null,Promise)},[e]);Object(r.useEffect)(()=>{c()},[c]);var u=(t,a)=>{var r={in_use:l,OpenAI:{OpenaiApiKey:e.getFieldValue("OpenaiApiKey")||"",HttpProxyHost:e.getFieldValue("HttpProxyHost")||"",HttpProxyPort:e.getFieldValue("HttpProxyPort")||"",ApiHost:e.getFieldValue("ApiHost")||""},DeepInsight:{ApiKey:e.getFieldValue("ApiKey")||""},Azure:{AzureApiKey:e.getFieldValue("AzureApiKey")||"",AzureHost:e.getFieldValue("AzureHost")||""}};B.post("/api/ai_token",r).then(e=>{if(200===e.code){if(a)return void a(t);XE.a.success(window.W_L.save_success),c()}else XE.a.error(window.W_L.save_failed);o(!1)}).catch(e=>{XE.a.error(window.W_L.save_failed),o(!1)})},d=e=>{try{"api"===e.receiver&&(200===e.state?XE.a.success(e.data.content):XE.a.error(e.data.content),o(!1))}catch(e){o(!1)}},p=e=>{var t,a,r,n,i;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:return o(!0),t={user_id:H.id,user_name:H.name,chat_id:0,message:{state:200,receiver:"sender",chat_type:"test",data:{data_type:"apikey",content:e,language_mode:window.W_L.language_mode}}},l.prev=2,l.next=5,regeneratorRuntime.awrap(fetch(MS,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify(t)}));case 5:(a=l.sent).body&&a.body.getReader?(r=a.body.getReader(),n=new TextDecoder,i="",r.read().then((function e(t){var a=t.done,o=t.value;if(a)console.log("Stream complete");else{var l=(i+=n.decode(o,{stream:!0})).split("---ENDOFMESSAGE---");i=l.pop(),l.forEach(e=>{try{var t=JSON.parse(e);d(t)}catch(e){console.error("Error parsing JSON:",e)}}),r.read().then(e)}}))):console.log("Streaming not supported"),l.next=13;break;case 9:l.prev=9,l.t0=l.catch(2),console.error("Fetch error:",l.t0),o(!1);case 13:case"end":return l.stop()}}),null,null,[[2,9]],Promise)};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"row1",style:{width:"50%",margin:"auto"}},n.a.createElement(Vb.a,{form:e,layout:"vertical",disabled:a,onFinish:e=>{o(!0),void 0===e.HttpProxyPort&&(e.HttpProxyPort=""),void 0===e.HttpProxyHost&&(e.HttpProxyHost=""),void 0===e.ApiHost&&(e.ApiHost=""),u(e)}},n.a.createElement(Vb.a.Item,null,n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement("h4",{style:{marginRight:"30px"}},"AI:"),n.a.createElement(kn.a.Group,{onChange:e=>{s(e.target.value)},value:l},n.a.createElement(kn.a,{value:"DeepInsight"},"DeepInsight"),n.a.createElement(kn.a,{value:"OpenAI"},"OpenAI"),n.a.createElement(kn.a,{value:"Azure"},"Azure")))),"DeepInsight"===l&&n.a.createElement(Vb.a.Item,{name:"ApiKey",label:"ApiKey",rules:[{required:!0,message:window.W_L.please_enter_api_key}]},n.a.createElement(ta.a,{placeholder:"ApiKey"})),"OpenAI"===l&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Vb.a.Item,{name:"OpenaiApiKey",label:"OpenaiApiKey",rules:[{required:!0,message:window.W_L.please_enter_api_key}]},n.a.createElement(ta.a,{placeholder:"OpenaiApiKey"})),n.a.createElement(Vb.a.Item,{name:"HttpProxyHost",label:"HttpProxyHost"},n.a.createElement(ta.a,{placeholder:"HttpProxyHost"})),n.a.createElement(Vb.a.Item,{name:"HttpProxyPort",label:"HttpProxyPort"},n.a.createElement(ta.a,{placeholder:"HttpProxyPort"})),n.a.createElement(Vb.a.Item,{name:"ApiHost",label:"ApiHost"},n.a.createElement(ta.a,{placeholder:"ApiHost"}))),"Azure"===l&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Vb.a.Item,{name:"AzureApiKey",label:"AzureApiKey",rules:[{required:!0,message:window.W_L.please_enter_api_key}]},n.a.createElement(ta.a,{placeholder:"AzureApiKey"})),n.a.createElement(Vb.a.Item,{name:"AzureHost",label:"AzureHost",rules:[{required:!0,message:window.W_L.please_enter_api_host}]},n.a.createElement(ta.a,{placeholder:"AzureHost"}))),n.a.createElement(Vb.a.Item,{style:{textAlign:"right"}},n.a.createElement("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}},"OpenAI"===l?n.a.createElement(n.a.Fragment,null):n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement(Lt.a,{style:{marginRight:"3px",color:"#2196f3"}}),n.a.createElement(h,{href:"https://holmes.bukeshiguang.com/",rel:"noopener noreferrer",target:"_blank"},window.W_L.click_here_to_get_apikey)),n.a.createElement("div",null,n.a.createElement(m.a,{loading:a,style:{marginRight:"10px"},onClick:()=>{e.validateFields().then(e=>{u(e,p)})}},window.W_L.connect_test),n.a.createElement(m.a,{loading:a,htmlType:"submit",type:"primary"},window.W_L.apply)))))))},QI=fP("Settings.OpenKey",{title:"API Key",path:"settings/OpenKey",order:9},YI);function KI(e){for(var t=e.target;t&&"A"!==t.tagName;)t=t.parentNode;if(t&&t.hasAttribute("href")&&!t.hasAttribute("download")&&!t.dataset.skipRouter&&!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){var a=t.getAttribute("target");Object(l.isString)(a)&&"_blank"===a.toLowerCase()||(e.preventDefault(),sa(t.href))}}rf.register("Settings.OpenKey",Zt({path:"/settings/OpenKey",title:"API Key",render:e=>n.a.createElement(QI,e)})),vf.a.setDefaultIndicator(n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading..."))),(BI=a(1617)).keys().forEach(BI),(HI=a(1809)).keys().map(HI).map(e=>e.default).filter(l.isFunction).filter(e=>e.init).map(e=>e());var GI=a(29),$I=a.n(GI),JI=a(735),XI=a.n(JI);a(1810);function ZI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return eq(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return eq(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eq(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var tq={init(){window.addEventListener("offline",()=>{var e;Hp.warning("Please check your Internet connection.",null,{key:"connectionNotification",duration:null}),e="connectionNotification",window.addEventListener("online",(function t(){Hp.close(e),window.removeEventListener("online",t)}))})}};i.a.render(n.a.createElement((function(){var e=ZI(Object(r.useState)(null),2),t=e[0],a=e[1],o=ZI(Object(r.useState)(null),2),i=o[0],l=o[1];return Object(r.useEffect)(()=>{t&&t.title&&(document.title=t.title)},[t]),Object(r.useEffect)(()=>{function e(e){e.preventDefault(),l(e.error)}return document.body.addEventListener("click",KI,!1),window.addEventListener("error",e,!1),()=>{document.body.removeEventListener("click",KI,!1),window.removeEventListener("error",e,!1)}},[]),i?n.a.createElement(nt,{error:i}):("CN"===window.W_L.language_mode?Ea.a.locale("zh-cn"):Ea.a.locale("en"),n.a.createElement($I.a,{locale:"CN"===window.W_L.language_mode?XI.a:""},n.a.createElement(JE.Toaster,null),n.a.createElement(mt,{routes:rf.items,onRouteChange:a})))}),null),document.getElementById("application-root"),()=>{tq.init()})}]));
//# sourceMappingURL=app.js.map